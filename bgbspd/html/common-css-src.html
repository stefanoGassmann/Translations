<!-- BG custom styling -->
<style type="text/css">
/* Fix for line numbers not visible */
pre.numberSource code > span {
    left: -1em;
}
pre.numberSource {
    margin-left: initial;
}

/* Put some space after the section numbers */
span.toc-section-number::after {
    content: "\a0\a0\a0";  /* non-breaking whitespace */
}

/* Hide underlines on code number links */
pre > code.sourceCode > span > a:first-child::before {
    text-decoration: none;
}

/* Color the source blocks */
div.sourceCode {
    background-color: #f0f0f0;
}

/* Fix iOS big text rendering issue */
pre > code.sourceCode > span {
    display: initial;
}


/* Color the inline code */
code:not(.sourceCode) {
    background: #f0f0f0;
    padding-left: 0.2em;
    padding-right: 0.2em;
    border-radius: 0.2em;
}

pre.sourceCode {
    border: 1px solid #ccc;
    padding: 0.5em;
    border-radius: 0.2em;
}

/* Keep code tags from wrapping in tables */
tbody code {
    white-space: nowrap;
}

td {
    vertical-align: top;
}

body {
    font-size: 12pt;
    max-width: 43em;
    font-family: sans-serif;
}

html {
    background: #f9f9f9;
}

figure > embed {
    max-width: 100%;
}

figure {
    text-align: center;
    margin-top: 2em;
    margin-bottom: 2em;
}

figcaption {
    font-size: 0.9em;
    font-style: italic;
    margin-top: 0.6em;
}

body {
    counter-reset: figure-counter-major;
    counter-reset: figure-counter-minor;
}

figure {
    counter-increment: figure-counter-minor;
}

figcaption::before {
    content: "Figure " counter(figure-counter-major) "." counter(figure-counter-minor) ": ";
}

/*
In multipage, we need to reset the figure counter to the chapter
number. Luckily, this is in the <h1 data-number> attribute. Unluckily,
there is no way to get this in a general way.

This doesn't work:

  h1[data-number] {
    counter-set: figure-counter-major attr(data-number);
  }

Nor this:

  h1[data-number] {
    --figure-counter-major-value: attr(data-number);
    counter-set: figure-counter-major var(--figure-counter-major-value);
  }

So, dumbly, we have a bunch of rules for all these sections, up to the
maximum possible section.

Here's a program to generate them:

  for (let i = 1; i < 100; i++)
      console.log(`h1[data-number="${i}"]{counter-set:figure-counter-major ${i};counter-reset:figure-counter-minor;}`);

Note to self: never write a book with more than 99 frickin' chapters.
*/

h1[data-number="1"]{counter-set:figure-counter-major 1;counter-reset:figure-counter-minor;}
h1[data-number="2"]{counter-set:figure-counter-major 2;counter-reset:figure-counter-minor;}
h1[data-number="3"]{counter-set:figure-counter-major 3;counter-reset:figure-counter-minor;}
h1[data-number="4"]{counter-set:figure-counter-major 4;counter-reset:figure-counter-minor;}
h1[data-number="5"]{counter-set:figure-counter-major 5;counter-reset:figure-counter-minor;}
h1[data-number="6"]{counter-set:figure-counter-major 6;counter-reset:figure-counter-minor;}
h1[data-number="7"]{counter-set:figure-counter-major 7;counter-reset:figure-counter-minor;}
h1[data-number="8"]{counter-set:figure-counter-major 8;counter-reset:figure-counter-minor;}
h1[data-number="9"]{counter-set:figure-counter-major 9;counter-reset:figure-counter-minor;}
h1[data-number="10"]{counter-set:figure-counter-major 10;counter-reset:figure-counter-minor;}
h1[data-number="11"]{counter-set:figure-counter-major 11;counter-reset:figure-counter-minor;}
h1[data-number="12"]{counter-set:figure-counter-major 12;counter-reset:figure-counter-minor;}
h1[data-number="13"]{counter-set:figure-counter-major 13;counter-reset:figure-counter-minor;}
h1[data-number="14"]{counter-set:figure-counter-major 14;counter-reset:figure-counter-minor;}
h1[data-number="15"]{counter-set:figure-counter-major 15;counter-reset:figure-counter-minor;}
h1[data-number="16"]{counter-set:figure-counter-major 16;counter-reset:figure-counter-minor;}
h1[data-number="17"]{counter-set:figure-counter-major 17;counter-reset:figure-counter-minor;}
h1[data-number="18"]{counter-set:figure-counter-major 18;counter-reset:figure-counter-minor;}
h1[data-number="19"]{counter-set:figure-counter-major 19;counter-reset:figure-counter-minor;}
h1[data-number="20"]{counter-set:figure-counter-major 20;counter-reset:figure-counter-minor;}
h1[data-number="21"]{counter-set:figure-counter-major 21;counter-reset:figure-counter-minor;}
h1[data-number="22"]{counter-set:figure-counter-major 22;counter-reset:figure-counter-minor;}
h1[data-number="23"]{counter-set:figure-counter-major 23;counter-reset:figure-counter-minor;}
h1[data-number="24"]{counter-set:figure-counter-major 24;counter-reset:figure-counter-minor;}
h1[data-number="25"]{counter-set:figure-counter-major 25;counter-reset:figure-counter-minor;}
h1[data-number="26"]{counter-set:figure-counter-major 26;counter-reset:figure-counter-minor;}
h1[data-number="27"]{counter-set:figure-counter-major 27;counter-reset:figure-counter-minor;}
h1[data-number="28"]{counter-set:figure-counter-major 28;counter-reset:figure-counter-minor;}
h1[data-number="29"]{counter-set:figure-counter-major 29;counter-reset:figure-counter-minor;}
h1[data-number="30"]{counter-set:figure-counter-major 30;counter-reset:figure-counter-minor;}
h1[data-number="31"]{counter-set:figure-counter-major 31;counter-reset:figure-counter-minor;}
h1[data-number="32"]{counter-set:figure-counter-major 32;counter-reset:figure-counter-minor;}
h1[data-number="33"]{counter-set:figure-counter-major 33;counter-reset:figure-counter-minor;}
h1[data-number="34"]{counter-set:figure-counter-major 34;counter-reset:figure-counter-minor;}
h1[data-number="35"]{counter-set:figure-counter-major 35;counter-reset:figure-counter-minor;}
h1[data-number="36"]{counter-set:figure-counter-major 36;counter-reset:figure-counter-minor;}
h1[data-number="37"]{counter-set:figure-counter-major 37;counter-reset:figure-counter-minor;}
h1[data-number="38"]{counter-set:figure-counter-major 38;counter-reset:figure-counter-minor;}
h1[data-number="39"]{counter-set:figure-counter-major 39;counter-reset:figure-counter-minor;}
h1[data-number="40"]{counter-set:figure-counter-major 40;counter-reset:figure-counter-minor;}
h1[data-number="41"]{counter-set:figure-counter-major 41;counter-reset:figure-counter-minor;}
h1[data-number="42"]{counter-set:figure-counter-major 42;counter-reset:figure-counter-minor;}
h1[data-number="43"]{counter-set:figure-counter-major 43;counter-reset:figure-counter-minor;}
h1[data-number="44"]{counter-set:figure-counter-major 44;counter-reset:figure-counter-minor;}
h1[data-number="45"]{counter-set:figure-counter-major 45;counter-reset:figure-counter-minor;}
h1[data-number="46"]{counter-set:figure-counter-major 46;counter-reset:figure-counter-minor;}
h1[data-number="47"]{counter-set:figure-counter-major 47;counter-reset:figure-counter-minor;}
h1[data-number="48"]{counter-set:figure-counter-major 48;counter-reset:figure-counter-minor;}
h1[data-number="49"]{counter-set:figure-counter-major 49;counter-reset:figure-counter-minor;}
h1[data-number="50"]{counter-set:figure-counter-major 50;counter-reset:figure-counter-minor;}
h1[data-number="51"]{counter-set:figure-counter-major 51;counter-reset:figure-counter-minor;}
h1[data-number="52"]{counter-set:figure-counter-major 52;counter-reset:figure-counter-minor;}
h1[data-number="53"]{counter-set:figure-counter-major 53;counter-reset:figure-counter-minor;}
h1[data-number="54"]{counter-set:figure-counter-major 54;counter-reset:figure-counter-minor;}
h1[data-number="55"]{counter-set:figure-counter-major 55;counter-reset:figure-counter-minor;}
h1[data-number="56"]{counter-set:figure-counter-major 56;counter-reset:figure-counter-minor;}
h1[data-number="57"]{counter-set:figure-counter-major 57;counter-reset:figure-counter-minor;}
h1[data-number="58"]{counter-set:figure-counter-major 58;counter-reset:figure-counter-minor;}
h1[data-number="59"]{counter-set:figure-counter-major 59;counter-reset:figure-counter-minor;}
h1[data-number="60"]{counter-set:figure-counter-major 60;counter-reset:figure-counter-minor;}
h1[data-number="61"]{counter-set:figure-counter-major 61;counter-reset:figure-counter-minor;}
h1[data-number="62"]{counter-set:figure-counter-major 62;counter-reset:figure-counter-minor;}
h1[data-number="63"]{counter-set:figure-counter-major 63;counter-reset:figure-counter-minor;}
h1[data-number="64"]{counter-set:figure-counter-major 64;counter-reset:figure-counter-minor;}
h1[data-number="65"]{counter-set:figure-counter-major 65;counter-reset:figure-counter-minor;}
h1[data-number="66"]{counter-set:figure-counter-major 66;counter-reset:figure-counter-minor;}
h1[data-number="67"]{counter-set:figure-counter-major 67;counter-reset:figure-counter-minor;}
h1[data-number="68"]{counter-set:figure-counter-major 68;counter-reset:figure-counter-minor;}
h1[data-number="69"]{counter-set:figure-counter-major 69;counter-reset:figure-counter-minor;}
h1[data-number="70"]{counter-set:figure-counter-major 70;counter-reset:figure-counter-minor;}
h1[data-number="71"]{counter-set:figure-counter-major 71;counter-reset:figure-counter-minor;}
h1[data-number="72"]{counter-set:figure-counter-major 72;counter-reset:figure-counter-minor;}
h1[data-number="73"]{counter-set:figure-counter-major 73;counter-reset:figure-counter-minor;}
h1[data-number="74"]{counter-set:figure-counter-major 74;counter-reset:figure-counter-minor;}
h1[data-number="75"]{counter-set:figure-counter-major 75;counter-reset:figure-counter-minor;}
h1[data-number="76"]{counter-set:figure-counter-major 76;counter-reset:figure-counter-minor;}
h1[data-number="77"]{counter-set:figure-counter-major 77;counter-reset:figure-counter-minor;}
h1[data-number="78"]{counter-set:figure-counter-major 78;counter-reset:figure-counter-minor;}
h1[data-number="79"]{counter-set:figure-counter-major 79;counter-reset:figure-counter-minor;}
h1[data-number="80"]{counter-set:figure-counter-major 80;counter-reset:figure-counter-minor;}
h1[data-number="81"]{counter-set:figure-counter-major 81;counter-reset:figure-counter-minor;}
h1[data-number="82"]{counter-set:figure-counter-major 82;counter-reset:figure-counter-minor;}
h1[data-number="83"]{counter-set:figure-counter-major 83;counter-reset:figure-counter-minor;}
h1[data-number="84"]{counter-set:figure-counter-major 84;counter-reset:figure-counter-minor;}
h1[data-number="85"]{counter-set:figure-counter-major 85;counter-reset:figure-counter-minor;}
h1[data-number="86"]{counter-set:figure-counter-major 86;counter-reset:figure-counter-minor;}
h1[data-number="87"]{counter-set:figure-counter-major 87;counter-reset:figure-counter-minor;}
h1[data-number="88"]{counter-set:figure-counter-major 88;counter-reset:figure-counter-minor;}
h1[data-number="89"]{counter-set:figure-counter-major 89;counter-reset:figure-counter-minor;}
h1[data-number="90"]{counter-set:figure-counter-major 90;counter-reset:figure-counter-minor;}
h1[data-number="91"]{counter-set:figure-counter-major 91;counter-reset:figure-counter-minor;}
h1[data-number="92"]{counter-set:figure-counter-major 92;counter-reset:figure-counter-minor;}
h1[data-number="93"]{counter-set:figure-counter-major 93;counter-reset:figure-counter-minor;}
h1[data-number="94"]{counter-set:figure-counter-major 94;counter-reset:figure-counter-minor;}
h1[data-number="95"]{counter-set:figure-counter-major 95;counter-reset:figure-counter-minor;}
h1[data-number="96"]{counter-set:figure-counter-major 96;counter-reset:figure-counter-minor;}
h1[data-number="97"]{counter-set:figure-counter-major 97;counter-reset:figure-counter-minor;}
h1[data-number="98"]{counter-set:figure-counter-major 98;counter-reset:figure-counter-minor;}
h1[data-number="99"]{counter-set:figure-counter-major 99;counter-reset:figure-counter-minor;}


</style>
