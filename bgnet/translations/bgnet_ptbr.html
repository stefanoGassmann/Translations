<html>
<head><meta http-equiv=Content-Type content="text/html; charset=UTF-8">
<style type="text/css">
<!--
span.cls_003{font-family:"DejaVu Serif",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_003{font-family:"DejaVu Serif",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_002{font-family:Arial,serif;font-size:22.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_002{font-family:Arial,serif;font-size:22.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_004{font-family:Arial,serif;font-size:14.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_004{font-family:Arial,serif;font-size:14.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_005{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_005{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_023{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: underline}
div.cls_023{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_006{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_006{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_007{font-family:Arial,serif;font-size:16.8px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_007{font-family:Arial,serif;font-size:16.8px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_008{font-family:Arial,serif;font-size:11.2px;color:rgb(144,31,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_008{font-family:Arial,serif;font-size:11.2px;color:rgb(144,31,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_009{font-family:Arial,serif;font-size:11.2px;color:rgb(61,153,107);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_009{font-family:Arial,serif;font-size:11.2px;color:rgb(61,153,107);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_010{font-family:Arial,serif;font-size:11.2px;color:rgb(61,107,153);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_010{font-family:Arial,serif;font-size:11.2px;color:rgb(61,107,153);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_024{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: underline}
div.cls_024{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_011{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_011{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_012{font-family:Arial,serif;font-size:11.2px;color:rgb(188,121,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_012{font-family:Arial,serif;font-size:11.2px;color:rgb(188,121,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_013{font-family:Arial,serif;font-size:11.2px;color:rgb(63,103,114);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_013{font-family:Arial,serif;font-size:11.2px;color:rgb(63,103,114);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_014{font-family:Arial,serif;font-size:11.2px;color:rgb(0,112,31);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_014{font-family:Arial,serif;font-size:11.2px;color:rgb(0,112,31);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_015{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_015{font-family:Arial,serif;font-size:9.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_016{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_016{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_025{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: underline}
div.cls_025{font-family:Arial,serif;font-size:11.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_017{font-family:Arial,serif;font-size:10.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_017{font-family:Arial,serif;font-size:10.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_018{font-family:Courier New,serif;font-size:10.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_018{font-family:Courier New,serif;font-size:10.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_019{font-family:Arial,serif;font-size:24.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_019{font-family:Arial,serif;font-size:24.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_020{font-family:Arial,serif;font-size:11.2px;color:rgb(255,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_020{font-family:Arial,serif;font-size:11.2px;color:rgb(255,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_026{font-family:Arial,serif;font-size:11.2px;color:rgb(84,26,138);font-weight:normal;font-style:normal;text-decoration: underline}
div.cls_026{font-family:Arial,serif;font-size:11.2px;color:rgb(84,26,138);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_027{font-family:"DejaVu Sans Condensed",serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: underline}
div.cls_027{font-family:"DejaVu Sans Condensed",serif;font-size:11.2px;color:rgb(0,0,237);font-weight:normal;font-style:normal;text-decoration: none}
-->
</style>
<script type="text/javascript" src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/wz_jsgraphics.js"></script>
</head>
<body>
<div style="position:absolute;left:50%;margin-left:-297px;top:0px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background001.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:80.65px" class="cls_002"><span class="cls_002">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:60.99px;top:123.06px" class="cls_004"><span class="cls_004">Usando Internet Sockets</span></div>
<div style="position:absolute;left:60.99px;top:155.89px" class="cls_005"><span class="cls_005">Brian “Beej Jorgensen” Hall</span></div>
<div style="position:absolute;left:60.99px;top:181.07px" class="cls_005"><span class="cls_005">v3.1.2, Copyright © Novembro 13, 2019</span></div>
<div style="position:absolute;left:88.97px;top:206.25px" class="cls_023"><span class="cls_023">Intro</span></div>
<div style="position:absolute;left:116.95px;top:220.24px" class="cls_023"><span class="cls_023">Ao público</span></div>
<div style="position:absolute;left:116.95px;top:234.22px" class="cls_023"><span class="cls_023">Plataforma e Compilador</span></div>
<div style="position:absolute;left:116.95px;top:248.21px" class="cls_023"><span class="cls_023">Homepa</span><span class="cls_006">g</span><span class="cls_023">e O cial e livros a venda</span></div>
<div style="position:absolute;left:116.95px;top:262.20px" class="cls_023"><span class="cls_023">Nota para pro</span><span class="cls_006">g</span><span class="cls_023">ramadores Solaris/SunOS</span></div>
<div style="position:absolute;left:116.95px;top:276.19px" class="cls_023"><span class="cls_023">Observa</span><span class="cls_006">ç</span><span class="cls_023">ão para </span><span class="cls_006">p</span><span class="cls_023">ro</span><span class="cls_006">g</span><span class="cls_023">ramadores Windows</span></div>
<div style="position:absolute;left:116.95px;top:290.18px" class="cls_023"><span class="cls_023">Política Email</span></div>
<div style="position:absolute;left:116.95px;top:304.17px" class="cls_023"><span class="cls_023">Mirrorin</span><span class="cls_006">g</span></div>
<div style="position:absolute;left:116.95px;top:318.16px" class="cls_023"><span class="cls_023">Nota para Tradutores</span></div>
<div style="position:absolute;left:116.95px;top:332.15px" class="cls_023"><span class="cls_023">Direitos autorais, distribui</span><span class="cls_006">ç</span><span class="cls_023">ão e informa</span><span class="cls_006">ç</span><span class="cls_023">ões le</span><span class="cls_006">g</span><span class="cls_023">ais</span></div>
<div style="position:absolute;left:116.95px;top:346.14px" class="cls_023"><span class="cls_023">Dedicatória</span></div>
<div style="position:absolute;left:116.95px;top:360.13px" class="cls_023"><span class="cls_023">Publicando Informa</span><span class="cls_006">ç</span><span class="cls_023">ões</span></div>
<div style="position:absolute;left:88.97px;top:374.11px" class="cls_023"><span class="cls_023">O que é um socket?</span></div>
<div style="position:absolute;left:116.95px;top:388.10px" class="cls_023"><span class="cls_023">Dois tipos de Internet Sockets</span></div>
<div style="position:absolute;left:116.95px;top:402.09px" class="cls_023"><span class="cls_023">Baixo nível nonsense e Teoria de Rede</span></div>
<div style="position:absolute;left:88.97px;top:417.01px" class="cls_023"><span class="cls_023">Endere</span><span class="cls_006">ç</span><span class="cls_023">os IP, structs, e Data Mun</span><span class="cls_006">g</span><span class="cls_023">in</span><span class="cls_006">g</span></div>
<div style="position:absolute;left:116.95px;top:431.94px" class="cls_023"><span class="cls_023">Endere</span><span class="cls_006">ç</span><span class="cls_023">os IP, versões 4 e 6</span></div>
<div style="position:absolute;left:144.93px;top:445.92px" class="cls_023"><span class="cls_023">Subnets</span></div>
<div style="position:absolute;left:144.93px;top:459.91px" class="cls_023"><span class="cls_023">Números de Porta</span></div>
<div style="position:absolute;left:116.95px;top:473.90px" class="cls_023"><span class="cls_023">B</span><span class="cls_006">y</span><span class="cls_023">te Order</span></div>
<div style="position:absolute;left:116.95px;top:488.82px" class="cls_023"><span class="cls_023">structs</span></div>
<div style="position:absolute;left:116.95px;top:503.75px" class="cls_023"><span class="cls_023">Endere</span><span class="cls_006">ç</span><span class="cls_023">os IP, Parte Dois</span></div>
<div style="position:absolute;left:144.93px;top:517.73px" class="cls_023"><span class="cls_023">Redes Privadas </span><span class="cls_006">(</span><span class="cls_023">ou desconectadas</span><span class="cls_006">)</span></div>
<div style="position:absolute;left:88.97px;top:531.72px" class="cls_023"><span class="cls_023">Saltando de IPv4 para IPv6</span></div>
<div style="position:absolute;left:88.97px;top:545.71px" class="cls_023"><span class="cls_023">Chamadas de Sistema</span></div>
<div style="position:absolute;left:116.95px;top:560.63px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_023">—Prepare para come</span><span class="cls_006">ç</span><span class="cls_023">ar!</span></div>
<div style="position:absolute;left:116.95px;top:576.49px" class="cls_023"><span class="cls_023">socket</span><span class="cls_006">()</span><span class="cls_023">—Obtenha o descritor de arquivo!</span></div>
<div style="position:absolute;left:116.95px;top:592.34px" class="cls_023"><span class="cls_023">bind</span><span class="cls_006">()</span><span class="cls_023">—Em que porta eu estou?</span></div>
<div style="position:absolute;left:116.95px;top:608.20px" class="cls_023"><span class="cls_023">connect</span><span class="cls_006">()</span><span class="cls_023">—Ei</span><span class="cls_006">,</span><span class="cls_023"> você!</span></div>
<div style="position:absolute;left:116.95px;top:624.05px" class="cls_023"><span class="cls_023">listen</span><span class="cls_006">()</span><span class="cls_023">—Al</span><span class="cls_006">g</span><span class="cls_023">uém por favor pode me li</span><span class="cls_006">g</span><span class="cls_023">ar?</span></div>
<div style="position:absolute;left:116.95px;top:639.90px" class="cls_023"><span class="cls_023">accept</span><span class="cls_006">()</span><span class="cls_023">—“Obri</span><span class="cls_006">g</span><span class="cls_023">ado por li</span><span class="cls_006">g</span><span class="cls_023">ar para a porta 3490.”</span></div>
<div style="position:absolute;left:116.95px;top:655.76px" class="cls_023"><span class="cls_023">send</span><span class="cls_006">()</span><span class="cls_023"> e recv</span><span class="cls_006">()</span><span class="cls_023">—Fale comi</span><span class="cls_006">g</span><span class="cls_023">o</span><span class="cls_006">,</span><span class="cls_023"> bab</span><span class="cls_006">y!</span></div>
<div style="position:absolute;left:116.95px;top:671.61px" class="cls_023"><span class="cls_023">sendto</span><span class="cls_006">()</span><span class="cls_023"> e recvfrom</span><span class="cls_006">()</span><span class="cls_023">—Fale comi</span><span class="cls_006">g</span><span class="cls_023">o</span><span class="cls_006">,</span><span class="cls_023"> DGRAM-st</span><span class="cls_006">y</span><span class="cls_023">le</span></div>
<div style="position:absolute;left:116.95px;top:687.47px" class="cls_023"><span class="cls_023">close</span><span class="cls_006">()</span><span class="cls_023"> e shutdown</span><span class="cls_006">()</span><span class="cls_023">—Não olhe mais na minha cara!</span></div>
<div style="position:absolute;left:116.95px;top:703.32px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etpeername</span><span class="cls_006">()</span><span class="cls_023">—Quem é você?</span></div>
<div style="position:absolute;left:116.95px;top:719.18px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostname</span><span class="cls_006">()</span><span class="cls_023">—Quem sou eu?</span></div>
<div style="position:absolute;left:88.97px;top:734.10px" class="cls_023"><span class="cls_023">Cliente-Servidor Back</span><span class="cls_006">g</span><span class="cls_023">round</span></div>
<div style="position:absolute;left:116.95px;top:748.09px" class="cls_023"><span class="cls_023">Um Servidor Stream Simples</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">1 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:851px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background002.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:116.95px;top:54.00px" class="cls_023"><span class="cls_023">Um Cliente Stream Simples</span></div>
<div style="position:absolute;left:116.95px;top:67.99px" class="cls_023"><span class="cls_023">Sockets Data</span><span class="cls_006">g</span><span class="cls_023">ram</span></div>
<div style="position:absolute;left:88.97px;top:81.98px" class="cls_023"><span class="cls_023">Técnicas Li</span><span class="cls_006">g</span><span class="cls_023">eiramente Avan</span><span class="cls_006">ç</span><span class="cls_023">adas</span></div>
<div style="position:absolute;left:116.95px;top:95.97px" class="cls_023"><span class="cls_023">Blockin</span><span class="cls_006">g</span></div>
<div style="position:absolute;left:116.95px;top:110.89px" class="cls_023"><span class="cls_023">poll</span><span class="cls_006">()</span><span class="cls_023">—Multiplexa</span><span class="cls_006">ç</span><span class="cls_023">ão Síncrona de E/S</span></div>
<div style="position:absolute;left:116.95px;top:126.74px" class="cls_023"><span class="cls_023">select</span><span class="cls_006">()</span><span class="cls_023">—Multiplexa</span><span class="cls_006">ç</span><span class="cls_023">ão Síncrona de E/S, Old School</span></div>
<div style="position:absolute;left:116.95px;top:142.60px" class="cls_023"><span class="cls_023">Manipulando send</span><span class="cls_006">()</span><span class="cls_023">s parcialmente</span></div>
<div style="position:absolute;left:116.95px;top:157.52px" class="cls_023"><span class="cls_023">Serializa</span><span class="cls_006">ç</span><span class="cls_023">ão—Como embalar Dados</span></div>
<div style="position:absolute;left:116.95px;top:171.51px" class="cls_023"><span class="cls_023">Bases do enca</span><span class="cls_006">p</span><span class="cls_023">sulamento de dados</span></div>
<div style="position:absolute;left:116.95px;top:185.50px" class="cls_023"><span class="cls_023">Pacotes Broadcast—Olá, mundo!</span></div>
<div style="position:absolute;left:88.97px;top:199.49px" class="cls_023"><span class="cls_023">Dúvidas Frequentes</span></div>
<div style="position:absolute;left:88.97px;top:213.47px" class="cls_023"><span class="cls_023">Pá</span><span class="cls_006">g</span><span class="cls_023">inas de Manual</span></div>
<div style="position:absolute;left:116.95px;top:228.40px" class="cls_023"><span class="cls_023">accept</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:243.32px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:257.31px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:271.30px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:285.28px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:299.27px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:314.19px" class="cls_023"><span class="cls_023">bind</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:329.12px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:343.11px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:357.09px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:371.08px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:385.07px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:399.99px" class="cls_023"><span class="cls_023">connect</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:414.92px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:428.90px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:442.89px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:456.88px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:470.87px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:485.79px" class="cls_023"><span class="cls_023">close</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:500.71px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:514.70px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:528.69px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:542.68px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:556.67px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:571.59px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">(), </span><span class="cls_023">freeaddrinfo</span><span class="cls_006">(), g</span><span class="cls_023">ai</span><span class="cls_006">_</span><span class="cls_023">strerror</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:586.51px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:600.50px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:614.49px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:628.48px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:642.47px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:657.39px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostname</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:672.31px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:686.30px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:700.29px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:714.28px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:728.27px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:743.19px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">name</span><span class="cls_006">(), g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">addr</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">2 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:1702px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background003.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:144.93px;top:54.00px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:67.99px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:81.98px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:95.97px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:109.96px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:124.88px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etnameinfo</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:139.80px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:153.79px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:167.78px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:181.77px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:195.75px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:210.68px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etpeername</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:225.60px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:239.59px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:253.58px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:267.56px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:281.55px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:296.48px" class="cls_023"><span class="cls_023">errno</span></div>
<div style="position:absolute;left:144.93px;top:311.40px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:325.39px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:339.37px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:353.36px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:367.35px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:382.27px" class="cls_023"><span class="cls_023">fcntl</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:397.20px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:411.18px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:425.17px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:439.16px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:453.15px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:468.07px" class="cls_023"><span class="cls_023">htons</span><span class="cls_006">(), </span><span class="cls_023">htonl</span><span class="cls_006">(), </span><span class="cls_023">ntohs</span><span class="cls_006">(), </span><span class="cls_023">ntohl</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:482.99px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:496.98px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:510.97px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:524.96px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:116.95px;top:539.88px" class="cls_023"><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">ntoa</span><span class="cls_006">(), </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">aton</span><span class="cls_006">(), </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">addr</span></div>
<div style="position:absolute;left:144.93px;top:554.80px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:568.79px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:582.78px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:596.77px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:610.76px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:625.68px" class="cls_023"><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">ntop</span><span class="cls_006">(), </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">pton</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:640.60px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:654.59px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:668.58px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:682.57px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:696.56px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:711.48px" class="cls_023"><span class="cls_023">listen</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:726.40px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:740.39px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">3 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:2553px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background004.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:144.93px;top:54.00px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:67.99px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:81.98px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:96.90px" class="cls_023"><span class="cls_023">perror</span><span class="cls_006">(), </span><span class="cls_023">strerror</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:111.82px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:125.81px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:139.80px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:153.79px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:167.78px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:182.70px" class="cls_023"><span class="cls_023">poll</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:197.62px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:211.61px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:225.60px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:239.59px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:253.58px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:268.50px" class="cls_023"><span class="cls_023">recv</span><span class="cls_006">(), </span><span class="cls_023">recvfrom</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:283.42px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:297.41px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:311.40px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:325.39px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:339.37px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:354.30px" class="cls_023"><span class="cls_023">select</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:369.22px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:383.21px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:397.20px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:411.18px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:425.17px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:440.10px" class="cls_023"><span class="cls_023">setsockopt</span><span class="cls_006">(), g</span><span class="cls_023">etsockopt</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:455.02px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:469.01px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:482.99px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:496.98px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:510.97px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:525.89px" class="cls_023"><span class="cls_023">send</span><span class="cls_006">(), </span><span class="cls_023">sendto</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:540.82px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:554.80px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:568.79px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:582.78px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:596.77px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:611.69px" class="cls_023"><span class="cls_023">shutdown</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:626.62px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:640.60px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:654.59px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:144.93px;top:668.58px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:682.57px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:697.49px" class="cls_023"><span class="cls_023">socket</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:144.93px;top:712.41px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:726.40px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:740.39px" class="cls_023"><span class="cls_023">Valor de retorno</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">4 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:3404px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background005.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:144.93px;top:54.00px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:67.99px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:116.95px;top:82.91px" class="cls_023"><span class="cls_023">struct sockaddr e companhia</span></div>
<div style="position:absolute;left:144.93px;top:97.83px" class="cls_023"><span class="cls_023">Sinopse</span></div>
<div style="position:absolute;left:144.93px;top:111.82px" class="cls_023"><span class="cls_023">Descri</span><span class="cls_006">ç</span><span class="cls_023">ão</span></div>
<div style="position:absolute;left:144.93px;top:125.81px" class="cls_023"><span class="cls_023">Exemplo</span></div>
<div style="position:absolute;left:144.93px;top:139.80px" class="cls_023"><span class="cls_023">Ve</span><span class="cls_006">j</span><span class="cls_023">a também</span></div>
<div style="position:absolute;left:88.97px;top:153.79px" class="cls_023"><span class="cls_023">Mais Referências</span></div>
<div style="position:absolute;left:116.95px;top:167.78px" class="cls_023"><span class="cls_023">Livros</span></div>
<div style="position:absolute;left:116.95px;top:181.77px" class="cls_023"><span class="cls_023">Web Referências</span></div>
<div style="position:absolute;left:116.95px;top:195.75px" class="cls_023"><span class="cls_023">RFCs</span></div>
<div style="position:absolute;left:60.99px;top:223.80px" class="cls_002"><span class="cls_002">Intro</span></div>
<div style="position:absolute;left:60.99px;top:266.77px" class="cls_005"><span class="cls_005">Hey! Programação de Sockets tem lhe deixado para baixo? É muito difícil entender a partir das</span></div>
<div style="position:absolute;left:60.99px;top:281.69px" class="cls_005"><span class="cls_005">páginas man? Você quer fazer programas legais para Internet mas você não tem tempo para</span></div>
<div style="position:absolute;left:60.99px;top:297.55px" class="cls_005"><span class="cls_005">percorrer diversas structs tentando descobrir se você precisa chamar bind() antes de</span></div>
<div style="position:absolute;left:60.99px;top:313.40px" class="cls_005"><span class="cls_005">connect(), etc., etc.</span></div>
<div style="position:absolute;left:60.99px;top:339.51px" class="cls_005"><span class="cls_005">Bem, adivinhe! Eu já  z este trabalho desagradável, e estou morrendo de vontade de</span></div>
<div style="position:absolute;left:60.99px;top:353.50px" class="cls_005"><span class="cls_005">compartilhar com todos o que aprendi! Você veio ao lugar certo. Este documento deve dar ao</span></div>
<div style="position:absolute;left:60.99px;top:367.49px" class="cls_005"><span class="cls_005">programador C médio competente o impulso que ele precisa para obter controle sobre a</span></div>
<div style="position:absolute;left:60.99px;top:381.48px" class="cls_005"><span class="cls_005">confusão que é redes.</span></div>
<div style="position:absolute;left:60.99px;top:406.66px" class="cls_005"><span class="cls_005">E con ra: Eu  nalmente caminhei para o futuro (apenas no momento certo!) e atualizei o Guia</span></div>
<div style="position:absolute;left:60.99px;top:420.65px" class="cls_005"><span class="cls_005">para IPv6! Divirta-se!</span></div>
<div style="position:absolute;left:60.99px;top:447.64px" class="cls_007"><span class="cls_007">Ao público</span></div>
<div style="position:absolute;left:60.99px;top:483.02px" class="cls_005"><span class="cls_005">Este documento foi escrito como um tutorial, não como uma referência completa. Ele</span></div>
<div style="position:absolute;left:60.99px;top:497.01px" class="cls_005"><span class="cls_005">provavelmente será mais e ciente quando lido por pessoas que estejam apenas começando</span></div>
<div style="position:absolute;left:60.99px;top:511.00px" class="cls_005"><span class="cls_005">com programação de sockets e à procura de uma direção a seguir. Certamente este não é um</span></div>
<div style="position:absolute;left:60.99px;top:524.99px" class="cls_005"><span class="cls_005">guia completo e total para programação de sockets, de qualquer forma.</span></div>
<div style="position:absolute;left:60.99px;top:550.17px" class="cls_005"><span class="cls_005">Espero, entretanto, que ele seja su ciente para que as páginas de manual comecem a fazer</span></div>
<div style="position:absolute;left:60.99px;top:565.09px" class="cls_005"><span class="cls_005">sentido... :-)</span></div>
<div style="position:absolute;left:60.99px;top:593.01px" class="cls_007"><span class="cls_007">Plataforma e Compilador</span></div>
<div style="position:absolute;left:60.99px;top:628.39px" class="cls_005"><span class="cls_005">Os códigos contidos neste documento foram compilados em um PC Linux usando</span></div>
<div style="position:absolute;left:60.99px;top:643.31px" class="cls_005"><span class="cls_005">compiladores GNU gcc. Estes devem, no entanto, ser compilados em praticamente qualquer</span></div>
<div style="position:absolute;left:60.99px;top:659.16px" class="cls_005"><span class="cls_005">plataforma que use gcc. Naturalmente, isto não se aplica se você está programando para</span></div>
<div style="position:absolute;left:60.99px;top:674.08px" class="cls_005"><span class="cls_005">Windows— consulte a </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão sobre pro</span><span class="cls_006">g</span><span class="cls_023">ramação no Windows</span><span class="cls_005">, abaixo.</span></div>
<div style="position:absolute;left:60.99px;top:701.07px" class="cls_007"><span class="cls_007">Homepage O cial e livros a venda</span></div>
<div style="position:absolute;left:60.99px;top:736.45px" class="cls_005"><span class="cls_005">Esta é a localização o cial deste documento:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">5 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:4255px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background006.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:88.97px;top:54.93px" class="cls_023"><span class="cls_023">https://bee</span><span class="cls_006">j</span><span class="cls_023">.us/</span><span class="cls_006">g</span><span class="cls_023">uide/b</span><span class="cls_006">g</span><span class="cls_023">net/</span></div>
<div style="position:absolute;left:60.99px;top:81.05px" class="cls_005"><span class="cls_005">Lá você também encontrará códigos de exemplo e traduções do guia em vários idiomas.</span></div>
<div style="position:absolute;left:60.99px;top:106.23px" class="cls_005"><span class="cls_005">Para comprar cópias impressas bem encadernadas (alguns chamam de "livros"), visite:</span></div>
<div style="position:absolute;left:88.97px;top:132.34px" class="cls_023"><span class="cls_023">https://bee</span><span class="cls_006">j</span><span class="cls_023">.us/</span><span class="cls_006">g</span><span class="cls_023">uide/url/b</span><span class="cls_006">g</span><span class="cls_023">bu</span><span class="cls_006">y</span></div>
<div style="position:absolute;left:60.99px;top:158.45px" class="cls_005"><span class="cls_005">Eu aprecio a compra porque ajuda a sustentar o meu estilo de vida de escritor de</span></div>
<div style="position:absolute;left:60.99px;top:172.44px" class="cls_005"><span class="cls_005">documentações.</span></div>
<div style="position:absolute;left:60.99px;top:199.43px" class="cls_007"><span class="cls_007">Nota para programadores Solaris/SunOS</span></div>
<div style="position:absolute;left:60.99px;top:234.81px" class="cls_005"><span class="cls_005">Ao compilar para Solaris ou SunOS, você precisa especi car algumas opções extras na linha</span></div>
<div style="position:absolute;left:60.99px;top:249.73px" class="cls_005"><span class="cls_005">de comando para ligar às bibliotecas adequadas. A  m de fazer isso, basta adicionar “-lnsl</span></div>
<div style="position:absolute;left:60.99px;top:265.58px" class="cls_005"><span class="cls_005">-lsocket -lresolv” ao  nal do comando de compilação, como isso:</span></div>
<div style="position:absolute;left:94.85px;top:299.62px" class="cls_005"><span class="cls_005">$ cc -o server server.c -lnsl -lsocket -lresolv</span></div>
<div style="position:absolute;left:60.99px;top:333.66px" class="cls_005"><span class="cls_005">Se você ainda receber erros, você pode tentar ainda adicionar -lxnet ao  nal da linha de</span></div>
<div style="position:absolute;left:60.99px;top:348.58px" class="cls_005"><span class="cls_005">comando. Eu não sei por que contece, exatamente, mas algumas pessoas parecem precisar.</span></div>
<div style="position:absolute;left:60.99px;top:374.70px" class="cls_005"><span class="cls_005">Outro lugar em que você pode encontrar problemas é na chamada de setsockopt(). O</span></div>
<div style="position:absolute;left:60.99px;top:389.62px" class="cls_005"><span class="cls_005">protótipo é diferente do que há no meu ambiente Linux, assim em vez de:</span></div>
<div style="position:absolute;left:94.85px;top:422.73px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> yes=</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:60.99px;top:455.83px" class="cls_005"><span class="cls_005">Digite o seguinte:</span></div>
<div style="position:absolute;left:94.85px;top:488.94px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> yes=</span><span class="cls_010">'1'</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:60.99px;top:522.05px" class="cls_005"><span class="cls_005">Como eu não tenho um ambiente Sun, eu não testei qualquer das instruções a cima, é apenas</span></div>
<div style="position:absolute;left:60.99px;top:536.04px" class="cls_005"><span class="cls_005">o que as pessoas me disseram por e-mail.</span></div>
<div style="position:absolute;left:60.99px;top:563.02px" class="cls_007"><span class="cls_007">Observação para programadores Windows</span></div>
<div style="position:absolute;left:60.99px;top:598.40px" class="cls_005"><span class="cls_005">Neste ponto do guia, historicamente, eu  z pouco caso do Windows, simplesmente devido ao</span></div>
<div style="position:absolute;left:60.99px;top:612.39px" class="cls_005"><span class="cls_005">fato de que eu não gosto muito. Mas eu realmente devo ser justo e dizer-lhe que o Windows</span></div>
<div style="position:absolute;left:60.99px;top:626.38px" class="cls_005"><span class="cls_005">tem uma enorme base de instalações e é, obviamente, perfeitamente um sistema operacional.</span></div>
<div style="position:absolute;left:60.99px;top:651.56px" class="cls_005"><span class="cls_005">Dizem que a ausência do Windows nos torna pessoas melhores, e, neste caso, eu acredito que</span></div>
<div style="position:absolute;left:60.99px;top:665.55px" class="cls_005"><span class="cls_005">seja verdade (Ou talvez seja a idade). Mas o que eu posso dizer é que depois de uma década</span></div>
<div style="position:absolute;left:60.99px;top:679.54px" class="cls_005"><span class="cls_005">sem usar sistemas operacionais da Microsoft para o meu trabalho pessoal, Eu sou muito mais</span></div>
<div style="position:absolute;left:60.99px;top:693.53px" class="cls_005"><span class="cls_005">feliz! Como tal, eu posso sentar e dizer com segurança: "Claro, sinta-se livre para usar</span></div>
<div style="position:absolute;left:60.99px;top:707.52px" class="cls_005"><span class="cls_005">Windows!"... Ok, sim, mas isso me faz cerrar os dentes ao dizer.</span></div>
<div style="position:absolute;left:60.99px;top:732.70px" class="cls_005"><span class="cls_005">Então, eu ainda o encorajo a experimentar </span><span class="cls_023">Linux</span><span class="cls_024"><sup>1</sup></span><span class="cls_005">, </span><span class="cls_023">BSD</span><span class="cls_024"><sup>2</sup></span><span class="cls_005">, ou algum sabor de Unix, em vez disso.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">6 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:5106px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background007.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Como as pessoas gostam do que gostam, o pessoal do Windows  cará satisfeito em saber</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">que essas informações são geralmente também aplicáveis ao Windows, com algumas</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">pequenas alterações, se houverem.</span></div>
<div style="position:absolute;left:60.99px;top:107.16px" class="cls_005"><span class="cls_005">Uma coisa legal que você pode fazer é instalar </span><span class="cls_023">C</span><span class="cls_006">yg</span><span class="cls_023">win</span><span class="cls_011"><sup>3</sup></span><span class="cls_005">, que é um conjunto de ferramentas</span></div>
<div style="position:absolute;left:60.99px;top:123.08px" class="cls_005"><span class="cls_005">Unix para Windows. Ouvi dizer que, ao fazer isso, todos esses programas são compilados sem</span></div>
<div style="position:absolute;left:60.99px;top:137.07px" class="cls_005"><span class="cls_005">modi cações.</span></div>
<div style="position:absolute;left:60.99px;top:162.25px" class="cls_005"><span class="cls_005">Outra coisa que você deve considerar é o </span><span class="cls_023">Subsistema Windows para Linux</span><span class="cls_024"><sup>4</sup></span><span class="cls_005">. Basicamente, isso</span></div>
<div style="position:absolute;left:60.99px;top:178.18px" class="cls_005"><span class="cls_005">permite que você instale coias como uma VM-ish Linux no Windows 10. Isso também</span></div>
<div style="position:absolute;left:60.99px;top:192.16px" class="cls_005"><span class="cls_005">de nitivamente o deixará situado.</span></div>
<div style="position:absolute;left:60.99px;top:217.34px" class="cls_005"><span class="cls_005">Mas alguns de vocês podem querer fazer as coisas na forma puramente Windows. Isso é</span></div>
<div style="position:absolute;left:60.99px;top:231.33px" class="cls_005"><span class="cls_005">muito corajoso de sua parte, e é isso que você tem que fazer: correr e pegar um Unix</span></div>
<div style="position:absolute;left:60.99px;top:245.32px" class="cls_005"><span class="cls_005">imediatamente! Não, não, estou brincando. Eu echo que sou mais Windows-friendly(er) hoje em</span></div>
<div style="position:absolute;left:60.99px;top:259.31px" class="cls_005"><span class="cls_005">dia...</span></div>
<div style="position:absolute;left:60.99px;top:284.49px" class="cls_005"><span class="cls_005">Isto é o que você terá que fazer (a menos que você instale </span><span class="cls_023">C</span><span class="cls_006">yg</span><span class="cls_023">win</span><span class="cls_005">!): Em primeiro lugar, ignore</span></div>
<div style="position:absolute;left:60.99px;top:298.48px" class="cls_005"><span class="cls_005">praticamente todos os arquivos de cabeçalho do sistema que menciono aqui. Tudo que você</span></div>
<div style="position:absolute;left:60.99px;top:312.47px" class="cls_005"><span class="cls_005">precisa incluir é:</span></div>
<div style="position:absolute;left:94.85px;top:345.58px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;winsock.h></span></div>
<div style="position:absolute;left:60.99px;top:379.62px" class="cls_005"><span class="cls_005">Espere! Você também precisa fazer uma chamada a WSAStartup() antes de fazer qualquer</span></div>
<div style="position:absolute;left:60.99px;top:394.54px" class="cls_005"><span class="cls_005">outra coisa com a biblioteca de sockets. O código para isso é algo como:</span></div>
<div style="position:absolute;left:83.19px;top:427.65px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:427.65px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;winsock.h></span></div>
<div style="position:absolute;left:83.19px;top:443.50px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:459.35px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:459.35px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:475.21px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:130.75px;top:475.21px" class="cls_005"><span class="cls_005">WSADATA wsaData;</span></div>
<div style="position:absolute;left:258.33px;top:475.21px" class="cls_013"><span class="cls_013">// se isso não funcionar</span></div>
<div style="position:absolute;left:83.19px;top:491.06px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:130.75px;top:491.06px" class="cls_013"><span class="cls_013">//WSAData wsaData; // tente isso em vez de</span></div>
<div style="position:absolute;left:83.19px;top:506.92px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:83.19px;top:521.84px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:521.84px" class="cls_013"><span class="cls_013">// MAKEWORD(1,1) para Winsock 1.1, MAKEWORD(2,0)</span></div>
<div style="position:absolute;left:109.49px;top:535.83px" class="cls_013"><span class="cls_013">para Winsock 2.0:</span></div>
<div style="position:absolute;left:83.19px;top:551.68px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:567.53px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:567.53px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (WSAStartup(MAKEWORD(</span><span class="cls_009">1</span><span class="cls_005">,</span><span class="cls_009">1</span><span class="cls_005">), &wsaData) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:583.39px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:157.60px;top:583.39px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"WSAStartup falhou.\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:599.24px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:157.60px;top:599.24px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:615.10px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:615.10px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:648.20px" class="cls_005"><span class="cls_005">Você também precisa dizer ao seu compilador para vincular a biblioteca Winsock, usualmente</span></div>
<div style="position:absolute;left:60.99px;top:663.13px" class="cls_005"><span class="cls_005">chamada wsock32.lib ou winsock32.lib, ou ws2_32.lib para Winsock 2.0. Em VC++,</span></div>
<div style="position:absolute;left:60.99px;top:678.98px" class="cls_005"><span class="cls_005">isso pode ser feito através do menu Project, em Settings... Clique na guia Link, e</span></div>
<div style="position:absolute;left:60.99px;top:693.90px" class="cls_005"><span class="cls_005">procure a caixa intitulada "Object/library modules". Adicione "wsock32.lib" (ou qualquer lib de</span></div>
<div style="position:absolute;left:60.99px;top:707.89px" class="cls_005"><span class="cls_005">sua preferência) para a lista.</span></div>
<div style="position:absolute;left:60.99px;top:733.07px" class="cls_005"><span class="cls_005">Ou foi pelo menos assim que ouvi.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">7 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:5957px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background008.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Finalmente, você precisa chamar WSACleanup() quando terminar o uso das bibliotecas de</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">sockets. Consulte a ajuda online para obter detalhes.</span></div>
<div style="position:absolute;left:60.99px;top:95.03px" class="cls_005"><span class="cls_005">Depois de fazer isso, o resto dos exemplos neste tutorial devem no geral se aplicar, com</span></div>
<div style="position:absolute;left:60.99px;top:109.96px" class="cls_005"><span class="cls_005">algumas exceções. Por um lado, você não pode usar close() para fechar um socket—você</span></div>
<div style="position:absolute;left:60.99px;top:125.81px" class="cls_005"><span class="cls_005">precisa usar closesocket(), em vez disso. Além disso, select() só funciona com</span></div>
<div style="position:absolute;left:60.99px;top:141.66px" class="cls_005"><span class="cls_005">descritores de sockets, não descritores de arquivos (como 0 para stdin).</span></div>
<div style="position:absolute;left:60.99px;top:168.71px" class="cls_005"><span class="cls_005">Há também uma classe socket que você pode usar, CSocket. Veri que as páginas de ajuda de</span></div>
<div style="position:absolute;left:60.99px;top:183.63px" class="cls_005"><span class="cls_005">seu compilador para mais informações.</span></div>
<div style="position:absolute;left:60.99px;top:208.81px" class="cls_005"><span class="cls_005">Para mais informações sobre Winsock, leia o </span><span class="cls_023">Winsock FA</span><span class="cls_006">Q</span><span class="cls_024"><sup>5</sup></span><span class="cls_005"> e inicie por lá.</span></div>
<div style="position:absolute;left:60.99px;top:236.86px" class="cls_005"><span class="cls_005">Finalmente, ouvi dizer que o Windows não possui a chamada de sistema fork(), que é,</span></div>
<div style="position:absolute;left:60.99px;top:251.78px" class="cls_005"><span class="cls_005">infelizmente, utilizada em alguns dos meus exemplos. Talvez você tenha que usar uma</span></div>
<div style="position:absolute;left:60.99px;top:266.70px" class="cls_005"><span class="cls_005">biblioteca POSIX ou algo para fazê-lo funcionar, ou você pode usar CreateProcess() em seu</span></div>
<div style="position:absolute;left:60.99px;top:282.56px" class="cls_005"><span class="cls_005">lugar. fork() não tem argumentos, e CreateProcess() leva cerca de 48 bilhões</span></div>
<div style="position:absolute;left:60.99px;top:298.41px" class="cls_005"><span class="cls_005">argumentos. Se você não está à altura, a CreateThread() é um pouco mais fácil de digerir...</span></div>
<div style="position:absolute;left:60.99px;top:313.33px" class="cls_005"><span class="cls_005">Infelizmente uma discussão sobre multithreading está além do escopo deste documento. Eu</span></div>
<div style="position:absolute;left:60.99px;top:327.32px" class="cls_005"><span class="cls_005">só posso falar um tanto sobre, você sabe!</span></div>
<div style="position:absolute;left:60.99px;top:354.31px" class="cls_007"><span class="cls_007">Política Email</span></div>
<div style="position:absolute;left:60.99px;top:389.69px" class="cls_005"><span class="cls_005">Eu geralmente estou disponível a ajudar com perguntas por e-mail, então  que à vontade para</span></div>
<div style="position:absolute;left:60.99px;top:403.68px" class="cls_005"><span class="cls_005">escrever, mas não posso garantir uma resposta. Eu levo uma vida muito ocupada e há</span></div>
<div style="position:absolute;left:60.99px;top:417.67px" class="cls_005"><span class="cls_005">momentos em que simplesmente não consigo responder a uma dúvida que você possua.</span></div>
<div style="position:absolute;left:60.99px;top:431.66px" class="cls_005"><span class="cls_005">Quando esse é o caso, normalmente apenas excluo a mensagem. Não é nada pessoal; Eu só</span></div>
<div style="position:absolute;left:60.99px;top:445.64px" class="cls_005"><span class="cls_005">nunca terei tempo para dar a resposta detalhada que você precisa.</span></div>
<div style="position:absolute;left:60.99px;top:470.82px" class="cls_005"><span class="cls_005">Como regra geral, quanto mais complexa a questão, é menos provável que eu responda. Se</span></div>
<div style="position:absolute;left:60.99px;top:484.81px" class="cls_005"><span class="cls_005">você puder re nar sua pergunta antes de enviá-la e incluir todas as informações pertinentes</span></div>
<div style="position:absolute;left:60.99px;top:498.80px" class="cls_005"><span class="cls_005">(como plataforma, compilador, mensagens de erro recebidas e qualquer outra coisa que possa</span></div>
<div style="position:absolute;left:60.99px;top:512.79px" class="cls_005"><span class="cls_005">ajudar a solucionar os problemas), é muito mais provável que você receba uma resposta. Para</span></div>
<div style="position:absolute;left:60.99px;top:526.78px" class="cls_005"><span class="cls_005">mais dicas, leia o documento do ESR, </span><span class="cls_023">Como fazer per</span><span class="cls_006">g</span><span class="cls_023">untas de maneira inteli</span><span class="cls_006">g</span><span class="cls_023">ente</span><span class="cls_024"><sup>6</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:553.90px" class="cls_005"><span class="cls_005">Se você não obtiver uma resposta, faça um pouco mais, tente encontrar a resposta e, se ainda</span></div>
<div style="position:absolute;left:60.99px;top:567.88px" class="cls_005"><span class="cls_005">não for su ciente, escreva-me novamente com as informações que encontrou e espero que</span></div>
<div style="position:absolute;left:60.99px;top:581.87px" class="cls_005"><span class="cls_005">seja o su ciente para eu o ajudar.</span></div>
<div style="position:absolute;left:60.99px;top:607.05px" class="cls_005"><span class="cls_005">Agora que te atormentei sobre como escrever e não me escrever, gostaria apenas de lhe dizer</span></div>
<div style="position:absolute;left:60.99px;top:621.04px" class="cls_005"><span class="cls_005">que aprecio plenamente todos os elogios que o guia recebeu ao longo dos anos. É um</span></div>
<div style="position:absolute;left:60.99px;top:635.96px" class="cls_005"><span class="cls_005">verdadeiro impulso moral, e  co feliz em saber que está sendo usado para o bem! :-)</span></div>
<div style="position:absolute;left:60.99px;top:650.89px" class="cls_005"><span class="cls_005">Obrigado!</span></div>
<div style="position:absolute;left:60.99px;top:677.87px" class="cls_007"><span class="cls_007">Mirroring</span></div>
<div style="position:absolute;left:60.99px;top:713.25px" class="cls_005"><span class="cls_005">Você é mais que bem-vindo para espelhar este site, seja pública ou privadamente. Se você</span></div>
<div style="position:absolute;left:60.99px;top:727.24px" class="cls_005"><span class="cls_005">espelhar publicamente o site e quiser que eu faça um link para ele a partir da página principal,</span></div>
<div style="position:absolute;left:60.99px;top:742.16px" class="cls_005"><span class="cls_005">me envie uma linha em </span><span class="cls_023">bee</span><span class="cls_006">j</span><span class="cls_023">@bee</span><span class="cls_006">j</span><span class="cls_023">.us</span><span class="cls_005">.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">8 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:6808px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background009.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:53.07px" class="cls_007"><span class="cls_007">Nota para Tradutores</span></div>
<div style="position:absolute;left:60.99px;top:89.38px" class="cls_005"><span class="cls_005">Se você quiser traduzir o guia para outra língua, escreva-me em </span><span class="cls_023">bee</span><span class="cls_006">j</span><span class="cls_023">@bee</span><span class="cls_006">j</span><span class="cls_023">.us</span><span class="cls_005"> e eu</span></div>
<div style="position:absolute;left:60.99px;top:104.30px" class="cls_005"><span class="cls_005">adicionarei uma ligação para sua tradução a partir da página principal. Sinta-se livre para</span></div>
<div style="position:absolute;left:60.99px;top:118.29px" class="cls_005"><span class="cls_005">adicionar seu nome e informações de contato à tradução.</span></div>
<div style="position:absolute;left:60.99px;top:143.47px" class="cls_005"><span class="cls_005">Este documento markdown fonte usa codi cação UTF-8.</span></div>
<div style="position:absolute;left:60.99px;top:168.65px" class="cls_005"><span class="cls_005">Por favor, observe as restrições de licença na seção </span><span class="cls_023">Direitos autorais</span><span class="cls_006">,</span><span class="cls_023"> distribui</span><span class="cls_006">ç</span><span class="cls_023">ão e</span></div>
<div style="position:absolute;left:60.99px;top:182.64px" class="cls_023"><span class="cls_023">informa</span><span class="cls_006">ç</span><span class="cls_023">ões le</span><span class="cls_006">g</span><span class="cls_023">ais</span><span class="cls_005">, abaixo.</span></div>
<div style="position:absolute;left:60.99px;top:207.82px" class="cls_005"><span class="cls_005">Caso queira que eu hospede a tradução, basta pedir. Eu também adicionarei uma ligação para</span></div>
<div style="position:absolute;left:60.99px;top:221.81px" class="cls_005"><span class="cls_005">ela caso você a hospede; de qualquer forma, tudo bem.</span></div>
<div style="position:absolute;left:60.99px;top:248.80px" class="cls_007"><span class="cls_007">Direitos autorais, distribuição e informações legais</span></div>
<div style="position:absolute;left:60.99px;top:284.18px" class="cls_005"><span class="cls_005">Beej’s Guide to Network Programming is Copyright © 2019 Brian “Beej Jorgensen” Hall.</span></div>
<div style="position:absolute;left:60.99px;top:309.36px" class="cls_005"><span class="cls_005">Com exceções especí cas para traduções e códigos fonte, abaixo, esta obra está licenciada</span></div>
<div style="position:absolute;left:60.99px;top:323.35px" class="cls_005"><span class="cls_005">sob a Creative Commons Attribution- Noncommercial- No Derivative Works 3.0 License. Para</span></div>
<div style="position:absolute;left:60.99px;top:337.33px" class="cls_005"><span class="cls_005">ver uma cópia desta licença, visite</span></div>
<div style="position:absolute;left:60.99px;top:363.45px" class="cls_023"><span class="cls_023">https://creativecommons.or</span><span class="cls_006">g</span><span class="cls_023">/licenses/b</span><span class="cls_006">y</span><span class="cls_023">-nc-nd/3.0/</span></div>
<div style="position:absolute;left:60.99px;top:389.56px" class="cls_005"><span class="cls_005">ou envie uma carta para Creative Commons, 171 Second Street, Suite 300, San Francisco,</span></div>
<div style="position:absolute;left:60.99px;top:403.55px" class="cls_005"><span class="cls_005">California, 94105, USA.</span></div>
<div style="position:absolute;left:60.99px;top:428.73px" class="cls_005"><span class="cls_005">Uma exceção especí ca à parte "Sem obras derivadas" da licença é a seguinte: este guia pode</span></div>
<div style="position:absolute;left:60.99px;top:442.72px" class="cls_005"><span class="cls_005">ser traduzido livremente para qualquer idioma, desde que a tradução seja exata e o guia seja</span></div>
<div style="position:absolute;left:60.99px;top:456.71px" class="cls_005"><span class="cls_005">reimpresso em sua totalidade. As mesmas restrições de licença se aplicam à tradução do guia</span></div>
<div style="position:absolute;left:60.99px;top:470.70px" class="cls_005"><span class="cls_005">original. A tradução também pode incluir o nome e as informações de contato do tradutor.</span></div>
<div style="position:absolute;left:60.99px;top:495.88px" class="cls_005"><span class="cls_005">O código-fonte C apresentado neste documento é concedido ao domínio público e está</span></div>
<div style="position:absolute;left:60.99px;top:509.87px" class="cls_005"><span class="cls_005">completamente livre de qualquer restrição de licença.</span></div>
<div style="position:absolute;left:60.99px;top:535.05px" class="cls_005"><span class="cls_005">Os educadores são encorajados a recomendar ou fornecer cópias deste guia aos seus alunos.</span></div>
<div style="position:absolute;left:60.99px;top:560.23px" class="cls_005"><span class="cls_005">Salvo acordo em contrário por escrito entre as partes, o autor oferece o trabalho como está e</span></div>
<div style="position:absolute;left:60.99px;top:574.21px" class="cls_005"><span class="cls_005">não faz representações ou garantias de qualquer tipo com relação ao trabalho, expresso,</span></div>
<div style="position:absolute;left:60.99px;top:588.20px" class="cls_005"><span class="cls_005">implícito, estatutário ou de outro modo, incluindo, sem limitação, garantias de titularidade,</span></div>
<div style="position:absolute;left:60.99px;top:602.19px" class="cls_005"><span class="cls_005">comercialização, adequação a um propósito especí co, não violação ou ausência de defeitos</span></div>
<div style="position:absolute;left:60.99px;top:616.18px" class="cls_005"><span class="cls_005">latentes ou outros, precisão ou presença de ausência de erros, detectáveis ou não.</span></div>
<div style="position:absolute;left:60.99px;top:641.36px" class="cls_005"><span class="cls_005">Exceto na medida exigida pela lei aplicável, em hipótese alguma o autor será responsável</span></div>
<div style="position:absolute;left:60.99px;top:655.35px" class="cls_005"><span class="cls_005">perante você por qualquer teoria jurídica por qualquer ação especial, incidental, danos</span></div>
<div style="position:absolute;left:60.99px;top:669.34px" class="cls_005"><span class="cls_005">consequenciais, punitivos ou exemplares decorrentes do uso da obra, mesmo que o autor</span></div>
<div style="position:absolute;left:60.99px;top:683.33px" class="cls_005"><span class="cls_005">tenha sido avisado da possibilidade de tais danos.</span></div>
<div style="position:absolute;left:60.99px;top:709.44px" class="cls_005"><span class="cls_005">Entre em contato com </span><span class="cls_023">bee</span><span class="cls_006">j</span><span class="cls_023">@bee</span><span class="cls_006">j</span><span class="cls_023">.us</span><span class="cls_005"> para mais informações.</span></div>
<div style="position:absolute;left:60.99px;top:737.36px" class="cls_007"><span class="cls_007">Dedicatória</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">9 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:7659px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background010.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Obrigado a todos que me ajudaram no passado e no futuro escrever este guia. E obrigado a</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">todas as pessoas que produzem o software livre e os pacotes que eu uso para criar o Guia:</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">GNU, Linux, Slackware, vim, Python, Inkscape, pandoc, muitos outros. E,  nalmente, um grande</span></div>
<div style="position:absolute;left:60.99px;top:95.97px" class="cls_005"><span class="cls_005">obrigado aos milhares de vocês que me escreveram com sugestões de melhorias e palavras</span></div>
<div style="position:absolute;left:60.99px;top:109.96px" class="cls_005"><span class="cls_005">de encorajamento.</span></div>
<div style="position:absolute;left:60.99px;top:135.14px" class="cls_005"><span class="cls_005">Dedico este guia a alguns dos meus maiores heróis e inspiradores no mundo dos</span></div>
<div style="position:absolute;left:60.99px;top:149.12px" class="cls_005"><span class="cls_005">computadores: Donald Knuth, Bruce Schneier, W. Richard Stevens e The Woz, meus leitores, e</span></div>
<div style="position:absolute;left:60.99px;top:163.11px" class="cls_005"><span class="cls_005">toda a comunidade de software livre e de código aberto.</span></div>
<div style="position:absolute;left:60.99px;top:190.10px" class="cls_007"><span class="cls_007">Publicando Informações</span></div>
<div style="position:absolute;left:60.99px;top:225.48px" class="cls_005"><span class="cls_005">Este livro foi escrito em Markdown usando o editor vim em um ambiente Arch Linux carregado</span></div>
<div style="position:absolute;left:60.99px;top:239.47px" class="cls_005"><span class="cls_005">com ferramentas GNU. A capa “art” e diagramas são produzidos com o Inkscape. O Markdown</span></div>
<div style="position:absolute;left:60.99px;top:253.46px" class="cls_005"><span class="cls_005">é convertido em HTML e LaTex/PDF pelo Python, Pandoc e XeLaTeX, usando fontes Liberation.</span></div>
<div style="position:absolute;left:60.99px;top:267.45px" class="cls_005"><span class="cls_005">O toolchain é composto 100% por software livre e de código aberto.</span></div>
<div style="position:absolute;left:60.99px;top:295.50px" class="cls_002"><span class="cls_002">O que é um socket?</span></div>
<div style="position:absolute;left:60.99px;top:338.47px" class="cls_005"><span class="cls_005">Você ouve falar em "sockets" o tempo todo, e talvez esteja se perguntando o que são</span></div>
<div style="position:absolute;left:60.99px;top:352.45px" class="cls_005"><span class="cls_005">exatamente. Bem, eles são isso: Um modo de se comunicar com outros programas utilizando</span></div>
<div style="position:absolute;left:60.99px;top:366.44px" class="cls_005"><span class="cls_005">descritores de arquivos padrão do Unix.</span></div>
<div style="position:absolute;left:60.99px;top:391.62px" class="cls_005"><span class="cls_005">O quê?</span></div>
<div style="position:absolute;left:60.99px;top:416.80px" class="cls_005"><span class="cls_005">Ok, você pode ter ouvido algum hacker de Unix dizer "Ei, tudo no Unix é arquivo!". O que essa</span></div>
<div style="position:absolute;left:60.99px;top:430.79px" class="cls_005"><span class="cls_005">pessoa disse é o fato de que quando os programas Unix fazem qualquer tipo de E/S, eles</span></div>
<div style="position:absolute;left:60.99px;top:444.78px" class="cls_005"><span class="cls_005">fazem isso pela leitura ou escrita em um descritor de arquivo. Um descritor de arquivo é</span></div>
<div style="position:absolute;left:60.99px;top:458.77px" class="cls_005"><span class="cls_005">simplesmente um inteiro associado a um arquivo aberto. Mas (e aqui está o segredo) esse</span></div>
<div style="position:absolute;left:60.99px;top:472.76px" class="cls_005"><span class="cls_005">arquivo pode ser uma conexão de rede, um FIFO, um pipe, um terminal, um arquivo real no</span></div>
<div style="position:absolute;left:60.99px;top:486.75px" class="cls_005"><span class="cls_005">disco, ou qualquer outra coisa. Tudo no Unix é um arquivo! Então, quando você quiser se</span></div>
<div style="position:absolute;left:60.99px;top:500.74px" class="cls_005"><span class="cls_005">comunicar com outro programa através da Internet você vai fazê-lo através de um descritor de</span></div>
<div style="position:absolute;left:60.99px;top:514.73px" class="cls_005"><span class="cls_005">arquivo, é melhor você acreditar.</span></div>
<div style="position:absolute;left:60.99px;top:539.91px" class="cls_005"><span class="cls_005">"Onde posso obter este descritor de arquivo para comunicação de rede, Sr. Sabichão?", É</span></div>
<div style="position:absolute;left:60.99px;top:553.90px" class="cls_005"><span class="cls_005">provavelmente a última pergunta em sua mente agora, mas eu vou responder a isso de</span></div>
<div style="position:absolute;left:60.99px;top:568.82px" class="cls_005"><span class="cls_005">qualquer maneira: Você faz uma chamada a função socket(). Ela retorna o descritor de</span></div>
<div style="position:absolute;left:60.99px;top:583.74px" class="cls_005"><span class="cls_005">socket, e você se comunica através dele utilizando as chamadas de sistema especializadas em</span></div>
<div style="position:absolute;left:60.99px;top:598.66px" class="cls_005"><span class="cls_005">sockets send() e recv() (</span><span class="cls_023">man send</span><span class="cls_005">, </span><span class="cls_023">man recv</span><span class="cls_005">).</span></div>
<div style="position:absolute;left:60.99px;top:624.77px" class="cls_005"><span class="cls_005">"Mas, Ei!" você pode estar exclamando agora. "Se é um descritor de arquivo, por que, em nome</span></div>
<div style="position:absolute;left:60.99px;top:639.69px" class="cls_005"><span class="cls_005">de Netuno, não posso simplesmente usar as chamadas normais read() e write() para me</span></div>
<div style="position:absolute;left:60.99px;top:654.62px" class="cls_005"><span class="cls_005">comunicar através do socket?" A resposta curta é: "Você pode!"; A resposta mais longa é:</span></div>
<div style="position:absolute;left:60.99px;top:669.54px" class="cls_005"><span class="cls_005">"Você pode, mas send() e recv() oferecem muito mais controle sobre a sua transmissão de</span></div>
<div style="position:absolute;left:60.99px;top:684.46px" class="cls_005"><span class="cls_005">dados."</span></div>
<div style="position:absolute;left:60.99px;top:709.64px" class="cls_005"><span class="cls_005">O que vem depois? Veja mais: existem diversos tipos de sockets. Como DARPA Internet</span></div>
<div style="position:absolute;left:60.99px;top:723.63px" class="cls_005"><span class="cls_005">addresses (Internet Sockets), path names em um nó local (Unix Sockets), CCITT X.25</span></div>
<div style="position:absolute;left:60.99px;top:737.62px" class="cls_005"><span class="cls_005">addresses (Sockets tipo X.25 podem ser ignorados traquilamente de forma segura), e</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">10 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:8510px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background011.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">provavelmente muitos outros, dependendo do sabor Unix executado. Este documento trata</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">somente do primeiro: Internet Sockets.</span></div>
<div style="position:absolute;left:60.99px;top:94.98px" class="cls_007"><span class="cls_007">Dois tipos de Internet Sockets</span></div>
<div style="position:absolute;left:60.99px;top:130.36px" class="cls_005"><span class="cls_005">Como é? Existem dois tipos de Internet sockets? Sim. Bem, não, estou mentindo. Há mais tipos</span></div>
<div style="position:absolute;left:60.99px;top:144.35px" class="cls_005"><span class="cls_005">mas eu não quero te assustar. Eu só comentarei sobre dois tipos aqui. Exceto por esta frase,</span></div>
<div style="position:absolute;left:60.99px;top:158.33px" class="cls_005"><span class="cls_005">onde eu vou dizer-lhe que "Raw Sockets" também são muito poderosos e você deveria procurá-</span></div>
<div style="position:absolute;left:60.99px;top:172.32px" class="cls_005"><span class="cls_005">los.</span></div>
<div style="position:absolute;left:60.99px;top:197.50px" class="cls_005"><span class="cls_005">Tudo bem, agora. Quais são os dois tipos? Um deles é "Stream Socket"; O outro é "Datagram</span></div>
<div style="position:absolute;left:60.99px;top:212.43px" class="cls_005"><span class="cls_005">Socket", que daqui em diante podem ser referidos como "SOCK_STREAM" e "SOCK_DGRAM",</span></div>
<div style="position:absolute;left:60.99px;top:227.35px" class="cls_005"><span class="cls_005">respectivamente. Sockets Datagram são às vezes chamados de "sockets sem conexão"</span></div>
<div style="position:absolute;left:60.99px;top:242.27px" class="cls_005"><span class="cls_005">(Embora possam ser usados com connect() caso você realmente queira. Veja </span><span class="cls_023">connect</span><span class="cls_006">()</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:60.99px;top:257.19px" class="cls_005"><span class="cls_005">abaixo).</span></div>
<div style="position:absolute;left:60.99px;top:282.37px" class="cls_005"><span class="cls_005">Sockets stream são   uxos de comunicação con áveis ligados bidirecionalmente. Se você</span></div>
<div style="position:absolute;left:60.99px;top:296.36px" class="cls_005"><span class="cls_005">envia dois itens ao socket na ordem "1,2", eles chegarão na ordem "1,2" na extremidade oposta.</span></div>
<div style="position:absolute;left:60.99px;top:310.35px" class="cls_005"><span class="cls_005">Eles também serão livres de erros. Eu estou tão certo, na verdade, que eles estarão livres de</span></div>
<div style="position:absolute;left:60.99px;top:324.34px" class="cls_005"><span class="cls_005">erros, que estou pondo agora meus dedos em meus ouvidos e cantando lá lá lá lá antes que</span></div>
<div style="position:absolute;left:60.99px;top:338.33px" class="cls_005"><span class="cls_005">alguém tente dizer o contrário.</span></div>
<div style="position:absolute;left:60.99px;top:364.44px" class="cls_005"><span class="cls_005">O que usa sockets stream? Bem, você pode já ter ouvido falarem da aplicação telnet, sim?</span></div>
<div style="position:absolute;left:60.99px;top:379.36px" class="cls_005"><span class="cls_005">Ela usa sockets stream. Todos os caracteres que você digita precisam chegar na mesma</span></div>
<div style="position:absolute;left:60.99px;top:393.35px" class="cls_005"><span class="cls_005">ordem que você digitou, certo? Além disso, os navegadores web usam o protocolo HTTP que</span></div>
<div style="position:absolute;left:60.99px;top:407.34px" class="cls_005"><span class="cls_005">utiliza sockets stream para obter as páginas. De fato, se você executa telnet contra um site na</span></div>
<div style="position:absolute;left:60.99px;top:422.26px" class="cls_005"><span class="cls_005">porta 80, e digita "GET</span></div>
<div style="position:absolute;left:177.46px;top:422.26px" class="cls_005"><span class="cls_005">/ HTTP/1.0" e pressiona RETURN duas vezes, ele retornará o HTML a</span></div>
<div style="position:absolute;left:60.99px;top:437.18px" class="cls_005"><span class="cls_005">você!</span></div>
<div style="position:absolute;left:88.97px;top:463.29px" class="cls_005"><span class="cls_005">Se você não possui o telnet instalado e não quer o instalar, ou o seu telnet está</span></div>
<div style="position:absolute;left:88.97px;top:479.15px" class="cls_005"><span class="cls_005">sendo exigente em conectar como cliente, o guia vem com um programa telnet-</span></div>
<div style="position:absolute;left:88.97px;top:494.07px" class="cls_005"><span class="cls_005">like chamado </span><span class="cls_023">telnot</span><span class="cls_024"><sup>7</sup></span><span class="cls_005">. Isso deve funcionar bem para todas as necessidades do</span></div>
<div style="position:absolute;left:88.97px;top:510.93px" class="cls_005"><span class="cls_005">guia. (Observe que o telnet é na realidade uma </span><span class="cls_023">especi ca</span><span class="cls_006">ç</span><span class="cls_023">ão de protocolo de rede</span><span class="cls_024"><sup>8</sup></span><span class="cls_005">,</span></div>
<div style="position:absolute;left:88.97px;top:527.78px" class="cls_005"><span class="cls_005">e telnot não o implementa completamente.)</span></div>
<div style="position:absolute;left:60.99px;top:553.90px" class="cls_005"><span class="cls_005">Como sockets stream conseguem atingir um nível tão elevado de qualidade de transmissão de</span></div>
<div style="position:absolute;left:60.99px;top:567.88px" class="cls_005"><span class="cls_005">dados? Ele usa um protocolo chamado "The Transmission Control Protocol", também</span></div>
<div style="position:absolute;left:60.99px;top:581.87px" class="cls_005"><span class="cls_005">conhecido como "TCP" (veja </span><span class="cls_023">RFC 793</span><span class="cls_024"><sup>9</sup></span><span class="cls_005"> para informações extremamente detalhadas sobre</span></div>
<div style="position:absolute;left:60.99px;top:597.80px" class="cls_005"><span class="cls_005">TCP). O TCP garante que seus dados cheguem sequencialmente e livres de erros. Você pode</span></div>
<div style="position:absolute;left:60.99px;top:611.79px" class="cls_005"><span class="cls_005">ter ouvido "TCP" antes como a melhor parte do "TCP/IP", onde "IP" signi ca "Internet Protocol"</span></div>
<div style="position:absolute;left:60.99px;top:625.78px" class="cls_005"><span class="cls_005">(veja </span><span class="cls_023">RFC 791</span><span class="cls_024"><sup>10</sup></span><span class="cls_005">). O IP lida principalmente com o roteamento da Internet e geralmente não é</span></div>
<div style="position:absolute;left:60.99px;top:641.70px" class="cls_005"><span class="cls_005">responsável pela integridade dos dados.</span></div>
<div style="position:absolute;left:60.99px;top:666.88px" class="cls_005"><span class="cls_005">Legal. E quanto aos sockets datagram? Por que eles são chamados sem conexão? Qual é o</span></div>
<div style="position:absolute;left:60.99px;top:680.87px" class="cls_005"><span class="cls_005">problema aqui, a nal? Por que eles não são con áveis? Bem, aqui estão alguns fatos: se você</span></div>
<div style="position:absolute;left:60.99px;top:694.86px" class="cls_005"><span class="cls_005">enviar um datagram, ele pode chegar. Pode chegar fora de ordem. Se chegar, os dados dentro</span></div>
<div style="position:absolute;left:60.99px;top:708.85px" class="cls_005"><span class="cls_005">do pacote estarão livres de erros.</span></div>
<div style="position:absolute;left:60.99px;top:734.03px" class="cls_005"><span class="cls_005">Sockets datagram também usam IP para roteamento, mas eles não usam TCP; eles usam o</span></div>
<div style="position:absolute;left:60.99px;top:748.02px" class="cls_005"><span class="cls_005">"User Datagram Protocol", ou "UDP" (veja </span><span class="cls_023">RFC 768</span><span class="cls_024"><sup>11</sup></span><span class="cls_005">).</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">11 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:9361px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background012.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Por que eles são sem conexão? Bem, basicamente, é porque você não precisa manter uma</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">conexão aberta como você faz com sockets stream. Você apenas constrói um pacote, coloca</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">um cabeçalho IP nele com informações de destino e envia-o para fora. Nenhuma conexão é</span></div>
<div style="position:absolute;left:60.99px;top:95.97px" class="cls_005"><span class="cls_005">necessária. Eles geralmente são usados quando uma pilha TCP não está disponível ou quando</span></div>
<div style="position:absolute;left:60.99px;top:109.96px" class="cls_005"><span class="cls_005">alguns pacotes descartados aqui e ali não signi cam o  m do Universo. Aplicações de</span></div>
<div style="position:absolute;left:60.99px;top:124.88px" class="cls_005"><span class="cls_005">exemplo: tftp (trivial  le transfer protocol, um irmão mais novo do FTP), dhcpcd (um cliente</span></div>
<div style="position:absolute;left:60.99px;top:139.80px" class="cls_005"><span class="cls_005">DHCP), jogos multiplayer, streaming de áudio, video conferência, etc.</span></div>
<div style="position:absolute;left:60.99px;top:165.91px" class="cls_005"><span class="cls_005">"Espere um minuto! tftp e dhcpcd são usadospara transferir dados e também aplicações</span></div>
<div style="position:absolute;left:60.99px;top:180.83px" class="cls_005"><span class="cls_005">binárias de um host a outro! Os dados não podem ser perdidos se você espera que o aplicativo</span></div>
<div style="position:absolute;left:60.99px;top:194.82px" class="cls_005"><span class="cls_005">funcione ao chegar! Que tipo de magia negra é essa?"</span></div>
<div style="position:absolute;left:60.99px;top:220.93px" class="cls_005"><span class="cls_005">Bem, meu amigo humano, tftp e outros programas semelhantes têm seus próprios</span></div>
<div style="position:absolute;left:60.99px;top:235.86px" class="cls_005"><span class="cls_005">protocolos em cima do UDP. Por exemplo, o protocolo tftp diz que para cada pacote que é</span></div>
<div style="position:absolute;left:60.99px;top:249.85px" class="cls_005"><span class="cls_005">enviado, o destinatário tem de enviar de volta um pacote que diz: "Eu consegui!" (Um pacote</span></div>
<div style="position:absolute;left:60.99px;top:263.83px" class="cls_005"><span class="cls_005">"ACK".). Se o remetente do pacote original não recebe a resposta, digamos, em cinco</span></div>
<div style="position:absolute;left:60.99px;top:277.82px" class="cls_005"><span class="cls_005">segundos, ele retransmitirá o pacote até que  nalmente receba um ACK. Este procedimento de</span></div>
<div style="position:absolute;left:60.99px;top:292.75px" class="cls_005"><span class="cls_005">reconhecimento é muito importante na implementação con ável do SOCK_DGRAM em</span></div>
<div style="position:absolute;left:60.99px;top:307.67px" class="cls_005"><span class="cls_005">aplicações.</span></div>
<div style="position:absolute;left:60.99px;top:332.85px" class="cls_005"><span class="cls_005">Para aplicações não con áveis, como jogos, áudio ou vídeo, você pode só ignorar os pacotes</span></div>
<div style="position:absolute;left:60.99px;top:346.84px" class="cls_005"><span class="cls_005">perdidos, ou talvez tentar compensá-los de forma inteligente (Jogadores de Quake conhecem</span></div>
<div style="position:absolute;left:60.99px;top:360.82px" class="cls_005"><span class="cls_005">bem a manifestação deste efeito pelo termo técnico: lag maldito. A palavra "maldito", neste</span></div>
<div style="position:absolute;left:60.99px;top:374.81px" class="cls_005"><span class="cls_005">caso, representa qualquer enunciado extremamente profano).</span></div>
<div style="position:absolute;left:60.99px;top:399.99px" class="cls_005"><span class="cls_005">Por que você usaria um protocolo subjacente não con ável? Duas razões: Velocidade e</span></div>
<div style="position:absolute;left:60.99px;top:413.98px" class="cls_005"><span class="cls_005">velocidade. É a maneira mais rápida de mirar-e-atirar do que seria para se certi car de que um</span></div>
<div style="position:absolute;left:60.99px;top:427.97px" class="cls_005"><span class="cls_005">dado chegou em segurança e ainda ter certeza que o mesmo está na ordem correta. Se você</span></div>
<div style="position:absolute;left:60.99px;top:441.96px" class="cls_005"><span class="cls_005">estiver enviando mensagens de bate-papo, o TCP é ótimo; Se você estiver enviando 40</span></div>
<div style="position:absolute;left:60.99px;top:455.95px" class="cls_005"><span class="cls_005">atualizações posicionais por segundo para jogadores ao redor do mundo, talvez não importe</span></div>
<div style="position:absolute;left:60.99px;top:469.94px" class="cls_005"><span class="cls_005">muito perder um ou dois pacotes e o UDP seja uma boa escolha.</span></div>
<div style="position:absolute;left:60.99px;top:496.93px" class="cls_007"><span class="cls_007">Baixo nível nonsense e Teoria de Rede</span></div>
<div style="position:absolute;left:60.99px;top:532.31px" class="cls_005"><span class="cls_005">Agora que acabei de mencionar a divisão de camadas de protocolos, é hora de falar sobre</span></div>
<div style="position:absolute;left:60.99px;top:546.30px" class="cls_005"><span class="cls_005">como as redes realmente funcionam, e mostrar alguns exemplos de como pacotes</span></div>
<div style="position:absolute;left:60.99px;top:561.22px" class="cls_005"><span class="cls_005">SOCK_DGRAM são construídos. Na prática, você provavelmente pode pular esta seção. É uma</span></div>
<div style="position:absolute;left:60.99px;top:576.14px" class="cls_005"><span class="cls_005">boa teoria de background, no entanto.</span></div>
<div style="position:absolute;left:230.02px;top:641.76px" class="cls_005"><span class="cls_005">Encapsulamento de dados.</span></div>
<div style="position:absolute;left:60.99px;top:666.94px" class="cls_005"><span class="cls_005">Ei, crianças, é hora de aprender sobre Encapsulamento de Dados! Isto é muito, muito</span></div>
<div style="position:absolute;left:60.99px;top:680.93px" class="cls_005"><span class="cls_005">importante. É tão importante que para que você possa aprender sobre é necessário fazer o</span></div>
<div style="position:absolute;left:60.99px;top:695.85px" class="cls_005"><span class="cls_005">curso de redes aqui na Chico State ;-). Basicamente, ele diz o seguinte: um pacote nasce, é</span></div>
<div style="position:absolute;left:60.99px;top:710.77px" class="cls_005"><span class="cls_005">envolto ( "encapsulado") em um cabeçalho (e raramente um rodapé) pelo primeiro protocolo</span></div>
<div style="position:absolute;left:60.99px;top:724.76px" class="cls_005"><span class="cls_005">(por exemplo, o protocolo TFTP), o conjunto da coisa (com cabeçalho TFTP já incluído) é</span></div>
<div style="position:absolute;left:60.99px;top:738.75px" class="cls_005"><span class="cls_005">encapsulado novamente pelo seguinte protocolo (digamos, UDP), em seguida, novamente pelo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">12 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:10212px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background013.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">próximo (IP), em seguida, novamente pelo protocolo  nal sobre a camada de hardware (física)</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">(por exemplo, Ethernet).</span></div>
<div style="position:absolute;left:60.99px;top:93.17px" class="cls_005"><span class="cls_005">Quando outro computador recebe o pacote, o hardware retira o cabeçalho Ethernet, o kernel</span></div>
<div style="position:absolute;left:60.99px;top:107.16px" class="cls_005"><span class="cls_005">retira os cabeçalhos IP e UDP, o programa TFTP retira o cabeçalho TFTP, e  nalmente você tem</span></div>
<div style="position:absolute;left:60.99px;top:121.15px" class="cls_005"><span class="cls_005">os dados.</span></div>
<div style="position:absolute;left:60.99px;top:146.33px" class="cls_005"><span class="cls_005">Agora posso  nalmente falar sobre o infame Modelo de Rede em Camadas (conhecido como</span></div>
<div style="position:absolute;left:60.99px;top:160.32px" class="cls_005"><span class="cls_005">"ISO/OSI"). Este modelo de rede descreve um sistema de funcionalidades de rede que tem</span></div>
<div style="position:absolute;left:60.99px;top:174.31px" class="cls_005"><span class="cls_005">muitas vantagens sobre outros modelos. Por exemplo, você pode escrever programas com</span></div>
<div style="position:absolute;left:60.99px;top:188.29px" class="cls_005"><span class="cls_005">sockets que são exatamente os mesmos sem se importar com a forma como os dados são</span></div>
<div style="position:absolute;left:60.99px;top:202.28px" class="cls_005"><span class="cls_005">transmitidos  sicamente (serial, thin Ethernet, AUI, o que for) porque programas em níveis mais</span></div>
<div style="position:absolute;left:60.99px;top:216.27px" class="cls_005"><span class="cls_005">baixos lidam com isso para você. O hardware e a topologia de rede reais são transparentes</span></div>
<div style="position:absolute;left:60.99px;top:230.26px" class="cls_005"><span class="cls_005">para o programador do socket.</span></div>
<div style="position:absolute;left:60.99px;top:255.44px" class="cls_005"><span class="cls_005">Sem mais delongas, apresentarei as camadas do modelo de forma completa. Lembre-se disso</span></div>
<div style="position:absolute;left:60.99px;top:269.43px" class="cls_005"><span class="cls_005">para seus exames do curso de redes:</span></div>
<div style="position:absolute;left:88.97px;top:294.61px" class="cls_005"><span class="cls_005">Aplicação</span></div>
<div style="position:absolute;left:88.97px;top:308.60px" class="cls_005"><span class="cls_005">Apresentação</span></div>
<div style="position:absolute;left:88.97px;top:322.59px" class="cls_005"><span class="cls_005">Sessão</span></div>
<div style="position:absolute;left:88.97px;top:336.58px" class="cls_005"><span class="cls_005">Transporte</span></div>
<div style="position:absolute;left:88.97px;top:350.57px" class="cls_005"><span class="cls_005">Rede</span></div>
<div style="position:absolute;left:88.97px;top:364.56px" class="cls_005"><span class="cls_005">Enlace</span></div>
<div style="position:absolute;left:88.97px;top:378.54px" class="cls_005"><span class="cls_005">Física</span></div>
<div style="position:absolute;left:60.99px;top:403.72px" class="cls_005"><span class="cls_005">A camada física é o hardware (serial, Ethernet, etc.). A camada de aplicação é quase tão</span></div>
<div style="position:absolute;left:60.99px;top:417.71px" class="cls_005"><span class="cls_005">distante da camada física quanto você possa imaginar—é onde os usuários interagem com a</span></div>
<div style="position:absolute;left:60.99px;top:431.70px" class="cls_005"><span class="cls_005">rede.</span></div>
<div style="position:absolute;left:60.99px;top:456.88px" class="cls_005"><span class="cls_005">Agora, este modelo é tão geral que você provavelmente poderia usá-lo como um guia de</span></div>
<div style="position:absolute;left:60.99px;top:470.87px" class="cls_005"><span class="cls_005">reparação de automóveis, se você realmente quiser. Um modelo em camadas mais consistente</span></div>
<div style="position:absolute;left:60.99px;top:484.86px" class="cls_005"><span class="cls_005">com Unix poderia ser:</span></div>
<div style="position:absolute;left:88.97px;top:510.04px" class="cls_005"><span class="cls_005">Camada de Aplicação (telnet, ftp, etc.)</span></div>
<div style="position:absolute;left:88.97px;top:524.03px" class="cls_005"><span class="cls_005">Camada de Transporte Host-para-Host (TCP, UDP)</span></div>
<div style="position:absolute;left:88.97px;top:538.02px" class="cls_005"><span class="cls_005">Camada de Internet (IP e roteamento)</span></div>
<div style="position:absolute;left:88.97px;top:552.01px" class="cls_005"><span class="cls_005">Camada de Acesso à Rede (Ethernet, Wi-Fi, ou outros)</span></div>
<div style="position:absolute;left:60.99px;top:577.19px" class="cls_005"><span class="cls_005">Neste momento, você provavelmente já pode ver como essas camadas correspondem ao</span></div>
<div style="position:absolute;left:60.99px;top:591.18px" class="cls_005"><span class="cls_005">encapsulamento dos dados originais.</span></div>
<div style="position:absolute;left:60.99px;top:616.36px" class="cls_005"><span class="cls_005">Viu quanto trabalho há na construção de um simples pacote? Eita! E você só precisa digitar</span></div>
<div style="position:absolute;left:60.99px;top:631.28px" class="cls_005"><span class="cls_005">seus cabeçalhos utilizando "cat"! Estou brincando. Tudo o que você precisa fazer para sockets</span></div>
<div style="position:absolute;left:60.99px;top:647.13px" class="cls_005"><span class="cls_005">stream é usar send() para enviar os dados. E tudo o que você precisa fazer para sockets</span></div>
<div style="position:absolute;left:60.99px;top:662.99px" class="cls_005"><span class="cls_005">datagram é encapsular o pacote no método de sua escolher e usar sendto(). O kernel</span></div>
<div style="position:absolute;left:60.99px;top:677.91px" class="cls_005"><span class="cls_005">constrói a Camada de Transporte e a Camada de Internet para você e o hardware faz a</span></div>
<div style="position:absolute;left:60.99px;top:691.90px" class="cls_005"><span class="cls_005">Camada de Acesso à Rede. Ah, a tecnologia moderna.</span></div>
<div style="position:absolute;left:60.99px;top:717.08px" class="cls_005"><span class="cls_005">Assim termina nossa breve incursão à teoria de rede. Ah, sim, eu esqueci de lhe dizer tudo o</span></div>
<div style="position:absolute;left:60.99px;top:731.07px" class="cls_005"><span class="cls_005">que eu queria dizer sobre roteamento: nada! Isso mesmo, eu não falarei sobre isso. O roteador</span></div>
<div style="position:absolute;left:60.99px;top:745.05px" class="cls_005"><span class="cls_005">abre o cabeçalho IP do pacote, consulta sua tabela de roteamento, blá-blá-blá. Con ra o </span><span class="cls_023">IP RFC</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">13 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:11063px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background014.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_011"><span class="cls_011">12</span></div>
<div style="position:absolute;left:74.23px;top:55.94px" class="cls_005"><span class="cls_005">caso realmente se importe em saber. E se você nunca souber, bem, você ainda estará vivo.</span></div>
<div style="position:absolute;left:60.99px;top:86.78px" class="cls_002"><span class="cls_002">Endereços IP, structs, e Data Munging</span></div>
<div style="position:absolute;left:60.99px;top:130.68px" class="cls_005"><span class="cls_005">Aqui, para variar, é a parte do jogo em que podemos falar sobre código.</span></div>
<div style="position:absolute;left:60.99px;top:155.86px" class="cls_005"><span class="cls_005">Mas, primeiro, vamos discutir mais não-códigos! Sim! Primeiro quero falar um pouco sobre</span></div>
<div style="position:absolute;left:60.99px;top:169.85px" class="cls_005"><span class="cls_005">endereços IP e portas e então teremos o assunto resolvido. Em seguida, falaremos sobre</span></div>
<div style="position:absolute;left:60.99px;top:183.84px" class="cls_005"><span class="cls_005">como a API de sockets armazena e manipula os endereços IP e outros dados.</span></div>
<div style="position:absolute;left:60.99px;top:210.83px" class="cls_007"><span class="cls_007">Endereços IP, versões 4 e 6</span></div>
<div style="position:absolute;left:60.99px;top:246.21px" class="cls_005"><span class="cls_005">Nos bons e velhos tempos, quando Ben Kenobi ainda era chamado Obi Wan Kenobi, havia um</span></div>
<div style="position:absolute;left:60.99px;top:260.20px" class="cls_005"><span class="cls_005">maravilhoso sistema de roteamento de rede chamado The Internet Protocol Version 4, também</span></div>
<div style="position:absolute;left:60.99px;top:274.19px" class="cls_005"><span class="cls_005">chamado IPv4. Ele possuia endereços compostos de quatro bytes (ou quatro "octetos"), e era</span></div>
<div style="position:absolute;left:60.99px;top:289.11px" class="cls_005"><span class="cls_005">escrito comumente na forma de "pontos e números", assim: 192.0.2.111.</span></div>
<div style="position:absolute;left:60.99px;top:315.22px" class="cls_005"><span class="cls_005">Você provavelmente já viu isso por aí.</span></div>
<div style="position:absolute;left:60.99px;top:340.40px" class="cls_005"><span class="cls_005">Na verdade, até o momento desta escrita, praticamente todos os sites da Internet usam IPv4.</span></div>
<div style="position:absolute;left:60.99px;top:365.58px" class="cls_005"><span class="cls_005">Todos, incluindo Obi Wan, estavam felizes. As coisas eram ótimas, até que algum opositor com</span></div>
<div style="position:absolute;left:60.99px;top:379.57px" class="cls_005"><span class="cls_005">o nome de Vint Cerf avisou que estávamos prestes a  car sem endereços IPv4!</span></div>
<div style="position:absolute;left:60.99px;top:404.75px" class="cls_005"><span class="cls_005">(Além de avisar a todos sobre o futuro destino apocalíptico de tristeza do IPv4, </span><span class="cls_023">Vint Cerf</span><span class="cls_024"><sup>13</sup></span></div>
<div style="position:absolute;left:60.99px;top:420.67px" class="cls_005"><span class="cls_005">também é conhecido por ser o Pai da Internet. Então, eu realmente não estou em condições de</span></div>
<div style="position:absolute;left:60.99px;top:434.66px" class="cls_005"><span class="cls_005">o julgar.)</span></div>
<div style="position:absolute;left:60.99px;top:459.84px" class="cls_005"><span class="cls_005">Ficar sem endereços? Como isso poderia acontecer? Quer dizer, existem bilhões de endereços</span></div>
<div style="position:absolute;left:60.99px;top:473.83px" class="cls_005"><span class="cls_005">IP em um endereço IPv4 de 32 bits. Nós realmente temos bilhões de computadores por aí?</span></div>
<div style="position:absolute;left:60.99px;top:499.01px" class="cls_005"><span class="cls_005">Sim.</span></div>
<div style="position:absolute;left:60.99px;top:524.19px" class="cls_005"><span class="cls_005">Além disso, no início, quando havia apenas alguns computadores e todos pensavam que um</span></div>
<div style="position:absolute;left:60.99px;top:538.18px" class="cls_005"><span class="cls_005">bilhão era um número incrivelmente grande, algumas grandes organizações receberam</span></div>
<div style="position:absolute;left:60.99px;top:552.17px" class="cls_005"><span class="cls_005">generosamente milhões de endereços IP para uso próprio (Como Xerox, MIT, Ford, HP, IBM, GE,</span></div>
<div style="position:absolute;left:60.99px;top:566.16px" class="cls_005"><span class="cls_005">AT&T e uma pequena empresa chamada Apple, para citar alguns.).</span></div>
<div style="position:absolute;left:60.99px;top:591.34px" class="cls_005"><span class="cls_005">Na verdade, se não fosse por várias medidas paliativas, já teríamos os esgotado há muito</span></div>
<div style="position:absolute;left:60.99px;top:605.33px" class="cls_005"><span class="cls_005">tempo.</span></div>
<div style="position:absolute;left:60.99px;top:630.51px" class="cls_005"><span class="cls_005">Mas agora estamos vivendo em uma era em que todos os seres humanos têm um endereço IP,</span></div>
<div style="position:absolute;left:60.99px;top:644.50px" class="cls_005"><span class="cls_005">todos os computadores, todas as calculadoras, todos os telefones, todos os parquímetros e</span></div>
<div style="position:absolute;left:60.99px;top:658.49px" class="cls_005"><span class="cls_005">(por que não) todos os  lhotes de cachorros também.</span></div>
<div style="position:absolute;left:60.99px;top:683.67px" class="cls_005"><span class="cls_005">E assim o IPv6 nasceu. Como Vint Cerf é provavelmente imortal (mesmo que sua forma física</span></div>
<div style="position:absolute;left:60.99px;top:697.66px" class="cls_005"><span class="cls_005">passe, Deus nos livre, ele provavelmente já está existindo como uma espécie hiper-inteligente</span></div>
<div style="position:absolute;left:60.99px;top:711.64px" class="cls_005"><span class="cls_005">do programa </span><span class="cls_023">ELIZA</span><span class="cls_024"><sup>14</sup></span><span class="cls_005"> nas profundezas do Internet2), ninguém quer ter de ouvi-lo dizer</span></div>
<div style="position:absolute;left:60.99px;top:727.57px" class="cls_005"><span class="cls_005">novamente "eu avisei" se não tivermos endereços su cientes na próxima versão do Internet</span></div>
<div style="position:absolute;left:60.99px;top:741.56px" class="cls_005"><span class="cls_005">Protocol.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">14 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:11914px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background015.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">O que isso lhe sugere?</span></div>
<div style="position:absolute;left:60.99px;top:79.18px" class="cls_005"><span class="cls_005">Que precisamos de muito mais endereços. Que não precisamos apenas de duas vezes mais de</span></div>
<div style="position:absolute;left:60.99px;top:93.17px" class="cls_005"><span class="cls_005">endereços, nem um bilhão de vezes mais, nem mil trilhões de vezes mais, mas 79 MILHÕES</span></div>
<div style="position:absolute;left:60.99px;top:107.16px" class="cls_005"><span class="cls_005">BILHÕES TRILHÕES de vezes mais endereços possíveis! Isso vai mostrar a eles!</span></div>
<div style="position:absolute;left:60.99px;top:132.34px" class="cls_005"><span class="cls_005">Você está dizendo: "Beej, isso é verdade? Eu tenho todos os motivos para descrer de grandes</span></div>
<div style="position:absolute;left:60.99px;top:146.33px" class="cls_005"><span class="cls_005">números." Bem, as diferenças entre 32 bits e 128 bits podem não parecer grandes; são apenas</span></div>
<div style="position:absolute;left:60.99px;top:160.32px" class="cls_005"><span class="cls_005">mais 96 bits, certo? Mas lembre-se, estamos falando de poderes aqui: 32 bits representam</span></div>
<div style="position:absolute;left:60.99px;top:174.31px" class="cls_005"><span class="cls_005">cerca de 4 bilhões de números (2</span><span class="cls_015"><sup>32</sup></span><span class="cls_005">), enquanto 128 bits representam cerca de 340 trilhões de</span></div>
<div style="position:absolute;left:60.99px;top:190.23px" class="cls_005"><span class="cls_005">trilhões de trilhões de números (na verdade, 2</span><span class="cls_015"><sup>128</sup></span><span class="cls_005">). Isso é como um milhão de Internets IPv4</span></div>
<div style="position:absolute;left:60.99px;top:206.15px" class="cls_005"><span class="cls_005">para cada estrela no Universo.</span></div>
<div style="position:absolute;left:60.99px;top:231.33px" class="cls_005"><span class="cls_005">Esqueça a aparência destes pontos-e-números do IPv4, também; agora temos uma</span></div>
<div style="position:absolute;left:60.99px;top:245.32px" class="cls_005"><span class="cls_005">representação hexadecimal, com cada bloco de dois bytes separados por dois pontos, como</span></div>
<div style="position:absolute;left:60.99px;top:259.31px" class="cls_005"><span class="cls_005">isso:</span></div>
<div style="position:absolute;left:94.85px;top:292.42px" class="cls_005"><span class="cls_005">2001:0db8:c9d2:aee5:73e3:934a:a5ae:9551</span></div>
<div style="position:absolute;left:60.99px;top:325.53px" class="cls_005"><span class="cls_005">Isso não é tudo! Muitas vezes, você terá um endereço IP com muitos zeros e poderá compactá-</span></div>
<div style="position:absolute;left:60.99px;top:339.51px" class="cls_005"><span class="cls_005">los entre dois-pontos. E você pode deixar zeros à esquerda para cada par de bytes. Por</span></div>
<div style="position:absolute;left:60.99px;top:353.50px" class="cls_005"><span class="cls_005">exemplo, cada um desses pares de endereços é equivalente:</span></div>
<div style="position:absolute;left:94.85px;top:386.61px" class="cls_005"><span class="cls_005">2001:0db8:c9d2:0012:0000:0000:0000:0051</span></div>
<div style="position:absolute;left:94.85px;top:402.47px" class="cls_005"><span class="cls_005">2001:db8:c9d2:12::51</span></div>
<div style="position:absolute;left:94.85px;top:434.17px" class="cls_005"><span class="cls_005">2001:0db8:ab00:0000:0000:0000:0000:0000</span></div>
<div style="position:absolute;left:94.85px;top:450.03px" class="cls_005"><span class="cls_005">2001:db8:ab00::</span></div>
<div style="position:absolute;left:94.85px;top:481.74px" class="cls_005"><span class="cls_005">0000:0000:0000:0000:0000:0000:0000:0001</span></div>
<div style="position:absolute;left:94.85px;top:497.59px" class="cls_005"><span class="cls_005">::1</span></div>
<div style="position:absolute;left:60.99px;top:531.63px" class="cls_005"><span class="cls_005">O endereço ::1 é o endereço de auto-retorno. Isto sempre signi ca "esta máquina que estou</span></div>
<div style="position:absolute;left:60.99px;top:547.48px" class="cls_005"><span class="cls_005">executando agora". Em IPv4, o endereço de auto-retorno é 127.0.0.1.</span></div>
<div style="position:absolute;left:60.99px;top:573.60px" class="cls_005"><span class="cls_005">Finalmente, há um modo de compatibilidade IPv4 para endereços IPv6 com o qual você pode</span></div>
<div style="position:absolute;left:60.99px;top:588.52px" class="cls_005"><span class="cls_005">se deparar. Se você quiser, por exemplo, para representar o IPv4 192.0.2.33 como um</span></div>
<div style="position:absolute;left:60.99px;top:604.37px" class="cls_005"><span class="cls_005">endereço IPv6, você usaria a seguinte notação: "::ffff:192.0.2.33"</span></div>
<div style="position:absolute;left:60.99px;top:630.49px" class="cls_005"><span class="cls_005">Estamos falando de diversão séria.</span></div>
<div style="position:absolute;left:60.99px;top:655.67px" class="cls_005"><span class="cls_005">Na verdade, é tão divertido, os criadores do IPv6 gentilmente mativeram trilhões e trilhões de</span></div>
<div style="position:absolute;left:60.99px;top:669.65px" class="cls_005"><span class="cls_005">endereços para uso reservado, mas temos tantos, francamente, quem ainda está contando?</span></div>
<div style="position:absolute;left:60.99px;top:683.64px" class="cls_005"><span class="cls_005">Há muito de sobra para cada homem, mulher, criança, cachorrinho e parquímetro em todos os</span></div>
<div style="position:absolute;left:60.99px;top:697.63px" class="cls_005"><span class="cls_005">planetas da galáxia. E acredite em mim, cada planeta da galáxia possui parquímetros. Você</span></div>
<div style="position:absolute;left:60.99px;top:711.62px" class="cls_005"><span class="cls_005">sabe que é verdade.</span></div>
<div style="position:absolute;left:60.99px;top:738.67px" class="cls_016"><span class="cls_016">Subnets</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">15 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:12765px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background016.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Por motivos organizacionais, às vezes é conveniente declarar que "Desta primeira parte do</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">endereço IP até este bit é a parte da rede do endereço IP, e o restante é a parte do host".</span></div>
<div style="position:absolute;left:60.99px;top:94.10px" class="cls_005"><span class="cls_005">Por exemplo, com IPv4, você pode ter 192.0.2.12, e poderíamos dizer que os três primeiros</span></div>
<div style="position:absolute;left:60.99px;top:109.02px" class="cls_005"><span class="cls_005">campos são a rede e o último o endereço do host. Ou, dito de outra forma, estamos falando do</span></div>
<div style="position:absolute;left:60.99px;top:123.94px" class="cls_005"><span class="cls_005">host 12 na rede 192.0.2.0 (veja como podemos zerar o byte de endereço do host.)</span></div>
<div style="position:absolute;left:60.99px;top:150.06px" class="cls_005"><span class="cls_005">E agora, para mais informações desatualizadas! Pronto? Nos tempos antigos, houveram</span></div>
<div style="position:absolute;left:60.99px;top:164.05px" class="cls_005"><span class="cls_005">"classes" de sub-redes, onde o primeiro, segundo, ou terceiro bytes do endereço formavam a</span></div>
<div style="position:absolute;left:60.99px;top:178.04px" class="cls_005"><span class="cls_005">parte de rede. Se você tivesse a sorte de ter um byte para a rede e três para o host, você</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">poderia ter 24 bits de hosts na sua rede (16 milhões ou mais). Essa era uma rede "Classe A".</span></div>
<div style="position:absolute;left:60.99px;top:206.01px" class="cls_005"><span class="cls_005">No extremo oposto, havia uma "Classe C", com três bytes de rede e um byte de host (256 hosts,</span></div>
<div style="position:absolute;left:60.99px;top:220.00px" class="cls_005"><span class="cls_005">menos uma dupla que estavam reservados).</span></div>
<div style="position:absolute;left:60.99px;top:245.18px" class="cls_005"><span class="cls_005">Então, como você pode ver, havia apenas alguns Classe A, uma pilha enorme de Classe C e</span></div>
<div style="position:absolute;left:60.99px;top:259.17px" class="cls_005"><span class="cls_005">alguns Classe B no meio.</span></div>
<div style="position:absolute;left:60.99px;top:285.28px" class="cls_005"><span class="cls_005">A porção da rede do endereço IP é descrita por algo chamado netmask, onde você realiza uma</span></div>
<div style="position:absolute;left:60.99px;top:300.21px" class="cls_005"><span class="cls_005">operação bitwise-AND com o endereço IP para obter o número da rede. A netmask geralmente</span></div>
<div style="position:absolute;left:60.99px;top:315.13px" class="cls_005"><span class="cls_005">tem um formato parecido com 255.255.255.0. (Por exemplo, com essa netmask, se o seu IP</span></div>
<div style="position:absolute;left:60.99px;top:330.98px" class="cls_005"><span class="cls_005">é 192.0.2.12, então sua rede é 192.0.2.12 AND 255.255.255.0 o que gera</span></div>
<div style="position:absolute;left:60.99px;top:346.84px" class="cls_005"><span class="cls_005">192.0.2.0.)</span></div>
<div style="position:absolute;left:60.99px;top:372.95px" class="cls_005"><span class="cls_005">Infelizmente, descobriu-se que isso não era su ciente para as eventuais necessidades da</span></div>
<div style="position:absolute;left:60.99px;top:386.94px" class="cls_005"><span class="cls_005">Internet; nós estávamos  cando sem classes C rapidamente, e nós estávamos de nitivamente</span></div>
<div style="position:absolute;left:60.99px;top:400.93px" class="cls_005"><span class="cls_005">fora das Classes A, então nem se incomode em perguntar. Para remediar isso, os números</span></div>
<div style="position:absolute;left:60.99px;top:414.92px" class="cls_005"><span class="cls_005">permitidos para a netmask são combinados arbitrários de bits, não apenas 8, 16 ou 24. Então</span></div>
<div style="position:absolute;left:60.99px;top:429.84px" class="cls_005"><span class="cls_005">você pode ter uma netmask de, digamos, 255.255.255.252, que é de 30 bits de rede e 2 bits</span></div>
<div style="position:absolute;left:60.99px;top:444.76px" class="cls_005"><span class="cls_005">de host, permitindo quatro hosts na rede. (Note que a netmask é SEMPRE um monte de bits 1</span></div>
<div style="position:absolute;left:60.99px;top:458.75px" class="cls_005"><span class="cls_005">seguidos por um monte de bits 0.)</span></div>
<div style="position:absolute;left:60.99px;top:484.86px" class="cls_005"><span class="cls_005">Mas é um pouco difícil usar uma grande série de números como 255.192.0.0 como</span></div>
<div style="position:absolute;left:60.99px;top:499.78px" class="cls_005"><span class="cls_005">netmask. Primeiro de tudo, as pessoas não têm uma ideia intuitiva da quantidade de bits, e em</span></div>
<div style="position:absolute;left:60.99px;top:513.77px" class="cls_005"><span class="cls_005">segundo lugar, não é realmente compacta. Então, o Novo Estilo surgiu e é muito melhor. Você</span></div>
<div style="position:absolute;left:60.99px;top:527.76px" class="cls_005"><span class="cls_005">apenas precisa colocar uma barra após o endereço IP e, em seguida, o número de bits de rede</span></div>
<div style="position:absolute;left:60.99px;top:542.68px" class="cls_005"><span class="cls_005">em decimal. Assim: 192.0.2.12/30.</span></div>
<div style="position:absolute;left:60.99px;top:569.73px" class="cls_005"><span class="cls_005">Ou, para IPv6, algo como isso: 2001:db8::/32 ou 2001:db8:5413:4028::9db9/64.</span></div>
<div style="position:absolute;left:60.99px;top:597.70px" class="cls_016"><span class="cls_016">Números de Porta</span></div>
<div style="position:absolute;left:60.99px;top:627.62px" class="cls_005"><span class="cls_005">Se você se lembra, apresentamos anteriormente o </span><span class="cls_023">Modelo de rede em camadas</span><span class="cls_005"> que possuia a</span></div>
<div style="position:absolute;left:60.99px;top:641.61px" class="cls_005"><span class="cls_005">camada de Internet (IP) separada da Camada de Transporte Host-para-Host (TCP e UDP).</span></div>
<div style="position:absolute;left:60.99px;top:655.60px" class="cls_005"><span class="cls_005">Atenção a isso antes do próximo parágrafo.</span></div>
<div style="position:absolute;left:60.99px;top:680.78px" class="cls_005"><span class="cls_005">Acontece que, além de um endereço IP (usado pela camada IP), há outro endereço usado pelo</span></div>
<div style="position:absolute;left:60.99px;top:694.76px" class="cls_005"><span class="cls_005">TCP (sockets stream) e, coincidentemente, pelo UDP (sockets datagram). É o número de porta.</span></div>
<div style="position:absolute;left:60.99px;top:708.75px" class="cls_005"><span class="cls_005">Ele é um número de 16-bit que é como o endereço local da conexão.</span></div>
<div style="position:absolute;left:60.99px;top:733.93px" class="cls_005"><span class="cls_005">Pense no endereço IP como o endereço de um hotel e o endereço da porta como o número do</span></div>
<div style="position:absolute;left:60.99px;top:747.92px" class="cls_005"><span class="cls_005">quarto. Essa é uma analogia decente; talvez mais tarde eu venha com uma envolvendo a</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">16 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:13616px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background017.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">indústria automobilística.</span></div>
<div style="position:absolute;left:60.99px;top:79.18px" class="cls_005"><span class="cls_005">Digamos que você queira ter um computador que lide com e-mails recebidos E serviços web—</span></div>
<div style="position:absolute;left:60.99px;top:93.17px" class="cls_005"><span class="cls_005">como você diferencia os dois em um único computador com um único endereço IP?</span></div>
<div style="position:absolute;left:60.99px;top:118.35px" class="cls_005"><span class="cls_005">Bem, serviços diferentes na Internet têm diferentes números de porta bem conhecidos. Você</span></div>
<div style="position:absolute;left:60.99px;top:132.34px" class="cls_005"><span class="cls_005">pode vê-los todos em </span><span class="cls_023">the Bi</span><span class="cls_006">g</span><span class="cls_023"> IANA Port List</span><span class="cls_024"><sup>15</sup></span><span class="cls_005"> ou, se você estiver em um ambiente Unix, em</span></div>
<div style="position:absolute;left:60.99px;top:149.19px" class="cls_005"><span class="cls_005">seu arquivo /etc/services. O HTTP (a web) usa a porta 80, o telnet usa a porta 23, o SMTP</span></div>
<div style="position:absolute;left:60.99px;top:164.12px" class="cls_005"><span class="cls_005">a porta 25, o jogo </span><span class="cls_023">DOOM</span><span class="cls_024"><sup>16</sup></span><span class="cls_005"> usa a porta 666, etc. E assim por diante. Portas abaixo de 1024 são</span></div>
<div style="position:absolute;left:60.99px;top:180.04px" class="cls_005"><span class="cls_005">frequentemente consideradas especiais, e geralmente exigem privilégios especiais do Sistema</span></div>
<div style="position:absolute;left:60.99px;top:194.03px" class="cls_005"><span class="cls_005">Operacional para seu uso.</span></div>
<div style="position:absolute;left:60.99px;top:219.21px" class="cls_005"><span class="cls_005">E é isso!</span></div>
<div style="position:absolute;left:60.99px;top:246.20px" class="cls_007"><span class="cls_007">Byte Order</span></div>
<div style="position:absolute;left:60.99px;top:281.58px" class="cls_005"><span class="cls_005">Por ordem do rei! Haverá duas ordenações de bytes, a seguir conhecidas como ótima e</span></div>
<div style="position:absolute;left:60.99px;top:295.57px" class="cls_005"><span class="cls_005">péssima!</span></div>
<div style="position:absolute;left:60.99px;top:321.68px" class="cls_005"><span class="cls_005">Brincadeira, mas uma é realmente melhor do que a outra. :-)</span></div>
<div style="position:absolute;left:60.99px;top:347.79px" class="cls_005"><span class="cls_005">Não há uma maneira fácil de dizer isso, então só vou deixar escapar: seu computador pode</span></div>
<div style="position:absolute;left:60.99px;top:361.78px" class="cls_005"><span class="cls_005">estar armazenando bytes em ordem inversa bem abaixo do seu nariz. Eu sei! Ninguém queria</span></div>
<div style="position:absolute;left:60.99px;top:375.77px" class="cls_005"><span class="cls_005">te dizer.</span></div>
<div style="position:absolute;left:60.99px;top:400.95px" class="cls_005"><span class="cls_005">O fato é que todos no mundo da Internet geralmente concordam que se você quiser</span></div>
<div style="position:absolute;left:60.99px;top:415.87px" class="cls_005"><span class="cls_005">representar um número hexadecimal de dois bytes, digamos b34f, você poderá armazená-lo</span></div>
<div style="position:absolute;left:60.99px;top:430.79px" class="cls_005"><span class="cls_005">em dois bytes sequenciais b3 seguido de 4f. Faz sentido, e, como </span><span class="cls_023">Wilford Brimle</span><span class="cls_006">y</span><span class="cls_024"><sup>17</sup></span><span class="cls_005"> diria, é a</span></div>
<div style="position:absolute;left:60.99px;top:447.65px" class="cls_005"><span class="cls_005">coisa certa a fazer. Esse número, armazenado com a parte mais signi cativa primeiro, é</span></div>
<div style="position:absolute;left:60.99px;top:461.64px" class="cls_005"><span class="cls_005">chamado Big-Endian.</span></div>
<div style="position:absolute;left:60.99px;top:486.82px" class="cls_005"><span class="cls_005">Infelizmente, alguns computadores espalhados aqui e ali ao longo o mundo, ou seja, qualquer</span></div>
<div style="position:absolute;left:60.99px;top:500.81px" class="cls_005"><span class="cls_005">coisa com um processador Intel ou compatível com Intel, armazena os bytes de forma</span></div>
<div style="position:absolute;left:60.99px;top:515.73px" class="cls_005"><span class="cls_005">invertida, de modo que b34f seria armazenado na memória como os bytes sequenciais 4f</span></div>
<div style="position:absolute;left:60.99px;top:531.58px" class="cls_005"><span class="cls_005">seguido de b3. Este método de armazenamento é chamado Little-Endian.</span></div>
<div style="position:absolute;left:60.99px;top:557.70px" class="cls_005"><span class="cls_005">Mas espere, ainda não terminei com a terminologia! O Big-Endian, o mais sensato, também é</span></div>
<div style="position:absolute;left:60.99px;top:571.68px" class="cls_005"><span class="cls_005">chamado de Network Byte Order porque essa é a ordem em que os tipos de rede funcionam.</span></div>
<div style="position:absolute;left:60.99px;top:596.87px" class="cls_005"><span class="cls_005">Seu computador salva números em Host Byte Order. Se ele é um Intel 80x86, o Host Byte Order</span></div>
<div style="position:absolute;left:60.99px;top:610.85px" class="cls_005"><span class="cls_005">é Little-Endian. Se é um Motorola 64k, o Host Byte Order é Big-Endian. Se é um PowerPC, o</span></div>
<div style="position:absolute;left:60.99px;top:624.84px" class="cls_005"><span class="cls_005">Host Byte Order é..., isso depende!</span></div>
<div style="position:absolute;left:60.99px;top:650.02px" class="cls_005"><span class="cls_005">Muitas vezes, quando você cria pacotes ou preenche estruturas de dados você precisa se</span></div>
<div style="position:absolute;left:60.99px;top:664.01px" class="cls_005"><span class="cls_005">certi car de que seus números de dois e quatro bytes estão em Network Byte Order. Mas como</span></div>
<div style="position:absolute;left:60.99px;top:678.00px" class="cls_005"><span class="cls_005">você pode fazer isso se você não conhece o Host Byte Order nativo?</span></div>
<div style="position:absolute;left:60.99px;top:703.18px" class="cls_005"><span class="cls_005">Boas notícias! Você acabou de supor que o Host Byte Order não está correto, e você sempre</span></div>
<div style="position:absolute;left:60.99px;top:717.17px" class="cls_005"><span class="cls_005">passa os valore através de uma função para con gurá-los para Network Byte Order. A função</span></div>
<div style="position:absolute;left:60.99px;top:731.16px" class="cls_005"><span class="cls_005">fará a conversão mágica se for necessário e ,desta forma, o seu código torna-se portátil entre</span></div>
<div style="position:absolute;left:60.99px;top:745.15px" class="cls_005"><span class="cls_005">máquinas com endianness diferentes.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">17 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:14467px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background018.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Tudo certo. Existem dois tipos de números que você pode converter: short (dois bytes) e</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">long (quatro bytes). Essas funções funcionam para variações de unsigned. Digamos que</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">você queira converter um short de Host Byte Order para Network Byte Order. Comece com "h"</span></div>
<div style="position:absolute;left:60.99px;top:102.50px" class="cls_005"><span class="cls_005">para "host", siga com "to", depois, "n" para "rede" e "s" para "short": h-to-n-s, ou htons() (leia:</span></div>
<div style="position:absolute;left:60.99px;top:117.42px" class="cls_005"><span class="cls_005">"Host to Network Short").</span></div>
<div style="position:absolute;left:60.99px;top:142.60px" class="cls_005"><span class="cls_005">É quase fácil demais...</span></div>
<div style="position:absolute;left:60.99px;top:167.78px" class="cls_005"><span class="cls_005">Você pode usar todas as combinações de "n", "h", "s" e "l" desejadas, sem contar as realmente</span></div>
<div style="position:absolute;left:60.99px;top:182.70px" class="cls_005"><span class="cls_005">estúpidas. Por exemplo, NÃO há função stolh() ("Short to Long Host")—não aqui, de</span></div>
<div style="position:absolute;left:60.99px;top:197.62px" class="cls_005"><span class="cls_005">qualquer forma. Mas há:</span></div>
<div style="position:absolute;left:214.81px;top:230.73px" class="cls_025"><span class="cls_025">Funcão</span></div>
<div style="position:absolute;left:302.77px;top:230.73px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:210.38px;top:247.05px" class="cls_005"><span class="cls_005">htons()   host to network short</span></div>
<div style="position:absolute;left:210.38px;top:264.30px" class="cls_005"><span class="cls_005">htonl()   host to network long</span></div>
<div style="position:absolute;left:210.38px;top:281.55px" class="cls_005"><span class="cls_005">ntohs()   network to host short</span></div>
<div style="position:absolute;left:210.38px;top:298.81px" class="cls_005"><span class="cls_005">ntohl()   network to host long</span></div>
<div style="position:absolute;left:60.99px;top:334.25px" class="cls_005"><span class="cls_005">Basicamente, você precisará converter os números para Network Byte Order antes de saírem</span></div>
<div style="position:absolute;left:60.99px;top:348.23px" class="cls_005"><span class="cls_005">pelo  o e convertê-los de volta a Host Byte Order quando recebidos pelo  o.</span></div>
<div style="position:absolute;left:60.99px;top:373.41px" class="cls_005"><span class="cls_005">Eu não conheço sobre a variante de 64-bit, desculpe. E se você quiser fazer com ponto</span></div>
<div style="position:absolute;left:67.34px;top:387.40px" class="cls_005"><span class="cls_005">utuante, con ra a seção sobre </span><span class="cls_023">Serialização</span><span class="cls_005">, bem abaixo.</span></div>
<div style="position:absolute;left:60.99px;top:412.58px" class="cls_005"><span class="cls_005">Assuma que os números neste documento estejam em Host Byte Order, a menos que eu diga o</span></div>
<div style="position:absolute;left:60.99px;top:426.57px" class="cls_005"><span class="cls_005">contrário.</span></div>
<div style="position:absolute;left:60.99px;top:455.43px" class="cls_007"><span class="cls_007">structs</span></div>
<div style="position:absolute;left:60.99px;top:490.81px" class="cls_005"><span class="cls_005">Bem,  nalmente estamos aqui. É hora de falar sobre programação. Nesta seção, cobrirei vários</span></div>
<div style="position:absolute;left:60.99px;top:504.79px" class="cls_005"><span class="cls_005">tipos de dados usados pelas interfaces de sockets, uma vez que alguns deles são verdadeiros</span></div>
<div style="position:absolute;left:60.99px;top:518.78px" class="cls_005"><span class="cls_005">mistérios a se descobrir.</span></div>
<div style="position:absolute;left:60.99px;top:543.96px" class="cls_005"><span class="cls_005">Primeiro, o mais fácil: o descritor de socket. Um descritor de socket é do seguinte tipo:</span></div>
<div style="position:absolute;left:94.85px;top:577.07px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:60.99px;top:611.11px" class="cls_005"><span class="cls_005">Apenas um int regular.</span></div>
<div style="position:absolute;left:60.99px;top:637.22px" class="cls_005"><span class="cls_005">As coisas  cam estranhas a partir daqui, então apenas leia comigo e acredite.</span></div>
<div style="position:absolute;left:60.99px;top:663.34px" class="cls_005"><span class="cls_005">Minha Primeira Struct™—struct addrinfo. Essa estrutura é uma invenção mais recente e é</span></div>
<div style="position:absolute;left:60.99px;top:678.26px" class="cls_005"><span class="cls_005">usada para preparar as estruturas de endereço do socket para uso posterior. Também é usada</span></div>
<div style="position:absolute;left:60.99px;top:692.25px" class="cls_005"><span class="cls_005">em pesquisas de nome de host e pesquisas de nome de serviço. Isso fará mais sentido mais</span></div>
<div style="position:absolute;left:60.99px;top:706.24px" class="cls_005"><span class="cls_005">tarde quando chegarmos ao seu uso real, mas saberemos por enquanto que é uma das</span></div>
<div style="position:absolute;left:60.99px;top:720.22px" class="cls_005"><span class="cls_005">primeiras coisas que você ligará ao fazer uma conexão.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">18 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:15318px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background019.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:61.93px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo {</span></div>
<div style="position:absolute;left:121.71px;top:76.85px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:235.85px;top:76.85px" class="cls_005"><span class="cls_005">ai_flags;</span></div>
<div style="position:absolute;left:329.87px;top:76.85px" class="cls_013"><span class="cls_013">// AI_PASSIVE, AI_CANONNAME,</span></div>
<div style="position:absolute;left:123.94px;top:90.84px" class="cls_013"><span class="cls_013">etc.</span></div>
<div style="position:absolute;left:121.71px;top:105.76px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:235.85px;top:105.76px" class="cls_005"><span class="cls_005">ai_family;</span></div>
<div style="position:absolute;left:329.87px;top:105.76px" class="cls_013"><span class="cls_013">// AF_INET, AF_INET6,</span></div>
<div style="position:absolute;left:123.94px;top:119.75px" class="cls_013"><span class="cls_013">AF_UNSPEC</span></div>
<div style="position:absolute;left:121.71px;top:135.60px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:235.85px;top:135.60px" class="cls_005"><span class="cls_005">ai_socktype;</span></div>
<div style="position:absolute;left:329.86px;top:135.60px" class="cls_013"><span class="cls_013">// SOCK_STREAM, SOCK_DGRAM</span></div>
<div style="position:absolute;left:121.71px;top:151.46px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:235.85px;top:151.46px" class="cls_005"><span class="cls_005">ai_protocol;</span></div>
<div style="position:absolute;left:329.86px;top:151.46px" class="cls_013"><span class="cls_013">// use 0 para "qualquer"</span></div>
<div style="position:absolute;left:121.71px;top:166.38px" class="cls_008"><span class="cls_008">size_t</span></div>
<div style="position:absolute;left:235.85px;top:166.38px" class="cls_005"><span class="cls_005">ai_addrlen;</span></div>
<div style="position:absolute;left:329.86px;top:166.38px" class="cls_013"><span class="cls_013">// tamanho de ai_addr em</span></div>
<div style="position:absolute;left:123.94px;top:180.37px" class="cls_013"><span class="cls_013">bytes</span></div>
<div style="position:absolute;left:121.71px;top:196.22px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr *ai_addr;</span></div>
<div style="position:absolute;left:331.26px;top:196.22px" class="cls_013"><span class="cls_013">// struct sockaddr_in ou _in6</span></div>
<div style="position:absolute;left:121.71px;top:211.14px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:229.13px;top:211.14px" class="cls_005"><span class="cls_005">*ai_canonname; </span><span class="cls_013">// nome de host canônico e</span></div>
<div style="position:absolute;left:123.94px;top:225.13px" class="cls_013"><span class="cls_013">completo</span></div>
<div style="position:absolute;left:121.71px;top:256.84px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo *ai_next;</span></div>
<div style="position:absolute;left:331.27px;top:256.84px" class="cls_013"><span class="cls_013">// lista ligada, próximo nó</span></div>
<div style="position:absolute;left:94.85px;top:272.69px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:306.73px" class="cls_005"><span class="cls_005">Você carregará essa struct rapidamente, e depois chamará getaddrinfo(). Ela retornará um</span></div>
<div style="position:absolute;left:60.99px;top:321.66px" class="cls_005"><span class="cls_005">ponteiro para uma nova lista ligada dessa estrutura preenchida com todos os itens</span></div>
<div style="position:absolute;left:60.99px;top:335.64px" class="cls_005"><span class="cls_005">necessários.</span></div>
<div style="position:absolute;left:60.99px;top:361.76px" class="cls_005"><span class="cls_005">Você pode forçá-la a usar IPv4 ou IPv6 no campo ai_family, ou deixá-lo como AF_UNSPEC</span></div>
<div style="position:absolute;left:60.99px;top:376.68px" class="cls_005"><span class="cls_005">para usar qualquer um. Isto é legal porque o seu código pode ser funcional com qualquer</span></div>
<div style="position:absolute;left:60.99px;top:390.67px" class="cls_005"><span class="cls_005">versão IP.</span></div>
<div style="position:absolute;left:60.99px;top:416.78px" class="cls_005"><span class="cls_005">Note que esta é uma lista ligada: ai_next aponta para o próximo elemento—pode haver vários</span></div>
<div style="position:absolute;left:60.99px;top:431.70px" class="cls_005"><span class="cls_005">resultados para você escolher. Eu usaria o primeiro resultado que funcionasse, mas você</span></div>
<div style="position:absolute;left:60.99px;top:445.69px" class="cls_005"><span class="cls_005">poderia ter necessidades de negócios diferentes; Eu não sei tudo, man!</span></div>
<div style="position:absolute;left:60.99px;top:471.80px" class="cls_005"><span class="cls_005">Você verá que o campo ai_addr na struct addrinfo é um ponteiro para uma struct</span></div>
<div style="position:absolute;left:60.99px;top:487.66px" class="cls_005"><span class="cls_005">sockaddr. É ai que começamos a entrar nos detalhes básicos do que está dentro de uma</span></div>
<div style="position:absolute;left:60.99px;top:502.58px" class="cls_005"><span class="cls_005">struct de endereço IP.</span></div>
<div style="position:absolute;left:60.99px;top:527.76px" class="cls_005"><span class="cls_005">Você não precisa escrever a essas estruturas usualmente; muitas vezes, uma chamada a</span></div>
<div style="position:absolute;left:60.99px;top:542.68px" class="cls_005"><span class="cls_005">getaddrinfo() para preencher a sua struct addrinfo é tudo o que você precisa. Você</span></div>
<div style="position:absolute;left:60.99px;top:558.54px" class="cls_005"><span class="cls_005">terá, no entanto, que espiar dentro destas structs para obter seus valores de retorno, então</span></div>
<div style="position:absolute;left:60.99px;top:573.46px" class="cls_005"><span class="cls_005">vou aprensentá-los aqui.</span></div>
<div style="position:absolute;left:60.99px;top:599.57px" class="cls_005"><span class="cls_005">(Além disso, todo o código escrito antes de struct addrinfo ser inventada eram</span></div>
<div style="position:absolute;left:60.99px;top:614.49px" class="cls_005"><span class="cls_005">embalados à mão, então você verá um monte de códigos IPv4 em estado bruto que fazem</span></div>
<div style="position:absolute;left:60.99px;top:628.48px" class="cls_005"><span class="cls_005">exatamente isso. Você sabe, em versões antigas deste guia e assim por diante.)</span></div>
<div style="position:absolute;left:60.99px;top:654.59px" class="cls_005"><span class="cls_005">Algumas structs são IPv4, algumas são IPv6, e algumas são ambas. Farei anotações de</span></div>
<div style="position:absolute;left:60.99px;top:669.51px" class="cls_005"><span class="cls_005">quais são o que.</span></div>
<div style="position:absolute;left:60.99px;top:695.63px" class="cls_005"><span class="cls_005">De qualquer forma, a struct sockaddr detém informações de endereço de socket para</span></div>
<div style="position:absolute;left:60.99px;top:710.55px" class="cls_005"><span class="cls_005">muitos tipos de sockets.</span></div>
<div style="position:absolute;left:94.85px;top:743.66px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr {</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">19 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:16169px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background020.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:121.71px;top:54.00px" class="cls_008"><span class="cls_008">unsigned  short</span></div>
<div style="position:absolute;left:242.57px;top:54.00px" class="cls_005"><span class="cls_005">sa_family;</span></div>
<div style="position:absolute;left:336.59px;top:54.00px" class="cls_013"><span class="cls_013">// família de endereços,</span></div>
<div style="position:absolute;left:123.94px;top:67.99px" class="cls_013"><span class="cls_013">AF_xxx</span></div>
<div style="position:absolute;left:121.71px;top:82.91px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:242.56px;top:82.91px" class="cls_005"><span class="cls_005">sa_data[</span><span class="cls_009">14</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:336.58px;top:82.91px" class="cls_013"><span class="cls_013">// 14 bytes de endereço do</span></div>
<div style="position:absolute;left:123.94px;top:96.90px" class="cls_013"><span class="cls_013">protocolo</span></div>
<div style="position:absolute;left:94.85px;top:112.75px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:146.79px" class="cls_005"><span class="cls_005">sa_family pode ser uma variedade de coisas, mas será AF_INET (IPv4) ou AF_INET6 (IPv6)</span></div>
<div style="position:absolute;left:60.99px;top:162.65px" class="cls_005"><span class="cls_005">para tudo o que  zermos neste documento. sa_data contém um endereço de destino e o</span></div>
<div style="position:absolute;left:60.99px;top:177.57px" class="cls_005"><span class="cls_005">número da porta para o socket. Isto é bastante complicado, pois você não quer embalar</span></div>
<div style="position:absolute;left:60.99px;top:192.49px" class="cls_005"><span class="cls_005">tediosamente o endereço no sa_data manualmente.</span></div>
<div style="position:absolute;left:60.99px;top:219.54px" class="cls_005"><span class="cls_005">Para lidar com struct sockaddr, os programadores criaram uma estrutura paralela: struct</span></div>
<div style="position:absolute;left:60.99px;top:235.39px" class="cls_005"><span class="cls_005">sockaddr_in ("in" para "Internet") para uso com IPv4.</span></div>
<div style="position:absolute;left:60.99px;top:262.44px" class="cls_005"><span class="cls_005">E esta é a parte importante: um ponteiro para uma struct sockaddr_in pode ser</span></div>
<div style="position:absolute;left:60.99px;top:278.29px" class="cls_005"><span class="cls_005">convertido para um ponteiro para uma struct sockaddr e vice-versa. Assim, mesmo que</span></div>
<div style="position:absolute;left:60.99px;top:294.14px" class="cls_005"><span class="cls_005">connect() procure uma struct sockaddr*, você ainda pode utilizar uma struct</span></div>
<div style="position:absolute;left:60.99px;top:310.00px" class="cls_005"><span class="cls_005">sockaddr_in e converte-lá no último minuto!</span></div>
<div style="position:absolute;left:94.85px;top:344.04px" class="cls_013"><span class="cls_013">// (IPv4 somente--veja struct sockaddr_in6 para IPv6)</span></div>
<div style="position:absolute;left:94.85px;top:375.75px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in {</span></div>
<div style="position:absolute;left:121.71px;top:390.67px" class="cls_008"><span class="cls_008">short  int</span></div>
<div style="position:absolute;left:249.27px;top:390.67px" class="cls_005"><span class="cls_005">sin_family;</span></div>
<div style="position:absolute;left:336.59px;top:390.67px" class="cls_013"><span class="cls_013">// Família de endereços,</span></div>
<div style="position:absolute;left:123.94px;top:404.66px" class="cls_013"><span class="cls_013">AF_INET</span></div>
<div style="position:absolute;left:121.71px;top:420.51px" class="cls_008"><span class="cls_008">unsigned  short  int</span><span class="cls_005"> sin_port;</span></div>
<div style="position:absolute;left:336.58px;top:420.51px" class="cls_013"><span class="cls_013">// Número de Porta</span></div>
<div style="position:absolute;left:121.71px;top:436.37px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr</span></div>
<div style="position:absolute;left:250.67px;top:436.37px" class="cls_005"><span class="cls_005">sin_addr;</span></div>
<div style="position:absolute;left:337.98px;top:436.37px" class="cls_013"><span class="cls_013">// Endereço Internet</span></div>
<div style="position:absolute;left:121.71px;top:451.29px" class="cls_008"><span class="cls_008">unsigned  char</span></div>
<div style="position:absolute;left:249.27px;top:451.29px" class="cls_005"><span class="cls_005">sin_zero[</span><span class="cls_009">8</span><span class="cls_005">]; </span><span class="cls_013">// Mesmo tamanho que struct</span></div>
<div style="position:absolute;left:123.94px;top:465.28px" class="cls_013"><span class="cls_013">sockaddr</span></div>
<div style="position:absolute;left:94.85px;top:481.13px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:515.17px" class="cls_005"><span class="cls_005">Esta estrutura facilita a referência de elementos do endereço do socket. Note que sin_zero</span></div>
<div style="position:absolute;left:60.99px;top:531.02px" class="cls_005"><span class="cls_005">(que é incluído para preencher a estrutura com o comprimento de uma struct sockaddr)</span></div>
<div style="position:absolute;left:60.99px;top:546.88px" class="cls_005"><span class="cls_005">deve ser todo de nido para zero com a função memset(). Além disso, observe que</span></div>
<div style="position:absolute;left:60.99px;top:562.73px" class="cls_005"><span class="cls_005">sin_family corresponde a sa_family em uma struct sockaddr e deve ser con gurada</span></div>
<div style="position:absolute;left:60.99px;top:578.59px" class="cls_005"><span class="cls_005">para "AF_INET". Finalmente, o sin_port deve estar em Network Byte Order (usando</span></div>
<div style="position:absolute;left:60.99px;top:594.44px" class="cls_005"><span class="cls_005">htons()!)</span></div>
<div style="position:absolute;left:60.99px;top:621.49px" class="cls_005"><span class="cls_005">Vamos cavar mais fundo! Você vê que o campo sin_addr é uma struct in_addr. Que</span></div>
<div style="position:absolute;left:60.99px;top:636.41px" class="cls_005"><span class="cls_005">coisa é essa? Bem, não para ser excessivamente dramático, mas é uma das mais</span></div>
<div style="position:absolute;left:60.99px;top:650.40px" class="cls_005"><span class="cls_005">assustadoras unions de todos os tempos:</span></div>
<div style="position:absolute;left:94.85px;top:683.50px" class="cls_013"><span class="cls_013">// (IPv4 somente--veja struct in6_addr para IPv6)</span></div>
<div style="position:absolute;left:94.85px;top:715.21px" class="cls_013"><span class="cls_013">// Endereço Internet (uma estrutura por razões históricas)</span></div>
<div style="position:absolute;left:94.85px;top:731.07px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr {</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">20 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:17020px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background021.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:121.71px;top:54.93px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> s_addr; </span><span class="cls_013">// é um int de 32 bits (4 bytes)</span></div>
<div style="position:absolute;left:94.85px;top:70.79px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:103.89px" class="cls_005"><span class="cls_005">Uau! Bem, isso era usado para ser uma união, mas agora aqueles dias parecem ter</span></div>
<div style="position:absolute;left:60.99px;top:118.82px" class="cls_005"><span class="cls_005">desaparecido. Boa viagem. Então, se você declarou ina para ser do tipo struct</span></div>
<div style="position:absolute;left:60.99px;top:134.67px" class="cls_005"><span class="cls_005">sockaddr_in, então ina.sin_addr.s_addr faz referência ao endereço IP de 4 bytes</span></div>
<div style="position:absolute;left:60.99px;top:149.59px" class="cls_005"><span class="cls_005">(Network Byte Order). Observe que, mesmo que o seu sistema ainda use a terrível union em</span></div>
<div style="position:absolute;left:60.99px;top:164.51px" class="cls_005"><span class="cls_005">struct em_addr, você ainda pode referenciar o endereço IP de 4 bytes exatamente da</span></div>
<div style="position:absolute;left:60.99px;top:180.37px" class="cls_005"><span class="cls_005">mesma maneira que eu  z acima (isto devido aos #defines.)</span></div>
<div style="position:absolute;left:60.99px;top:207.41px" class="cls_005"><span class="cls_005">E sobre IPv6? Existem structs similares para ele, assim:</span></div>
<div style="position:absolute;left:94.85px;top:240.52px" class="cls_013"><span class="cls_013">// (IPv6 somente--veja struct sockaddr_in e struct in_addr para</span></div>
<div style="position:absolute;left:123.94px;top:254.51px" class="cls_013"><span class="cls_013">IPv4)</span></div>
<div style="position:absolute;left:94.85px;top:286.22px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 {</span></div>
<div style="position:absolute;left:121.70px;top:301.14px" class="cls_005"><span class="cls_005">u_int16_t</span></div>
<div style="position:absolute;left:229.12px;top:301.14px" class="cls_005"><span class="cls_005">sin6_family;</span></div>
<div style="position:absolute;left:329.87px;top:301.14px" class="cls_013"><span class="cls_013">// família de endereços,</span></div>
<div style="position:absolute;left:123.94px;top:315.13px" class="cls_013"><span class="cls_013">AF_INET6</span></div>
<div style="position:absolute;left:121.70px;top:330.05px" class="cls_005"><span class="cls_005">u_int16_t</span></div>
<div style="position:absolute;left:229.12px;top:330.05px" class="cls_005"><span class="cls_005">sin6_port;</span></div>
<div style="position:absolute;left:329.86px;top:330.05px" class="cls_013"><span class="cls_013">// número da porta, Network</span></div>
<div style="position:absolute;left:123.94px;top:344.04px" class="cls_013"><span class="cls_013">Byte Order</span></div>
<div style="position:absolute;left:121.70px;top:359.89px" class="cls_005"><span class="cls_005">u_int32_t</span></div>
<div style="position:absolute;left:229.12px;top:359.89px" class="cls_005"><span class="cls_005">sin6_flowinfo; </span><span class="cls_013">// informação de fluxo IPv6</span></div>
<div style="position:absolute;left:121.71px;top:375.75px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr sin6_addr;</span></div>
<div style="position:absolute;left:331.26px;top:375.75px" class="cls_013"><span class="cls_013">// endereço IPv6</span></div>
<div style="position:absolute;left:121.70px;top:391.60px" class="cls_005"><span class="cls_005">u_int32_t</span></div>
<div style="position:absolute;left:229.12px;top:391.60px" class="cls_005"><span class="cls_005">sin6_scope_id; </span><span class="cls_013">// ID do escopo</span></div>
<div style="position:absolute;left:94.85px;top:407.45px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:439.16px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr {</span></div>
<div style="position:absolute;left:121.71px;top:455.02px" class="cls_008"><span class="cls_008">unsigned  char</span><span class="cls_005">   s6_addr[</span><span class="cls_009">16</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:329.86px;top:455.02px" class="cls_013"><span class="cls_013">// endereço IPv6</span></div>
<div style="position:absolute;left:94.85px;top:470.87px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:503.98px" class="cls_005"><span class="cls_005">Observe que o IPv6 tem um endereço IPv6 e um número de porta, assim como IPv4 tem um</span></div>
<div style="position:absolute;left:60.99px;top:517.97px" class="cls_005"><span class="cls_005">endereço IPv4 e um número de porta.</span></div>
<div style="position:absolute;left:60.99px;top:543.15px" class="cls_005"><span class="cls_005">Além disso, note que eu não estou começando a falar sobre as informações de   uxo IPv6 ou</span></div>
<div style="position:absolute;left:60.99px;top:558.07px" class="cls_005"><span class="cls_005">campos de identi cação de escopo neste momento... este é apenas um guia de iniciação.:-)</span></div>
<div style="position:absolute;left:60.99px;top:585.11px" class="cls_005"><span class="cls_005">Por último, mas não menos importante, aqui está outra estrutura simples, struct</span></div>
<div style="position:absolute;left:60.99px;top:600.97px" class="cls_005"><span class="cls_005">sockaddr_storage que é projetada para ser grande o su ciente para manter ambas as</span></div>
<div style="position:absolute;left:60.99px;top:615.89px" class="cls_005"><span class="cls_005">estruturas IPv4 e IPv6. Veja, para algumas chamadas, às vezes você não sabe com</span></div>
<div style="position:absolute;left:60.99px;top:630.81px" class="cls_005"><span class="cls_005">antecedência se vai preencher sua struct sockaddr com um endereço IPv4 ou IPv6. Assim</span></div>
<div style="position:absolute;left:60.99px;top:646.67px" class="cls_005"><span class="cls_005">você passa por esta estrutura paralela, muito semelhante à struct sockaddr, exceto maior,</span></div>
<div style="position:absolute;left:60.99px;top:661.59px" class="cls_005"><span class="cls_005">e depois a converte para o tipo que você precisa:</span></div>
<div style="position:absolute;left:94.85px;top:694.69px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage {</span></div>
<div style="position:absolute;left:121.70px;top:710.55px" class="cls_005"><span class="cls_005">sa_family_t  ss_family;</span></div>
<div style="position:absolute;left:309.74px;top:710.55px" class="cls_013"><span class="cls_013">// família de endereços</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">21 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:17871px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background022.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:121.71px;top:54.00px" class="cls_013"><span class="cls_013">// tudo isso é preenchimento, implementação específica,</span></div>
<div style="position:absolute;left:123.94px;top:67.99px" class="cls_013"><span class="cls_013">ignore:</span></div>
<div style="position:absolute;left:121.71px;top:83.84px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:188.84px;top:83.84px" class="cls_005"><span class="cls_005">__ss_pad1[_SS_PAD1SIZE];</span></div>
<div style="position:absolute;left:121.71px;top:99.70px" class="cls_008"><span class="cls_008">int64_t</span></div>
<div style="position:absolute;left:188.85px;top:99.70px" class="cls_005"><span class="cls_005">__ss_align;</span></div>
<div style="position:absolute;left:121.71px;top:115.55px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:188.84px;top:115.55px" class="cls_005"><span class="cls_005">__ss_pad2[_SS_PAD2SIZE];</span></div>
<div style="position:absolute;left:94.85px;top:131.41px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:165.45px" class="cls_005"><span class="cls_005">O que é importante é que você pode ver a família de endereços no campo ss_family</span></div>
<div style="position:absolute;left:60.99px;top:181.30px" class="cls_005"><span class="cls_005">—veri que isso para ver se é AF_INET ou AF_INET6 (para IPv4 ou IPv6). Então você pode</span></div>
<div style="position:absolute;left:60.99px;top:197.15px" class="cls_005"><span class="cls_005">converter para uma struct sockaddr_in ou struct sockaddr_in6 se você quiser.</span></div>
<div style="position:absolute;left:60.99px;top:225.07px" class="cls_007"><span class="cls_007">Endereços IP, Parte Dois</span></div>
<div style="position:absolute;left:60.99px;top:260.45px" class="cls_005"><span class="cls_005">Felizmente para você, há diversas funções que lhe permitem manipular endereços IP. Não há</span></div>
<div style="position:absolute;left:60.99px;top:275.38px" class="cls_005"><span class="cls_005">necessidade de os descobrir à mão e enchê-los por um longo tempo usando o operador &lt;&lt;.</span></div>
<div style="position:absolute;left:60.99px;top:302.42px" class="cls_005"><span class="cls_005">Primeiro, digamos que você tenha uma struct sockaddr_in ina, e você tem um endereço</span></div>
<div style="position:absolute;left:60.99px;top:318.27px" class="cls_005"><span class="cls_005">IP "10.12.110.57" ou "2001:db8:63b3:1::3490" que você deseja armazenar nela. A</span></div>
<div style="position:absolute;left:60.99px;top:334.13px" class="cls_005"><span class="cls_005">função que você desejará usar, inet_pton(), converte um endereço IP em notação de</span></div>
<div style="position:absolute;left:60.99px;top:349.98px" class="cls_005"><span class="cls_005">números e pontos em uma struct in_addr ou uma struct in6_addr dependendo se</span></div>
<div style="position:absolute;left:60.99px;top:365.84px" class="cls_005"><span class="cls_005">você especi car AF_INET ou AF_INET6. ("pton" signi ca "presentation to network"—você</span></div>
<div style="position:absolute;left:60.99px;top:380.76px" class="cls_005"><span class="cls_005">pode chamar isso de "printable to network" se for mais fácil para lembrar.) A conversão pode</span></div>
<div style="position:absolute;left:60.99px;top:394.75px" class="cls_005"><span class="cls_005">ser feita da seguinte forma:</span></div>
<div style="position:absolute;left:94.85px;top:427.86px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in sa; </span><span class="cls_013">// IPv4</span></div>
<div style="position:absolute;left:94.85px;top:443.71px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 sa6; </span><span class="cls_013">// IPv6</span></div>
<div style="position:absolute;left:94.85px;top:475.42px" class="cls_005"><span class="cls_005">inet_pton(AF_INET, </span><span class="cls_010">"10.12.110.57"</span><span class="cls_005">, &(sa.sin_addr)); </span><span class="cls_013">// IPv4</span></div>
<div style="position:absolute;left:94.85px;top:490.34px" class="cls_005"><span class="cls_005">inet_pton(AF_INET6, </span><span class="cls_010">"2001:db8:63b3:1::3490"</span><span class="cls_005">, &(sa6.sin6_addr));</span></div>
<div style="position:absolute;left:123.94px;top:504.33px" class="cls_013"><span class="cls_013">// IPv6</span></div>
<div style="position:absolute;left:60.99px;top:537.44px" class="cls_005"><span class="cls_005">(Nota rápida: as velhas maneiras de fazer as coisas utilizado uma função chamada</span></div>
<div style="position:absolute;left:60.99px;top:552.36px" class="cls_005"><span class="cls_005">inet_addr() ou outra chamada inet_aton() são agora obsoletas e não funcionam com o</span></div>
<div style="position:absolute;left:60.99px;top:567.28px" class="cls_005"><span class="cls_005">IPv6.)</span></div>
<div style="position:absolute;left:60.99px;top:592.46px" class="cls_005"><span class="cls_005">Agora, o trecho de código acima não é muito robusto porque não há veri cação de erros. Veja,</span></div>
<div style="position:absolute;left:60.99px;top:607.38px" class="cls_005"><span class="cls_005">inet_pton() retorna -1 em caso de erro, ou 0 se o endereço é confuso. Portanto, para</span></div>
<div style="position:absolute;left:60.99px;top:622.30px" class="cls_005"><span class="cls_005">garantir veri que se o resultado é superior a 0 antes de usar!</span></div>
<div style="position:absolute;left:60.99px;top:647.48px" class="cls_005"><span class="cls_005">Tudo bem, agora você pode converter strings de endereços IP em suas representações</span></div>
<div style="position:absolute;left:60.99px;top:662.40px" class="cls_005"><span class="cls_005">binárias. E o contrário? E se você tem uma struct in_addr e você quiser imprimi-lá em</span></div>
<div style="position:absolute;left:60.99px;top:678.26px" class="cls_005"><span class="cls_005">notação de números-e-pontos? (Ou uma struct in6_addr que você quer na notação hex-</span></div>
<div style="position:absolute;left:60.99px;top:694.11px" class="cls_005"><span class="cls_005">e-pontos). Neste caso, você vai querer usar a função inet_ntop() ("ntop" signi ca "network</span></div>
<div style="position:absolute;left:60.99px;top:709.03px" class="cls_005"><span class="cls_005">to presentation"—você pode chamá-la de "network to printable" se for mais fácil de lembrar),</span></div>
<div style="position:absolute;left:60.99px;top:723.02px" class="cls_005"><span class="cls_005">assim:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">22 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:18722px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background023.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:61.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:61.93px" class="cls_013"><span class="cls_013">// IPv4:</span></div>
<div style="position:absolute;left:83.19px;top:77.78px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:92.70px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:92.70px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> ip4[INET_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:291.91px;top:92.70px" class="cls_013"><span class="cls_013">// espaço para manter a</span></div>
<div style="position:absolute;left:109.49px;top:106.69px" class="cls_013"><span class="cls_013">string IPv4</span></div>
<div style="position:absolute;left:83.19px;top:121.61px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:121.61px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in sa;</span></div>
<div style="position:absolute;left:293.30px;top:121.61px" class="cls_013"><span class="cls_013">// fingir que isso é</span></div>
<div style="position:absolute;left:109.49px;top:135.60px" class="cls_013"><span class="cls_013">carregado com algo</span></div>
<div style="position:absolute;left:83.19px;top:151.46px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:166.38px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:166.38px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET, &(sa.sin_addr), ip4,</span></div>
<div style="position:absolute;left:109.49px;top:180.37px" class="cls_005"><span class="cls_005">INET_ADDRSTRLEN);</span></div>
<div style="position:absolute;left:83.19px;top:196.22px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:212.08px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:212.08px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"O endereço IPv4 é: %s\n"</span><span class="cls_005">, ip4);</span></div>
<div style="position:absolute;left:83.19px;top:227.93px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:243.78px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:259.64px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:259.64px" class="cls_013"><span class="cls_013">// IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:275.49px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:290.41px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:290.41px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> ip6[INET6_ADDRSTRLEN]; </span><span class="cls_013">// espaço para manter a</span></div>
<div style="position:absolute;left:109.49px;top:304.40px" class="cls_013"><span class="cls_013">string IPv6</span></div>
<div style="position:absolute;left:76.48px;top:319.32px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:319.32px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 sa6;</span></div>
<div style="position:absolute;left:293.30px;top:319.32px" class="cls_013"><span class="cls_013">// fingir que isso é</span></div>
<div style="position:absolute;left:109.49px;top:333.31px" class="cls_013"><span class="cls_013">carregado com algo</span></div>
<div style="position:absolute;left:76.48px;top:349.17px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:364.09px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:364.09px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET6, &(sa6.sin6_addr), ip6,</span></div>
<div style="position:absolute;left:109.49px;top:378.08px" class="cls_005"><span class="cls_005">INET6_ADDRSTRLEN);</span></div>
<div style="position:absolute;left:76.48px;top:393.93px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:409.79px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:409.79px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"O endereço IPv6 é: %s\n"</span><span class="cls_005">, ip6);</span></div>
<div style="position:absolute;left:60.99px;top:442.89px" class="cls_005"><span class="cls_005">Quando você executa, você passa o tipo de endereço (IPv4 ou IPv6), o endereço, um ponteiro</span></div>
<div style="position:absolute;left:60.99px;top:456.88px" class="cls_005"><span class="cls_005">para uma string que manterá o resultado e o máximo comprimento dessa string. (Duas macros</span></div>
<div style="position:absolute;left:60.99px;top:470.87px" class="cls_005"><span class="cls_005">seguram convenientemente o tamanho da grande string de endereço IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:60.99px;top:485.79px" class="cls_005"><span class="cls_005">INET_ADDRSTRLEN e INET6_ADDRSTRLEN.)</span></div>
<div style="position:absolute;left:60.99px;top:511.91px" class="cls_005"><span class="cls_005">(Outra nota rápida a mencionar, mais uma vez a velha maneira de fazer as coisas: a função</span></div>
<div style="position:absolute;left:60.99px;top:526.83px" class="cls_005"><span class="cls_005">histórica para fazer esta conversão foi chamada inet_ntoa(). Também é obsoleta e não</span></div>
<div style="position:absolute;left:60.99px;top:541.75px" class="cls_005"><span class="cls_005">funcionará com IPv6.)</span></div>
<div style="position:absolute;left:60.99px;top:566.93px" class="cls_005"><span class="cls_005">Por  m, essas funções só funcionam com endereços de IP numéricos—elas não farão qualquer</span></div>
<div style="position:absolute;left:60.99px;top:581.85px" class="cls_005"><span class="cls_005">pesquisa de servidor de nomes DNS para um nome de host, como "</span><A HREF="http://www.example.com"./">www.example.com".</A> Você</div>
<div style="position:absolute;left:60.99px;top:597.70px" class="cls_005"><span class="cls_005">usará getaddrinfo() para fazer isso, como você verá mais tarde.</span></div>
<div style="position:absolute;left:60.99px;top:625.68px" class="cls_016"><span class="cls_016">Redes Privadas (ou desconectadas)</span></div>
<div style="position:absolute;left:60.99px;top:655.60px" class="cls_005"><span class="cls_005">Muitos lugares têm um  rewall que oculta a rede local do restante do mundo para sua própria</span></div>
<div style="position:absolute;left:60.99px;top:669.58px" class="cls_005"><span class="cls_005">proteção. E muitas vezes, o  rewall traduz endereços IP "internos" para "externos" (que todos</span></div>
<div style="position:absolute;left:60.99px;top:683.57px" class="cls_005"><span class="cls_005">os outros no mundo conhecem) usando um processo chamado Network Address Translation,</span></div>
<div style="position:absolute;left:60.99px;top:697.56px" class="cls_005"><span class="cls_005">ou NAT.</span></div>
<div style="position:absolute;left:60.99px;top:722.74px" class="cls_005"><span class="cls_005">Você ainda está  cando nervoso? "Onde ele está indo com todas estas coisas estranhas?"</span></div>
<div style="position:absolute;left:60.99px;top:747.92px" class="cls_005"><span class="cls_005">Bem, relaxe e compre uma bebida não-alcoólica (ou alcoólica) porque, como iniciante, você</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">23 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:19573px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background024.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">não precisa nem se preocupar com o NAT, ele é feito para você de forma transparente. Mas eu</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">queria falar sobre a rede atrás do  rewall no caso de você começar a  car confuso com</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">números de rede que esteja vendo.</span></div>
<div style="position:absolute;left:60.99px;top:107.16px" class="cls_005"><span class="cls_005">Por exemplo, eu tenho um  rewall em casa. Eu tenho dois endereços IPv4 estáticos alocados</span></div>
<div style="position:absolute;left:60.99px;top:121.15px" class="cls_005"><span class="cls_005">para meu uso pela empresa do DSL, e ainda tenho sete computadores na rede. Como isso é</span></div>
<div style="position:absolute;left:60.99px;top:135.14px" class="cls_005"><span class="cls_005">possível? Dois computadores não podem compartilhar um mesmo endereço IP, ou então os</span></div>
<div style="position:absolute;left:60.99px;top:149.12px" class="cls_005"><span class="cls_005">dados não saberiam para qual deles se destinam!</span></div>
<div style="position:absolute;left:60.99px;top:174.31px" class="cls_005"><span class="cls_005">A resposta é: eles não compartilham os mesmos endereços IP. Eles estão em uma rede</span></div>
<div style="position:absolute;left:60.99px;top:188.29px" class="cls_005"><span class="cls_005">privada, com 24 milhões de endereços IP alocados para eles. Eles são todos só para mim.</span></div>
<div style="position:absolute;left:60.99px;top:202.28px" class="cls_005"><span class="cls_005">Bem, tudo para mim, tanto quanto para qualquer outra pessoa que esteja preocupada. Aqui</span></div>
<div style="position:absolute;left:60.99px;top:216.27px" class="cls_005"><span class="cls_005">está o que está acontecendo:</span></div>
<div style="position:absolute;left:60.99px;top:241.45px" class="cls_005"><span class="cls_005">Se eu  zer login em um computador remoto, ele me informará que estou logado em 192.0.2.33,</span></div>
<div style="position:absolute;left:60.99px;top:255.44px" class="cls_005"><span class="cls_005">que é o endereço IP público que meu ISP forneceu para mim. Mas se eu perguntar ao meu</span></div>
<div style="position:absolute;left:60.99px;top:269.43px" class="cls_005"><span class="cls_005">computador local qual é seu endereço IP, ele diz 10.0.0.5. Quem está traduzindo o endereço IP</span></div>
<div style="position:absolute;left:60.99px;top:283.42px" class="cls_005"><span class="cls_005">de um para o outro? Está certo, o  rewall! Está fazendo NAT!</span></div>
<div style="position:absolute;left:60.99px;top:309.53px" class="cls_005"><span class="cls_005">10.x.x.x é um dos poucos endereços de rede reservados que só deve ser usado em redes</span></div>
<div style="position:absolute;left:60.99px;top:324.45px" class="cls_005"><span class="cls_005">totalmente desconectadas, ou em redes que estão atrás de  rewalls. Os detalhes de quais</span></div>
<div style="position:absolute;left:60.99px;top:338.44px" class="cls_005"><span class="cls_005">números de redes privadas estão disponíveis para uso estão descritos na </span><span class="cls_023">RFC 1918</span><span class="cls_024"><sup>18</sup></span><span class="cls_005">, mas</span></div>
<div style="position:absolute;left:60.99px;top:355.30px" class="cls_005"><span class="cls_005">alguns comuns que você verá são 10.x.x.x e 192.168.x.x, onde x é 0-255, geralmente. O</span></div>
<div style="position:absolute;left:60.99px;top:371.15px" class="cls_005"><span class="cls_005">menos comum é 172.y.x.x, onde y varia entre 16 e 31.</span></div>
<div style="position:absolute;left:60.99px;top:397.27px" class="cls_005"><span class="cls_005">Redes atrás de um  rewall NAT não necessitam estar em uma faixa de IP´s reservados, mas</span></div>
<div style="position:absolute;left:60.99px;top:411.25px" class="cls_005"><span class="cls_005">elas geralmente estão.</span></div>
<div style="position:absolute;left:60.99px;top:437.37px" class="cls_005"><span class="cls_005">(Curiosidade! Meu endereço IP externo não é realmente 192.0.2.33. A rede 192.0.2.x é</span></div>
<div style="position:absolute;left:60.99px;top:452.29px" class="cls_005"><span class="cls_005">reservada para simular um IP "real" em documentações, assim como neste guia! Uau!)</span></div>
<div style="position:absolute;left:60.99px;top:478.40px" class="cls_005"><span class="cls_005">O IPv6 também possui redes privadas. Elas começam com fdXX: (ou talvez no futuro fcXX:),</span></div>
<div style="position:absolute;left:60.99px;top:493.32px" class="cls_005"><span class="cls_005">conforme </span><span class="cls_023">RFC 4193</span><span class="cls_024"><sup>19</sup></span><span class="cls_005">. NAT e IPv6 não se misturam geralmente, no entanto (a menos que</span></div>
<div style="position:absolute;left:60.99px;top:509.25px" class="cls_005"><span class="cls_005">você esteja fazendo gateway IPv6 para IPv4, o que está além do escopo deste documento)—</span></div>
<div style="position:absolute;left:60.99px;top:523.24px" class="cls_005"><span class="cls_005">em teoria você terá tantos endereços à sua disposição que você não precisará usar NAT por</span></div>
<div style="position:absolute;left:60.99px;top:537.23px" class="cls_005"><span class="cls_005">muito mais tempo. Mas se você quiser alocar endereços para você em uma rede que não será</span></div>
<div style="position:absolute;left:60.99px;top:551.21px" class="cls_005"><span class="cls_005">encaminhada para fora, é assim que se faz.</span></div>
<div style="position:absolute;left:60.99px;top:579.26px" class="cls_002"><span class="cls_002">Saltando de IPv4 para IPv6</span></div>
<div style="position:absolute;left:60.99px;top:622.23px" class="cls_005"><span class="cls_005">Mas eu só quero saber o que mudar no meu código para continuar com o IPv6! Diga-me agora!</span></div>
<div style="position:absolute;left:60.99px;top:647.41px" class="cls_005"><span class="cls_005">Ok! Ok!</span></div>
<div style="position:absolute;left:60.99px;top:672.59px" class="cls_005"><span class="cls_005">Quase tudo aqui já foi dito a cima, mas a versão curta para os impacientes. (É claro que há</span></div>
<div style="position:absolute;left:60.99px;top:686.58px" class="cls_005"><span class="cls_005">mais do que isso, mas é isso que se aplica ao guia.)</span></div>
<div style="position:absolute;left:76.97px;top:712.69px" class="cls_005"><span class="cls_005">1. Em primeiro lugar, tente usar </span><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005"> para obter todas as informações sobre</span></div>
<div style="position:absolute;left:88.97px;top:728.55px" class="cls_005"><span class="cls_005">struct sockaddr, em vez de embalar a estrutura manualmente. Isto irá mantê-la</span></div>
<div style="position:absolute;left:88.97px;top:743.47px" class="cls_005"><span class="cls_005">compatível entre versões de IP, e eliminará muitos dos passos seguintes.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">24 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:20424px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background025.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.97px;top:54.00px" class="cls_005"><span class="cls_005">2. Em qualquer lugar em que você perceba estar codi cando qualquer coisa relacionada a</span></div>
<div style="position:absolute;left:88.97px;top:67.99px" class="cls_005"><span class="cls_005">versão IP, tente a embalar com uso de uma função auxiliar.</span></div>
<div style="position:absolute;left:76.97px;top:94.10px" class="cls_005"><span class="cls_005">3. Altere AF_INET para AF_INET6.</span></div>
<div style="position:absolute;left:76.97px;top:121.15px" class="cls_005"><span class="cls_005">4. Altere PF_INET para PF_INET6.</span></div>
<div style="position:absolute;left:76.97px;top:148.19px" class="cls_005"><span class="cls_005">5. Altere atribuições INADDR_ANY para atribuições in6addr_any, que são ligeiramente</span></div>
<div style="position:absolute;left:88.97px;top:163.11px" class="cls_005"><span class="cls_005">diferentes:</span></div>
<div style="position:absolute;left:122.83px;top:196.22px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in sa;</span></div>
<div style="position:absolute;left:122.83px;top:212.08px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 sa6;</span></div>
<div style="position:absolute;left:122.83px;top:243.78px" class="cls_005"><span class="cls_005">sa.sin_addr.s_addr = INADDR_ANY;</span></div>
<div style="position:absolute;left:351.13px;top:243.78px" class="cls_013"><span class="cls_013">// usar meu endereço IPv4</span></div>
<div style="position:absolute;left:122.83px;top:259.64px" class="cls_005"><span class="cls_005">sa6.sin6_addr = in6addr_any; </span><span class="cls_013">// usar meu endereço IPv6</span></div>
<div style="position:absolute;left:88.97px;top:293.68px" class="cls_005"><span class="cls_005">Além disso, o valor IN6ADDR_ANY_INIT pode ser usado como um inicializador quando</span></div>
<div style="position:absolute;left:88.97px;top:309.53px" class="cls_005"><span class="cls_005">a struct in6_addr é declarada, assim:</span></div>
<div style="position:absolute;left:122.83px;top:343.57px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr ia6 = IN6ADDR_ANY_INIT;</span></div>
<div style="position:absolute;left:76.97px;top:377.61px" class="cls_005"><span class="cls_005">6. Em vez de struct sockaddr_in use struct sockaddr_in6, certi cando-se de</span></div>
<div style="position:absolute;left:88.97px;top:393.47px" class="cls_005"><span class="cls_005">adicionar "6" para os campos de forma apropriada (Veja </span><span class="cls_023">structs</span><span class="cls_005">, acima). Não há</span></div>
<div style="position:absolute;left:88.97px;top:409.32px" class="cls_005"><span class="cls_005">campo sin6_zero.</span></div>
<div style="position:absolute;left:76.97px;top:436.37px" class="cls_005"><span class="cls_005">7. Em vez de struct in_addr use struct in6_addr, certi cando-se de adicionar "6"</span></div>
<div style="position:absolute;left:88.97px;top:452.22px" class="cls_005"><span class="cls_005">para os campos conforme apropriado (Veja </span><span class="cls_023">structs</span><span class="cls_005">, acima).</span></div>
<div style="position:absolute;left:76.97px;top:479.26px" class="cls_005"><span class="cls_005">8. Em vez de inet_aton() ou inet_addr(), use inet_pton().</span></div>
<div style="position:absolute;left:76.97px;top:506.31px" class="cls_005"><span class="cls_005">9. Em vez de inet_ntoa(), use inet_ntop().</span></div>
<div style="position:absolute;left:70.68px;top:533.36px" class="cls_005"><span class="cls_005">10. Em vez de gethostbyname(), utilize a superior getaddrinfo().</span></div>
<div style="position:absolute;left:70.68px;top:560.40px" class="cls_005"><span class="cls_005">11. Em vez de gethostbyaddr(), use a superior getnameinfo() (embora</span></div>
<div style="position:absolute;left:88.97px;top:576.25px" class="cls_005"><span class="cls_005">gethostbyaddr() ainda possa trabalhar com IPv6).</span></div>
<div style="position:absolute;left:70.68px;top:603.30px" class="cls_005"><span class="cls_005">12. INADDR_BROADCAST não funciona mais. Use IPv6 multicast em seu lugar.</span></div>
<div style="position:absolute;left:60.99px;top:629.41px" class="cls_005"><span class="cls_005">E é isso!</span></div>
<div style="position:absolute;left:60.99px;top:657.46px" class="cls_002"><span class="cls_002">Chamadas de Sistema</span></div>
<div style="position:absolute;left:60.99px;top:700.43px" class="cls_005"><span class="cls_005">Esta é a seção onde nós entramos nas chamadas de sistema (e outras chamadas de</span></div>
<div style="position:absolute;left:60.99px;top:714.42px" class="cls_005"><span class="cls_005">bibliotecas) que permitem que você acesse funcionalidades de rede de um ambiente Unix, ou</span></div>
<div style="position:absolute;left:60.99px;top:728.41px" class="cls_005"><span class="cls_005">qualquer ambiente que suporte a API de sockets para esses assuntos (BSD, Windows, Linux,</span></div>
<div style="position:absolute;left:60.99px;top:742.40px" class="cls_005"><span class="cls_005">Mac, o-que-você-tiver.). Quando você chama uma dessas funções, o kernel assume o controle</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">25 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:21275px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background026.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">e faz todo o trabalho para você automagicamente.</span></div>
<div style="position:absolute;left:60.99px;top:79.18px" class="cls_005"><span class="cls_005">O lugar onde a maioria das pessoas  cam presas aqui é na ordem de chamada das funções.</span></div>
<div style="position:absolute;left:60.99px;top:94.10px" class="cls_005"><span class="cls_005">Nisso, as páginas man não são úteis, como você provavelmente já descobriu. Bem, para ajudar</span></div>
<div style="position:absolute;left:60.99px;top:109.02px" class="cls_005"><span class="cls_005">nessa terrível situação, tentei expor as chamadas de sistema nas seções a seguir exatamente</span></div>
<div style="position:absolute;left:60.99px;top:123.01px" class="cls_005"><span class="cls_005">(aproximadamente) na mesma ordem em que você precisará chamá-las em seus programas.</span></div>
<div style="position:absolute;left:60.99px;top:148.19px" class="cls_005"><span class="cls_005">Isso, juntamente com algumas amostras de códigos aqui e ali, um pouco de leite com</span></div>
<div style="position:absolute;left:60.99px;top:162.18px" class="cls_005"><span class="cls_005">biscoitos (que temo que você tenha que fornecer a si mesmo), e algumas vísceras cruas com</span></div>
<div style="position:absolute;left:60.99px;top:176.17px" class="cls_005"><span class="cls_005">coragem, e você estará transmitindo dados pela Internet como o Filho de Jon Postel!</span></div>
<div style="position:absolute;left:60.99px;top:201.35px" class="cls_005"><span class="cls_005">(Observe que, por brevidade, muitos trechos de código abaixo não fazem as veri cações de</span></div>
<div style="position:absolute;left:60.99px;top:215.34px" class="cls_005"><span class="cls_005">erros necessárias. E eles muito comumente assumem que os resultados de chamadas a</span></div>
<div style="position:absolute;left:60.99px;top:230.26px" class="cls_005"><span class="cls_005">getaddrinfo() têm sucesso e retornam uma entrada válida para a lista ligada. Ambas as</span></div>
<div style="position:absolute;left:60.99px;top:245.18px" class="cls_005"><span class="cls_005">situações são adequadamente abordadas nos programas independentes, portanto, use-os</span></div>
<div style="position:absolute;left:60.99px;top:259.17px" class="cls_005"><span class="cls_005">como um modelo.)</span></div>
<div style="position:absolute;left:60.99px;top:288.02px" class="cls_007"><span class="cls_007">getaddrinfo()—Prepare Para Começar!</span></div>
<div style="position:absolute;left:60.99px;top:323.40px" class="cls_005"><span class="cls_005">Esta função é um verdadeiro burro de carga com diversas opções, mas seu uso é realmente</span></div>
<div style="position:absolute;left:60.99px;top:338.33px" class="cls_005"><span class="cls_005">muito simples. Ela ajuda a de nir as structs que você precisará mais tarde.</span></div>
<div style="position:absolute;left:60.99px;top:365.37px" class="cls_005"><span class="cls_005">Um pouco de história: Costumávamos usar uma função chamada gethostbyname() para</span></div>
<div style="position:absolute;left:60.99px;top:381.23px" class="cls_005"><span class="cls_005">fazer pesquisas de DNS. Então carregávamos essas informações à mão em uma struct</span></div>
<div style="position:absolute;left:60.99px;top:397.08px" class="cls_005"><span class="cls_005">sockaddr_in, e usávamos isso em nossas chamadas.</span></div>
<div style="position:absolute;left:60.99px;top:423.19px" class="cls_005"><span class="cls_005">Isto não é mais necessário, felizmente (Também não é desejável, se você quer escrever código</span></div>
<div style="position:absolute;left:60.99px;top:437.18px" class="cls_005"><span class="cls_005">que funcione tanto para IPv4 quanto para IPv6!). Nestes tempos modernos, você tem agora a</span></div>
<div style="position:absolute;left:60.99px;top:452.10px" class="cls_005"><span class="cls_005">função getaddrinfo() que faz todos os tipos de coisas boas para você, incluindo pesquisas</span></div>
<div style="position:absolute;left:60.99px;top:467.96px" class="cls_005"><span class="cls_005">de nomes DNS e serviço, e preenche as structs que você precisa, além disso!</span></div>
<div style="position:absolute;left:60.99px;top:494.07px" class="cls_005"><span class="cls_005">Vamos dar uma olhada!</span></div>
<div style="position:absolute;left:94.85px;top:527.18px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:543.03px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:558.89px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:94.85px;top:589.66px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getaddrinfo(</span><span class="cls_008">const  char</span><span class="cls_005"> *node,</span></div>
<div style="position:absolute;left:350.02px;top:589.66px" class="cls_013"><span class="cls_013">// Ex. "</span><A HREF="http://www.example.com"/">www.example.com"</A> </div>
<div style="position:absolute;left:123.94px;top:603.65px" class="cls_013"><span class="cls_013">ou IP</span></div>
<div style="position:absolute;left:202.28px;top:618.57px" class="cls_008"><span class="cls_008">const  char</span><span class="cls_005"> *service,</span></div>
<div style="position:absolute;left:350.01px;top:618.57px" class="cls_013"><span class="cls_013">// Ex. "http" ou número da</span></div>
<div style="position:absolute;left:123.94px;top:632.56px" class="cls_013"><span class="cls_013">porta</span></div>
<div style="position:absolute;left:202.28px;top:648.41px" class="cls_008"><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> addrinfo *hints,</span></div>
<div style="position:absolute;left:202.28px;top:664.27px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo **res);</span></div>
<div style="position:absolute;left:60.99px;top:697.38px" class="cls_005"><span class="cls_005">Você passa à essa função três parâmetros de entrada, e dá-lhe um ponteiro para uma lista</span></div>
<div style="position:absolute;left:60.99px;top:712.30px" class="cls_005"><span class="cls_005">ligada, res, para resultados.</span></div>
<div style="position:absolute;left:60.99px;top:739.34px" class="cls_005"><span class="cls_005">O parâmetro node é o nome do host a se conectar, ou um endereço IP.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">26 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:22126px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background027.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Em seguida vem o parâmetro service, que pode ser um número de porta, como "80", ou o</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">nome de um determinado serviço (encontrados em </span><span class="cls_023">The IANA Port List</span><span class="cls_024"><sup>20</sup></span><span class="cls_005"> ou no arquivo</span></div>
<div style="position:absolute;left:60.99px;top:86.71px" class="cls_005"><span class="cls_005">/etc/services em sua máquina Unix) como "http" ou "ftp" ou "telnet" ou "smtp" ou qualquer</span></div>
<div style="position:absolute;left:60.99px;top:101.63px" class="cls_005"><span class="cls_005">outro.</span></div>
<div style="position:absolute;left:60.99px;top:127.75px" class="cls_005"><span class="cls_005">Finalmente, o parâmetro hints aponta para uma struct addrinfo já preenchida por você</span></div>
<div style="position:absolute;left:60.99px;top:142.67px" class="cls_005"><span class="cls_005">com informações relevantes.</span></div>
<div style="position:absolute;left:60.99px;top:167.85px" class="cls_005"><span class="cls_005">Aqui está uma chamada de exemplo, se você é um servidor no IP do seu próprio host, porta</span></div>
<div style="position:absolute;left:60.99px;top:181.84px" class="cls_005"><span class="cls_005">3490. Observe que isso não faz realmente nenhuma escuta ou con guração de rede; ele</span></div>
<div style="position:absolute;left:60.99px;top:195.82px" class="cls_005"><span class="cls_005">simplesmente con gura estruturas que usaremos mais tarde:</span></div>
<div style="position:absolute;left:83.19px;top:228.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:228.93px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> status;</span></div>
<div style="position:absolute;left:83.19px;top:244.79px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:244.79px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints;</span></div>
<div style="position:absolute;left:83.19px;top:259.71px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:259.71px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo *servinfo;</span></div>
<div style="position:absolute;left:293.33px;top:259.71px" class="cls_013"><span class="cls_013">// apontará para os</span></div>
<div style="position:absolute;left:109.49px;top:273.70px" class="cls_013"><span class="cls_013">resultados</span></div>
<div style="position:absolute;left:83.19px;top:289.55px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:304.47px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:304.47px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints); </span><span class="cls_013">// verifique se a</span></div>
<div style="position:absolute;left:109.49px;top:318.46px" class="cls_013"><span class="cls_013">estrutura está vazia</span></div>
<div style="position:absolute;left:83.19px;top:333.38px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:333.38px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:325.49px;top:333.38px" class="cls_013"><span class="cls_013">// não me importo se</span></div>
<div style="position:absolute;left:109.49px;top:347.37px" class="cls_013"><span class="cls_013">IPv4 ou IPv6</span></div>
<div style="position:absolute;left:83.19px;top:363.23px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:363.23px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM; </span><span class="cls_013">// sockets stream TCP</span></div>
<div style="position:absolute;left:83.19px;top:378.15px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:378.15px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:325.49px;top:378.15px" class="cls_013"><span class="cls_013">// preencha meu IP para</span></div>
<div style="position:absolute;left:109.49px;top:392.14px" class="cls_013"><span class="cls_013">mim</span></div>
<div style="position:absolute;left:83.19px;top:407.99px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:422.91px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:422.91px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((status = getaddrinfo(NULL, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:436.90px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:451.82px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:451.82px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"erro em getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:465.81px" class="cls_005"><span class="cls_005">gai_strerror(status));</span></div>
<div style="position:absolute;left:76.48px;top:481.67px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:481.67px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:497.52px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:497.52px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:513.37px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:529.23px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:529.23px" class="cls_013"><span class="cls_013">// servinfo agora aponta para uma lista encadeada de 1</span></div>
<div style="position:absolute;left:76.48px;top:545.08px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:545.08px" class="cls_013"><span class="cls_013">// ou mais structs addrinfos</span></div>
<div style="position:absolute;left:76.48px;top:560.94px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:575.86px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:575.86px" class="cls_013"><span class="cls_013">// ... faça tudo até que você não precise mais de</span></div>
<div style="position:absolute;left:109.49px;top:589.85px" class="cls_013"><span class="cls_013">servinfo</span></div>
<div style="position:absolute;left:76.48px;top:605.70px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:621.56px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:621.56px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo); </span><span class="cls_013">// liberar a lista encadeada</span></div>
<div style="position:absolute;left:60.99px;top:655.60px" class="cls_005"><span class="cls_005">Observe que eu de ni o ai_family para AF_UNSPEC, dizendo com isso que eu não me</span></div>
<div style="position:absolute;left:60.99px;top:671.45px" class="cls_005"><span class="cls_005">importo se usarmos IPv4 ou IPv6. Você pode con gurá-lo para AF_INET ou AF_INET6 se você</span></div>
<div style="position:absolute;left:60.99px;top:686.37px" class="cls_005"><span class="cls_005">quiser um ou outro especi camente.</span></div>
<div style="position:absolute;left:60.99px;top:712.48px" class="cls_005"><span class="cls_005">Além disso, você verá a   ag AI_PASSIVE ali; isto diz a getaddrinfo() para atribuir o</span></div>
<div style="position:absolute;left:60.99px;top:727.41px" class="cls_005"><span class="cls_005">endereço do meu host local à estrutura do socket. Isso é bom porque você não precisa</span></div>
<div style="position:absolute;left:60.99px;top:741.39px" class="cls_005"><span class="cls_005">codi cá-lo. (Ou você pode colocar um endereço especí co como primeiro parâmetro de</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">27 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:22977px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background028.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">getaddrinfo(), onde eu tenho atualmente NULL, lá em cima.)</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">Então nós fazemos a chamada. Se houver um erro (getaddrinfo() retornar diferente de</span></div>
<div style="position:absolute;left:60.99px;top:97.83px" class="cls_005"><span class="cls_005">zero), podemos imprimi-lo usando a função gai_strerror(), como você pode ver. Se tudo</span></div>
<div style="position:absolute;left:60.99px;top:113.69px" class="cls_005"><span class="cls_005">funcionar corretamente, porém, servinfo irá apontar para uma lista ligada de struct</span></div>
<div style="position:absolute;left:60.99px;top:129.54px" class="cls_005"><span class="cls_005">addrinfos, cada uma das quais contém uma struct sockaddr de algum tipo que</span></div>
<div style="position:absolute;left:60.99px;top:144.46px" class="cls_005"><span class="cls_005">podemos usar mais tarde! Bacana!</span></div>
<div style="position:absolute;left:60.99px;top:170.57px" class="cls_005"><span class="cls_005">Finalmente, quando terminamos de usar a lista ligada que getaddrinfo() tão</span></div>
<div style="position:absolute;left:60.99px;top:185.50px" class="cls_005"><span class="cls_005">graciosamente alocou para nós, nós podemos (e devemos) liberar tudo com uma chamada a</span></div>
<div style="position:absolute;left:60.99px;top:200.42px" class="cls_005"><span class="cls_005">freeaddrinfo().</span></div>
<div style="position:absolute;left:60.99px;top:226.53px" class="cls_005"><span class="cls_005">Aqui está um exemplo de chamada se você é um cliente que quer se conectar a um</span></div>
<div style="position:absolute;left:60.99px;top:240.52px" class="cls_005"><span class="cls_005">determinado servidor, digamos "</span><A HREF="http://www.example.net"/">www.example.net"</A> na porta 3490. Novamente, isto não faz</div>
<div style="position:absolute;left:60.99px;top:254.51px" class="cls_005"><span class="cls_005">realmente se conectar, mas con gura as estruturas que usaremos mais tarde:</span></div>
<div style="position:absolute;left:83.19px;top:287.62px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:287.62px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> status;</span></div>
<div style="position:absolute;left:83.19px;top:303.47px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:303.47px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints;</span></div>
<div style="position:absolute;left:83.19px;top:318.39px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:318.39px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo *servinfo;</span></div>
<div style="position:absolute;left:293.33px;top:318.39px" class="cls_013"><span class="cls_013">// apontará para os</span></div>
<div style="position:absolute;left:109.49px;top:332.38px" class="cls_013"><span class="cls_013">resultados</span></div>
<div style="position:absolute;left:83.19px;top:348.23px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:363.16px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:363.16px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints); </span><span class="cls_013">// verifique se a</span></div>
<div style="position:absolute;left:109.49px;top:377.15px" class="cls_013"><span class="cls_013">estrutura está vazia</span></div>
<div style="position:absolute;left:83.19px;top:392.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:392.07px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:325.49px;top:392.07px" class="cls_013"><span class="cls_013">// não me importo se</span></div>
<div style="position:absolute;left:109.49px;top:406.06px" class="cls_013"><span class="cls_013">IPv4 ou IPv6</span></div>
<div style="position:absolute;left:83.19px;top:421.91px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:421.91px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM; </span><span class="cls_013">// sockets stream TCP</span></div>
<div style="position:absolute;left:83.19px;top:437.76px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:453.62px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:453.62px" class="cls_013"><span class="cls_013">// prepare-se para conectar</span></div>
<div style="position:absolute;left:76.48px;top:468.54px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:468.54px" class="cls_005"><span class="cls_005">status = getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.net"/">www.example.net"</A> </span><span class="cls_005">, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:482.53px" class="cls_005"><span class="cls_005">&servinfo);</span></div>
<div style="position:absolute;left:76.48px;top:498.38px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:514.24px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:514.24px" class="cls_013"><span class="cls_013">// servinfo agora aponta para uma</span></div>
<div style="position:absolute;left:76.48px;top:530.09px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:530.09px" class="cls_013"><span class="cls_013">// lista encadeada de 1 ou mais struct addrinfos</span></div>
<div style="position:absolute;left:76.48px;top:545.95px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:561.80px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:561.80px" class="cls_013"><span class="cls_013">// etc.</span></div>
<div style="position:absolute;left:60.99px;top:595.84px" class="cls_005"><span class="cls_005">Eu continuo dizendo que servinfo é uma lista ligada com todos os tipos de informações de</span></div>
<div style="position:absolute;left:60.99px;top:610.76px" class="cls_005"><span class="cls_005">endereço. Vamos escrever um programa de demonstração rápida para mostrar essas</span></div>
<div style="position:absolute;left:60.99px;top:624.75px" class="cls_005"><span class="cls_005">informações. </span><span class="cls_023">Este pequeno </span><span class="cls_006">p</span><span class="cls_023">ro</span><span class="cls_006">g</span><span class="cls_023">rama</span><span class="cls_024"><sup>21</sup></span><span class="cls_005"> imprimirá os endereços IP para qualquer host que</span></div>
<div style="position:absolute;left:60.99px;top:640.67px" class="cls_005"><span class="cls_005">você especi que na linha de comando:</span></div>
<div style="position:absolute;left:83.19px;top:673.78px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:673.78px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:688.70px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:688.70px" class="cls_013"><span class="cls_013">** showip.c -- mostra endereços IP para um host dado na</span></div>
<div style="position:absolute;left:109.49px;top:702.69px" class="cls_013"><span class="cls_013">linha de comando</span></div>
<div style="position:absolute;left:83.19px;top:718.55px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:718.55px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:734.40px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">28 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:23828px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background029.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:83.19px;top:118.35px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:134.20px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:150.06px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:181.77px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">int</span><span class="cls_005"> argc, </span><span class="cls_008">char</span><span class="cls_005"> *argv[])</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:197.62px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:213.47px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:213.47px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res, *p;</span></div>
<div style="position:absolute;left:76.48px;top:229.33px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:229.33px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> status;</span></div>
<div style="position:absolute;left:76.48px;top:245.18px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:245.18px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> ipstr[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:261.04px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:276.89px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:276.89px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (argc != </span><span class="cls_009">2</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:292.75px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:157.60px;top:292.75px" class="cls_005"><span class="cls_005">fprintf(stderr,</span><span class="cls_010">"uso: showip hostname\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:308.60px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:157.61px;top:308.60px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:324.45px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:324.45px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:340.31px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:76.48px;top:356.16px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:356.16px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:371.08px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:371.08px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC; </span><span class="cls_013">// AF_INET ou AF_INET6</span></div>
<div style="position:absolute;left:109.49px;top:385.07px" class="cls_013"><span class="cls_013">para forçar versão</span></div>
<div style="position:absolute;left:76.48px;top:400.93px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:400.93px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:416.78px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:431.70px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:431.70px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((status = getaddrinfo(argv[</span><span class="cls_009">1</span><span class="cls_005">], NULL, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:445.69px" class="cls_005"><span class="cls_005">&res)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:460.61px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:157.60px;top:460.61px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:474.60px" class="cls_005"><span class="cls_005">gai_strerror(status));</span></div>
<div style="position:absolute;left:76.48px;top:490.46px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:157.61px;top:490.46px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:506.31px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:506.31px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:522.16px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:538.02px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:538.02px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Endereço IP para %s:\n\n"</span><span class="cls_005">, argv[</span><span class="cls_009">1</span><span class="cls_005">]);</span></div>
<div style="position:absolute;left:76.48px;top:553.87px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:76.48px;top:569.73px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:569.73px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = res;p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:585.58px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:157.61px;top:585.58px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *addr;</span></div>
<div style="position:absolute;left:76.48px;top:601.43px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:157.61px;top:601.43px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *ipver;</span></div>
<div style="position:absolute;left:76.48px;top:617.29px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:76.48px;top:633.14px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:157.61px;top:633.14px" class="cls_013"><span class="cls_013">// pegue o ponteiro para o endereço em si,</span></div>
<div style="position:absolute;left:76.48px;top:649.00px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:157.61px;top:649.00px" class="cls_013"><span class="cls_013">// campos diferentes em IPv4 e IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:664.85px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:157.61px;top:664.85px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p->ai_family == AF_INET) { </span><span class="cls_013">// IPv4</span></div>
<div style="position:absolute;left:76.48px;top:679.77px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:184.47px;top:679.77px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in *ipv4 = (</span><span class="cls_014">struct</span></div>
<div style="position:absolute;left:109.49px;top:693.76px" class="cls_005"><span class="cls_005">sockaddr_in *)p->ai_addr;</span></div>
<div style="position:absolute;left:76.48px;top:709.62px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:184.46px;top:709.62px" class="cls_005"><span class="cls_005">addr = &(ipv4->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:725.47px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:184.46px;top:725.47px" class="cls_005"><span class="cls_005">ipver = </span><span class="cls_010">"IPv4"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:741.32px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:157.61px;top:741.32px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> { </span><span class="cls_013">// IPv6</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">29 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:24679px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background030.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:184.47px;top:54.00px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 *ipv6 = (</span><span class="cls_014">struct</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">sockaddr_in6 *)p->ai_addr;</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:184.46px;top:83.84px" class="cls_005"><span class="cls_005">addr = &(ipv6->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:184.46px;top:99.70px" class="cls_005"><span class="cls_005">ipver = </span><span class="cls_010">"IPv6"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:157.61px;top:115.55px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:157.61px;top:147.26px" class="cls_013"><span class="cls_013">// converta o IP em uma string e imprima-o:</span></div>
<div style="position:absolute;left:76.48px;top:162.18px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:157.60px;top:162.18px" class="cls_005"><span class="cls_005">inet_ntop(p->ai_family, addr, ipstr, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:176.17px" class="cls_005"><span class="cls_005">ipstr);</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:157.60px;top:192.02px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"</span></div>
<div style="position:absolute;left:224.77px;top:192.02px" class="cls_010"><span class="cls_010">%s: %s\n"</span><span class="cls_005">, ipver, ipstr);</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:130.75px;top:207.88px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:130.75px;top:239.59px" class="cls_005"><span class="cls_005">freeaddrinfo(res); </span><span class="cls_013">// libere a lista ligada</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:130.75px;top:271.30px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:103.89px;top:287.15px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:321.19px" class="cls_005"><span class="cls_005">Como você pode ver, o código chama getaddrinfo() para o que quer que você passe na</span></div>
<div style="position:absolute;left:60.99px;top:337.04px" class="cls_005"><span class="cls_005">linha de comando, que preenche a lista ligada apontada por res, e então nós podemos iterar</span></div>
<div style="position:absolute;left:60.99px;top:351.96px" class="cls_005"><span class="cls_005">sobre a lista e imprimir coisas ou fazer qualquer coisa.</span></div>
<div style="position:absolute;left:60.99px;top:378.08px" class="cls_005"><span class="cls_005">(Há um pouco de feiúra lá onde nós temos que cavar diferentes tipos de struct sockaddrs</span></div>
<div style="position:absolute;left:60.99px;top:393.00px" class="cls_005"><span class="cls_005">dependendo da versão IP. Me desculpe por isso! Eu não tenho certeza de uma maneira melhor</span></div>
<div style="position:absolute;left:60.99px;top:406.99px" class="cls_005"><span class="cls_005">para contornar isso.)</span></div>
<div style="position:absolute;left:60.99px;top:432.17px" class="cls_005"><span class="cls_005">Execução de exemplo! Todo mundo adora screenshots:</span></div>
<div style="position:absolute;left:94.85px;top:465.28px" class="cls_005"><span class="cls_005">$ showip </span><A HREF="http://www.example.net/">www.example.net</A> </div>
<div style="position:absolute;left:94.85px;top:481.13px" class="cls_005"><span class="cls_005">Endereço IP para </span><A HREF="http://www.example.net:/">www.example.net:</A> </div>
<div style="position:absolute;left:108.27px;top:512.84px" class="cls_005"><span class="cls_005">IPv4: 192.0.2.88</span></div>
<div style="position:absolute;left:94.85px;top:544.55px" class="cls_005"><span class="cls_005">$ showip ipv6.example.com</span></div>
<div style="position:absolute;left:94.85px;top:560.40px" class="cls_005"><span class="cls_005">Endereço IP para ipv6.example.com:</span></div>
<div style="position:absolute;left:108.27px;top:592.11px" class="cls_005"><span class="cls_005">IPv4: 192.0.2.101</span></div>
<div style="position:absolute;left:108.27px;top:607.96px" class="cls_005"><span class="cls_005">IPv6: 2001:db8:8c00:22::171</span></div>
<div style="position:absolute;left:60.99px;top:641.07px" class="cls_005"><span class="cls_005">Agora que temos isso sob controle, usaremos os resultados que obtivemos de</span></div>
<div style="position:absolute;left:60.99px;top:655.99px" class="cls_005"><span class="cls_005">getaddrinfo() para passar a outras funções de socket e,  nalmente, estabelecer a nossa</span></div>
<div style="position:absolute;left:60.99px;top:670.91px" class="cls_005"><span class="cls_005">conexão de rede! Continue lendo!</span></div>
<div style="position:absolute;left:60.99px;top:699.77px" class="cls_007"><span class="cls_007">socket()—Obtenha o descritor de arquivo!</span></div>
<div style="position:absolute;left:60.99px;top:735.15px" class="cls_005"><span class="cls_005">Eu acho que não posso mais deixar de comentar—Eu tenho que comentar sobre a chamada de</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">30 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:25530px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background031.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">sistema socket(). Aqui estão os detalhes:</span></div>
<div style="position:absolute;left:94.85px;top:88.97px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:104.83px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:136.53px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> socket(</span><span class="cls_008">int</span><span class="cls_005"> domain, </span><span class="cls_008">int</span><span class="cls_005"> type, </span><span class="cls_008">int</span><span class="cls_005"> protocol);</span></div>
<div style="position:absolute;left:60.99px;top:169.64px" class="cls_005"><span class="cls_005">Mas o que são esses argumentos? Eles permitem que você de na que tipo de socket deseja</span></div>
<div style="position:absolute;left:60.99px;top:183.63px" class="cls_005"><span class="cls_005">(IPv4 ou IPv6, stream ou datagram, e TCP ou UDP).</span></div>
<div style="position:absolute;left:60.99px;top:209.74px" class="cls_005"><span class="cls_005">As pessoas costumavam codi car esses valores, e você ainda pode fazer isso. (domain é</span></div>
<div style="position:absolute;left:60.99px;top:225.60px" class="cls_005"><span class="cls_005">PF_INET ou PF_INET6, type é SOCK_STREAM ou SOCK_DGRAM, e protocol pode ser</span></div>
<div style="position:absolute;left:60.99px;top:241.45px" class="cls_005"><span class="cls_005">de nido como 0 para que se escolha o protocolo apropriado para type. Ou você pode chamar</span></div>
<div style="position:absolute;left:60.99px;top:257.31px" class="cls_005"><span class="cls_005">getprotobyname() para procurar o protocolo desejado, "tcp" ou "udp".)</span></div>
<div style="position:absolute;left:60.99px;top:284.35px" class="cls_005"><span class="cls_005">(Este PF_INET é um parente próximo do AF_INET que você pode usar ao inicializar o campo</span></div>
<div style="position:absolute;left:60.99px;top:300.21px" class="cls_005"><span class="cls_005">sin_family em sua struct sockaddr_in. Na verdade, eles são tão intimamente</span></div>
<div style="position:absolute;left:60.99px;top:315.13px" class="cls_005"><span class="cls_005">relacionados que possuem realmente o mesmo valor, e muitos programadores chamam</span></div>
<div style="position:absolute;left:60.99px;top:330.05px" class="cls_005"><span class="cls_005">socket() e passam AF_INET como o primeiro argumento em vez de PF_INET. Agora, pegue</span></div>
<div style="position:absolute;left:60.99px;top:344.97px" class="cls_005"><span class="cls_005">um pouco de leite com biscoitos, porque é hora da história. Era uma vez, há muito tempo,</span></div>
<div style="position:absolute;left:60.99px;top:359.89px" class="cls_005"><span class="cls_005">pensava-se que talvez uma família de endereços (o que signi ca o "AF" em "AF_INET")</span></div>
<div style="position:absolute;left:60.99px;top:374.81px" class="cls_005"><span class="cls_005">pudesse suportar vários protocolos que foram referidos por sua família de protocolos (o que</span></div>
<div style="position:absolute;left:60.99px;top:389.74px" class="cls_005"><span class="cls_005">signi ca "PF" em "PF_INET"). Isso não aconteceu. E todos viveram felizes para sempre,  m.</span></div>
<div style="position:absolute;left:60.99px;top:405.59px" class="cls_005"><span class="cls_005">Então a coisa mais certa a fazer é usar AF_INET em sua struct sockaddr_in e PF_INET</span></div>
<div style="position:absolute;left:60.99px;top:421.44px" class="cls_005"><span class="cls_005">em sua chamada a socket().)</span></div>
<div style="position:absolute;left:60.99px;top:447.56px" class="cls_005"><span class="cls_005">De qualquer forma, chega disso. O que você realmente precisa fazer é usar os valores a partir</span></div>
<div style="position:absolute;left:60.99px;top:462.48px" class="cls_005"><span class="cls_005">dos resultados da execução de getaddrinfo(), e alimentá-los em socket() diretamente</span></div>
<div style="position:absolute;left:60.99px;top:477.40px" class="cls_005"><span class="cls_005">assim:</span></div>
<div style="position:absolute;left:83.19px;top:510.51px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:510.51px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:83.19px;top:526.36px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:526.36px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:542.21px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:558.07px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:558.07px" class="cls_013"><span class="cls_013">// faça a pesquisa</span></div>
<div style="position:absolute;left:83.19px;top:573.92px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:573.92px" class="cls_013"><span class="cls_013">// [fingir que já preenchemos a estrutura "hints"]</span></div>
<div style="position:absolute;left:83.19px;top:589.78px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:589.78px" class="cls_005"><span class="cls_005">getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"http"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:83.19px;top:605.63px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:620.55px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:620.55px" class="cls_013"><span class="cls_013">// novamente, você deve verificar erros em getaddrinfo()</span></div>
<div style="position:absolute;left:109.49px;top:634.54px" class="cls_013"><span class="cls_013">e percorrer</span></div>
<div style="position:absolute;left:83.19px;top:649.46px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:649.46px" class="cls_013"><span class="cls_013">// a lista vinculada "res" procurando entradas válidas</span></div>
<div style="position:absolute;left:109.49px;top:663.45px" class="cls_013"><span class="cls_013">em vez de apenas</span></div>
<div style="position:absolute;left:76.48px;top:678.37px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:678.37px" class="cls_013"><span class="cls_013">// supor que a primeira seja boa (como muitos desses</span></div>
<div style="position:absolute;left:109.49px;top:692.36px" class="cls_013"><span class="cls_013">exemplos).</span></div>
<div style="position:absolute;left:76.48px;top:708.22px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:708.22px" class="cls_013"><span class="cls_013">// Veja a seção cliente/servidor para exemplos reais.</span></div>
<div style="position:absolute;left:76.48px;top:724.07px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">31 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:26381px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background032.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:54.00px" class="cls_005"><span class="cls_005">s = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:60.99px;top:102.03px" class="cls_005"><span class="cls_005">socket() simplesmente retorna a você um descritor de socket que você pode usar em</span></div>
<div style="position:absolute;left:60.99px;top:117.88px" class="cls_005"><span class="cls_005">chamadas de sistema posteriores, ou -1 em caso de erro. A variável global errno é de nida</span></div>
<div style="position:absolute;left:60.99px;top:133.74px" class="cls_005"><span class="cls_005">para o valor do erro (veja a página man </span><span class="cls_023">errno</span><span class="cls_005"> para mais detalhes, e uma nota rápida sobre o</span></div>
<div style="position:absolute;left:60.99px;top:149.59px" class="cls_005"><span class="cls_005">uso de errno em programas multithreaded).</span></div>
<div style="position:absolute;left:60.99px;top:175.70px" class="cls_005"><span class="cls_005">Bem, bem, bem, mas o que há de bom neste socket? A resposta é que ele não é muito bom por</span></div>
<div style="position:absolute;left:60.99px;top:189.69px" class="cls_005"><span class="cls_005">si só, e você precisa ler e fazer mais chamadas de sistema para que possa fazer qualquer</span></div>
<div style="position:absolute;left:60.99px;top:203.68px" class="cls_005"><span class="cls_005">sentido.</span></div>
<div style="position:absolute;left:60.99px;top:232.53px" class="cls_007"><span class="cls_007">bind()—Em que porta eu estou?</span></div>
<div style="position:absolute;left:60.99px;top:267.91px" class="cls_005"><span class="cls_005">Depois de ter um socket, talvez seja necessário o associar a uma porta na sua máquina local.</span></div>
<div style="position:absolute;left:60.99px;top:282.84px" class="cls_005"><span class="cls_005">(Isto é comumente feito se você estiver usando listen() para conexões de entrada em uma</span></div>
<div style="position:absolute;left:60.99px;top:297.76px" class="cls_005"><span class="cls_005">porta especí ca—jogos de rede multijogador fazem isso quando dizem para "conecte-se a</span></div>
<div style="position:absolute;left:60.99px;top:311.75px" class="cls_005"><span class="cls_005">192.168.5.10 na porta 3490".) O número da porta é usado pelo kernel para assciar um pacote</span></div>
<div style="position:absolute;left:60.99px;top:325.74px" class="cls_005"><span class="cls_005">de entrada ao descritor de socket de um determinado processo. Se você estiver apenas</span></div>
<div style="position:absolute;left:60.99px;top:340.66px" class="cls_005"><span class="cls_005">usando connect() (porque você é o cliente, não o servidor), isso provavelmente será</span></div>
<div style="position:absolute;left:60.99px;top:355.58px" class="cls_005"><span class="cls_005">desnecessário. Leia de qualquer maneira, apenas por diversão.</span></div>
<div style="position:absolute;left:60.99px;top:381.69px" class="cls_005"><span class="cls_005">Aqui está a sinopse para a chamada de sistema bind():</span></div>
<div style="position:absolute;left:94.85px;top:415.73px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:431.59px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:463.29px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> bind(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *my_addr, </span><span class="cls_008">int</span><span class="cls_005"> addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:497.33px" class="cls_005"><span class="cls_005">sockfd é o descritor de arquivo de socket retornado por socket(). my_addr é um ponteiro</span></div>
<div style="position:absolute;left:60.99px;top:513.19px" class="cls_005"><span class="cls_005">para uma struct sockaddr que contém informações sobre o seu endereço, ou seja, porta e</span></div>
<div style="position:absolute;left:60.99px;top:529.04px" class="cls_005"><span class="cls_005">endereço IP. addrlen é o comprimento em bytes desse endereço.</span></div>
<div style="position:absolute;left:60.99px;top:555.15px" class="cls_005"><span class="cls_005">Uau. Isso é um pouco para que possamos absorver em pouco tempo. Vamos a um exemplo de</span></div>
<div style="position:absolute;left:60.99px;top:569.14px" class="cls_005"><span class="cls_005">uso de sockets com bind() no host onde o programa é executado, porta 3490:</span></div>
<div style="position:absolute;left:83.19px;top:602.25px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:602.25px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:618.11px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:618.11px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:633.96px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:648.88px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:648.88px" class="cls_013"><span class="cls_013">// primeiro, carregar estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:662.87px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:678.72px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:694.58px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:694.58px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:709.50px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:709.50px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:709.50px" class="cls_013"><span class="cls_013">// usar IPv4 ou IPv6,</span></div>
<div style="position:absolute;left:109.49px;top:723.49px" class="cls_013"><span class="cls_013">qualquer que seja</span></div>
<div style="position:absolute;left:83.19px;top:739.34px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:739.34px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">32 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:27232px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background033.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.00px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:54.00px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:325.49px;top:54.00px" class="cls_013"><span class="cls_013">// preencha meu IP para</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_013"><span class="cls_013">mim</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:99.70px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:131.41px" class="cls_013"><span class="cls_013">// cria o socket:</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:162.18px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:162.18px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:176.17px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:207.88px" class="cls_013"><span class="cls_013">// Usa bind na porta que passamos a getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:239.59px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:273.63px" class="cls_005"><span class="cls_005">Ao utilizar a   ag AI_PASSIVE, estou dizendo ao programa para usar bind() no IP da máquina</span></div>
<div style="position:absolute;left:60.99px;top:288.55px" class="cls_005"><span class="cls_005">em que está sendo executado. Se você deseja usar bind em um endereço IP local especí co,</span></div>
<div style="position:absolute;left:60.99px;top:303.47px" class="cls_005"><span class="cls_005">ignore AI_PASSIVE e ponha o endereço IP como primeiro argumento de getaddrinfo().</span></div>
<div style="position:absolute;left:60.99px;top:330.52px" class="cls_005"><span class="cls_005">bind() também retorna -1 em caso de erro e põe em errno o valor do erro.</span></div>
<div style="position:absolute;left:60.99px;top:357.56px" class="cls_005"><span class="cls_005">Muitos códigos antigos empacotam manualmente a struct sockaddr_in antes de</span></div>
<div style="position:absolute;left:60.99px;top:373.41px" class="cls_005"><span class="cls_005">chamarem bind(). Obviamente, isso é especí co para IPv4, mas não há realmente nada que</span></div>
<div style="position:absolute;left:60.99px;top:389.27px" class="cls_005"><span class="cls_005">impeça você de fazer a mesma coisa com IPv6, exceto que o uso de getaddrinfo() será</span></div>
<div style="position:absolute;left:60.99px;top:404.19px" class="cls_005"><span class="cls_005">mais fácil, em geral. De qualquer forma, o código antigo é algo como isto:</span></div>
<div style="position:absolute;left:83.19px;top:437.30px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:437.30px" class="cls_013"><span class="cls_013">// !!! ESTE É O MODO ANTIGO !!!</span></div>
<div style="position:absolute;left:83.19px;top:453.15px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:469.01px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:469.01px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:484.86px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:484.86px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in my_addr;</span></div>
<div style="position:absolute;left:83.19px;top:500.71px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:516.57px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:516.57px" class="cls_005"><span class="cls_005">sockfd = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:532.42px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:548.28px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:548.28px" class="cls_005"><span class="cls_005">my_addr.sin_family = AF_INET;</span></div>
<div style="position:absolute;left:83.19px;top:563.20px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:563.20px" class="cls_005"><span class="cls_005">my_addr.sin_port = htons(MYPORT);</span></div>
<div style="position:absolute;left:359.05px;top:563.20px" class="cls_013"><span class="cls_013">// short, network</span></div>
<div style="position:absolute;left:109.49px;top:577.19px" class="cls_013"><span class="cls_013">byte order</span></div>
<div style="position:absolute;left:76.48px;top:593.04px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:593.04px" class="cls_005"><span class="cls_005">my_addr.sin_addr.s_addr = inet_addr(</span><span class="cls_010">"10.12.110.57"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:608.90px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:608.90px" class="cls_005"><span class="cls_005">memset(my_addr.sin_zero, </span><span class="cls_010">'\0'</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> my_addr.sin_zero);</span></div>
<div style="position:absolute;left:76.48px;top:624.75px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:639.67px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:639.67px" class="cls_005"><span class="cls_005">bind(sockfd, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&my_addr, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:653.66px" class="cls_005"><span class="cls_005">my_addr);</span></div>
<div style="position:absolute;left:60.99px;top:687.70px" class="cls_005"><span class="cls_005">No código acima, você também pode atribuir INADDR_ANY ao campo s_addr, se você quiser</span></div>
<div style="position:absolute;left:60.99px;top:703.55px" class="cls_005"><span class="cls_005">usar bind no seu endereço de IP local (como a   ag AI_PASSIVE, acima). A versão IPv6 de</span></div>
<div style="position:absolute;left:60.99px;top:719.41px" class="cls_005"><span class="cls_005">INADDR_ANY é uma variável global in6addr_any que é atribuída ao campo sin6_addr de</span></div>
<div style="position:absolute;left:60.99px;top:735.26px" class="cls_005"><span class="cls_005">sua struct sockaddr_in6. (Há também uma macro IN6ADDR_ANY_INIT que você pode</span></div>
<div style="position:absolute;left:60.99px;top:750.18px" class="cls_005"><span class="cls_005">usar em uma variável inicializadora.)</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">33 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:28083px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background034.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Outra coisa a observar ao chamar bind(): não use números baixos como endereços de</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">portas. Todas as portas abaixo de 1024 são RESERVADAS (a menos que você seja o</span></div>
<div style="position:absolute;left:60.99px;top:83.84px" class="cls_005"><span class="cls_005">superusuário)! Você pode ter qualquer número de porta acima disso, até 65535 (desde que não</span></div>
<div style="position:absolute;left:60.99px;top:97.83px" class="cls_005"><span class="cls_005">esteja sendo usada por outro programa).</span></div>
<div style="position:absolute;left:60.99px;top:123.94px" class="cls_005"><span class="cls_005">Às vezes, você pode perceber, você tenta executar novamente um servidor e bind() falha,</span></div>
<div style="position:absolute;left:60.99px;top:138.87px" class="cls_005"><span class="cls_005">alegando "Endereço já em uso." O que signi ca isso? Bem, parte de um socket que estava</span></div>
<div style="position:absolute;left:60.99px;top:152.86px" class="cls_005"><span class="cls_005">conectado ainda está pendurada no kernel e está monopolizando a porta. Você pode esperar</span></div>
<div style="position:absolute;left:60.99px;top:166.84px" class="cls_005"><span class="cls_005">que ele seja limpo (um minuto ou mais) ou adicionar ao seu programa um código que lhe</span></div>
<div style="position:absolute;left:60.99px;top:180.83px" class="cls_005"><span class="cls_005">permita reutilizar a porta, como isso:</span></div>
<div style="position:absolute;left:83.19px;top:213.94px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:213.94px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> yes=</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:229.79px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:229.79px" class="cls_013"><span class="cls_013">//char yes='1'; // As pessoas do Solaris usam isso</span></div>
<div style="position:absolute;left:83.19px;top:245.65px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:261.50px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:261.50px" class="cls_013"><span class="cls_013">// contornar a mensagem de erro "Endereço já em uso"</span></div>
<div style="position:absolute;left:83.19px;top:276.42px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:276.42px" class="cls_014"><span class="cls_014">if</span></div>
<div style="position:absolute;left:109.49px;top:290.41px" class="cls_005"><span class="cls_005">(setsockopt(listener,SOL_SOCKET,SO_REUSEADDR,&yes,</span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:304.40px" class="cls_005"><span class="cls_005">yes) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:83.19px;top:320.26px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:320.26px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"setsockopt"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:336.11px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:336.11px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:351.96px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:351.96px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:386.00px" class="cls_005"><span class="cls_005">Uma pequena nota  nal extra sobre bind(): há momentos em que você absolutamente não</span></div>
<div style="position:absolute;left:60.99px;top:401.86px" class="cls_005"><span class="cls_005">precisará chamá-la. Se você está conectado com connect() a uma máquina remota e você</span></div>
<div style="position:absolute;left:60.99px;top:417.71px" class="cls_005"><span class="cls_005">não se importa com a porta local (como é o caso com telnet, onde você só se preocupa com</span></div>
<div style="position:absolute;left:60.99px;top:433.57px" class="cls_005"><span class="cls_005">a porta remota), você pode simplesmente chamar connect(), ela veri cará se o socket está</span></div>
<div style="position:absolute;left:60.99px;top:449.42px" class="cls_005"><span class="cls_005">desativado, e fará bind() para uma porta local não usada, se necessário.</span></div>
<div style="position:absolute;left:60.99px;top:479.21px" class="cls_007"><span class="cls_007">connect()—Ei, você!</span></div>
<div style="position:absolute;left:60.99px;top:514.59px" class="cls_005"><span class="cls_005">Vamos  ngir por alguns minutos que você é uma aplicação telnet. Seu usuário ordena que</span></div>
<div style="position:absolute;left:60.99px;top:528.58px" class="cls_005"><span class="cls_005">você (assim como no  lme TRON) obtenha um descritor de arquivo de socket. Você obedece e</span></div>
<div style="position:absolute;left:60.99px;top:543.50px" class="cls_005"><span class="cls_005">chama socket(). Em seguida, o usuário diz-lhe para conectar-se a "10.12.110.57" na porta</span></div>
<div style="position:absolute;left:60.99px;top:559.35px" class="cls_005"><span class="cls_005">"23" (a porta padrão para telnet.) Uau! O que você faz agora?</span></div>
<div style="position:absolute;left:60.99px;top:586.40px" class="cls_005"><span class="cls_005">Para sua sorte, programa, você está agora examinando a seção sobre connect()—como se</span></div>
<div style="position:absolute;left:60.99px;top:601.32px" class="cls_005"><span class="cls_005">conectar a um host remoto. Então leia furiosamente a seguir! Não há tempo a perder!</span></div>
<div style="position:absolute;left:60.99px;top:627.43px" class="cls_005"><span class="cls_005">A chamada connect() é a seguinte:</span></div>
<div style="position:absolute;left:94.85px;top:661.47px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:677.33px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:708.10px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> connect(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *serv_addr, </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:123.94px;top:722.09px" class="cls_005"><span class="cls_005">addrlen);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">34 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:28934px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background035.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">sockfd é o nosso descritor de arquivo de socket amigável, como retornado pela chamada</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">socket(), serv_addr é uma struct sockaddr contendo a porta de destino e o endereço</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">IP, e addrlen é o comprimento em bytes da estrutura de endereço do servidor.</span></div>
<div style="position:absolute;left:60.99px;top:112.75px" class="cls_005"><span class="cls_005">Todas essas informações podem ser adquiridas a partir dos resultados da chamada de</span></div>
<div style="position:absolute;left:60.99px;top:127.68px" class="cls_005"><span class="cls_005">getaddrinfo().</span></div>
<div style="position:absolute;left:60.99px;top:153.79px" class="cls_005"><span class="cls_005">Isso está começando a fazer mais sentido? Eu não posso lhe ouvir a partir daqui, por isso, eu</span></div>
<div style="position:absolute;left:60.99px;top:167.78px" class="cls_005"><span class="cls_005">espero que esteja. Vamos dar um exemplo onde fazemos uma conexão a</span></div>
<div style="position:absolute;left:60.99px;top:182.70px" class="cls_005"><span class="cls_005">"</span><A HREF="http://www.example.com"/">www.example.com"</A>, porta 3490:</div>
<div style="position:absolute;left:83.19px;top:216.74px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:216.74px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:232.59px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:232.59px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:248.45px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:263.37px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:263.37px" class="cls_013"><span class="cls_013">// primeiro, carregue as estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:277.36px" class="cls_013"><span class="cls_013">getaddrinfo:</span></div>
<div style="position:absolute;left:83.19px;top:293.21px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:309.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:309.07px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:324.92px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:324.92px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:83.19px;top:340.77px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:340.77px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:83.19px;top:356.63px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:372.48px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:372.48px" class="cls_005"><span class="cls_005">getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:388.34px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:404.19px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:404.19px" class="cls_013"><span class="cls_013">// crie o socket:</span></div>
<div style="position:absolute;left:76.48px;top:420.04px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:76.48px;top:434.97px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:434.97px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:448.96px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:464.81px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:480.66px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:480.66px" class="cls_013"><span class="cls_013">// conectar!</span></div>
<div style="position:absolute;left:76.48px;top:496.52px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:512.37px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:512.37px" class="cls_005"><span class="cls_005">connect(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:546.41px" class="cls_005"><span class="cls_005">Mais uma vez, os programas old-school preenchiam suas próprias struct sockaddr_in</span></div>
<div style="position:absolute;left:60.99px;top:562.27px" class="cls_005"><span class="cls_005">para passar a connect(). Você pode fazer isso se você quiser. Veja a nota similar na seção</span></div>
<div style="position:absolute;left:60.99px;top:578.12px" class="cls_023"><span class="cls_023">bind</span><span class="cls_006">()</span><span class="cls_005">, acima.</span></div>
<div style="position:absolute;left:60.99px;top:605.17px" class="cls_005"><span class="cls_005">Certi que-se de veri car o valor de retorno de connect()—ela retornará -1 em caso de erro e</span></div>
<div style="position:absolute;left:60.99px;top:621.02px" class="cls_005"><span class="cls_005">con gurará a variável errno.</span></div>
<div style="position:absolute;left:60.99px;top:648.06px" class="cls_005"><span class="cls_005">Além disso, observe que nós não chamamos bind(). Basicamente, nós não nos importamos</span></div>
<div style="position:absolute;left:60.99px;top:662.99px" class="cls_005"><span class="cls_005">com o nosso número de porta local; nós só nos importamos com para onde estamos indo (a</span></div>
<div style="position:absolute;left:60.99px;top:676.98px" class="cls_005"><span class="cls_005">porta remota). O kernel escolherá uma porta local para nós, e o site ao qual nos conectaremos</span></div>
<div style="position:absolute;left:60.99px;top:690.96px" class="cls_005"><span class="cls_005">receberá automaticamente essas informações. Não se preocupe.</span></div>
<div style="position:absolute;left:60.99px;top:719.82px" class="cls_007"><span class="cls_007">listen()—Alguém por favor pode me ligar?</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">35 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:29785px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background036.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Ok, tempo para uma mudança de ritmo. E se você não quiser se conectar a um host remoto?</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">Digo, apenas por diversão, você quer esperar conexões de entrada e tratá-las de alguma forma.</span></div>
<div style="position:absolute;left:60.99px;top:82.91px" class="cls_005"><span class="cls_005">O processo é executado em dois passos: primeiro você usa listen(), então você usa</span></div>
<div style="position:absolute;left:60.99px;top:98.76px" class="cls_005"><span class="cls_005">accept() (veja abaixo).</span></div>
<div style="position:absolute;left:60.99px;top:124.88px" class="cls_005"><span class="cls_005">A chamada de escuta (listen) é bastante simples, mas requer um pouco de explicação:</span></div>
<div style="position:absolute;left:94.85px;top:157.98px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> listen(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">int</span><span class="cls_005"> backlog);</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">sockfd é o descritor de arquivo de socket usual da chamada de sistema socket(). backlog</span></div>
<div style="position:absolute;left:60.99px;top:206.95px" class="cls_005"><span class="cls_005">é o número de conexões permitidas na  la de entrada. O que isso signi ca? Bem, conexões de</span></div>
<div style="position:absolute;left:60.99px;top:221.87px" class="cls_005"><span class="cls_005">entrada aguardarão nesta  la até que você as aceite com accept() (veja abaixo) e este é o</span></div>
<div style="position:absolute;left:60.99px;top:236.79px" class="cls_005"><span class="cls_005">limite de quantas podem entrar na  la. A maioria dos sistemas limita silenciosamente esse</span></div>
<div style="position:absolute;left:60.99px;top:251.71px" class="cls_005"><span class="cls_005">número para cerca de 20; você provavelmente pode de nir como 5 ou 10.</span></div>
<div style="position:absolute;left:60.99px;top:278.76px" class="cls_005"><span class="cls_005">Mais uma vez, como de costume, listen() retorna -1 e con gura errno quando houverem</span></div>
<div style="position:absolute;left:60.99px;top:293.68px" class="cls_005"><span class="cls_005">erros.</span></div>
<div style="position:absolute;left:60.99px;top:319.79px" class="cls_005"><span class="cls_005">Bem, como você provavelmente pode imaginar, precisamos chamar bind() antes de</span></div>
<div style="position:absolute;left:60.99px;top:335.64px" class="cls_005"><span class="cls_005">chamarmos listen() para que o servidor esteja sendo executado em uma porta especí ca.</span></div>
<div style="position:absolute;left:60.99px;top:350.57px" class="cls_005"><span class="cls_005">(Você tem que ser capaz de dizer aos seus amigos em que porta conectarem-se!) Então, se</span></div>
<div style="position:absolute;left:60.99px;top:364.56px" class="cls_005"><span class="cls_005">você estiver ouvindo as conexões de entrada, a sequência de chamadas de sistema que você</span></div>
<div style="position:absolute;left:60.99px;top:378.54px" class="cls_005"><span class="cls_005">fará é:</span></div>
<div style="position:absolute;left:83.19px;top:411.65px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:411.65px" class="cls_005"><span class="cls_005">getaddrinfo();</span></div>
<div style="position:absolute;left:83.19px;top:427.51px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:427.51px" class="cls_005"><span class="cls_005">socket();</span></div>
<div style="position:absolute;left:83.19px;top:443.36px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:443.36px" class="cls_005"><span class="cls_005">bind();</span></div>
<div style="position:absolute;left:83.19px;top:459.21px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:459.21px" class="cls_005"><span class="cls_005">listen();</span></div>
<div style="position:absolute;left:83.19px;top:475.07px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:475.07px" class="cls_013"><span class="cls_013">/* accept() aceita aqui */</span></div>
<div style="position:absolute;left:60.99px;top:508.18px" class="cls_005"><span class="cls_005">Eu só deixarei isso como código de exemplo, uma vez que é bastante autoexplicativo. (O</span></div>
<div style="position:absolute;left:60.99px;top:523.10px" class="cls_005"><span class="cls_005">código na seção accept(), abaixo, é mais completo.) A parte realmente complicada de todas</span></div>
<div style="position:absolute;left:60.99px;top:538.95px" class="cls_005"><span class="cls_005">estas coisas é a chamada de accept().</span></div>
<div style="position:absolute;left:60.99px;top:568.74px" class="cls_007"><span class="cls_007">accept()—"Obrigado por ligar para a porta 3490."</span></div>
<div style="position:absolute;left:60.99px;top:605.05px" class="cls_005"><span class="cls_005">Prepare-se—a chamada a accept() é meio estranha! O que vai acontecer é o seguinte:</span></div>
<div style="position:absolute;left:60.99px;top:620.90px" class="cls_005"><span class="cls_005">alguém de muito longe vai tentar usar connect() contra a sua máquina em uma porta em</span></div>
<div style="position:absolute;left:60.99px;top:636.76px" class="cls_005"><span class="cls_005">que você usou listen(). As conexões serão en leiradas esperando para serem aceitas com</span></div>
<div style="position:absolute;left:60.99px;top:652.61px" class="cls_005"><span class="cls_005">accept(). Você chama accept() e diz a ela para obter a conexão pendente. Ela vai retornar</span></div>
<div style="position:absolute;left:60.99px;top:667.53px" class="cls_005"><span class="cls_005">para você um novo descritor de arquivo socket para utilizar com esta única conexão! É isso</span></div>
<div style="position:absolute;left:60.99px;top:681.52px" class="cls_005"><span class="cls_005">mesmo, de repente você tem dois descritores de arquivos sockets pelo preço de um! O original</span></div>
<div style="position:absolute;left:60.99px;top:695.51px" class="cls_005"><span class="cls_005">ainda continua esperando novas conexões, e o recém-criado está  nalmente pronto para o uso</span></div>
<div style="position:absolute;left:60.99px;top:710.43px" class="cls_005"><span class="cls_005">de send() e recv(). Chegamos lá!</span></div>
<div style="position:absolute;left:60.99px;top:736.54px" class="cls_005"><span class="cls_005">A chamada é a seguinte:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">36 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:30636px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background037.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:61.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:77.78px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:108.56px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> accept(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *addr, socklen_t</span></div>
<div style="position:absolute;left:123.94px;top:122.55px" class="cls_005"><span class="cls_005">*addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:156.59px" class="cls_005"><span class="cls_005">sockfd é o descritor de socket de listen(). Bastante fácil. addr normalmente será um</span></div>
<div style="position:absolute;left:60.99px;top:172.44px" class="cls_005"><span class="cls_005">ponteiro para uma struct sockaddr_storage local. É aqui onde as informações sobre a</span></div>
<div style="position:absolute;left:60.99px;top:187.36px" class="cls_005"><span class="cls_005">conexão de entrada vão (e com elas você pode determinar qual host está lhe chamando de</span></div>
<div style="position:absolute;left:60.99px;top:202.28px" class="cls_005"><span class="cls_005">qual porta). addrlen é uma variável local do tipo inteira que deve ser de nida para</span></div>
<div style="position:absolute;left:60.99px;top:218.14px" class="cls_005"><span class="cls_005">sizeof(struct sockaddr_storage) antes de seu endereço ser passado a accept().</span></div>
<div style="position:absolute;left:60.99px;top:233.99px" class="cls_005"><span class="cls_005">accept() não colocará mais bytes do que addr foi con gurado para guardar. Se ele colocar</span></div>
<div style="position:absolute;left:60.99px;top:249.85px" class="cls_005"><span class="cls_005">um menor número, ele alterará o valor de addrlen para re  etir isso.</span></div>
<div style="position:absolute;left:60.99px;top:276.89px" class="cls_005"><span class="cls_005">Adivinha? accept() retorna -1 e de ne errno se ocorrer um erro. Aposto que não percebeu.</span></div>
<div style="position:absolute;left:60.99px;top:303.00px" class="cls_005"><span class="cls_005">Como antes, isso é muito para absorver em tão pouco tempo, então aqui está um fragmento de</span></div>
<div style="position:absolute;left:60.99px;top:316.99px" class="cls_005"><span class="cls_005">código de exemplo para leitura:</span></div>
<div style="position:absolute;left:83.19px;top:350.10px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:350.10px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:83.19px;top:365.95px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:365.95px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:381.81px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:381.81px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:83.19px;top:397.66px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:397.66px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:83.19px;top:413.52px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:428.44px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:428.44px" class="cls_012"><span class="cls_012">#define MYPORT "3490"</span></div>
<div style="position:absolute;left:258.34px;top:428.44px" class="cls_013"><span class="cls_013">// a porta onde os usuários se</span></div>
<div style="position:absolute;left:109.49px;top:442.43px" class="cls_013"><span class="cls_013">estarão</span></div>
<div style="position:absolute;left:83.19px;top:457.35px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:457.35px" class="cls_012"><span class="cls_012">#define BACKLOG 10</span></div>
<div style="position:absolute;left:258.34px;top:457.35px" class="cls_013"><span class="cls_013">// quantidade de conexões</span></div>
<div style="position:absolute;left:109.49px;top:471.34px" class="cls_013"><span class="cls_013">enfileiradas</span></div>
<div style="position:absolute;left:83.19px;top:487.19px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:503.05px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:503.05px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:518.90px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:518.90px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:534.75px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:534.75px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage their_addr;</span></div>
<div style="position:absolute;left:76.48px;top:550.61px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:550.61px" class="cls_005"><span class="cls_005">socklen_t addr_size;</span></div>
<div style="position:absolute;left:76.48px;top:566.46px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:566.46px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:76.48px;top:582.32px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:582.32px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd, new_fd;</span></div>
<div style="position:absolute;left:76.48px;top:598.17px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:613.09px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:613.09px" class="cls_013"><span class="cls_013">// !! não esqueça de fazer de realizar as</span></div>
<div style="position:absolute;left:109.49px;top:627.08px" class="cls_013"><span class="cls_013">verificações de erros !!</span></div>
<div style="position:absolute;left:76.48px;top:642.94px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:657.86px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:130.75px;top:657.86px" class="cls_013"><span class="cls_013">// primeiro, carregue as estruturas de endereços com</span></div>
<div style="position:absolute;left:109.49px;top:671.85px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:687.70px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:703.55px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:703.55px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:718.48px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:718.48px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:332.21px;top:718.48px" class="cls_013"><span class="cls_013">// usar IPv4 ou IPv6,</span></div>
<div style="position:absolute;left:109.49px;top:732.46px" class="cls_013"><span class="cls_013">o que for</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">37 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:31487px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background038.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:69.85px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:69.85px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:352.35px;top:69.85px" class="cls_013"><span class="cls_013">// preencha meu IP</span></div>
<div style="position:absolute;left:109.49px;top:83.84px" class="cls_013"><span class="cls_013">para mim</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:115.55px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, MYPORT, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:146.33px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:146.33px" class="cls_013"><span class="cls_013">// cria socket, liga-o com bind, e ouve nele com</span></div>
<div style="position:absolute;left:109.49px;top:160.32px" class="cls_013"><span class="cls_013">listen:</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:76.48px;top:191.09px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:191.09px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:205.08px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:220.93px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:220.93px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:236.79px" class="cls_005"><span class="cls_005">listen(sockfd, BACKLOG);</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:268.50px" class="cls_013"><span class="cls_013">// agora aceita uma conexão de entrada:</span></div>
<div style="position:absolute;left:76.48px;top:284.35px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:76.48px;top:300.21px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:300.21px" class="cls_005"><span class="cls_005">addr_size = </span><span class="cls_014">sizeof</span><span class="cls_005"> their_addr;</span></div>
<div style="position:absolute;left:76.48px;top:315.13px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:315.13px" class="cls_005"><span class="cls_005">new_fd = accept(sockfd, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr</span></div>
<div style="position:absolute;left:109.49px;top:329.12px" class="cls_005"><span class="cls_005">*)&their_addr, &addr_size);</span></div>
<div style="position:absolute;left:76.48px;top:344.97px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:76.48px;top:359.89px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:359.89px" class="cls_013"><span class="cls_013">// pronto para se comunicar no descritor de socket</span></div>
<div style="position:absolute;left:109.49px;top:373.88px" class="cls_013"><span class="cls_013">new_fd!</span></div>
<div style="position:absolute;left:76.48px;top:389.74px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:76.48px;top:405.59px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:76.48px;top:421.44px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:60.99px;top:455.48px" class="cls_005"><span class="cls_005">Mais uma vez, note que vamos usar o descritor de socket new_fd para todas as chamadas</span></div>
<div style="position:absolute;left:60.99px;top:471.34px" class="cls_005"><span class="cls_005">send() e recv(). Se você está recebendo apenas uma única conexão, você pode fechar com</span></div>
<div style="position:absolute;left:60.99px;top:487.19px" class="cls_005"><span class="cls_005">close() a escuta de sockfd a  m de evitar mais conexões de entrada na mesma porta, se</span></div>
<div style="position:absolute;left:60.99px;top:502.11px" class="cls_005"><span class="cls_005">você assim desejar.</span></div>
<div style="position:absolute;left:60.99px;top:530.97px" class="cls_007"><span class="cls_007">send() e recv()—Fale comigo, baby!</span></div>
<div style="position:absolute;left:60.99px;top:566.35px" class="cls_005"><span class="cls_005">Estas duas funções são para comunicação através de sockets stream ou sockets datagram</span></div>
<div style="position:absolute;left:60.99px;top:580.33px" class="cls_005"><span class="cls_005">conectados. Se você quiser usar sockets datagram regulares, desconectados, você precisa ver</span></div>
<div style="position:absolute;left:60.99px;top:595.26px" class="cls_005"><span class="cls_005">a seção sobre </span><span class="cls_023">sendto</span><span class="cls_006">()</span><span class="cls_023"> e recvfrom</span><span class="cls_006">()</span><span class="cls_005">, abaixo.</span></div>
<div style="position:absolute;left:60.99px;top:622.30px" class="cls_005"><span class="cls_005">A chamada send():</span></div>
<div style="position:absolute;left:94.85px;top:656.34px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> send(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">const  void</span><span class="cls_005"> *msg, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> flags);</span></div>
<div style="position:absolute;left:60.99px;top:690.38px" class="cls_005"><span class="cls_005">sockfd é o descritor de socket para o qual você quer enviar dados (seja ele o retornado por</span></div>
<div style="position:absolute;left:60.99px;top:706.24px" class="cls_005"><span class="cls_005">socket() ou o que você recebeu com accept().) msg é um ponteiro para os dados que você</span></div>
<div style="position:absolute;left:60.99px;top:722.09px" class="cls_005"><span class="cls_005">deseja enviar, e len é o comprimento desses dados em bytes. Basta de nir flags para 0.</span></div>
<div style="position:absolute;left:60.99px;top:737.94px" class="cls_005"><span class="cls_005">(Veja a página man de send() para mais informações sobre   ags.)</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">38 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:32338px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background039.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Um código de exemplo pode ser:</span></div>
<div style="position:absolute;left:83.19px;top:87.11px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:87.11px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *msg = </span><span class="cls_010">"Beej está aqui!"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:102.96px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:102.96px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> len, bytes_sent;</span></div>
<div style="position:absolute;left:83.19px;top:118.82px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:134.67px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:150.52px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:166.38px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:166.38px" class="cls_005"><span class="cls_005">len = strlen(msg);</span></div>
<div style="position:absolute;left:83.19px;top:182.23px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:182.23px" class="cls_005"><span class="cls_005">bytes_sent = send(sockfd, msg, len, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:198.09px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:213.94px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:229.79px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:60.99px;top:263.83px" class="cls_005"><span class="cls_005">send() retorna o número de bytes realmente enviados—isso pode ser menor do que o número</span></div>
<div style="position:absolute;left:60.99px;top:278.76px" class="cls_005"><span class="cls_005">que você disse para ela enviar! Veja, às vezes você diz para enviar um monte de dados e ela</span></div>
<div style="position:absolute;left:60.99px;top:292.75px" class="cls_005"><span class="cls_005">simplesmente não pode lidar com isso. Ela irá disparar tanto dos dados quanto possível, e</span></div>
<div style="position:absolute;left:60.99px;top:307.67px" class="cls_005"><span class="cls_005">con ará em você para enviar o resto mais tarde. Lembre-se, se o valor retornado por send()</span></div>
<div style="position:absolute;left:60.99px;top:323.52px" class="cls_005"><span class="cls_005">não coincide com o valor em len, cabe a você enviar o resto da string. A boa notícia é a</span></div>
<div style="position:absolute;left:60.99px;top:338.44px" class="cls_005"><span class="cls_005">seguinte: se o pacote for pequeno (menos de 1K ou quase isso) ela irá provavelmente</span></div>
<div style="position:absolute;left:60.99px;top:353.36px" class="cls_005"><span class="cls_005">gerenciar para enviar a coisa toda de uma só vez. Mais uma vez, -1 é devolvido em caso de</span></div>
<div style="position:absolute;left:60.99px;top:369.22px" class="cls_005"><span class="cls_005">erro, e errno é de nido para o número do erro.</span></div>
<div style="position:absolute;left:60.99px;top:396.26px" class="cls_005"><span class="cls_005">A chamada recv() é semelhante em muitos aspectos:</span></div>
<div style="position:absolute;left:94.85px;top:430.30px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> recv(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">void</span><span class="cls_005"> *buf, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> flags);</span></div>
<div style="position:absolute;left:60.99px;top:464.34px" class="cls_005"><span class="cls_005">sockfd é o descritor de socket a ser lido, buf é o buffer para receber as informações, len é o</span></div>
<div style="position:absolute;left:60.99px;top:480.20px" class="cls_005"><span class="cls_005">comprimento máximo do buffer, e flags pode ser novamente ajustada para 0. (Veja a página</span></div>
<div style="position:absolute;left:60.99px;top:496.05px" class="cls_005"><span class="cls_005">man de recv() para obter informações sobre   ags.)</span></div>
<div style="position:absolute;left:60.99px;top:523.10px" class="cls_005"><span class="cls_005">recv() retorna o número de bytes realmente lidos no buffer, ou -1 em caso de erro (com</span></div>
<div style="position:absolute;left:60.99px;top:538.95px" class="cls_005"><span class="cls_005">errno ajustado de acordo.)</span></div>
<div style="position:absolute;left:60.99px;top:566.00px" class="cls_005"><span class="cls_005">Espere! recv() pode retornar 0. Isso só pode signi car uma coisa: o lado remoto terminou a</span></div>
<div style="position:absolute;left:60.99px;top:581.85px" class="cls_005"><span class="cls_005">conexão com você! Um valor de retorno 0 é a forma de recv() informar que isso ocorreu.</span></div>
<div style="position:absolute;left:60.99px;top:607.96px" class="cls_005"><span class="cls_005">Agora, isso foi fácil, não foi? Agora você pode enviar e receber dados em sockets stream! Uau!</span></div>
<div style="position:absolute;left:60.99px;top:621.95px" class="cls_005"><span class="cls_005">Você é um Programador de Rede Unix!</span></div>
<div style="position:absolute;left:60.99px;top:650.80px" class="cls_007"><span class="cls_007">sendto() e recvfrom()—Fale comigo, DGRAM-style</span></div>
<div style="position:absolute;left:60.99px;top:686.18px" class="cls_005"><span class="cls_005">"Isto é tudo muito bom e elegante," Eu ouvi você dizendo, "mas onde é que isto me leva com</span></div>
<div style="position:absolute;left:60.99px;top:700.17px" class="cls_005"><span class="cls_005">sockets datagram desconectados?". Sem problemas, amigo. Nós temos exatamente a coisa.</span></div>
<div style="position:absolute;left:60.99px;top:725.35px" class="cls_005"><span class="cls_005">Como sockets datagram não estão conectados a um host remoto, adivinha qual informação</span></div>
<div style="position:absolute;left:60.99px;top:739.34px" class="cls_005"><span class="cls_005">precisamos fornecer antes de enviar um pacote? Está certo! O endereço de destino! Aqui está</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">39 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:33189px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background040.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">o escopo:</span></div>
<div style="position:absolute;left:94.85px;top:86.17px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sendto(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">const  void</span><span class="cls_005"> *msg, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">unsigned  int</span></div>
<div style="position:absolute;left:123.94px;top:100.16px" class="cls_005"><span class="cls_005">flags,</span></div>
<div style="position:absolute;left:168.71px;top:116.02px" class="cls_008"><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> sockaddr *to, socklen_t tolen);</span></div>
<div style="position:absolute;left:60.99px;top:150.06px" class="cls_005"><span class="cls_005">Como você pode ver, esta chamada é basicamente a mesma que a chamada send() com a</span></div>
<div style="position:absolute;left:60.99px;top:165.91px" class="cls_005"><span class="cls_005">adição de dois outros pedaços de informação. to é um ponteiro para uma struct sockaddr</span></div>
<div style="position:absolute;left:60.99px;top:181.77px" class="cls_005"><span class="cls_005">(que provavelmente será outra struct sockaddr_in ou struct sockaddr_in6 ou</span></div>
<div style="position:absolute;left:60.99px;top:197.62px" class="cls_005"><span class="cls_005">struct sockaddr_storage que você converteu no último minuto), que contém o endereço</span></div>
<div style="position:absolute;left:60.99px;top:213.47px" class="cls_005"><span class="cls_005">IP de destino e porta. tolen, um int no fundo, pode simplesmente ser de nido para sizeof</span></div>
<div style="position:absolute;left:60.99px;top:229.33px" class="cls_005"><span class="cls_005">*to ou sizeof(struct sockaddr_storage).</span></div>
<div style="position:absolute;left:60.99px;top:255.44px" class="cls_005"><span class="cls_005">Para colocar as mãos na estrutura de endereço de destino, você provavelmente a obterá de</span></div>
<div style="position:absolute;left:60.99px;top:270.36px" class="cls_005"><span class="cls_005">getaddrinfo(), ou a partir de recvfrom(), abaixo, ou preencherá manualmente.</span></div>
<div style="position:absolute;left:60.99px;top:297.41px" class="cls_005"><span class="cls_005">Assim como com send(), sendto() retorna o número de bytes realmente enviados (que,</span></div>
<div style="position:absolute;left:60.99px;top:313.26px" class="cls_005"><span class="cls_005">novamente, pode ser menor do que o número de bytes que você disse para ela enviar), ou -1</span></div>
<div style="position:absolute;left:60.99px;top:328.18px" class="cls_005"><span class="cls_005">em caso de erro.</span></div>
<div style="position:absolute;left:60.99px;top:354.30px" class="cls_005"><span class="cls_005">Igualmente semelhantes são recv() e recvfrom(). A sinopse de recvfrom() é:</span></div>
<div style="position:absolute;left:94.85px;top:388.34px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> recvfrom(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">void</span><span class="cls_005"> *buf, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">unsigned  int</span><span class="cls_005"> flags,</span></div>
<div style="position:absolute;left:182.14px;top:404.19px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr *from, </span><span class="cls_008">int</span><span class="cls_005"> *fromlen);</span></div>
<div style="position:absolute;left:60.99px;top:438.23px" class="cls_005"><span class="cls_005">Novamente, isso é exatamente como recv() com a adição de alguns campos. from é um</span></div>
<div style="position:absolute;left:60.99px;top:454.08px" class="cls_005"><span class="cls_005">ponteiro para uma struct sockaddr_storage que será preenchida com o endereço IP e a</span></div>
<div style="position:absolute;left:60.99px;top:469.94px" class="cls_005"><span class="cls_005">porta da máquina de origem. fromlen é um ponteiro para um int local, que deve ser</span></div>
<div style="position:absolute;left:60.99px;top:485.79px" class="cls_005"><span class="cls_005">inicializado para sizeof</span></div>
<div style="position:absolute;left:191.60px;top:485.79px" class="cls_005"><span class="cls_005">*from ou sizeof (struct sockaddr_storage). Quando a</span></div>
<div style="position:absolute;left:60.99px;top:501.65px" class="cls_005"><span class="cls_005">função retornar, fromlen conterá o comprimento do endereço armazenado em from.</span></div>
<div style="position:absolute;left:60.99px;top:528.69px" class="cls_005"><span class="cls_005">recvfrom() retorna o número de bytes recebidos, ou -1 em caso de erro (com errno</span></div>
<div style="position:absolute;left:60.99px;top:543.61px" class="cls_005"><span class="cls_005">ajustado em conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:569.73px" class="cls_005"><span class="cls_005">Então, aqui vai uma pergunta: Por que usamos struct sockaddr_storage como o tipo de</span></div>
<div style="position:absolute;left:60.99px;top:585.58px" class="cls_005"><span class="cls_005">socket? Por que não struct sockaddr_in? Porque, veja, nós não queremos nos amarrar ao</span></div>
<div style="position:absolute;left:60.99px;top:601.43px" class="cls_005"><span class="cls_005">IPv4 ou IPv6. Então, usamos uma struct genérica struct sockaddr_storage, que sabemos</span></div>
<div style="position:absolute;left:60.99px;top:616.36px" class="cls_005"><span class="cls_005">que será grande o su ciente para ambos.</span></div>
<div style="position:absolute;left:60.99px;top:642.47px" class="cls_005"><span class="cls_005">(Então... aqui está uma outra questão: por que struct sockaddr não é grande o su ciente</span></div>
<div style="position:absolute;left:60.99px;top:658.32px" class="cls_005"><span class="cls_005">para qualquer endereço? Nós até de nimos a struct sockaddr_storage de propósito</span></div>
<div style="position:absolute;left:60.99px;top:674.18px" class="cls_005"><span class="cls_005">geral para a struct sockaddr de propósito geral! Parece estranho e redundante, hum. A</span></div>
<div style="position:absolute;left:60.99px;top:689.10px" class="cls_005"><span class="cls_005">resposta é, ela simplesmente não é grande o su ciente, e eu acho que alterá-la neste momento</span></div>
<div style="position:absolute;left:60.99px;top:703.09px" class="cls_005"><span class="cls_005">seria problemático. Então, eles  zeram uma nova.)</span></div>
<div style="position:absolute;left:60.99px;top:729.20px" class="cls_005"><span class="cls_005">Lembre-se, se você usa connect() com um socket datagram, então você pode simplesmente</span></div>
<div style="position:absolute;left:60.99px;top:745.05px" class="cls_005"><span class="cls_005">usar send() e recv() para todas as suas transações. O socket em si ainda é um socket</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">40 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:34040px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background041.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">datagram e os pacotes ainda usam UDP, mas a interface do socket adicionará</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">automaticamente as informações de destino e fonte para você.</span></div>
<div style="position:absolute;left:60.99px;top:96.84px" class="cls_007"><span class="cls_007">close() e shutdown()—Não olhe mais na minha cara!</span></div>
<div style="position:absolute;left:60.99px;top:133.15px" class="cls_005"><span class="cls_005">Uau! Você esteve enviando dados com send() e recebendo com recv() o dia inteiro, e os</span></div>
<div style="position:absolute;left:60.99px;top:148.08px" class="cls_005"><span class="cls_005">obteve. Você está pronto para fechar a conexão em seu descritor de socket. Isso é fácil. Você</span></div>
<div style="position:absolute;left:60.99px;top:163.00px" class="cls_005"><span class="cls_005">pode apenas usar a função normal de descritores de arquivos Unix close():</span></div>
<div style="position:absolute;left:94.85px;top:197.04px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:60.99px;top:230.14px" class="cls_005"><span class="cls_005">Isso evitará mais leituras e gravações no socket. Qualquer um tentando ler ou escrever no</span></div>
<div style="position:absolute;left:60.99px;top:244.13px" class="cls_005"><span class="cls_005">socket na extremidade remota receberá um erro.</span></div>
<div style="position:absolute;left:60.99px;top:269.31px" class="cls_005"><span class="cls_005">Apenas no caso de você querer um pouco mais de controle sobre como o socket fecha, você</span></div>
<div style="position:absolute;left:60.99px;top:284.24px" class="cls_005"><span class="cls_005">pode usar a função shutdown(). Ela permite que você interrompa a comunicação em um</span></div>
<div style="position:absolute;left:60.99px;top:300.09px" class="cls_005"><span class="cls_005">determinado sentido, ou em ambos os sentidos (assim como close() faz). Sinopse:</span></div>
<div style="position:absolute;left:94.85px;top:334.13px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> shutdown(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">int</span><span class="cls_005"> how);</span></div>
<div style="position:absolute;left:60.99px;top:368.17px" class="cls_005"><span class="cls_005">sockfd é o descritor de arquivo socket que você deseja desligar, e how é um dos seguintes:</span></div>
<div style="position:absolute;left:121.68px;top:403.14px" class="cls_025"><span class="cls_025">how</span></div>
<div style="position:absolute;left:300.23px;top:403.14px" class="cls_025"><span class="cls_025">Effect</span></div>
<div style="position:absolute;left:128.75px;top:420.39px" class="cls_005"><span class="cls_005">0</span></div>
<div style="position:absolute;left:157.91px;top:420.39px" class="cls_005"><span class="cls_005">Recebimentos seguintes desativados</span></div>
<div style="position:absolute;left:128.75px;top:437.65px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:157.91px;top:437.65px" class="cls_005"><span class="cls_005">Envios seguintes desativados</span></div>
<div style="position:absolute;left:128.75px;top:454.90px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:157.91px;top:454.90px" class="cls_005"><span class="cls_005">Envios e recebimentos seguintes desativados (como close())</span></div>
<div style="position:absolute;left:60.99px;top:491.27px" class="cls_005"><span class="cls_005">shutdown() retorna 0 em caso de sucesso, e -1 em caso de erro (com errno ajustado em</span></div>
<div style="position:absolute;left:60.99px;top:506.19px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:532.31px" class="cls_005"><span class="cls_005">Se você se atrever a usar shutdown() em sockets datagram desconectados, ela</span></div>
<div style="position:absolute;left:60.99px;top:548.16px" class="cls_005"><span class="cls_005">simplesmente tornará o socket indisponível para posteriores chamadas de send() e recv()</span></div>
<div style="position:absolute;left:60.99px;top:564.01px" class="cls_005"><span class="cls_005">(lembre-se de que você pode usá-las se você usou connect() com sockets datagram.)</span></div>
<div style="position:absolute;left:60.99px;top:591.06px" class="cls_005"><span class="cls_005">É importante notar que shutdown() na verdade não fecha o descritor de arquivo—apenas</span></div>
<div style="position:absolute;left:60.99px;top:606.91px" class="cls_005"><span class="cls_005">altera a sua usabilidade. Para liberar um descritor de socket, você precisa usar close().</span></div>
<div style="position:absolute;left:60.99px;top:633.03px" class="cls_005"><span class="cls_005">Nada mais sobre.</span></div>
<div style="position:absolute;left:60.99px;top:658.21px" class="cls_005"><span class="cls_005">(Exceto para lembrar que, se você estiver usando Windows e Winsock você deverá chamar</span></div>
<div style="position:absolute;left:60.99px;top:673.13px" class="cls_005"><span class="cls_005">closesocket() em vez de close().)</span></div>
<div style="position:absolute;left:60.99px;top:702.91px" class="cls_007"><span class="cls_007">getpeername()—Quem é você?</span></div>
<div style="position:absolute;left:60.99px;top:738.29px" class="cls_005"><span class="cls_005">Essa função é tão fácil.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">41 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:34891px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background042.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">É tão fácil, que eu quase não lhe dei a sua própria secção. Mas aqui está, de qualquer forma.</span></div>
<div style="position:absolute;left:60.99px;top:80.11px" class="cls_005"><span class="cls_005">A função getpeername() informará quem está na outra extremidade de um socket stream</span></div>
<div style="position:absolute;left:60.99px;top:95.03px" class="cls_005"><span class="cls_005">conectado. A sinopse:</span></div>
<div style="position:absolute;left:94.85px;top:128.14px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:158.92px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getpeername(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *addr, </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:123.94px;top:172.91px" class="cls_005"><span class="cls_005">*addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:206.95px" class="cls_005"><span class="cls_005">sockfd é o descritor do socket stream conectado, addr é um ponteiro para uma struct</span></div>
<div style="position:absolute;left:60.99px;top:222.80px" class="cls_005"><span class="cls_005">sockaddr (ou uma struct sockaddr_in) que conterá as informações sobre o outro lado</span></div>
<div style="position:absolute;left:60.99px;top:238.65px" class="cls_005"><span class="cls_005">da conexão, e addrlen é um ponteiro para um int, que deve ser inicializado para sizeof</span></div>
<div style="position:absolute;left:60.99px;top:254.51px" class="cls_005"><span class="cls_005">*addr ou sizeof (struct sockaddr).</span></div>
<div style="position:absolute;left:60.99px;top:281.55px" class="cls_005"><span class="cls_005">A função retorna -1 em caso de erro e de ne errno em conformidade.</span></div>
<div style="position:absolute;left:60.99px;top:308.60px" class="cls_005"><span class="cls_005">Depois de ter seu endereço, você pode usar inet_ntop(), getnameinfo() ou</span></div>
<div style="position:absolute;left:60.99px;top:324.45px" class="cls_005"><span class="cls_005">gethostbyaddr() para imprimir ou obter mais informações. Não, você não pode obter o seu</span></div>
<div style="position:absolute;left:60.99px;top:339.37px" class="cls_005"><span class="cls_005">nome de login. (Ok, ok. Se o outro computador está executando um daemon ident, isso é</span></div>
<div style="position:absolute;left:60.99px;top:353.36px" class="cls_005"><span class="cls_005">possível. Isso, no entanto, está além do escopo deste documento. Con ra </span><span class="cls_023">RFC 1413</span><span class="cls_024"><sup>22</sup></span><span class="cls_005"> para</span></div>
<div style="position:absolute;left:60.99px;top:369.29px" class="cls_005"><span class="cls_005">mais informações.)</span></div>
<div style="position:absolute;left:60.99px;top:398.14px" class="cls_007"><span class="cls_007">gethostname()—Quem sou eu?</span></div>
<div style="position:absolute;left:60.99px;top:434.45px" class="cls_005"><span class="cls_005">Ainda mais fácil do que getpeername() é a função gethostname(). Ela retorna o nome do</span></div>
<div style="position:absolute;left:60.99px;top:449.37px" class="cls_005"><span class="cls_005">computador em que seu programa está sendo executado. O nome pode ser usado por</span></div>
<div style="position:absolute;left:60.99px;top:464.30px" class="cls_005"><span class="cls_005">gethostbyname(), a seguir, para determinar o endereço IP da sua máquina local.</span></div>
<div style="position:absolute;left:60.99px;top:490.41px" class="cls_005"><span class="cls_005">O que poderia ser mais divertido? Eu poderia pensar em algumas coisas, mas elas não</span></div>
<div style="position:absolute;left:60.99px;top:504.40px" class="cls_005"><span class="cls_005">pertencem à programação de sockets. De qualquer forma, aqui está sua composição:</span></div>
<div style="position:absolute;left:60.99px;top:529.58px" class="cls_005"><span class="cls_005">O que poderia ser mais divertido? Eu poderia pensar em algumas coisas, mas elas não</span></div>
<div style="position:absolute;left:60.99px;top:543.57px" class="cls_005"><span class="cls_005">pertencem à programação de sockets. De qualquer forma, aqui está o detalhamento:</span></div>
<div style="position:absolute;left:94.85px;top:576.67px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:94.85px;top:608.38px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> gethostname(</span><span class="cls_008">char</span><span class="cls_005"> *hostname, </span><span class="cls_008">size_t</span><span class="cls_005"> size);</span></div>
<div style="position:absolute;left:60.99px;top:642.42px" class="cls_005"><span class="cls_005">Os argumentos são simples: hostname é um ponteiro para um vetor de caracteres que conterá</span></div>
<div style="position:absolute;left:60.99px;top:658.28px" class="cls_005"><span class="cls_005">o nome do host ao retorno da função, e size é o comprimento em bytes do vetor hostname.</span></div>
<div style="position:absolute;left:60.99px;top:685.32px" class="cls_005"><span class="cls_005">A função retorna 0 ao completar com sucesso, e -1 em caso de erro, estabelecendo errno</span></div>
<div style="position:absolute;left:60.99px;top:700.24px" class="cls_005"><span class="cls_005">como de costume.</span></div>
<div style="position:absolute;left:60.99px;top:728.29px" class="cls_002"><span class="cls_002">Cliente-Servidor Background</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">42 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:35742px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background043.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Isso é o um mundo cliente-servidor, baby. Quase tudo na rede é baseado em processos</span></div>
<div style="position:absolute;left:60.99px;top:68.92px" class="cls_005"><span class="cls_005">clientes falando com processos servidores e vice-versa. Como telnet, por exemplo. Quando</span></div>
<div style="position:absolute;left:60.99px;top:83.84px" class="cls_005"><span class="cls_005">você se conecta a um servidor remoto na porta 23 com o telnet (o cliente), um programa</span></div>
<div style="position:absolute;left:60.99px;top:98.76px" class="cls_005"><span class="cls_005">naquele host (chamado telnetd, o servidor) ganha vida. Ele lida com a conexão telnet de</span></div>
<div style="position:absolute;left:60.99px;top:113.69px" class="cls_005"><span class="cls_005">entrada, prepara um prompt de login, etc.</span></div>
<div style="position:absolute;left:275.21px;top:149.53px" class="cls_017"><span class="cls_017">request</span></div>
<div style="position:absolute;left:189.49px;top:170.17px" class="cls_018"><span class="cls_018">send()</span></div>
<div style="position:absolute;left:363.06px;top:169.64px" class="cls_018"><span class="cls_018">recv()</span></div>
<div style="position:absolute;left:156.90px;top:183.77px" class="cls_019"><span class="cls_019">Client</span></div>
<div style="position:absolute;left:360.41px;top:182.67px" class="cls_019"><span class="cls_019">Server</span></div>
<div style="position:absolute;left:191.07px;top:215.15px" class="cls_018"><span class="cls_018">recv()</span></div>
<div style="position:absolute;left:364.11px;top:214.62px" class="cls_018"><span class="cls_018">send()</span></div>
<div style="position:absolute;left:272.57px;top:234.20px" class="cls_017"><span class="cls_017">response</span></div>
<div style="position:absolute;left:232.28px;top:264.39px" class="cls_005"><span class="cls_005">Interação Cliente-Servidor.</span></div>
<div style="position:absolute;left:60.99px;top:289.57px" class="cls_005"><span class="cls_005">A troca de informações entre cliente e servidor é resumida no diagrama acima.</span></div>
<div style="position:absolute;left:60.99px;top:315.69px" class="cls_005"><span class="cls_005">Note que o par cliente-servidor podem falar SOCK_STREAM, SOCK_DGRAM, ou qualquer outra</span></div>
<div style="position:absolute;left:60.99px;top:330.61px" class="cls_005"><span class="cls_005">coisa (contanto que eles estejam falando a mesma coisa.) Alguns bons exemplos de pares de</span></div>
<div style="position:absolute;left:60.99px;top:345.53px" class="cls_005"><span class="cls_005">cliente-servidor são telnet/telnetd, ftp/ftpd, ou Firefox/Apache. Toda vez que você</span></div>
<div style="position:absolute;left:60.99px;top:361.38px" class="cls_005"><span class="cls_005">usa ftp, há um programa remoto, ftpd, que serve você.</span></div>
<div style="position:absolute;left:60.99px;top:387.50px" class="cls_005"><span class="cls_005">Geralmente, haverá apenas um servidor em uma máquina, e esse servidor lidará com vários</span></div>
<div style="position:absolute;left:60.99px;top:402.42px" class="cls_005"><span class="cls_005">clientes usando fork(). A rotina básica é: o servidor espera por uma conexão, a aceita com</span></div>
<div style="position:absolute;left:60.99px;top:418.27px" class="cls_005"><span class="cls_005">accept(), e cria um novo processo  lho com fork() para lidar com isso. Isso é o que o</span></div>
<div style="position:absolute;left:60.99px;top:433.19px" class="cls_005"><span class="cls_005">nosso servidor de exemplo faz na próxima seção.</span></div>
<div style="position:absolute;left:60.99px;top:460.18px" class="cls_007"><span class="cls_007">Um Servidor Stream Simples</span></div>
<div style="position:absolute;left:60.99px;top:496.49px" class="cls_005"><span class="cls_005">Tudo o que esse servidor faz é enviar a string "Olá, mundo!" por uma conexão stream. Tudo</span></div>
<div style="position:absolute;left:60.99px;top:511.42px" class="cls_005"><span class="cls_005">que você precisa fazer para testar este servidor é executá-lo em uma janela, e com telnet</span></div>
<div style="position:absolute;left:60.99px;top:525.40px" class="cls_005"><span class="cls_005">conectar a ele a partir de outra com:</span></div>
<div style="position:absolute;left:94.85px;top:558.51px" class="cls_005"><span class="cls_005">$ telnet remotehostname 3490</span></div>
<div style="position:absolute;left:60.99px;top:592.55px" class="cls_005"><span class="cls_005">Onde remotehostname é o nome da máquina em que você está executando o servidor.</span></div>
<div style="position:absolute;left:60.99px;top:618.66px" class="cls_023"><span class="cls_023">O códi</span><span class="cls_006">g</span><span class="cls_023">o do servidor</span><span class="cls_024"><sup>23</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:653.71px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:653.71px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:668.63px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:668.63px" class="cls_013"><span class="cls_013">** server.c -- uma demonstração de socket stream como</span></div>
<div style="position:absolute;left:109.49px;top:682.62px" class="cls_013"><span class="cls_013">servidor</span></div>
<div style="position:absolute;left:83.19px;top:698.47px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:698.47px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:714.33px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:730.18px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:730.18px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">43 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:36593px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background044.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:134.20px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:150.06px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:165.91px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:181.77px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:197.62px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/wait.h></span></div>
<div style="position:absolute;left:76.48px;top:213.47px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:213.47px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;signal.h></span></div>
<div style="position:absolute;left:76.48px;top:229.33px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:244.25px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:244.25px" class="cls_012"><span class="cls_012">#define PORT "3490"</span></div>
<div style="position:absolute;left:244.91px;top:244.25px" class="cls_013"><span class="cls_013">// a porta que os clientes usarão</span></div>
<div style="position:absolute;left:109.49px;top:258.24px" class="cls_013"><span class="cls_013">para se conectarem</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:289.01px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:289.01px" class="cls_012"><span class="cls_012">#define BACKLOG 10</span></div>
<div style="position:absolute;left:244.91px;top:289.01px" class="cls_013"><span class="cls_013">// a quantidade de conexões</span></div>
<div style="position:absolute;left:109.49px;top:303.00px" class="cls_013"><span class="cls_013">pendentes a enfileirar</span></div>
<div style="position:absolute;left:76.48px;top:318.86px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:334.71px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:334.71px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> sigchld_handler(</span><span class="cls_008">int</span><span class="cls_005"> s)</span></div>
<div style="position:absolute;left:76.48px;top:350.57px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:350.57px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:365.49px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:365.49px" class="cls_013"><span class="cls_013">// waitpid() pode sobrescrever errno, então nós</span></div>
<div style="position:absolute;left:109.49px;top:379.48px" class="cls_013"><span class="cls_013">salvamos e restauramos:</span></div>
<div style="position:absolute;left:76.48px;top:395.33px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:395.33px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> saved_errno = errno;</span></div>
<div style="position:absolute;left:76.48px;top:411.18px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:427.04px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:427.04px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(waitpid(-</span><span class="cls_009">1</span><span class="cls_005">, NULL, WNOHANG) > </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:442.89px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:76.48px;top:458.75px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:458.75px" class="cls_005"><span class="cls_005">errno = saved_errno;</span></div>
<div style="position:absolute;left:76.48px;top:474.60px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:103.89px;top:474.60px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:490.46px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:76.48px;top:506.31px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:522.16px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:103.89px;top:522.16px" class="cls_013"><span class="cls_013">// obtém sockaddr, IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:538.02px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:103.89px;top:538.02px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *get_in_addr(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *sa)</span></div>
<div style="position:absolute;left:76.48px;top:553.87px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:103.89px;top:553.87px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:569.73px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:569.73px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sa->sa_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:585.58px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:157.61px;top:585.58px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in*)sa)->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:601.43px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:601.43px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:617.29px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:76.48px;top:633.14px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:633.14px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6*)sa)->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:649.00px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:103.89px;top:649.00px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:664.85px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:76.48px;top:680.71px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:103.89px;top:680.71px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:696.56px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:103.89px;top:696.56px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:711.48px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:130.75px;top:711.48px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd, new_fd;</span></div>
<div style="position:absolute;left:271.78px;top:711.48px" class="cls_013"><span class="cls_013">// ouça em sock_fd, nova</span></div>
<div style="position:absolute;left:109.49px;top:725.47px" class="cls_013"><span class="cls_013">conexão em new_fd</span></div>
<div style="position:absolute;left:76.48px;top:741.32px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:741.32px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">44 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:37444px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background045.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:130.75px;top:54.00px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage their_addr; </span><span class="cls_013">// informações</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_013"><span class="cls_013">de endereço do cliente</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:130.75px;top:83.84px" class="cls_005"><span class="cls_005">socklen_t sin_size;</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:130.75px;top:99.70px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sigaction sa;</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:130.75px;top:115.55px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> yes=</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> s[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:130.75px;top:147.26px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:130.75px;top:210.68px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:130.75px;top:226.53px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE; </span><span class="cls_013">// use meu IP</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:76.48px;top:257.31px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:130.75px;top:257.31px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(NULL, PORT, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:271.30px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:286.22px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:157.60px;top:286.22px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:300.21px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:316.06px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:157.61px;top:316.06px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:331.91px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:130.75px;top:331.91px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:347.77px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:76.48px;top:363.62px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:130.75px;top:363.62px" class="cls_013"><span class="cls_013">// loop através de todos os resultados e</span></div>
<div style="position:absolute;left:76.48px;top:379.48px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:130.75px;top:379.48px" class="cls_013"><span class="cls_013">// fazer bind para o primeiro que pudermos</span></div>
<div style="position:absolute;left:76.48px;top:395.33px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:130.75px;top:395.33px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:410.25px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:157.61px;top:410.25px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family,</span></div>
<div style="position:absolute;left:109.49px;top:424.24px" class="cls_005"><span class="cls_005">p->ai_socktype,</span></div>
<div style="position:absolute;left:76.48px;top:440.10px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:211.31px;top:440.10px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:455.95px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:184.46px;top:455.95px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"servidor: socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:471.80px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:184.47px;top:471.80px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:487.66px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:157.61px;top:487.66px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:503.51px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:76.48px;top:518.43px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:157.61px;top:518.43px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR,</span></div>
<div style="position:absolute;left:109.49px;top:532.42px" class="cls_005"><span class="cls_005">&yes,</span></div>
<div style="position:absolute;left:76.48px;top:548.28px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:211.33px;top:548.28px" class="cls_014"><span class="cls_014">sizeof</span><span class="cls_005">(</span><span class="cls_008">int</span><span class="cls_005">)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:564.13px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:184.46px;top:564.13px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"setsockopt"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:579.99px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:184.46px;top:579.99px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:595.84px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:157.61px;top:595.84px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:611.69px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:76.48px;top:626.62px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:157.61px;top:626.62px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (bind(sockfd, p->ai_addr, p->ai_addrlen) ==</span></div>
<div style="position:absolute;left:109.49px;top:640.60px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:656.46px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:184.46px;top:656.46px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:672.31px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:184.46px;top:672.31px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"servidor: bind"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:688.17px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:184.47px;top:688.17px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:704.02px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:157.61px;top:704.02px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:719.87px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:76.48px;top:735.73px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:157.61px;top:735.73px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">45 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:38295px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background046.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:130.75px;top:85.71px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo); </span><span class="cls_013">// tudo feito com essa</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_013"><span class="cls_013">estrutura</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL)</span></div>
<div style="position:absolute;left:238.65px;top:131.41px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:157.60px;top:147.26px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"servidor: falha com bind\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:157.60px;top:163.11px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">95</span></div>
<div style="position:absolute;left:130.75px;top:210.68px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listen(sockfd, BACKLOG) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">96</span></div>
<div style="position:absolute;left:157.60px;top:226.53px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"listen"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">97</span></div>
<div style="position:absolute;left:157.60px;top:242.38px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">98</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">99</span></div>
<div style="position:absolute;left:69.76px;top:289.01px" class="cls_005"><span class="cls_005">100</span></div>
<div style="position:absolute;left:130.75px;top:289.01px" class="cls_005"><span class="cls_005">sa.sa_handler = sigchld_handler; </span><span class="cls_013">// colher todos os</span></div>
<div style="position:absolute;left:109.49px;top:303.00px" class="cls_013"><span class="cls_013">processos mortos</span></div>
<div style="position:absolute;left:69.76px;top:318.86px" class="cls_005"><span class="cls_005">101</span></div>
<div style="position:absolute;left:130.75px;top:318.86px" class="cls_005"><span class="cls_005">sigemptyset(&sa.sa_mask);</span></div>
<div style="position:absolute;left:69.76px;top:334.71px" class="cls_005"><span class="cls_005">102</span></div>
<div style="position:absolute;left:130.75px;top:334.71px" class="cls_005"><span class="cls_005">sa.sa_flags = SA_RESTART;</span></div>
<div style="position:absolute;left:69.76px;top:350.57px" class="cls_005"><span class="cls_005">103</span></div>
<div style="position:absolute;left:130.75px;top:350.57px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sigaction(SIGCHLD, &sa, NULL) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:366.42px" class="cls_005"><span class="cls_005">104</span></div>
<div style="position:absolute;left:157.60px;top:366.42px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"sigaction"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:382.27px" class="cls_005"><span class="cls_005">105</span></div>
<div style="position:absolute;left:157.60px;top:382.27px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:398.13px" class="cls_005"><span class="cls_005">106</span></div>
<div style="position:absolute;left:130.75px;top:398.13px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:413.98px" class="cls_005"><span class="cls_005">107</span></div>
<div style="position:absolute;left:69.76px;top:429.84px" class="cls_005"><span class="cls_005">108</span></div>
<div style="position:absolute;left:130.75px;top:429.84px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"servidor: aguardando por conexões...\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:445.69px" class="cls_005"><span class="cls_005">109</span></div>
<div style="position:absolute;left:69.76px;top:461.55px" class="cls_005"><span class="cls_005">110</span></div>
<div style="position:absolute;left:130.75px;top:461.55px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:212.49px;top:461.55px" class="cls_013"><span class="cls_013">// loop principal de accept()</span></div>
<div style="position:absolute;left:69.76px;top:477.40px" class="cls_005"><span class="cls_005">111</span></div>
<div style="position:absolute;left:157.60px;top:477.40px" class="cls_005"><span class="cls_005">sin_size = </span><span class="cls_014">sizeof</span><span class="cls_005"> their_addr;</span></div>
<div style="position:absolute;left:69.76px;top:492.32px" class="cls_005"><span class="cls_005">112</span></div>
<div style="position:absolute;left:157.60px;top:492.32px" class="cls_005"><span class="cls_005">new_fd = accept(sockfd, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr</span></div>
<div style="position:absolute;left:109.49px;top:506.31px" class="cls_005"><span class="cls_005">*)&their_addr, &sin_size);</span></div>
<div style="position:absolute;left:69.76px;top:522.16px" class="cls_005"><span class="cls_005">113</span></div>
<div style="position:absolute;left:157.61px;top:522.16px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (new_fd == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:538.02px" class="cls_005"><span class="cls_005">114</span></div>
<div style="position:absolute;left:184.46px;top:538.02px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"accept"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:553.87px" class="cls_005"><span class="cls_005">115</span></div>
<div style="position:absolute;left:184.47px;top:553.87px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:569.73px" class="cls_005"><span class="cls_005">116</span></div>
<div style="position:absolute;left:157.61px;top:569.73px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:585.58px" class="cls_005"><span class="cls_005">117</span></div>
<div style="position:absolute;left:69.76px;top:601.43px" class="cls_005"><span class="cls_005">118</span></div>
<div style="position:absolute;left:157.60px;top:601.43px" class="cls_005"><span class="cls_005">inet_ntop(their_addr.ss_family,</span></div>
<div style="position:absolute;left:69.76px;top:617.29px" class="cls_005"><span class="cls_005">119</span></div>
<div style="position:absolute;left:184.46px;top:617.29px" class="cls_005"><span class="cls_005">get_in_addr((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&their_addr),</span></div>
<div style="position:absolute;left:69.76px;top:633.14px" class="cls_005"><span class="cls_005">120</span></div>
<div style="position:absolute;left:184.46px;top:633.14px" class="cls_005"><span class="cls_005">s, </span><span class="cls_014">sizeof</span><span class="cls_005"> s);</span></div>
<div style="position:absolute;left:69.76px;top:648.06px" class="cls_005"><span class="cls_005">121</span></div>
<div style="position:absolute;left:157.60px;top:648.06px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"servidor: tenho uma conexão de %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:662.05px" class="cls_005"><span class="cls_005">s);</span></div>
<div style="position:absolute;left:69.76px;top:677.91px" class="cls_005"><span class="cls_005">122</span></div>
<div style="position:absolute;left:69.76px;top:693.76px" class="cls_005"><span class="cls_005">123</span></div>
<div style="position:absolute;left:157.61px;top:693.76px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (!fork()) { </span><span class="cls_013">// este é o processo filho</span></div>
<div style="position:absolute;left:69.76px;top:708.68px" class="cls_005"><span class="cls_005">124</span></div>
<div style="position:absolute;left:184.46px;top:708.68px" class="cls_005"><span class="cls_005">close(sockfd); </span><span class="cls_013">// processo filho não precisa</span></div>
<div style="position:absolute;left:109.49px;top:722.67px" class="cls_013"><span class="cls_013">ouvir</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">46 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:39146px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background047.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.00px" class="cls_005"><span class="cls_005">125</span></div>
<div style="position:absolute;left:184.47px;top:54.00px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (send(new_fd, </span><span class="cls_010">"Hello, world!"</span><span class="cls_005">, </span><span class="cls_009">13</span><span class="cls_005">, </span><span class="cls_009">0</span><span class="cls_005">) ==</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:69.76px;top:83.84px" class="cls_005"><span class="cls_005">126</span></div>
<div style="position:absolute;left:211.31px;top:83.84px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"send"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:99.70px" class="cls_005"><span class="cls_005">127</span></div>
<div style="position:absolute;left:184.46px;top:99.70px" class="cls_005"><span class="cls_005">close(new_fd);</span></div>
<div style="position:absolute;left:69.76px;top:115.55px" class="cls_005"><span class="cls_005">128</span></div>
<div style="position:absolute;left:184.46px;top:115.55px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:131.41px" class="cls_005"><span class="cls_005">129</span></div>
<div style="position:absolute;left:157.61px;top:131.41px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:147.26px" class="cls_005"><span class="cls_005">130</span></div>
<div style="position:absolute;left:157.60px;top:147.26px" class="cls_005"><span class="cls_005">close(new_fd);</span></div>
<div style="position:absolute;left:265.06px;top:147.26px" class="cls_013"><span class="cls_013">// pai não precisa disso</span></div>
<div style="position:absolute;left:69.76px;top:163.11px" class="cls_005"><span class="cls_005">131</span></div>
<div style="position:absolute;left:130.75px;top:163.11px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:178.97px" class="cls_005"><span class="cls_005">132</span></div>
<div style="position:absolute;left:69.76px;top:194.82px" class="cls_005"><span class="cls_005">133</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:210.68px" class="cls_005"><span class="cls_005">134</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:244.72px" class="cls_005"><span class="cls_005">Caso você esteja curioso, eu tenho o código em uma grande função main() para manter (eu</span></div>
<div style="position:absolute;left:60.99px;top:259.64px" class="cls_005"><span class="cls_005">sinto) a clareza sintática. Sinta-se livre para dividi-la em funções menores, se isso te faz se</span></div>
<div style="position:absolute;left:60.99px;top:273.63px" class="cls_005"><span class="cls_005">sentir melhor.</span></div>
<div style="position:absolute;left:60.99px;top:299.74px" class="cls_005"><span class="cls_005">(Além disso, toda esta coisa de sigaction() pode ser nova para você—isso é ok. O código</span></div>
<div style="position:absolute;left:60.99px;top:314.66px" class="cls_005"><span class="cls_005">que está lá é responsável por colher os processos zumbis que aparecem quando os processos</span></div>
<div style="position:absolute;left:67.18px;top:329.58px" class="cls_005"><span class="cls_005">lhos de fork() terminam. Se você criar lotes de zumbis e não terminá-los, o administrador</span></div>
<div style="position:absolute;left:60.99px;top:344.50px" class="cls_005"><span class="cls_005">do sistema se tornará raivoso.)</span></div>
<div style="position:absolute;left:60.99px;top:369.68px" class="cls_005"><span class="cls_005">Você pode obter os dados desse servidor usando o cliente listado na próxima seção.</span></div>
<div style="position:absolute;left:60.99px;top:396.67px" class="cls_007"><span class="cls_007">Um Cliente Stream Simples</span></div>
<div style="position:absolute;left:60.99px;top:432.05px" class="cls_005"><span class="cls_005">Esse cara é ainda mais fácil que o servidor. Tudo o que este cliente faz é conectar-se ao host</span></div>
<div style="position:absolute;left:60.99px;top:446.04px" class="cls_005"><span class="cls_005">especi cado na linha de comandos, porta 3490. Ele obtém a string que o servidor envia.</span></div>
<div style="position:absolute;left:60.99px;top:471.22px" class="cls_023"><span class="cls_023">O códi</span><span class="cls_006">g</span><span class="cls_023">o do cliente</span><span class="cls_024"><sup>24</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:506.26px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:506.26px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:521.18px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:521.18px" class="cls_013"><span class="cls_013">** client.c -- uma demonstração de socket stream como</span></div>
<div style="position:absolute;left:109.49px;top:535.17px" class="cls_013"><span class="cls_013">cliente</span></div>
<div style="position:absolute;left:83.19px;top:551.03px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:551.03px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:566.88px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:582.74px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:582.74px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:598.59px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:598.59px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:614.44px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:614.44px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:630.30px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:630.30px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:83.19px;top:646.15px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:646.15px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:76.48px;top:662.01px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:662.01px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:677.86px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:677.86px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:693.72px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:693.72px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:709.57px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:709.57px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:725.42px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:741.28px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:741.28px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">47 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:39997px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background048.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_012"><span class="cls_012">#define PORT "3490" </span><span class="cls_013">// a porta onde o cliente conectará</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:101.56px" class="cls_012"><span class="cls_012">#define MAXDATASIZE 100 </span><span class="cls_013">// número máximo de bytes a</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_013"><span class="cls_013">obter por vez</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:147.26px" class="cls_013"><span class="cls_013">// obtém sockaddr, IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:163.11px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *get_in_addr(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *sa)</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:178.97px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sa->sa_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:157.61px;top:210.68px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in*)sa)->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:226.53px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6*)sa)->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:103.89px;top:274.09px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:289.95px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:76.48px;top:305.80px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:103.89px;top:305.80px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">int</span><span class="cls_005"> argc, </span><span class="cls_008">char</span><span class="cls_005"> *argv[])</span></div>
<div style="position:absolute;left:76.48px;top:321.66px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:321.66px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:337.51px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:337.51px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd, numbytes;</span></div>
<div style="position:absolute;left:76.48px;top:353.36px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:353.36px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[MAXDATASIZE];</span></div>
<div style="position:absolute;left:76.48px;top:369.22px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:369.22px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:76.48px;top:385.07px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:385.07px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:76.48px;top:400.93px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:400.93px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> s[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:416.78px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:76.48px;top:432.63px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:432.63px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (argc != </span><span class="cls_009">2</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:448.49px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:157.60px;top:448.49px" class="cls_005"><span class="cls_005">fprintf(stderr,</span><span class="cls_010">"uso: cliente hostname\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:464.34px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:157.60px;top:464.34px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:480.20px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:130.75px;top:480.20px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:496.05px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:76.48px;top:511.91px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:511.91px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:527.76px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:130.75px;top:527.76px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:76.48px;top:543.61px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:543.61px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:559.47px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:76.48px;top:574.39px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:130.75px;top:574.39px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(argv[</span><span class="cls_009">1</span><span class="cls_005">], PORT, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:588.38px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:603.30px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:157.60px;top:603.30px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:617.29px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:633.14px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:157.61px;top:633.14px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:649.00px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:649.00px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:664.85px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:76.48px;top:680.71px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:130.75px;top:680.71px" class="cls_013"><span class="cls_013">// percorrer todos os resultados e</span></div>
<div style="position:absolute;left:76.48px;top:696.56px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:130.75px;top:696.56px" class="cls_013"><span class="cls_013">// conectar-se ao primeiro que pudermos</span></div>
<div style="position:absolute;left:76.48px;top:712.41px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:712.41px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:727.34px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:157.61px;top:727.34px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family,</span></div>
<div style="position:absolute;left:109.49px;top:741.32px" class="cls_005"><span class="cls_005">p->ai_socktype,</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">48 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:40848px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background049.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:211.31px;top:54.93px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:184.46px;top:70.79px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"cliente: socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:184.47px;top:86.64px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:157.61px;top:102.50px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:76.48px;top:133.27px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:157.61px;top:133.27px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (connect(sockfd, p->ai_addr, p->ai_addrlen)</span></div>
<div style="position:absolute;left:109.49px;top:147.26px" class="cls_005"><span class="cls_005">==</span></div>
<div style="position:absolute;left:129.63px;top:147.26px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:184.46px;top:163.11px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:184.46px;top:178.97px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"cliente: connect"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:184.47px;top:194.82px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:157.61px;top:210.68px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:157.61px;top:242.38px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:76.48px;top:289.95px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:130.75px;top:289.95px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:305.80px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:157.60px;top:305.80px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"cliente: falha em connect\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:321.66px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:157.61px;top:321.66px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:337.51px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:130.75px;top:337.51px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:353.36px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:76.48px;top:368.29px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:130.75px;top:368.29px" class="cls_005"><span class="cls_005">inet_ntop(p->ai_family, get_in_addr((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr</span></div>
<div style="position:absolute;left:109.49px;top:382.27px" class="cls_005"><span class="cls_005">*)p->ai_addr),</span></div>
<div style="position:absolute;left:76.48px;top:398.13px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:184.46px;top:398.13px" class="cls_005"><span class="cls_005">s, </span><span class="cls_014">sizeof</span><span class="cls_005"> s);</span></div>
<div style="position:absolute;left:76.48px;top:413.98px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:130.75px;top:413.98px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"cliente: conectando a %s\n"</span><span class="cls_005">, s);</span></div>
<div style="position:absolute;left:76.48px;top:429.84px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:76.48px;top:444.76px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:130.75px;top:444.76px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo); </span><span class="cls_013">// tudo feito com essa</span></div>
<div style="position:absolute;left:109.49px;top:458.75px" class="cls_013"><span class="cls_013">estrutura</span></div>
<div style="position:absolute;left:76.48px;top:474.60px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:76.48px;top:489.52px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:130.75px;top:489.52px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((numbytes = recv(sockfd, buf, MAXDATASIZE-</span><span class="cls_009">1</span><span class="cls_005">, </span><span class="cls_009">0</span><span class="cls_005">))</span></div>
<div style="position:absolute;left:109.49px;top:503.51px" class="cls_005"><span class="cls_005">==</span></div>
<div style="position:absolute;left:129.63px;top:503.51px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:519.37px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:157.60px;top:519.37px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"recv"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:535.22px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:157.60px;top:535.22px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:551.07px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:130.75px;top:551.07px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:566.93px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:76.48px;top:582.78px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:130.75px;top:582.78px" class="cls_005"><span class="cls_005">buf[numbytes] = </span><span class="cls_010">'\0'</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:598.64px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:76.48px;top:614.49px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:130.75px;top:614.49px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"cliente: recebido '%s'\n"</span><span class="cls_005">,buf);</span></div>
<div style="position:absolute;left:76.48px;top:630.35px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:76.48px;top:646.20px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:130.75px;top:646.20px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:662.05px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:76.48px;top:677.91px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:130.75px;top:677.91px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:693.76px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:103.89px;top:693.76px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:727.80px" class="cls_005"><span class="cls_005">Observe que, se você não executar o servidor antes de executar o cliente, connect()</span></div>
<div style="position:absolute;left:60.99px;top:742.72px" class="cls_005"><span class="cls_005">retornará "Conexão recusada". Muito útil.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">49 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:41699px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background050.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:53.07px" class="cls_007"><span class="cls_007">Sockets Datagram</span></div>
<div style="position:absolute;left:60.99px;top:89.38px" class="cls_005"><span class="cls_005">Nós já cobrimos o básico de sockets UDP datagram com a nossa discussão sobre sendto()</span></div>
<div style="position:absolute;left:60.99px;top:105.23px" class="cls_005"><span class="cls_005">e recvfrom(), acima, então eu vou apresentar apenas alguns programas de exemplo:</span></div>
<div style="position:absolute;left:60.99px;top:121.09px" class="cls_005"><span class="cls_005">talker.c e listener.c.</span></div>
<div style="position:absolute;left:60.99px;top:148.13px" class="cls_005"><span class="cls_005">listener  ca em uma máquina à espera de um pacote de entrada na porta 4950. talker</span></div>
<div style="position:absolute;left:60.99px;top:163.06px" class="cls_005"><span class="cls_005">envia um pacote para essa porta, na máquina especi cada, que contém o que o usuário digita</span></div>
<div style="position:absolute;left:60.99px;top:177.04px" class="cls_005"><span class="cls_005">na linha de comando.</span></div>
<div style="position:absolute;left:60.99px;top:202.22px" class="cls_005"><span class="cls_005">Aqui está o </span><span class="cls_023">códi</span><span class="cls_006">g</span><span class="cls_023">o para listener.c</span><span class="cls_024"><sup>25</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:238.20px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:238.20px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:253.12px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:253.12px" class="cls_013"><span class="cls_013">** listener.c -- uma demonstração de socket "servidor"</span></div>
<div style="position:absolute;left:109.49px;top:267.11px" class="cls_013"><span class="cls_013">com datagram</span></div>
<div style="position:absolute;left:83.19px;top:282.96px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:282.96px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:298.82px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:314.67px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:314.67px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:330.53px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:330.53px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:346.38px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:346.38px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:362.24px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:362.24px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:83.19px;top:378.09px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:378.09px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:76.48px;top:393.94px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:393.94px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:409.80px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:409.80px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:425.65px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:425.65px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:441.51px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:441.51px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:457.36px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:457.36px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:473.21px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:488.14px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:488.14px" class="cls_012"><span class="cls_012">#define MYPORT "4950"</span></div>
<div style="position:absolute;left:265.06px;top:488.14px" class="cls_013"><span class="cls_013">// a porta onde os usuários se</span></div>
<div style="position:absolute;left:109.49px;top:502.12px" class="cls_013"><span class="cls_013">conectarão</span></div>
<div style="position:absolute;left:76.48px;top:517.98px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:533.83px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:533.83px" class="cls_012"><span class="cls_012">#define MAXBUFLEN 100</span></div>
<div style="position:absolute;left:76.48px;top:549.69px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:565.54px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:565.54px" class="cls_013"><span class="cls_013">// obtém sockaddr, IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:581.40px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:581.40px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *get_in_addr(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *sa)</span></div>
<div style="position:absolute;left:76.48px;top:597.25px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:597.25px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:613.10px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:613.10px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sa->sa_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:628.96px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:157.61px;top:628.96px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in*)sa)->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:644.81px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:644.81px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:660.67px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:676.52px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:676.52px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6*)sa)->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:692.37px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:692.37px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:708.23px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:76.48px;top:724.08px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:103.89px;top:724.08px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:739.94px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:103.89px;top:739.94px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">50 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:42550px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background051.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> numbytes;</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage their_addr;</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:134.20px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[MAXBUFLEN];</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:150.06px" class="cls_005"><span class="cls_005">socklen_t addr_len;</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:165.91px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> s[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:197.62px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:212.54px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:130.75px;top:212.54px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC; </span><span class="cls_013">// configure com</span></div>
<div style="position:absolute;left:109.49px;top:226.53px" class="cls_013"><span class="cls_013">AF_INET para forçar IPv4</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:130.75px;top:242.38px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_DGRAM;</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE; </span><span class="cls_013">// use meu IP</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:76.48px;top:289.01px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:289.01px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(NULL, MYPORT, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:303.00px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:317.93px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:157.60px;top:317.93px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:331.91px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:347.77px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:157.61px;top:347.77px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:363.62px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:130.75px;top:363.62px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:379.48px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:76.48px;top:394.40px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:394.40px" class="cls_013"><span class="cls_013">// loop através dos resultados e bind para o</span></div>
<div style="position:absolute;left:109.49px;top:408.39px" class="cls_013"><span class="cls_013">primeiro que pudermos</span></div>
<div style="position:absolute;left:76.48px;top:424.24px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:130.75px;top:424.24px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:439.16px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:157.61px;top:439.16px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family,</span></div>
<div style="position:absolute;left:109.49px;top:453.15px" class="cls_005"><span class="cls_005">p->ai_socktype,</span></div>
<div style="position:absolute;left:76.48px;top:469.01px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:211.31px;top:469.01px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:484.86px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:184.46px;top:484.86px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"listener: socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:500.71px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:184.47px;top:500.71px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:516.57px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:157.61px;top:516.57px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:532.42px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:76.48px;top:547.34px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:157.61px;top:547.34px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (bind(sockfd, p->ai_addr, p->ai_addrlen) ==</span></div>
<div style="position:absolute;left:109.49px;top:561.33px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:577.19px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:184.46px;top:577.19px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:593.04px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:184.46px;top:593.04px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"listener: bind"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:608.90px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:184.47px;top:608.90px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:624.75px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:157.61px;top:624.75px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:640.60px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:76.48px;top:656.46px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:157.61px;top:656.46px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:672.31px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:130.75px;top:672.31px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:688.17px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:76.48px;top:704.02px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:130.75px;top:704.02px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:718.94px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:157.60px;top:718.94px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"listener: falha ao fazer bind</span></div>
<div style="position:absolute;left:109.49px;top:732.93px" class="cls_010"><span class="cls_010">para o socket\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">51 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:43401px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background052.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:157.61px;top:54.93px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo);</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:130.75px;top:134.20px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"listener: aguardando por recvfrom...\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:130.75px;top:165.91px" class="cls_005"><span class="cls_005">addr_len = </span><span class="cls_014">sizeof</span><span class="cls_005"> their_addr;</span></div>
<div style="position:absolute;left:76.48px;top:180.83px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:130.75px;top:180.83px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((numbytes = recvfrom(sockfd, buf, MAXBUFLEN-</span><span class="cls_009">1</span><span class="cls_005"> ,</span></div>
<div style="position:absolute;left:109.49px;top:194.82px" class="cls_009"><span class="cls_009">0</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:209.74px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:157.61px;top:209.74px" class="cls_005"><span class="cls_005">(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&their_addr, &addr_len)) ==</span></div>
<div style="position:absolute;left:109.49px;top:223.73px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:157.60px;top:239.59px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"recvfrom"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:157.60px;top:255.44px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:130.75px;top:271.30px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:76.48px;top:303.00px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:130.75px;top:303.00px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"listener: tenho um pacote de %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:318.86px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:157.60px;top:318.86px" class="cls_005"><span class="cls_005">inet_ntop(their_addr.ss_family,</span></div>
<div style="position:absolute;left:76.48px;top:334.71px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:184.46px;top:334.71px" class="cls_005"><span class="cls_005">get_in_addr((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&their_addr),</span></div>
<div style="position:absolute;left:76.48px;top:350.57px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:184.46px;top:350.57px" class="cls_005"><span class="cls_005">s, </span><span class="cls_014">sizeof</span><span class="cls_005"> s));</span></div>
<div style="position:absolute;left:76.48px;top:365.49px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:130.75px;top:365.49px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"listener: o pacote tem %d bytes de</span></div>
<div style="position:absolute;left:109.49px;top:379.48px" class="cls_010"><span class="cls_010">comprimento\n"</span><span class="cls_005">, numbytes);</span></div>
<div style="position:absolute;left:76.48px;top:395.33px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:130.75px;top:395.33px" class="cls_005"><span class="cls_005">buf[numbytes] = </span><span class="cls_010">'\0'</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:410.25px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:130.75px;top:410.25px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"listener: conteúdo do pacote \"%s\"\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:424.24px" class="cls_005"><span class="cls_005">buf);</span></div>
<div style="position:absolute;left:76.48px;top:440.10px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:76.48px;top:455.95px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:130.75px;top:455.95px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:471.80px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:76.48px;top:487.66px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:130.75px;top:487.66px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:503.51px" class="cls_005"><span class="cls_005">95</span></div>
<div style="position:absolute;left:103.89px;top:503.51px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:537.55px" class="cls_005"><span class="cls_005">Observe que, em nossa chamada a getaddrinfo() estamos  nalmente usando</span></div>
<div style="position:absolute;left:60.99px;top:553.41px" class="cls_005"><span class="cls_005">SOCK_DGRAM. Além disso, observe que não há necessidade de listen() ou accept(). Esta</span></div>
<div style="position:absolute;left:60.99px;top:568.33px" class="cls_005"><span class="cls_005">é uma das vantagens de usar sockets datagram desconectados!</span></div>
<div style="position:absolute;left:60.99px;top:593.51px" class="cls_005"><span class="cls_005">Em seguida vem o </span><span class="cls_023">códi</span><span class="cls_006">g</span><span class="cls_023">o fonte de talker.c</span><span class="cls_024"><sup>26</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:629.48px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:629.48px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:645.34px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:645.34px" class="cls_013"><span class="cls_013">** talker.c -- um "cliente" de demonstração com datagram</span></div>
<div style="position:absolute;left:83.19px;top:661.19px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:661.19px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:677.05px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:692.90px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:692.90px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:708.75px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:708.75px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:724.61px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:724.61px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:740.46px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:740.46px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">52 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:44252px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background053.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:134.20px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:165.91px" class="cls_012"><span class="cls_012">#define SERVERPORT "4950"</span></div>
<div style="position:absolute;left:291.92px;top:165.91px" class="cls_013"><span class="cls_013">// a porta onde se conectar</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:197.62px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">int</span><span class="cls_005"> argc, </span><span class="cls_008">char</span><span class="cls_005"> *argv[])</span></div>
<div style="position:absolute;left:76.48px;top:213.47px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:213.47px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:229.33px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:229.33px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:76.48px;top:245.18px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:245.18px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:76.48px;top:261.04px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:261.04px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:76.48px;top:276.89px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:276.89px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> numbytes;</span></div>
<div style="position:absolute;left:76.48px;top:292.75px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:308.60px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:308.60px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (argc != </span><span class="cls_009">3</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:323.52px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:157.60px;top:323.52px" class="cls_005"><span class="cls_005">fprintf(stderr,</span><span class="cls_010">"uso: talker hostname</span></div>
<div style="position:absolute;left:109.49px;top:337.51px" class="cls_010"><span class="cls_010">mensagem\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:353.36px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:157.60px;top:353.36px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:369.22px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:369.22px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:385.07px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:76.48px;top:400.93px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:400.93px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:416.78px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:416.78px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:76.48px;top:432.63px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:432.63px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_DGRAM;</span></div>
<div style="position:absolute;left:76.48px;top:448.49px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:76.48px;top:463.41px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:463.41px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(argv[</span><span class="cls_009">1</span><span class="cls_005">], SERVERPORT, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:477.40px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:492.32px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:157.60px;top:492.32px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:506.31px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:522.16px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:157.61px;top:522.16px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:538.02px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:538.02px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:553.87px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:76.48px;top:568.79px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:568.79px" class="cls_013"><span class="cls_013">// loop atráves de todos os resultados e criar</span></div>
<div style="position:absolute;left:109.49px;top:582.78px" class="cls_013"><span class="cls_013">socket</span></div>
<div style="position:absolute;left:76.48px;top:598.64px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:598.64px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:613.56px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:157.61px;top:613.56px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family,</span></div>
<div style="position:absolute;left:109.49px;top:627.55px" class="cls_005"><span class="cls_005">p->ai_socktype,</span></div>
<div style="position:absolute;left:76.48px;top:643.40px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:211.31px;top:643.40px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:659.26px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:184.46px;top:659.26px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"talker: socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:675.11px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:184.47px;top:675.11px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:690.96px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:157.61px;top:690.96px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:706.82px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:76.48px;top:722.67px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:157.61px;top:722.67px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:738.53px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:130.75px;top:738.53px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">53 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:45103px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background054.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:157.60px;top:85.71px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"talker: falha ao criar o</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_010"><span class="cls_010">socket\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:157.61px;top:115.55px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:76.48px;top:162.18px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:162.18px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((numbytes = sendto(sockfd, argv[</span><span class="cls_009">2</span><span class="cls_005">],</span></div>
<div style="position:absolute;left:109.49px;top:176.17px" class="cls_005"><span class="cls_005">strlen(argv[</span><span class="cls_009">2</span><span class="cls_005">]), </span><span class="cls_009">0</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:191.17px;top:192.02px" class="cls_005"><span class="cls_005">p->ai_addr, p->ai_addrlen)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:157.60px;top:207.88px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"talker: sendto"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:157.60px;top:223.73px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:130.75px;top:239.59px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:130.75px;top:271.30px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo);</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:76.48px;top:302.07px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:130.75px;top:302.07px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"talker: enviados %d bytes para %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:316.06px" class="cls_005"><span class="cls_005">numbytes, argv[</span><span class="cls_009">1</span><span class="cls_005">]);</span></div>
<div style="position:absolute;left:76.48px;top:331.91px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:130.75px;top:331.91px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:347.77px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:76.48px;top:363.62px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:130.75px;top:363.62px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:379.48px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:103.89px;top:379.48px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:413.52px" class="cls_005"><span class="cls_005">E isso é tudo o que existe sobre o assunto! Execute listener em alguma máquina, em</span></div>
<div style="position:absolute;left:60.99px;top:429.37px" class="cls_005"><span class="cls_005">seguida, execute talker em outra. Veja-as se comunicarem! Diversão garantida para toda a</span></div>
<div style="position:absolute;left:60.99px;top:444.29px" class="cls_005"><span class="cls_005">família!</span></div>
<div style="position:absolute;left:60.99px;top:470.40px" class="cls_005"><span class="cls_005">Você nem precisa executar o servidor dessa vez! Você pode rodar talker, por si só, e ele feliz</span></div>
<div style="position:absolute;left:60.99px;top:485.33px" class="cls_005"><span class="cls_005">simplesmente dispara pacotes para o além, onde desaparecem se ninguém estiver pronto com</span></div>
<div style="position:absolute;left:60.99px;top:500.25px" class="cls_005"><span class="cls_005">recvfrom() no outro lado. Lembre-se: dados enviados usando sockets datagram UDP não</span></div>
<div style="position:absolute;left:60.99px;top:515.17px" class="cls_005"><span class="cls_005">possuem garantia de entrega!</span></div>
<div style="position:absolute;left:60.99px;top:540.35px" class="cls_005"><span class="cls_005">Com exceção de um pequeno detalhe que eu já mencionei muitas vezes no passado: sockets</span></div>
<div style="position:absolute;left:60.99px;top:554.34px" class="cls_005"><span class="cls_005">datagram conectados. Eu preciso falar sobre isso aqui, já que estamos na seção datagram do</span></div>
<div style="position:absolute;left:60.99px;top:569.26px" class="cls_005"><span class="cls_005">documento. Digamos que talker chame connect() e especi que o endereço de listener.</span></div>
<div style="position:absolute;left:60.99px;top:585.11px" class="cls_005"><span class="cls_005">Daquele ponto em diante, talker só pode enviar e receber do endereço especi cado por</span></div>
<div style="position:absolute;left:60.99px;top:600.97px" class="cls_005"><span class="cls_005">connect(). Por esta razão, você não precisa usar sendto() e recvfrom(); Você pode</span></div>
<div style="position:absolute;left:60.99px;top:616.82px" class="cls_005"><span class="cls_005">simplesmente usar send() e recv().</span></div>
<div style="position:absolute;left:60.99px;top:645.80px" class="cls_002"><span class="cls_002">Técnicas Ligeiramente Avançadas</span></div>
<div style="position:absolute;left:60.99px;top:688.77px" class="cls_005"><span class="cls_005">Estas técnicas não são realmente avançadas, mas elas saem dos níveis mais básicos já</span></div>
<div style="position:absolute;left:60.99px;top:702.76px" class="cls_005"><span class="cls_005">cobertos. Na verdade, se você chegou até aqui, você deve se considerar bastante realizado nos</span></div>
<div style="position:absolute;left:60.99px;top:716.75px" class="cls_005"><span class="cls_005">fundamentos da programação de rede Unix! Parabéns!</span></div>
<div style="position:absolute;left:60.99px;top:741.93px" class="cls_005"><span class="cls_005">Então, aqui vamos nós para o admirável mundo novo de algumas das coisas mais esotéricas</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">54 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:45954px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background055.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">que você pode querer aprender sobre sockets. Veja agora!</span></div>
<div style="position:absolute;left:60.99px;top:80.99px" class="cls_007"><span class="cls_007">Blocking</span></div>
<div style="position:absolute;left:60.99px;top:116.37px" class="cls_005"><span class="cls_005">Blocking. Você já ouviu falar sobre isso—agora, o que diabos é isso? Em poucas palavras,</span></div>
<div style="position:absolute;left:60.99px;top:130.36px" class="cls_005"><span class="cls_005">"block" é jargão técnico para "sleep". Você provavelmente reparou que quando você executa</span></div>
<div style="position:absolute;left:60.99px;top:145.28px" class="cls_005"><span class="cls_005">listener, acima, ele  ca ali até que um pacote chegue. O que acontece é que ele chamou</span></div>
<div style="position:absolute;left:60.99px;top:161.13px" class="cls_005"><span class="cls_005">recvfrom(), não havia dados e, portanto, por recvfrom() é feito "block" (ou seja, dormir lá)</span></div>
<div style="position:absolute;left:60.99px;top:176.05px" class="cls_005"><span class="cls_005">até que alguns dados cheguem.</span></div>
<div style="position:absolute;left:60.99px;top:202.17px" class="cls_005"><span class="cls_005">Muitas funções fazem block. accept() faz block. Todas funções recv() fazem block. A</span></div>
<div style="position:absolute;left:60.99px;top:217.09px" class="cls_005"><span class="cls_005">razão pela qual elas podem fazer isso é porque elas estão autorizadas. Quando você cria pela</span></div>
<div style="position:absolute;left:60.99px;top:232.01px" class="cls_005"><span class="cls_005">primeira vez o descritor de socket com socket(), o kernel o con gura para blocking. Se você</span></div>
<div style="position:absolute;left:60.99px;top:247.86px" class="cls_005"><span class="cls_005">não quer um socket realizando blocking, você precisa fazer uma chamada a fcntl():</span></div>
<div style="position:absolute;left:83.19px;top:281.90px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:281.90px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:297.76px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:297.76px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;fcntl.h></span></div>
<div style="position:absolute;left:83.19px;top:313.61px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:329.47px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:345.32px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:361.17px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:361.17px" class="cls_005"><span class="cls_005">sockfd = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:377.03px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:377.03px" class="cls_005"><span class="cls_005">fcntl(sockfd, F_SETFL, O_NONBLOCK);</span></div>
<div style="position:absolute;left:83.19px;top:392.88px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:408.74px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:424.59px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:60.99px;top:457.70px" class="cls_005"><span class="cls_005">Ao de nir um socket para non-blocking, você pode efetivamente "consultar" o socket para obter</span></div>
<div style="position:absolute;left:60.99px;top:471.69px" class="cls_005"><span class="cls_005">informações. Se você tenta ler de um socket non-blocking e não houverem dados lá, não será</span></div>
<div style="position:absolute;left:60.99px;top:486.61px" class="cls_005"><span class="cls_005">permitido fazer blocking—ele retornará -1 e errno será de nido como EAGAIN ou</span></div>
<div style="position:absolute;left:60.99px;top:502.46px" class="cls_005"><span class="cls_005">EWOULDBLOCK.</span></div>
<div style="position:absolute;left:60.99px;top:529.51px" class="cls_005"><span class="cls_005">(Espere—ele pode retornar EAGAIN ou EWOULDBLOCK? Por qual você veri cará? A</span></div>
<div style="position:absolute;left:60.99px;top:544.43px" class="cls_005"><span class="cls_005">especi cação na verdade não diz qual o seu sistema retornará, então para a portabilidade,</span></div>
<div style="position:absolute;left:60.99px;top:558.42px" class="cls_005"><span class="cls_005">con ra ambos.)</span></div>
<div style="position:absolute;left:60.99px;top:583.60px" class="cls_005"><span class="cls_005">De um modo geral, no entanto, este tipo de consulta é uma má idéia. Se você colocar seu</span></div>
<div style="position:absolute;left:60.99px;top:597.59px" class="cls_005"><span class="cls_005">programa em uma espera ocupada procurando dados sobre o socket, você drenará tempo de</span></div>
<div style="position:absolute;left:60.99px;top:611.58px" class="cls_005"><span class="cls_005">CPU de modo antiquado. Uma solução mais elegante para veri car se há dados esperando</span></div>
<div style="position:absolute;left:60.99px;top:626.50px" class="cls_005"><span class="cls_005">para serem lidos vem na seção a seguir em poll().</span></div>
<div style="position:absolute;left:60.99px;top:656.28px" class="cls_007"><span class="cls_007">poll()—Multiplexação Síncrona de E/S</span></div>
<div style="position:absolute;left:60.99px;top:691.66px" class="cls_005"><span class="cls_005">O que você realmente deseja fazer é, de alguma forma, monitorar um monte de sockets de</span></div>
<div style="position:absolute;left:60.99px;top:705.65px" class="cls_005"><span class="cls_005">uma só vez e depois lidar com aqueles que têm dados prontos. Dessa forma, você não precisa</span></div>
<div style="position:absolute;left:60.99px;top:719.64px" class="cls_005"><span class="cls_005">consultar continuamente todos os sockets para ver quais estão prontos para leitura.</span></div>
<div style="position:absolute;left:88.97px;top:745.75px" class="cls_005"><span class="cls_005">Uma palavra de aviso: poll() é terrivelmente lento quando se trata de um número</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">55 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:46805px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background056.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:88.97px;top:54.00px" class="cls_005"><span class="cls_005">gigantesco de conexões. Nessas circunstâncias, você obterá melhor desempenho</span></div>
<div style="position:absolute;left:88.97px;top:67.99px" class="cls_005"><span class="cls_005">com uma biblioteca de eventos como </span><span class="cls_023">libevent</span><span class="cls_024"><sup>27</sup></span><span class="cls_005"> que tenta usar o método mais</span></div>
<div style="position:absolute;left:88.97px;top:83.91px" class="cls_005"><span class="cls_005">rápido possível disponível em seu sistema.</span></div>
<div style="position:absolute;left:60.99px;top:109.09px" class="cls_005"><span class="cls_005">Então, como você pode evitar as consultas? Não como simples ironia, você pode evitar usando</span></div>
<div style="position:absolute;left:60.99px;top:124.01px" class="cls_005"><span class="cls_005">a chamada de sistema poll(). Em poucas palavras, pediremos ao sistema operacional que</span></div>
<div style="position:absolute;left:60.99px;top:138.94px" class="cls_005"><span class="cls_005">faça todo o trabalho sujo para nós e avise-nos quando alguns dados estiverem prontos para</span></div>
<div style="position:absolute;left:60.99px;top:152.93px" class="cls_005"><span class="cls_005">leitura em quais sockets. Enquanto isso, nosso processo pode dormir, economizando recursos</span></div>
<div style="position:absolute;left:60.99px;top:166.91px" class="cls_005"><span class="cls_005">do sistema.</span></div>
<div style="position:absolute;left:60.99px;top:193.03px" class="cls_005"><span class="cls_005">O plano geral do jogo é manter uma matriz de struct pollfds com informações sobre</span></div>
<div style="position:absolute;left:60.99px;top:207.95px" class="cls_005"><span class="cls_005">quais descritores de sockets queremos monitorar e que tipo de eventos queremos monitorar. O</span></div>
<div style="position:absolute;left:60.99px;top:222.87px" class="cls_005"><span class="cls_005">sistema operacional bloqueará a chamada poll() até que um desses eventos ocorra (por</span></div>
<div style="position:absolute;left:60.99px;top:237.79px" class="cls_005"><span class="cls_005">exemplo, "socket pronto para leitura!") ou até que ocorra um tempo limite especi cado pelo</span></div>
<div style="position:absolute;left:60.99px;top:251.78px" class="cls_005"><span class="cls_005">usuário.</span></div>
<div style="position:absolute;left:60.99px;top:277.89px" class="cls_005"><span class="cls_005">Útilmente, um socket listen() retornará "pronto para ler" quando uma nova conexão de</span></div>
<div style="position:absolute;left:60.99px;top:293.75px" class="cls_005"><span class="cls_005">entrada estiver pronta para ser aceita com accept().</span></div>
<div style="position:absolute;left:60.99px;top:319.86px" class="cls_005"><span class="cls_005">Isso é divertido o su ciente. Como usamos isso?</span></div>
<div style="position:absolute;left:94.85px;top:352.97px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;poll.h></span></div>
<div style="position:absolute;left:94.85px;top:384.68px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> poll(</span><span class="cls_014">struct</span><span class="cls_005"> pollfd fds[], nfds_t nfds, </span><span class="cls_008">int</span><span class="cls_005"> timeout);</span></div>
<div style="position:absolute;left:60.99px;top:418.72px" class="cls_005"><span class="cls_005">fds é nossa matriz de informações (que sockets devem ser monitoradas para quê), nfds é a</span></div>
<div style="position:absolute;left:60.99px;top:434.57px" class="cls_005"><span class="cls_005">contagem de elementos na matriz e timeout é um tempo limite em milissegundos. Retorna o</span></div>
<div style="position:absolute;left:60.99px;top:449.49px" class="cls_005"><span class="cls_005">número de elementos na matriz que tiveram um evento ocorrendo.</span></div>
<div style="position:absolute;left:60.99px;top:475.60px" class="cls_005"><span class="cls_005">Vamos dar uma olhada nessa struct:</span></div>
<div style="position:absolute;left:94.85px;top:509.64px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> pollfd {</span></div>
<div style="position:absolute;left:121.71px;top:525.50px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fd;</span></div>
<div style="position:absolute;left:229.15px;top:525.50px" class="cls_013"><span class="cls_013">// o descritor de socket</span></div>
<div style="position:absolute;left:121.71px;top:540.42px" class="cls_008"><span class="cls_008">short</span><span class="cls_005"> events;</span></div>
<div style="position:absolute;left:229.14px;top:540.42px" class="cls_013"><span class="cls_013">// bitmap de eventos em que estamos</span></div>
<div style="position:absolute;left:123.94px;top:554.41px" class="cls_013"><span class="cls_013">interessados</span></div>
<div style="position:absolute;left:121.71px;top:569.33px" class="cls_008"><span class="cls_008">short</span><span class="cls_005"> revents;</span></div>
<div style="position:absolute;left:229.14px;top:569.33px" class="cls_013"><span class="cls_013">// quando poll() retorna, bitmap de</span></div>
<div style="position:absolute;left:123.94px;top:583.32px" class="cls_013"><span class="cls_013">ocorridos</span></div>
<div style="position:absolute;left:94.85px;top:599.17px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:633.21px" class="cls_005"><span class="cls_005">Então, teremos uma matriz dessas e veremos o campo fd para cada elemento em um</span></div>
<div style="position:absolute;left:60.99px;top:648.13px" class="cls_005"><span class="cls_005">descritor de socket que estamos interessados em monitorar. E então de niremos o campo</span></div>
<div style="position:absolute;left:60.99px;top:663.06px" class="cls_005"><span class="cls_005">events para indicar o tipo de evento em que estamos interessados.</span></div>
<div style="position:absolute;left:60.99px;top:690.10px" class="cls_005"><span class="cls_005">O campo events é um bitwise-OR como se segue:</span></div>
<div style="position:absolute;left:91.28px;top:724.14px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:302.76px;top:724.14px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">56 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:47656px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background057.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:91.28px;top:61.93px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:302.76px;top:61.93px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:84.25px;top:78.25px" class="cls_005"><span class="cls_005">POLLIN    Avise-me quando os dados estiverem prontos para recv() neste socket.</span></div>
<div style="position:absolute;left:84.25px;top:95.50px" class="cls_005"><span class="cls_005">POLLOUT   Avise-me quando eu puder utilizar send() neste socket sem bloquear.</span></div>
<div style="position:absolute;left:60.99px;top:131.87px" class="cls_005"><span class="cls_005">Depois de ter seu array de struct pollfds em ordem, você pode passá-lo para poll(),</span></div>
<div style="position:absolute;left:60.99px;top:146.79px" class="cls_005"><span class="cls_005">passando também o tamanho do array, assim como um valor de tempo limite em</span></div>
<div style="position:absolute;left:60.99px;top:160.78px" class="cls_005"><span class="cls_005">milissegundos. (Você pode especi car um tempo limite negativo para aguardar uma</span></div>
<div style="position:absolute;left:60.99px;top:174.77px" class="cls_005"><span class="cls_005">eternidade.)</span></div>
<div style="position:absolute;left:60.99px;top:200.88px" class="cls_005"><span class="cls_005">Após o retorno de poll(), você pode veri car o campo revents para ver se POLLIN ou</span></div>
<div style="position:absolute;left:60.99px;top:216.74px" class="cls_005"><span class="cls_005">POLLOUT está de nido, indicando que o evento ocorreu.</span></div>
<div style="position:absolute;left:60.99px;top:243.78px" class="cls_005"><span class="cls_005">(Na verdade, você pode fazer mais com a chamada poll(). Consulte a </span><span class="cls_023">pá</span><span class="cls_006">g</span><span class="cls_023">ina de manual</span></div>
<div style="position:absolute;left:60.99px;top:259.64px" class="cls_023"><span class="cls_023">poll</span><span class="cls_006">()</span><span class="cls_005">, abaixo, para mais detalhes.)</span></div>
<div style="position:absolute;left:60.99px;top:285.75px" class="cls_005"><span class="cls_005">Aqui está </span><span class="cls_023">um exemplo</span><span class="cls_024"><sup>28</sup></span><span class="cls_005"> onde esperaremos 2,5 segundos para que os dados estejam prontos</span></div>
<div style="position:absolute;left:60.99px;top:302.61px" class="cls_005"><span class="cls_005">para leitura da entrada padrão, ou seja, quando você pressionar RETURN:</span></div>
<div style="position:absolute;left:83.19px;top:336.65px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:336.65px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:352.50px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:352.50px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;poll.h></span></div>
<div style="position:absolute;left:83.19px;top:368.36px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:384.21px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:384.21px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:83.19px;top:400.06px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:400.06px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:414.99px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:414.99px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> pollfd pfds[</span><span class="cls_009">1</span><span class="cls_005">]; </span><span class="cls_013">// Mais se você quiser</span></div>
<div style="position:absolute;left:109.49px;top:428.97px" class="cls_013"><span class="cls_013">monitorar mais</span></div>
<div style="position:absolute;left:83.19px;top:444.83px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:460.68px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:460.68px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].fd = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:298.64px;top:460.68px" class="cls_013"><span class="cls_013">// Entrada padrão</span></div>
<div style="position:absolute;left:83.19px;top:475.60px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:475.60px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].events = POLLIN; </span><span class="cls_013">// Diga-me quando estiver</span></div>
<div style="position:absolute;left:109.49px;top:489.59px" class="cls_013"><span class="cls_013">pronto para ler</span></div>
<div style="position:absolute;left:76.48px;top:505.45px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:520.37px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:520.37px" class="cls_013"><span class="cls_013">// Se você precisava monitorar outras coisas,</span></div>
<div style="position:absolute;left:109.49px;top:534.36px" class="cls_013"><span class="cls_013">também:</span></div>
<div style="position:absolute;left:76.48px;top:549.28px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:549.28px" class="cls_013"><span class="cls_013">//pfds[1].fd = some_socket; // Algum descritor de</span></div>
<div style="position:absolute;left:109.49px;top:563.27px" class="cls_013"><span class="cls_013">socket</span></div>
<div style="position:absolute;left:76.48px;top:578.19px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:578.19px" class="cls_013"><span class="cls_013">//pfds[1].events = POLLIN;</span></div>
<div style="position:absolute;left:318.74px;top:578.19px" class="cls_013"><span class="cls_013">// Diga-me quando pronto</span></div>
<div style="position:absolute;left:109.49px;top:592.18px" class="cls_013"><span class="cls_013">para leitura</span></div>
<div style="position:absolute;left:76.48px;top:608.03px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:622.95px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:622.95px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Pressione RETURN ou aguarde 2,5 segundos</span></div>
<div style="position:absolute;left:109.49px;top:636.94px" class="cls_010"><span class="cls_010">pelo timeout\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:652.80px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:667.72px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:667.72px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> num_events = poll(pfds, </span><span class="cls_009">1</span><span class="cls_005">, </span><span class="cls_009">2500</span><span class="cls_005">); </span><span class="cls_013">// timeout de</span></div>
<div style="position:absolute;left:109.49px;top:681.71px" class="cls_013"><span class="cls_013">2.5 segundos</span></div>
<div style="position:absolute;left:76.48px;top:697.56px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:713.42px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:713.42px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (num_events == </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:729.27px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:157.60px;top:729.27px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Poll sofreu timeout!\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">57 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:48507px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background058.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:157.61px;top:70.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> pollin_happened = pfds[</span><span class="cls_009">0</span><span class="cls_005">].revents & POLLIN;</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:157.61px;top:102.50px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (pollin_happened) {</span></div>
<div style="position:absolute;left:76.48px;top:117.42px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:184.46px;top:117.42px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Descritor %d pronto para leitura\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:131.41px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].fd);</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:157.61px;top:147.26px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:76.48px;top:162.18px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:184.46px;top:162.18px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Ocorreu um evento inesperado: %d\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:176.17px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].revents);</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:157.61px;top:192.02px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:207.88px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:239.59px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:255.44px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:289.48px" class="cls_005"><span class="cls_005">Observe novamente que poll() retorna o número de elementos na matriz pfds para os quais</span></div>
<div style="position:absolute;left:60.99px;top:304.40px" class="cls_005"><span class="cls_005">os eventos ocorreram. Ela não informa quais elementos da matriz (você ainda precisa procurar</span></div>
<div style="position:absolute;left:60.99px;top:319.32px" class="cls_005"><span class="cls_005">por isso), mas informa quantas entradas têm um campo revents diferente de zero (para que</span></div>
<div style="position:absolute;left:60.99px;top:334.25px" class="cls_005"><span class="cls_005">você pare de procurar depois de encontrar muitos).</span></div>
<div style="position:absolute;left:60.99px;top:359.43px" class="cls_005"><span class="cls_005">Algumas perguntas podem surgir aqui: como adicionar novos descritores de arquivo ao</span></div>
<div style="position:absolute;left:60.99px;top:374.35px" class="cls_005"><span class="cls_005">conjunto que passo para poll()? Para isso, basta ter espaço su ciente na matriz para tudo o</span></div>
<div style="position:absolute;left:60.99px;top:390.20px" class="cls_005"><span class="cls_005">que você precisa ou realoque com realloc() mais espaço, conforme necessário.</span></div>
<div style="position:absolute;left:60.99px;top:416.31px" class="cls_005"><span class="cls_005">E quanto a excluir itens do conjunto? Para isso, você pode copiar o último elemento da matriz</span></div>
<div style="position:absolute;left:60.99px;top:430.30px" class="cls_005"><span class="cls_005">por cima do que você está excluindo. E depois passe menos um como a contagem para</span></div>
<div style="position:absolute;left:60.99px;top:445.22px" class="cls_005"><span class="cls_005">poll(). Outra opção é que você pode de nir qualquer campo fd como um número negativo e</span></div>
<div style="position:absolute;left:60.99px;top:461.08px" class="cls_005"><span class="cls_005">poll() irá ignorá-lo.</span></div>
<div style="position:absolute;left:60.99px;top:487.19px" class="cls_005"><span class="cls_005">Como podemos reunir tudo isso em um servidor de bate-papo em que você possa executar</span></div>
<div style="position:absolute;left:60.99px;top:502.11px" class="cls_005"><span class="cls_005">telnet contra?</span></div>
<div style="position:absolute;left:60.99px;top:528.23px" class="cls_005"><span class="cls_005">O que faremos é iniciar um socket ouvinte e adicioná-lo ao conjunto de descritores de arquivos</span></div>
<div style="position:absolute;left:60.99px;top:543.15px" class="cls_005"><span class="cls_005">de poll(). (Ele será exibido como pronto para leitura quando houver uma conexão de</span></div>
<div style="position:absolute;left:60.99px;top:558.07px" class="cls_005"><span class="cls_005">entrada.)</span></div>
<div style="position:absolute;left:60.99px;top:584.18px" class="cls_005"><span class="cls_005">Em seguida, adicionaremos novas conexões ao nosso array struct pollfd. E cresceremos</span></div>
<div style="position:absolute;left:60.99px;top:599.10px" class="cls_005"><span class="cls_005">dinamicamente se  carmos sem espaço.</span></div>
<div style="position:absolute;left:60.99px;top:624.28px" class="cls_005"><span class="cls_005">Quando uma conexão é fechada, nós a removeremos da array.</span></div>
<div style="position:absolute;left:60.99px;top:649.46px" class="cls_005"><span class="cls_005">E quando uma conexão estiver pronta para leitura, leremos os dados dela e enviaremos esses</span></div>
<div style="position:absolute;left:60.99px;top:663.45px" class="cls_005"><span class="cls_005">dados para todas as outras conexões para que eles possam ver o que os outros usuários</span></div>
<div style="position:absolute;left:60.99px;top:677.44px" class="cls_005"><span class="cls_005">digitaram.</span></div>
<div style="position:absolute;left:60.99px;top:702.62px" class="cls_005"><span class="cls_005">Portanto </span><span class="cls_023">este servidor poll</span><span class="cls_024"><sup>29</sup></span><span class="cls_005"> uma tentativa. Execute-o em uma janela e, em seguida, telnet</span></div>
<div style="position:absolute;left:60.99px;top:720.41px" class="cls_005"><span class="cls_005">localhost 9034 de várias outras janelas do terminal. Você deve poder ver o que você digite</span></div>
<div style="position:absolute;left:60.99px;top:735.33px" class="cls_005"><span class="cls_005">uma janela nas outras (depois que você pressionar RETURN).</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">58 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:49358px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background059.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Não apenas isso, mas se você pressionar CTRL-] e digitar quit para sair do telnet, o</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">servidor deverá detectar a desconexão e remover você do array de descritores de arquivos.</span></div>
<div style="position:absolute;left:83.19px;top:102.96px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:102.96px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:117.88px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:117.88px" class="cls_013"><span class="cls_013">** pollserver.c -- um servidor de bate-papo com várias</span></div>
<div style="position:absolute;left:109.49px;top:131.87px" class="cls_013"><span class="cls_013">pessoas</span></div>
<div style="position:absolute;left:83.19px;top:147.73px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:147.73px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:163.58px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:179.43px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:179.43px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:195.29px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:195.29px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:211.14px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:211.14px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:83.19px;top:227.00px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:227.00px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:242.85px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:242.85px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:258.71px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:258.71px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:274.56px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:274.56px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:290.41px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:290.41px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:306.27px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:306.27px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:322.12px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:322.12px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;poll.h></span></div>
<div style="position:absolute;left:76.48px;top:337.98px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:353.83px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:353.83px" class="cls_012"><span class="cls_012">#define PORT "9034"</span></div>
<div style="position:absolute;left:251.63px;top:353.83px" class="cls_013"><span class="cls_013">// Porta em que estamos ouvindo</span></div>
<div style="position:absolute;left:76.48px;top:369.68px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:385.54px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:385.54px" class="cls_013"><span class="cls_013">// Obtenha sockaddr, IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:401.39px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:401.39px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *get_in_addr(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *sa)</span></div>
<div style="position:absolute;left:76.48px;top:417.25px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:417.25px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:433.10px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:433.10px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sa->sa_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:448.96px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:157.61px;top:448.96px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in*)sa)->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:464.81px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:464.81px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:480.66px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:496.52px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:496.52px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6*)sa)->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:512.37px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:103.89px;top:512.37px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:528.23px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:544.08px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:544.08px" class="cls_013"><span class="cls_013">// Retornar um socket de escuta</span></div>
<div style="position:absolute;left:76.48px;top:559.93px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:103.89px;top:559.93px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> get_listener_socket(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:575.79px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:103.89px;top:575.79px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:591.64px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:591.64px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> listener;</span></div>
<div style="position:absolute;left:251.62px;top:591.64px" class="cls_013"><span class="cls_013">// Descritor de socket de escuta</span></div>
<div style="position:absolute;left:76.48px;top:606.56px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:606.56px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> yes=</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:251.62px;top:606.56px" class="cls_013"><span class="cls_013">// Para setsockopt() SO_REUSEADDR,</span></div>
<div style="position:absolute;left:109.49px;top:620.55px" class="cls_013"><span class="cls_013">abaixo</span></div>
<div style="position:absolute;left:76.48px;top:636.41px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:636.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:76.48px;top:652.26px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:76.48px;top:668.12px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:668.12px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *ai, *p;</span></div>
<div style="position:absolute;left:76.48px;top:683.97px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:76.48px;top:699.82px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:699.82px" class="cls_013"><span class="cls_013">// Pegue um socket e ligue-o</span></div>
<div style="position:absolute;left:76.48px;top:715.68px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:715.68px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:731.53px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:731.53px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">59 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:50209px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background060.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:130.75px;top:85.71px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(NULL, PORT, &hints, &ai)) !=</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_009"><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:114.62px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:157.60px;top:114.62px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"selectserver: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:128.61px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:144.46px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:157.60px;top:144.46px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:130.75px;top:160.32px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:130.75px;top:192.02px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = ai; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:206.95px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:157.60px;top:206.95px" class="cls_005"><span class="cls_005">listener = socket(p->ai_family, p->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:220.93px" class="cls_005"><span class="cls_005">p->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:157.61px;top:236.79px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listener &lt; </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:184.47px;top:252.64px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:157.61px;top:268.50px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:284.35px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:76.48px;top:299.27px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:157.61px;top:299.27px" class="cls_013"><span class="cls_013">// Perder a maldita mensagem de erro "endereço</span></div>
<div style="position:absolute;left:109.49px;top:313.26px" class="cls_013"><span class="cls_013">já em uso"</span></div>
<div style="position:absolute;left:76.48px;top:328.18px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:157.60px;top:328.18px" class="cls_005"><span class="cls_005">setsockopt(listener, SOL_SOCKET, SO_REUSEADDR,</span></div>
<div style="position:absolute;left:109.49px;top:342.17px" class="cls_005"><span class="cls_005">&yes, </span><span class="cls_014">sizeof</span><span class="cls_005">(</span><span class="cls_008">int</span><span class="cls_005">));</span></div>
<div style="position:absolute;left:76.48px;top:358.03px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:76.48px;top:372.95px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:157.61px;top:372.95px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (bind(listener, p->ai_addr, p->ai_addrlen) &lt;</span></div>
<div style="position:absolute;left:109.49px;top:386.94px" class="cls_009"><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:402.79px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:184.46px;top:402.79px" class="cls_005"><span class="cls_005">close(listener);</span></div>
<div style="position:absolute;left:76.48px;top:418.65px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:184.47px;top:418.65px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:434.50px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:157.61px;top:434.50px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:450.35px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:76.48px;top:466.21px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:157.61px;top:466.21px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:482.06px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:130.75px;top:482.06px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:497.92px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:76.48px;top:512.84px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:130.75px;top:512.84px" class="cls_013"><span class="cls_013">// Se chegamos aqui, significa que não ficamos</span></div>
<div style="position:absolute;left:109.49px;top:526.83px" class="cls_013"><span class="cls_013">presos</span></div>
<div style="position:absolute;left:76.48px;top:542.68px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:130.75px;top:542.68px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:558.54px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:157.61px;top:558.54px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> -</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:574.39px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:130.75px;top:574.39px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:590.24px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:76.48px;top:606.10px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:130.75px;top:606.10px" class="cls_005"><span class="cls_005">freeaddrinfo(ai); </span><span class="cls_013">// Tudo feito com isso</span></div>
<div style="position:absolute;left:76.48px;top:621.95px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:76.48px;top:637.81px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:130.75px;top:637.81px" class="cls_013"><span class="cls_013">// Listen</span></div>
<div style="position:absolute;left:76.48px;top:653.66px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:130.75px;top:653.66px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listen(listener, </span><span class="cls_009">10</span><span class="cls_005">) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:669.51px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:157.61px;top:669.51px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> -</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:685.37px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:130.75px;top:685.37px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:701.22px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:76.48px;top:717.08px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:130.75px;top:717.08px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> listener;</span></div>
<div style="position:absolute;left:76.48px;top:732.93px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:103.89px;top:732.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">60 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:51060px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background061.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_013"><span class="cls_013">// Inclua um novo descritor de arquivo no conjunto</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:103.89px;top:85.71px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> add_to_pfds(</span><span class="cls_014">struct</span><span class="cls_005"> pollfd *pfds[], </span><span class="cls_008">int</span><span class="cls_005"> newfd, </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_005"><span class="cls_005">*fd_count, </span><span class="cls_008">int</span><span class="cls_005"> *fd_size)</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:103.89px;top:115.55px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:130.47px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:130.75px;top:130.47px" class="cls_013"><span class="cls_013">// Se não tivermos espaço, adicione mais espaço na</span></div>
<div style="position:absolute;left:109.49px;top:144.46px" class="cls_013"><span class="cls_013">matriz pfds</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:130.75px;top:160.32px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (*fd_count == *fd_size) {</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:157.60px;top:176.17px" class="cls_005"><span class="cls_005">*fd_size *= </span><span class="cls_009">2</span><span class="cls_005">; </span><span class="cls_013">// Dobrar</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:76.48px;top:206.95px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:157.60px;top:206.95px" class="cls_005"><span class="cls_005">*pfds = realloc(*pfds, </span><span class="cls_014">sizeof</span><span class="cls_005">(**pfds) *</span></div>
<div style="position:absolute;left:109.49px;top:220.93px" class="cls_005"><span class="cls_005">(*fd_size));</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:130.75px;top:236.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:130.75px;top:268.50px" class="cls_005"><span class="cls_005">(*pfds)[*fd_count].fd = newfd;</span></div>
<div style="position:absolute;left:76.48px;top:283.42px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:130.75px;top:283.42px" class="cls_005"><span class="cls_005">(*pfds)[*fd_count].events = POLLIN; </span><span class="cls_013">// Verifique</span></div>
<div style="position:absolute;left:109.49px;top:297.41px" class="cls_013"><span class="cls_013">pronto-para-ler</span></div>
<div style="position:absolute;left:76.48px;top:313.26px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:76.48px;top:329.12px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:130.75px;top:329.12px" class="cls_005"><span class="cls_005">(*fd_count)++;</span></div>
<div style="position:absolute;left:76.48px;top:344.97px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:103.89px;top:344.97px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:360.82px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:76.48px;top:376.68px" class="cls_005"><span class="cls_005">95</span></div>
<div style="position:absolute;left:103.89px;top:376.68px" class="cls_013"><span class="cls_013">// Remova um índice do conjunto</span></div>
<div style="position:absolute;left:76.48px;top:391.60px" class="cls_005"><span class="cls_005">96</span></div>
<div style="position:absolute;left:103.89px;top:391.60px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> del_from_pfds(</span><span class="cls_014">struct</span><span class="cls_005"> pollfd pfds[], </span><span class="cls_008">int</span><span class="cls_005"> i, </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:109.49px;top:405.59px" class="cls_005"><span class="cls_005">*fd_count)</span></div>
<div style="position:absolute;left:76.48px;top:421.44px" class="cls_005"><span class="cls_005">97</span></div>
<div style="position:absolute;left:103.89px;top:421.44px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:437.30px" class="cls_005"><span class="cls_005">98</span></div>
<div style="position:absolute;left:130.75px;top:437.30px" class="cls_013"><span class="cls_013">// Copie o do final sobre este</span></div>
<div style="position:absolute;left:76.48px;top:453.15px" class="cls_005"><span class="cls_005">99</span></div>
<div style="position:absolute;left:130.75px;top:453.15px" class="cls_005"><span class="cls_005">pfds[i] = pfds[*fd_count-</span><span class="cls_009">1</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:69.76px;top:469.01px" class="cls_005"><span class="cls_005">100</span></div>
<div style="position:absolute;left:69.76px;top:484.86px" class="cls_005"><span class="cls_005">101</span></div>
<div style="position:absolute;left:130.75px;top:484.86px" class="cls_005"><span class="cls_005">(*fd_count)--;</span></div>
<div style="position:absolute;left:69.76px;top:500.71px" class="cls_005"><span class="cls_005">102</span></div>
<div style="position:absolute;left:103.89px;top:500.71px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:516.57px" class="cls_005"><span class="cls_005">103</span></div>
<div style="position:absolute;left:69.76px;top:532.42px" class="cls_005"><span class="cls_005">104</span></div>
<div style="position:absolute;left:103.89px;top:532.42px" class="cls_013"><span class="cls_013">// Main</span></div>
<div style="position:absolute;left:69.76px;top:548.28px" class="cls_005"><span class="cls_005">105</span></div>
<div style="position:absolute;left:103.89px;top:548.28px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:69.76px;top:564.13px" class="cls_005"><span class="cls_005">106</span></div>
<div style="position:absolute;left:103.89px;top:564.13px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:69.76px;top:579.99px" class="cls_005"><span class="cls_005">107</span></div>
<div style="position:absolute;left:130.75px;top:579.99px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> listener;</span></div>
<div style="position:absolute;left:251.62px;top:579.99px" class="cls_013"><span class="cls_013">// Descritor de socket de escuta</span></div>
<div style="position:absolute;left:69.76px;top:595.84px" class="cls_005"><span class="cls_005">108</span></div>
<div style="position:absolute;left:69.76px;top:610.76px" class="cls_005"><span class="cls_005">109</span></div>
<div style="position:absolute;left:130.75px;top:610.76px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> newfd;</span></div>
<div style="position:absolute;left:251.63px;top:610.76px" class="cls_013"><span class="cls_013">// Descritor de socket recém-</span></div>
<div style="position:absolute;left:109.49px;top:624.75px" class="cls_013"><span class="cls_013">aceito com accept()</span></div>
<div style="position:absolute;left:69.76px;top:639.67px" class="cls_005"><span class="cls_005">110</span></div>
<div style="position:absolute;left:130.75px;top:639.67px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage remoteaddr; </span><span class="cls_013">// Endereço do</span></div>
<div style="position:absolute;left:109.49px;top:653.66px" class="cls_013"><span class="cls_013">cliente</span></div>
<div style="position:absolute;left:69.76px;top:669.51px" class="cls_005"><span class="cls_005">111</span></div>
<div style="position:absolute;left:130.75px;top:669.51px" class="cls_005"><span class="cls_005">socklen_t addrlen;</span></div>
<div style="position:absolute;left:69.76px;top:685.37px" class="cls_005"><span class="cls_005">112</span></div>
<div style="position:absolute;left:69.76px;top:701.22px" class="cls_005"><span class="cls_005">113</span></div>
<div style="position:absolute;left:130.75px;top:701.22px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[</span><span class="cls_009">256</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:251.63px;top:701.22px" class="cls_013"><span class="cls_013">// Buffer para dados do cliente</span></div>
<div style="position:absolute;left:69.76px;top:717.08px" class="cls_005"><span class="cls_005">114</span></div>
<div style="position:absolute;left:69.76px;top:732.93px" class="cls_005"><span class="cls_005">115</span></div>
<div style="position:absolute;left:130.75px;top:732.93px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> remoteIP[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">61 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:51911px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background062.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">116</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">117</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_013"><span class="cls_013">// Comece com espaço para 5 conexões</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">118</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_013"><span class="cls_013">// (Realocamos conforme necessário)</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">119</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fd_count = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">120</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fd_size = </span><span class="cls_009">5</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:133.27px" class="cls_005"><span class="cls_005">121</span></div>
<div style="position:absolute;left:130.75px;top:133.27px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> pollfd *pfds = malloc(</span><span class="cls_014">sizeof</span><span class="cls_005"> *pfds *</span></div>
<div style="position:absolute;left:109.49px;top:147.26px" class="cls_005"><span class="cls_005">fd_size);</span></div>
<div style="position:absolute;left:69.76px;top:163.11px" class="cls_005"><span class="cls_005">122</span></div>
<div style="position:absolute;left:69.76px;top:178.97px" class="cls_005"><span class="cls_005">123</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_013"><span class="cls_013">// Configure e obtenha um socket ouvinte</span></div>
<div style="position:absolute;left:69.76px;top:194.82px" class="cls_005"><span class="cls_005">124</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_005"><span class="cls_005">listener = get_listener_socket();</span></div>
<div style="position:absolute;left:69.76px;top:210.68px" class="cls_005"><span class="cls_005">125</span></div>
<div style="position:absolute;left:69.76px;top:226.53px" class="cls_005"><span class="cls_005">126</span></div>
<div style="position:absolute;left:130.75px;top:226.53px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listener == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:241.45px" class="cls_005"><span class="cls_005">127</span></div>
<div style="position:absolute;left:157.60px;top:241.45px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"erro ao obter o socket de</span></div>
<div style="position:absolute;left:109.49px;top:255.44px" class="cls_010"><span class="cls_010">escuta\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:271.30px" class="cls_005"><span class="cls_005">128</span></div>
<div style="position:absolute;left:157.60px;top:271.30px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:287.15px" class="cls_005"><span class="cls_005">129</span></div>
<div style="position:absolute;left:130.75px;top:287.15px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:303.00px" class="cls_005"><span class="cls_005">130</span></div>
<div style="position:absolute;left:69.76px;top:318.86px" class="cls_005"><span class="cls_005">131</span></div>
<div style="position:absolute;left:130.75px;top:318.86px" class="cls_013"><span class="cls_013">// Adicione o ouvinte para o conjunto</span></div>
<div style="position:absolute;left:69.76px;top:334.71px" class="cls_005"><span class="cls_005">132</span></div>
<div style="position:absolute;left:130.75px;top:334.71px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].fd = listener;</span></div>
<div style="position:absolute;left:69.76px;top:349.63px" class="cls_005"><span class="cls_005">133</span></div>
<div style="position:absolute;left:130.75px;top:349.63px" class="cls_005"><span class="cls_005">pfds[</span><span class="cls_009">0</span><span class="cls_005">].events = POLLIN; </span><span class="cls_013">// Reporta pronto para</span></div>
<div style="position:absolute;left:109.49px;top:363.62px" class="cls_013"><span class="cls_013">leitura na conexão recebida</span></div>
<div style="position:absolute;left:69.76px;top:379.48px" class="cls_005"><span class="cls_005">134</span></div>
<div style="position:absolute;left:69.76px;top:395.33px" class="cls_005"><span class="cls_005">135</span></div>
<div style="position:absolute;left:130.75px;top:395.33px" class="cls_005"><span class="cls_005">fd_count = </span><span class="cls_009">1</span><span class="cls_005">; </span><span class="cls_013">// Para o ouvinte</span></div>
<div style="position:absolute;left:69.76px;top:411.18px" class="cls_005"><span class="cls_005">136</span></div>
<div style="position:absolute;left:69.76px;top:427.04px" class="cls_005"><span class="cls_005">137</span></div>
<div style="position:absolute;left:130.75px;top:427.04px" class="cls_013"><span class="cls_013">// Main loop</span></div>
<div style="position:absolute;left:69.76px;top:442.89px" class="cls_005"><span class="cls_005">138</span></div>
<div style="position:absolute;left:130.75px;top:442.89px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(;;) {</span></div>
<div style="position:absolute;left:69.76px;top:458.75px" class="cls_005"><span class="cls_005">139</span></div>
<div style="position:absolute;left:157.61px;top:458.75px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> poll_count = poll(pfds, fd_count, -</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:474.60px" class="cls_005"><span class="cls_005">140</span></div>
<div style="position:absolute;left:69.76px;top:490.46px" class="cls_005"><span class="cls_005">141</span></div>
<div style="position:absolute;left:157.61px;top:490.46px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (poll_count == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:506.31px" class="cls_005"><span class="cls_005">142</span></div>
<div style="position:absolute;left:184.46px;top:506.31px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"poll"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:522.16px" class="cls_005"><span class="cls_005">143</span></div>
<div style="position:absolute;left:184.46px;top:522.16px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:538.02px" class="cls_005"><span class="cls_005">144</span></div>
<div style="position:absolute;left:157.61px;top:538.02px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:553.87px" class="cls_005"><span class="cls_005">145</span></div>
<div style="position:absolute;left:69.76px;top:568.79px" class="cls_005"><span class="cls_005">146</span></div>
<div style="position:absolute;left:157.61px;top:568.79px" class="cls_013"><span class="cls_013">// Percorra as conexões existentes procurando</span></div>
<div style="position:absolute;left:109.49px;top:582.78px" class="cls_013"><span class="cls_013">dados para ler</span></div>
<div style="position:absolute;left:69.76px;top:598.64px" class="cls_005"><span class="cls_005">147</span></div>
<div style="position:absolute;left:157.61px;top:598.64px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(</span><span class="cls_008">int</span><span class="cls_005"> i = </span><span class="cls_009">0</span><span class="cls_005">; i &lt; fd_count; i++) {</span></div>
<div style="position:absolute;left:69.76px;top:614.49px" class="cls_005"><span class="cls_005">148</span></div>
<div style="position:absolute;left:69.76px;top:630.35px" class="cls_005"><span class="cls_005">149</span></div>
<div style="position:absolute;left:184.47px;top:630.35px" class="cls_013"><span class="cls_013">// Verifique se alguém está pronto para ler</span></div>
<div style="position:absolute;left:69.76px;top:645.27px" class="cls_005"><span class="cls_005">150</span></div>
<div style="position:absolute;left:184.47px;top:645.27px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (pfds[i].revents & POLLIN) { </span><span class="cls_013">// Temos</span></div>
<div style="position:absolute;left:109.49px;top:659.26px" class="cls_013"><span class="cls_013">um!!</span></div>
<div style="position:absolute;left:69.76px;top:675.11px" class="cls_005"><span class="cls_005">151</span></div>
<div style="position:absolute;left:69.76px;top:690.96px" class="cls_005"><span class="cls_005">152</span></div>
<div style="position:absolute;left:211.33px;top:690.96px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (pfds[i].fd == listener) {</span></div>
<div style="position:absolute;left:69.76px;top:705.89px" class="cls_005"><span class="cls_005">153</span></div>
<div style="position:absolute;left:238.19px;top:705.89px" class="cls_013"><span class="cls_013">// Se o ouvinte estiver pronto para</span></div>
<div style="position:absolute;left:109.49px;top:719.87px" class="cls_013"><span class="cls_013">ler, lide com a nova conexão</span></div>
<div style="position:absolute;left:69.76px;top:735.73px" class="cls_005"><span class="cls_005">154</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">62 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:52762px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background063.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">155</span></div>
<div style="position:absolute;left:238.17px;top:54.93px" class="cls_005"><span class="cls_005">addrlen = </span><span class="cls_014">sizeof</span><span class="cls_005"> remoteaddr;</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">156</span></div>
<div style="position:absolute;left:238.17px;top:70.79px" class="cls_005"><span class="cls_005">newfd = accept(listener,</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">157</span></div>
<div style="position:absolute;left:265.02px;top:86.64px" class="cls_005"><span class="cls_005">(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&remoteaddr,</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">158</span></div>
<div style="position:absolute;left:265.02px;top:102.50px" class="cls_005"><span class="cls_005">&addrlen);</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">159</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">160</span></div>
<div style="position:absolute;left:238.19px;top:134.20px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (newfd == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">161</span></div>
<div style="position:absolute;left:265.02px;top:150.06px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"accept"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">162</span></div>
<div style="position:absolute;left:238.17px;top:165.91px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:180.83px" class="cls_005"><span class="cls_005">163</span></div>
<div style="position:absolute;left:265.02px;top:180.83px" class="cls_005"><span class="cls_005">add_to_pfds(&pfds, newfd,</span></div>
<div style="position:absolute;left:109.49px;top:194.82px" class="cls_005"><span class="cls_005">&fd_count, &fd_size);</span></div>
<div style="position:absolute;left:69.76px;top:210.68px" class="cls_005"><span class="cls_005">164</span></div>
<div style="position:absolute;left:69.76px;top:225.60px" class="cls_005"><span class="cls_005">165</span></div>
<div style="position:absolute;left:265.02px;top:225.60px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"servidor poll: nova</span></div>
<div style="position:absolute;left:109.49px;top:239.59px" class="cls_010"><span class="cls_010">conexão de %s em "</span></div>
<div style="position:absolute;left:69.76px;top:255.44px" class="cls_005"><span class="cls_005">166</span></div>
<div style="position:absolute;left:291.91px;top:255.44px" class="cls_010"><span class="cls_010">"socket %d\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:69.76px;top:270.36px" class="cls_005"><span class="cls_005">167</span></div>
<div style="position:absolute;left:109.49px;top:284.35px" class="cls_005"><span class="cls_005">inet_ntop(remoteaddr.ss_family,</span></div>
<div style="position:absolute;left:69.76px;top:299.27px" class="cls_005"><span class="cls_005">168</span></div>
<div style="position:absolute;left:318.73px;top:299.27px" class="cls_005"><span class="cls_005">get_in_addr((</span><span class="cls_014">struct</span></div>
<div style="position:absolute;left:109.49px;top:313.26px" class="cls_005"><span class="cls_005">sockaddr*)&remoteaddr),</span></div>
<div style="position:absolute;left:69.76px;top:328.18px" class="cls_005"><span class="cls_005">169</span></div>
<div style="position:absolute;left:318.73px;top:328.18px" class="cls_005"><span class="cls_005">remoteIP,</span></div>
<div style="position:absolute;left:109.49px;top:342.17px" class="cls_005"><span class="cls_005">INET6_ADDRSTRLEN),</span></div>
<div style="position:absolute;left:69.76px;top:358.03px" class="cls_005"><span class="cls_005">170</span></div>
<div style="position:absolute;left:291.87px;top:358.03px" class="cls_005"><span class="cls_005">newfd);</span></div>
<div style="position:absolute;left:69.76px;top:373.88px" class="cls_005"><span class="cls_005">171</span></div>
<div style="position:absolute;left:238.17px;top:373.88px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:389.74px" class="cls_005"><span class="cls_005">172</span></div>
<div style="position:absolute;left:211.31px;top:389.74px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:404.66px" class="cls_005"><span class="cls_005">173</span></div>
<div style="position:absolute;left:238.19px;top:404.66px" class="cls_013"><span class="cls_013">// Se não o ouvinte, somos apenas um</span></div>
<div style="position:absolute;left:109.49px;top:418.65px" class="cls_013"><span class="cls_013">cliente comum</span></div>
<div style="position:absolute;left:69.76px;top:433.57px" class="cls_005"><span class="cls_005">174</span></div>
<div style="position:absolute;left:238.19px;top:433.57px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> nbytes = recv(pfds[i].fd, buf,</span></div>
<div style="position:absolute;left:109.49px;top:447.56px" class="cls_014"><span class="cls_014">sizeof</span><span class="cls_005"> buf, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:463.41px" class="cls_005"><span class="cls_005">175</span></div>
<div style="position:absolute;left:69.76px;top:479.26px" class="cls_005"><span class="cls_005">176</span></div>
<div style="position:absolute;left:238.19px;top:479.26px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sender_fd = pfds[i].fd;</span></div>
<div style="position:absolute;left:69.76px;top:495.12px" class="cls_005"><span class="cls_005">177</span></div>
<div style="position:absolute;left:69.76px;top:510.97px" class="cls_005"><span class="cls_005">178</span></div>
<div style="position:absolute;left:238.19px;top:510.97px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (nbytes &lt;= </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:525.89px" class="cls_005"><span class="cls_005">179</span></div>
<div style="position:absolute;left:265.05px;top:525.89px" class="cls_013"><span class="cls_013">// Erro ou conexão encerrada</span></div>
<div style="position:absolute;left:109.49px;top:539.88px" class="cls_013"><span class="cls_013">pelo cliente</span></div>
<div style="position:absolute;left:69.76px;top:555.74px" class="cls_005"><span class="cls_005">180</span></div>
<div style="position:absolute;left:265.05px;top:555.74px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (nbytes == </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:571.59px" class="cls_005"><span class="cls_005">181</span></div>
<div style="position:absolute;left:291.91px;top:571.59px" class="cls_013"><span class="cls_013">// Conexão fechada</span></div>
<div style="position:absolute;left:69.76px;top:586.51px" class="cls_005"><span class="cls_005">182</span></div>
<div style="position:absolute;left:291.87px;top:586.51px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"servidor poll:</span></div>
<div style="position:absolute;left:109.49px;top:600.50px" class="cls_010"><span class="cls_010">desligar socket %d\n"</span><span class="cls_005">, sender_fd);</span></div>
<div style="position:absolute;left:69.76px;top:616.36px" class="cls_005"><span class="cls_005">183</span></div>
<div style="position:absolute;left:265.02px;top:616.36px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:632.21px" class="cls_005"><span class="cls_005">184</span></div>
<div style="position:absolute;left:291.87px;top:632.21px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"recv"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:648.06px" class="cls_005"><span class="cls_005">185</span></div>
<div style="position:absolute;left:265.02px;top:648.06px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:663.92px" class="cls_005"><span class="cls_005">186</span></div>
<div style="position:absolute;left:69.76px;top:679.77px" class="cls_005"><span class="cls_005">187</span></div>
<div style="position:absolute;left:265.02px;top:679.77px" class="cls_005"><span class="cls_005">close(pfds[i].fd); </span><span class="cls_013">// Tchau!</span></div>
<div style="position:absolute;left:69.76px;top:695.63px" class="cls_005"><span class="cls_005">188</span></div>
<div style="position:absolute;left:69.76px;top:710.55px" class="cls_005"><span class="cls_005">189</span></div>
<div style="position:absolute;left:265.02px;top:710.55px" class="cls_005"><span class="cls_005">del_from_pfds(pfds, i,</span></div>
<div style="position:absolute;left:109.49px;top:724.54px" class="cls_005"><span class="cls_005">&fd_count);</span></div>
<div style="position:absolute;left:69.76px;top:740.39px" class="cls_005"><span class="cls_005">190</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">63 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:53613px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background064.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">191</span></div>
<div style="position:absolute;left:238.17px;top:54.93px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:69.85px" class="cls_005"><span class="cls_005">192</span></div>
<div style="position:absolute;left:265.05px;top:69.85px" class="cls_013"><span class="cls_013">// Temos bons dados de um</span></div>
<div style="position:absolute;left:109.49px;top:83.84px" class="cls_013"><span class="cls_013">cliente</span></div>
<div style="position:absolute;left:69.76px;top:99.70px" class="cls_005"><span class="cls_005">193</span></div>
<div style="position:absolute;left:69.76px;top:114.62px" class="cls_005"><span class="cls_005">194</span></div>
<div style="position:absolute;left:265.05px;top:114.62px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(</span><span class="cls_008">int</span><span class="cls_005"> j = </span><span class="cls_009">0</span><span class="cls_005">; j &lt; fd_count;</span></div>
<div style="position:absolute;left:109.49px;top:128.61px" class="cls_005"><span class="cls_005">j++) {</span></div>
<div style="position:absolute;left:69.76px;top:144.46px" class="cls_005"><span class="cls_005">195</span></div>
<div style="position:absolute;left:291.91px;top:144.46px" class="cls_013"><span class="cls_013">// Envie para todos!</span></div>
<div style="position:absolute;left:69.76px;top:160.32px" class="cls_005"><span class="cls_005">196</span></div>
<div style="position:absolute;left:291.91px;top:160.32px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> dest_fd = pfds[j].fd;</span></div>
<div style="position:absolute;left:69.76px;top:176.17px" class="cls_005"><span class="cls_005">197</span></div>
<div style="position:absolute;left:69.76px;top:191.09px" class="cls_005"><span class="cls_005">198</span></div>
<div style="position:absolute;left:291.91px;top:191.09px" class="cls_013"><span class="cls_013">// Exceto o ouvinte e nós</span></div>
<div style="position:absolute;left:109.49px;top:205.08px" class="cls_013"><span class="cls_013">mesmos</span></div>
<div style="position:absolute;left:69.76px;top:220.00px" class="cls_005"><span class="cls_005">199</span></div>
<div style="position:absolute;left:291.91px;top:220.00px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (dest_fd != listener &&</span></div>
<div style="position:absolute;left:109.49px;top:233.99px" class="cls_005"><span class="cls_005">dest_fd != sender_fd) {</span></div>
<div style="position:absolute;left:69.76px;top:248.91px" class="cls_005"><span class="cls_005">200</span></div>
<div style="position:absolute;left:318.76px;top:248.91px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (send(dest_fd, buf,</span></div>
<div style="position:absolute;left:109.49px;top:262.90px" class="cls_005"><span class="cls_005">nbytes, </span><span class="cls_009">0</span><span class="cls_005">) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:278.76px" class="cls_005"><span class="cls_005">201</span></div>
<div style="position:absolute;left:345.58px;top:278.76px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"send"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:294.61px" class="cls_005"><span class="cls_005">202</span></div>
<div style="position:absolute;left:318.73px;top:294.61px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:310.46px" class="cls_005"><span class="cls_005">203</span></div>
<div style="position:absolute;left:291.87px;top:310.46px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:326.32px" class="cls_005"><span class="cls_005">204</span></div>
<div style="position:absolute;left:265.02px;top:326.32px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:342.17px" class="cls_005"><span class="cls_005">205</span></div>
<div style="position:absolute;left:238.17px;top:342.17px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:358.03px" class="cls_005"><span class="cls_005">206</span></div>
<div style="position:absolute;left:211.31px;top:358.03px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">END</span><span class="cls_013"> manipular dados do cliente</span></div>
<div style="position:absolute;left:69.76px;top:373.88px" class="cls_005"><span class="cls_005">207</span></div>
<div style="position:absolute;left:184.46px;top:373.88px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">END</span><span class="cls_013"> ficou pronto para leitura em poll()</span></div>
<div style="position:absolute;left:69.76px;top:389.74px" class="cls_005"><span class="cls_005">208</span></div>
<div style="position:absolute;left:157.61px;top:389.74px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">END</span><span class="cls_013"> percorrendo descritores de arquivo</span></div>
<div style="position:absolute;left:69.76px;top:404.66px" class="cls_005"><span class="cls_005">209</span></div>
<div style="position:absolute;left:130.75px;top:404.66px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">END</span><span class="cls_013"> for(;;)--e você pensou que isso nunca iria</span></div>
<div style="position:absolute;left:109.49px;top:418.65px" class="cls_013"><span class="cls_013">acabar!</span></div>
<div style="position:absolute;left:69.76px;top:434.50px" class="cls_005"><span class="cls_005">210</span></div>
<div style="position:absolute;left:69.76px;top:450.35px" class="cls_005"><span class="cls_005">211</span></div>
<div style="position:absolute;left:130.75px;top:450.35px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:466.21px" class="cls_005"><span class="cls_005">212</span></div>
<div style="position:absolute;left:103.89px;top:466.21px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:500.25px" class="cls_005"><span class="cls_005">Na próxima seção veremos uma função mais antiga, semelhante, chamada select(). Tanto</span></div>
<div style="position:absolute;left:60.99px;top:516.10px" class="cls_005"><span class="cls_005">select() quanto poll() oferecem funcionalidade e desempenho semelhantes, e diferem</span></div>
<div style="position:absolute;left:60.99px;top:531.96px" class="cls_005"><span class="cls_005">realmente apenas na forma como são usadas. select() pode ser um pouco mais portátil,</span></div>
<div style="position:absolute;left:60.99px;top:546.88px" class="cls_005"><span class="cls_005">mas talvez seja um pouco mais desajeitada em uso. Escolha a que você mais gosta, desde que</span></div>
<div style="position:absolute;left:60.99px;top:560.87px" class="cls_005"><span class="cls_005">seja compatível com seu sistema.</span></div>
<div style="position:absolute;left:60.99px;top:589.72px" class="cls_007"><span class="cls_007">select()—Multiplexação Síncrona de E/S, Old School</span></div>
<div style="position:absolute;left:60.99px;top:625.10px" class="cls_005"><span class="cls_005">Esta função é um pouco estranha, mas é muito útil. Considere a seguinte situação: você é um</span></div>
<div style="position:absolute;left:60.99px;top:639.09px" class="cls_005"><span class="cls_005">servidor e deseja ouvir as conexões de entrada, bem como manter a leitura das conexões que</span></div>
<div style="position:absolute;left:60.99px;top:653.08px" class="cls_005"><span class="cls_005">você já possui.</span></div>
<div style="position:absolute;left:60.99px;top:679.19px" class="cls_005"><span class="cls_005">Não há problema, você diz, apenas um accept() e alguns pares de recv() já resolveriam.</span></div>
<div style="position:absolute;left:60.99px;top:695.04px" class="cls_005"><span class="cls_005">Não tão rápido, imbecil! E se você estiver em blocking em uma chamada accept()? Como</span></div>
<div style="position:absolute;left:60.99px;top:710.90px" class="cls_005"><span class="cls_005">você receberá dados com recv() ao mesmo tempo? "Use sockets non-blocking!" De jeito</span></div>
<div style="position:absolute;left:60.99px;top:725.82px" class="cls_005"><span class="cls_005">nenhum! Você não quer ser um parasita de CPU. O que, então?</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">64 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:54464px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background065.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">select() lhe dá o poder para monitorar vários sockets ao mesmo tempo. Ele lhe dirá quais</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">estão prontos para a leitura, quais estão prontos para a escrita, e quais sockets geraram</span></div>
<div style="position:absolute;left:60.99px;top:83.84px" class="cls_005"><span class="cls_005">exceções, se você realmente quiser saber isso.</span></div>
<div style="position:absolute;left:88.97px;top:109.96px" class="cls_005"><span class="cls_005">Alguns avisos: select(), embora muito portátil, é terrivelmente lento quando se</span></div>
<div style="position:absolute;left:88.97px;top:124.88px" class="cls_005"><span class="cls_005">trata de um número gigante de conexões. Nessas circunstâncias, você obtém um</span></div>
<div style="position:absolute;left:88.97px;top:138.87px" class="cls_005"><span class="cls_005">melhor desempenho de uma biblioteca de eventos como a </span><span class="cls_023">libevent</span><span class="cls_024"><sup>30</sup></span><span class="cls_005">, que tenta</span></div>
<div style="position:absolute;left:88.97px;top:154.79px" class="cls_005"><span class="cls_005">usar o método mais rápido possível disponível em seu sistema.</span></div>
<div style="position:absolute;left:60.99px;top:180.90px" class="cls_005"><span class="cls_005">Sem mais delongas, vou oferecer a sinopse de select():</span></div>
<div style="position:absolute;left:94.85px;top:214.94px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/time.h></span></div>
<div style="position:absolute;left:94.85px;top:230.80px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:246.65px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:94.85px;top:278.36px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> select(</span><span class="cls_008">int</span><span class="cls_005"> numfds, fd_set *readfds, fd_set *writefds,</span></div>
<div style="position:absolute;left:168.70px;top:294.21px" class="cls_005"><span class="cls_005">fd_set *exceptfds, </span><span class="cls_014">struct</span><span class="cls_005"> timeval *timeout);</span></div>
<div style="position:absolute;left:60.99px;top:328.25px" class="cls_005"><span class="cls_005">A função monitora "sets" (conjuntos) de descritores de arquivos; em particular: readfds,</span></div>
<div style="position:absolute;left:60.99px;top:344.11px" class="cls_005"><span class="cls_005">writefds e exceptfds. Se você quiser ver se pode ler da entrada padrão e de algum</span></div>
<div style="position:absolute;left:60.99px;top:359.96px" class="cls_005"><span class="cls_005">descritor de socket, sockfd, apenas de na o descritor de arquivo 0 e sockfd para o "set"</span></div>
<div style="position:absolute;left:60.99px;top:375.82px" class="cls_005"><span class="cls_005">readfds. O parâmetro numfds deve ser de nido para o valor do mais alto descritor de arquivo</span></div>
<div style="position:absolute;left:60.99px;top:391.67px" class="cls_005"><span class="cls_005">mais um. Neste exemplo, ele deve ser de nido para sockfd+1, uma vez que é seguramente</span></div>
<div style="position:absolute;left:60.99px;top:407.52px" class="cls_005"><span class="cls_005">maior que o da entrada padrão (0).</span></div>
<div style="position:absolute;left:60.99px;top:434.57px" class="cls_005"><span class="cls_005">Quando select() retorna, readfds será modi cado para re  etir quais descritores de arquivo</span></div>
<div style="position:absolute;left:60.99px;top:449.49px" class="cls_005"><span class="cls_005">selecionados por você estão prontos para a leitura. Você pode testá-los com a macro</span></div>
<div style="position:absolute;left:60.99px;top:464.41px" class="cls_005"><span class="cls_005">FD_ISSET(), abaixo.</span></div>
<div style="position:absolute;left:60.99px;top:490.53px" class="cls_005"><span class="cls_005">Antes de avançar muito mais, falarei sobre como manipular esses conjuntos. Cada set é do</span></div>
<div style="position:absolute;left:60.99px;top:505.45px" class="cls_005"><span class="cls_005">tipo fd_set. As seguintes macros operam neste tipo:</span></div>
<div style="position:absolute;left:184.67px;top:539.49px" class="cls_025"><span class="cls_025">Fun</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:380.00px;top:539.49px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:103.01px;top:555.81px" class="cls_005"><span class="cls_005">FD_SET(int fd, fd_set *set);</span></div>
<div style="position:absolute;left:319.86px;top:555.81px" class="cls_005"><span class="cls_005">Adiciona fd para set.</span></div>
<div style="position:absolute;left:103.01px;top:573.06px" class="cls_005"><span class="cls_005">FD_CLR(int fd, fd_set *set);</span></div>
<div style="position:absolute;left:319.86px;top:573.06px" class="cls_005"><span class="cls_005">Remove fd de set.</span></div>
<div style="position:absolute;left:103.01px;top:590.31px" class="cls_005"><span class="cls_005">FD_ISSET(int fd, fd_set *set);   Retorna true se fd estiver em set.</span></div>
<div style="position:absolute;left:103.01px;top:607.57px" class="cls_005"><span class="cls_005">FD_ZERO(fd_set *set);</span></div>
<div style="position:absolute;left:319.86px;top:607.57px" class="cls_005"><span class="cls_005">Limpa todas as entradas de set.</span></div>
<div style="position:absolute;left:60.99px;top:643.94px" class="cls_005"><span class="cls_005">Finalmente, o que é a estranha struct timeval? Bem, às vezes você não quer esperar para</span></div>
<div style="position:absolute;left:60.99px;top:658.86px" class="cls_005"><span class="cls_005">sempre até que alguém lhe envie alguns dados. Talvez a cada 96 segundos você queira</span></div>
<div style="position:absolute;left:60.99px;top:672.85px" class="cls_005"><span class="cls_005">imprimir "Ainda em andamento..." no terminal, mesmo que nada tenha acontecido. Esta</span></div>
<div style="position:absolute;left:60.99px;top:686.84px" class="cls_005"><span class="cls_005">estrutura de tempo permite que você especi que um período de tempo limite. Se o tempo for</span></div>
<div style="position:absolute;left:60.99px;top:701.76px" class="cls_005"><span class="cls_005">excedido e select() ainda não tiver encontrado nenhum descritor de arquivo pronto, ele</span></div>
<div style="position:absolute;left:60.99px;top:716.68px" class="cls_005"><span class="cls_005">retornará para que você possa continuar o processamento.</span></div>
<div style="position:absolute;left:60.99px;top:742.79px" class="cls_005"><span class="cls_005">A struct timeval possui os seguinte campos:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">65 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:55315px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background066.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:61.93px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> timeval {</span></div>
<div style="position:absolute;left:121.71px;top:77.78px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> tv_sec;</span></div>
<div style="position:absolute;left:229.14px;top:77.78px" class="cls_013"><span class="cls_013">// segundos</span></div>
<div style="position:absolute;left:121.71px;top:93.64px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> tv_usec;</span></div>
<div style="position:absolute;left:229.14px;top:93.64px" class="cls_013"><span class="cls_013">// microssegundos</span></div>
<div style="position:absolute;left:94.85px;top:109.49px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:143.53px" class="cls_005"><span class="cls_005">Basta de nir tv_sec para o número de segundos a esperar, e de nir tv_usec para o número</span></div>
<div style="position:absolute;left:60.99px;top:158.45px" class="cls_005"><span class="cls_005">de microssegundos que se deve esperar. Sim, isso é _micro_segundos, não milissegundos. Há</span></div>
<div style="position:absolute;left:60.99px;top:172.44px" class="cls_005"><span class="cls_005">1.000 microssegundos em um milésimo de segundo, e 1.000 milissegundos em um segundo.</span></div>
<div style="position:absolute;left:60.99px;top:186.43px" class="cls_005"><span class="cls_005">Assim, existem 1.000.000 microssegundos em um segundo. Por que "usec"? O "u" é</span></div>
<div style="position:absolute;left:60.99px;top:200.42px" class="cls_005"><span class="cls_005">supostamente parecido com a letra grega μ (Mi) que usamos para "micro". Além disso, quando</span></div>
<div style="position:absolute;left:60.99px;top:215.34px" class="cls_005"><span class="cls_005">a função retorna, timeout poderia ser atualizado para mostrar o tempo ainda restante. Isso</span></div>
<div style="position:absolute;left:60.99px;top:230.26px" class="cls_005"><span class="cls_005">depende de que sabor de Unix você está executando.</span></div>
<div style="position:absolute;left:60.99px;top:255.44px" class="cls_005"><span class="cls_005">Uau! Temos um temporizador com resolução de microssegundos! Bem, não conte com isso.</span></div>
<div style="position:absolute;left:60.99px;top:269.43px" class="cls_005"><span class="cls_005">Você provavelmente terá que esperar, em parte, também o tempo padrão do seu Unix, não</span></div>
<div style="position:absolute;left:60.99px;top:284.35px" class="cls_005"><span class="cls_005">importando quão mínimo seja o tempo de nido para struct timeval.</span></div>
<div style="position:absolute;left:60.99px;top:311.40px" class="cls_005"><span class="cls_005">Outras coisas de interesse: Se você de nir os campos da sua struct timeval para 0,</span></div>
<div style="position:absolute;left:60.99px;top:327.25px" class="cls_005"><span class="cls_005">select() irá expirar imediatamente, efetivamente sondando todos os descritores de arquivos</span></div>
<div style="position:absolute;left:60.99px;top:343.11px" class="cls_005"><span class="cls_005">em seus sets. Se você de nir o parâmetro timeout para NULL, ele nunca terá tempo limite e</span></div>
<div style="position:absolute;left:60.99px;top:358.03px" class="cls_005"><span class="cls_005">aguardará até que o primeiro descritor de arquivo esteja pronto. Finalmente, se você não se</span></div>
<div style="position:absolute;left:60.99px;top:372.02px" class="cls_005"><span class="cls_005">importa em esperar por um determinado conjunto, você pode apenas con gurá-lo para NULL</span></div>
<div style="position:absolute;left:60.99px;top:386.94px" class="cls_005"><span class="cls_005">na chamada de select().</span></div>
<div style="position:absolute;left:60.99px;top:413.05px" class="cls_023"><span class="cls_023">O se</span><span class="cls_006">g</span><span class="cls_023">uinte trecho de códi</span><span class="cls_006">g</span><span class="cls_023">o</span><span class="cls_024"><sup>31</sup></span><span class="cls_005"> aguarda 2,5 segundos para que algo apareça na entrada padrão:</span></div>
<div style="position:absolute;left:83.19px;top:448.09px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:448.09px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:463.95px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:463.95px" class="cls_013"><span class="cls_013">** select.c -- uma demonstração de select()</span></div>
<div style="position:absolute;left:83.19px;top:479.80px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:479.80px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:495.65px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:511.51px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:511.51px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:527.36px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:527.36px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/time.h></span></div>
<div style="position:absolute;left:83.19px;top:543.22px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:543.22px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:559.07px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:559.07px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:574.93px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:589.85px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:589.85px" class="cls_012"><span class="cls_012">#define STDIN 0</span></div>
<div style="position:absolute;left:218.06px;top:589.85px" class="cls_013"><span class="cls_013">// descritor de arquivo para entrada</span></div>
<div style="position:absolute;left:109.49px;top:603.84px" class="cls_013"><span class="cls_013">padrão</span></div>
<div style="position:absolute;left:76.48px;top:619.69px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:635.54px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:635.54px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:651.40px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:651.40px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:667.25px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:667.25px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> timeval tv;</span></div>
<div style="position:absolute;left:76.48px;top:683.11px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:683.11px" class="cls_005"><span class="cls_005">fd_set readfds;</span></div>
<div style="position:absolute;left:76.48px;top:698.96px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:714.82px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:714.82px" class="cls_005"><span class="cls_005">tv.tv_sec = </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:730.67px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:130.75px;top:730.67px" class="cls_005"><span class="cls_005">tv.tv_usec = </span><span class="cls_009">500000</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">66 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:56166px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background067.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">FD_ZERO(&readfds);</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_005"><span class="cls_005">FD_SET(STDIN, &readfds);</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_013"><span class="cls_013">// não me importo com writefds e exceptfds:</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:134.20px" class="cls_005"><span class="cls_005">select(STDIN+</span><span class="cls_009">1</span><span class="cls_005">, &readfds, NULL, NULL, &tv);</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:165.91px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (FD_ISSET(STDIN, &readfds))</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:157.60px;top:181.77px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Uma tecla foi pressionada!\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:197.62px" class="cls_014"><span class="cls_014">else</span></div>
<div style="position:absolute;left:76.48px;top:213.47px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:157.60px;top:213.47px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Tempo esgotado.\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:229.33px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:76.48px;top:245.18px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:245.18px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:261.04px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:261.04px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:294.14px" class="cls_005"><span class="cls_005">Se você estiver em um terminal de linha bufferizada, a tecla que você pressionar deverá ser</span></div>
<div style="position:absolute;left:60.99px;top:308.13px" class="cls_005"><span class="cls_005">sucedida por RETURN ou o tempo irá expirar de qualquer maneira.</span></div>
<div style="position:absolute;left:60.99px;top:333.31px" class="cls_005"><span class="cls_005">Agora, alguns de vocês podem pensar que esta é uma ótima maneira de esperar por dados em</span></div>
<div style="position:absolute;left:60.99px;top:347.30px" class="cls_005"><span class="cls_005">um socket datagram—e você está certo: pode ser. Alguns Unix podem usar select desta</span></div>
<div style="position:absolute;left:60.99px;top:361.29px" class="cls_005"><span class="cls_005">maneira, e outros não. Você deve ver o que sua página man local diz sobre o assunto, se você</span></div>
<div style="position:absolute;left:60.99px;top:375.28px" class="cls_005"><span class="cls_005">quiser tenta-lo.</span></div>
<div style="position:absolute;left:60.99px;top:401.39px" class="cls_005"><span class="cls_005">Alguns Unix atualizam o tempo em sua struct timeval para re  etir a quantidade de tempo</span></div>
<div style="position:absolute;left:60.99px;top:416.31px" class="cls_005"><span class="cls_005">que resta até um tempo limite. Mas outros não. Não con e que isso ocorra se você quer</span></div>
<div style="position:absolute;left:60.99px;top:431.24px" class="cls_005"><span class="cls_005">portabilidade. (Use gettimeofday() se você precisar controlar o tempo decorrido. É</span></div>
<div style="position:absolute;left:60.99px;top:446.16px" class="cls_005"><span class="cls_005">cansativo, eu sei, mas essa é a maneira de ser feito.)</span></div>
<div style="position:absolute;left:60.99px;top:472.27px" class="cls_005"><span class="cls_005">O que acontece se um socket no set de leitura fecha a conexão? Bem, nesse caso, select()</span></div>
<div style="position:absolute;left:60.99px;top:487.19px" class="cls_005"><span class="cls_005">retorna com o descritor de socket de nido como "pronto para ler". Quando você realmente faz</span></div>
<div style="position:absolute;left:60.99px;top:502.11px" class="cls_005"><span class="cls_005">recv() a partir dele, recv() retornará 0. É assim que você sabe que o cliente fechou a</span></div>
<div style="position:absolute;left:60.99px;top:517.03px" class="cls_005"><span class="cls_005">conexão.</span></div>
<div style="position:absolute;left:60.99px;top:543.15px" class="cls_005"><span class="cls_005">Mais uma nota de interesse sobre select(): Se você tem um socket executando listen(),</span></div>
<div style="position:absolute;left:60.99px;top:558.07px" class="cls_005"><span class="cls_005">você pode veri car se há uma nova conexão colocando seu descritor de arquivo no set</span></div>
<div style="position:absolute;left:60.99px;top:572.99px" class="cls_005"><span class="cls_005">readfds.</span></div>
<div style="position:absolute;left:60.99px;top:600.04px" class="cls_005"><span class="cls_005">E isso, meus amigos, é uma rápida visão geral da poderosa função select().</span></div>
<div style="position:absolute;left:60.99px;top:626.15px" class="cls_005"><span class="cls_005">Mas, por demanda popular, aqui está um exemplo em profundidade. Infelizmente, a diferença</span></div>
<div style="position:absolute;left:60.99px;top:640.14px" class="cls_005"><span class="cls_005">entre o exemplo simples, acima, e este aqui é signi cativa. Mas dê uma olhada, leia a</span></div>
<div style="position:absolute;left:60.99px;top:654.13px" class="cls_005"><span class="cls_005">descrição que o segue.</span></div>
<div style="position:absolute;left:60.99px;top:679.31px" class="cls_023"><span class="cls_023">Este pro</span><span class="cls_006">g</span><span class="cls_023">rama</span><span class="cls_024"><sup>32</sup></span><span class="cls_005"> funciona como um simples servidor de chat multiusuário. Comece</span></div>
<div style="position:absolute;left:60.99px;top:696.16px" class="cls_005"><span class="cls_005">executando-o em uma janela e, em seguida, conecte-se via telnet a ele ("telnet hostname</span></div>
<div style="position:absolute;left:60.99px;top:712.02px" class="cls_005"><span class="cls_005">9034") a partir de várias outras janelas. Quando você digita algo em uma sessão telnet, isso</span></div>
<div style="position:absolute;left:60.99px;top:726.94px" class="cls_005"><span class="cls_005">deve aparecer em todas as outras.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">67 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:57017px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background068.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:61.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:61.93px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:83.19px;top:76.85px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:76.85px" class="cls_013"><span class="cls_013">** selectserver.c -- um servidor de bate-papo com várias</span></div>
<div style="position:absolute;left:109.49px;top:90.84px" class="cls_013"><span class="cls_013">pessoas</span></div>
<div style="position:absolute;left:83.19px;top:106.69px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:106.69px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:122.55px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:138.40px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:138.40px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:154.25px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:154.25px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:170.11px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:170.11px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:83.19px;top:185.96px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:185.96px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:201.82px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:201.82px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:217.67px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:217.67px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:233.53px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:233.53px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:249.38px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:249.38px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:265.23px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:265.23px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:281.09px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:296.94px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:296.94px" class="cls_012"><span class="cls_012">#define PORT "9034"</span></div>
<div style="position:absolute;left:251.63px;top:296.94px" class="cls_013"><span class="cls_013">// porta onde estaremos ouvindo</span></div>
<div style="position:absolute;left:76.48px;top:312.80px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:328.65px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:328.65px" class="cls_013"><span class="cls_013">// obtém sockaddr, IPv4 ou IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:344.50px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:344.50px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> *get_in_addr(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *sa)</span></div>
<div style="position:absolute;left:76.48px;top:360.36px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:360.36px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:376.21px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:376.21px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sa->sa_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:392.07px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:157.61px;top:392.07px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in*)sa)->sin_addr);</span></div>
<div style="position:absolute;left:76.48px;top:407.92px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:407.92px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:423.78px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:76.48px;top:439.63px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:439.63px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6*)sa)->sin6_addr);</span></div>
<div style="position:absolute;left:76.48px;top:455.48px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:455.48px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:471.34px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:487.19px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:103.89px;top:487.19px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:76.48px;top:503.05px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:503.05px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:517.97px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:517.97px" class="cls_005"><span class="cls_005">fd_set master;</span></div>
<div style="position:absolute;left:251.63px;top:517.97px" class="cls_013"><span class="cls_013">// lista de descritores de</span></div>
<div style="position:absolute;left:109.49px;top:531.96px" class="cls_013"><span class="cls_013">arquivos master</span></div>
<div style="position:absolute;left:76.48px;top:546.88px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:546.88px" class="cls_005"><span class="cls_005">fd_set read_fds;</span></div>
<div style="position:absolute;left:251.64px;top:546.88px" class="cls_013"><span class="cls_013">// lista de descritores</span></div>
<div style="position:absolute;left:109.49px;top:560.87px" class="cls_013"><span class="cls_013">temporários para select()</span></div>
<div style="position:absolute;left:76.48px;top:575.79px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:575.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fdmax;</span></div>
<div style="position:absolute;left:251.63px;top:575.79px" class="cls_013"><span class="cls_013">// número máximo de descritores de</span></div>
<div style="position:absolute;left:109.49px;top:589.78px" class="cls_013"><span class="cls_013">arquivos</span></div>
<div style="position:absolute;left:76.48px;top:605.63px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:621.49px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:621.49px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> listener;</span></div>
<div style="position:absolute;left:251.62px;top:621.49px" class="cls_013"><span class="cls_013">// descritor de socket de escuta</span></div>
<div style="position:absolute;left:76.48px;top:636.41px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:636.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> newfd;</span></div>
<div style="position:absolute;left:251.63px;top:636.41px" class="cls_013"><span class="cls_013">// novos descritores de socket com</span></div>
<div style="position:absolute;left:109.49px;top:650.40px" class="cls_013"><span class="cls_013">accept()</span></div>
<div style="position:absolute;left:76.48px;top:665.32px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:665.32px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage remoteaddr; </span><span class="cls_013">// endereço do</span></div>
<div style="position:absolute;left:109.49px;top:679.31px" class="cls_013"><span class="cls_013">cliente</span></div>
<div style="position:absolute;left:76.48px;top:695.16px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:695.16px" class="cls_005"><span class="cls_005">socklen_t addrlen;</span></div>
<div style="position:absolute;left:76.48px;top:711.02px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:76.48px;top:726.87px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:726.87px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[</span><span class="cls_009">256</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:251.63px;top:726.87px" class="cls_013"><span class="cls_013">// buffer para dados do cliente</span></div>
<div style="position:absolute;left:76.48px;top:742.72px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:742.72px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> nbytes;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">68 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:57868px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background069.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> remoteIP[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:130.75px;top:101.56px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> yes=</span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:251.62px;top:101.56px" class="cls_013"><span class="cls_013">// para setsockopt() SO_REUSEADDR,</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_013"><span class="cls_013">abaixo</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> i, j, rv;</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:163.11px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *ai, *p;</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:76.48px;top:193.89px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:130.75px;top:193.89px" class="cls_005"><span class="cls_005">FD_ZERO(&master);</span></div>
<div style="position:absolute;left:271.76px;top:193.89px" class="cls_013"><span class="cls_013">// limpa sets master e</span></div>
<div style="position:absolute;left:109.49px;top:207.88px" class="cls_013"><span class="cls_013">temporário</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:130.75px;top:223.73px" class="cls_005"><span class="cls_005">FD_ZERO(&read_fds);</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:255.44px" class="cls_013"><span class="cls_013">// nos dá um socket e faz bind nele</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:130.75px;top:271.30px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:130.75px;top:287.15px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:76.48px;top:303.00px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:130.75px;top:303.00px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:318.86px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:318.86px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:76.48px;top:333.78px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:130.75px;top:333.78px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(NULL, PORT, &hints, &ai)) !=</span></div>
<div style="position:absolute;left:109.49px;top:347.77px" class="cls_009"><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:362.69px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:157.60px;top:362.69px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"selectserver: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:376.68px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:392.53px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:157.60px;top:392.53px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:408.39px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:130.75px;top:408.39px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:424.24px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:76.48px;top:440.10px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:130.75px;top:440.10px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = ai; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:455.02px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:157.60px;top:455.02px" class="cls_005"><span class="cls_005">listener = socket(p->ai_family, p->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:469.01px" class="cls_005"><span class="cls_005">p->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:484.86px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:157.61px;top:484.86px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listener &lt; </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:500.71px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:184.47px;top:500.71px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:516.57px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:157.61px;top:516.57px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:532.42px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:76.48px;top:547.34px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:157.61px;top:547.34px" class="cls_013"><span class="cls_013">// evitar a irritante mensagem de erro "endereço</span></div>
<div style="position:absolute;left:109.49px;top:561.33px" class="cls_013"><span class="cls_013">já em uso"</span></div>
<div style="position:absolute;left:76.48px;top:576.25px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:157.60px;top:576.25px" class="cls_005"><span class="cls_005">setsockopt(listener, SOL_SOCKET, SO_REUSEADDR,</span></div>
<div style="position:absolute;left:109.49px;top:590.24px" class="cls_005"><span class="cls_005">&yes, </span><span class="cls_014">sizeof</span><span class="cls_005">(</span><span class="cls_008">int</span><span class="cls_005">));</span></div>
<div style="position:absolute;left:76.48px;top:606.10px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:76.48px;top:621.02px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:157.61px;top:621.02px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (bind(listener, p->ai_addr, p->ai_addrlen) &lt;</span></div>
<div style="position:absolute;left:109.49px;top:635.01px" class="cls_009"><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:650.86px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:184.46px;top:650.86px" class="cls_005"><span class="cls_005">close(listener);</span></div>
<div style="position:absolute;left:76.48px;top:666.72px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:184.47px;top:666.72px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:682.57px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:157.61px;top:682.57px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:698.43px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:76.48px;top:714.28px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:157.61px;top:714.28px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:730.13px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:130.75px;top:730.13px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">69 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:58719px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background070.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:76.48px;top:69.85px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:130.75px;top:69.85px" class="cls_013"><span class="cls_013">//se chegou até aqui, significa que não fomos</span></div>
<div style="position:absolute;left:109.49px;top:83.84px" class="cls_013"><span class="cls_013">impedidos</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:130.75px;top:99.70px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:114.62px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:157.60px;top:114.62px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"selectserver: failed to</span></div>
<div style="position:absolute;left:109.49px;top:128.61px" class="cls_010"><span class="cls_010">bind\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:144.46px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:157.60px;top:144.46px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">2</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:130.75px;top:160.32px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:130.75px;top:192.02px" class="cls_005"><span class="cls_005">freeaddrinfo(ai); </span><span class="cls_013">// tudo feito com isso</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:130.75px;top:223.73px" class="cls_013"><span class="cls_013">// listen</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:130.75px;top:239.59px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listen(listener, </span><span class="cls_009">10</span><span class="cls_005">) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:157.60px;top:255.44px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"listen"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:157.60px;top:271.30px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">3</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:130.75px;top:287.15px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:303.00px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:76.48px;top:318.86px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:130.75px;top:318.86px" class="cls_013"><span class="cls_013">// adicione listener ao set master</span></div>
<div style="position:absolute;left:76.48px;top:334.71px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:130.75px;top:334.71px" class="cls_005"><span class="cls_005">FD_SET(listener, &master);</span></div>
<div style="position:absolute;left:76.48px;top:350.57px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:76.48px;top:366.42px" class="cls_005"><span class="cls_005">95</span></div>
<div style="position:absolute;left:130.75px;top:366.42px" class="cls_013"><span class="cls_013">// acompanhe o maior descritor de arquivos</span></div>
<div style="position:absolute;left:76.48px;top:382.27px" class="cls_005"><span class="cls_005">96</span></div>
<div style="position:absolute;left:130.75px;top:382.27px" class="cls_005"><span class="cls_005">fdmax = listener; </span><span class="cls_013">// até agora, é esse aqui</span></div>
<div style="position:absolute;left:76.48px;top:398.13px" class="cls_005"><span class="cls_005">97</span></div>
<div style="position:absolute;left:76.48px;top:413.98px" class="cls_005"><span class="cls_005">98</span></div>
<div style="position:absolute;left:130.75px;top:413.98px" class="cls_013"><span class="cls_013">// loop principal</span></div>
<div style="position:absolute;left:76.48px;top:429.84px" class="cls_005"><span class="cls_005">99</span></div>
<div style="position:absolute;left:130.75px;top:429.84px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(;;) {</span></div>
<div style="position:absolute;left:69.76px;top:445.69px" class="cls_005"><span class="cls_005">100</span></div>
<div style="position:absolute;left:157.60px;top:445.69px" class="cls_005"><span class="cls_005">read_fds = master; </span><span class="cls_013">// copie</span></div>
<div style="position:absolute;left:69.76px;top:460.61px" class="cls_005"><span class="cls_005">101</span></div>
<div style="position:absolute;left:157.61px;top:460.61px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (select(fdmax+</span><span class="cls_009">1</span><span class="cls_005">, &read_fds, NULL, NULL, NULL)</span></div>
<div style="position:absolute;left:109.49px;top:474.60px" class="cls_005"><span class="cls_005">==</span></div>
<div style="position:absolute;left:129.63px;top:474.60px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:490.46px" class="cls_005"><span class="cls_005">102</span></div>
<div style="position:absolute;left:184.46px;top:490.46px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"select"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:506.31px" class="cls_005"><span class="cls_005">103</span></div>
<div style="position:absolute;left:184.46px;top:506.31px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">4</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:522.16px" class="cls_005"><span class="cls_005">104</span></div>
<div style="position:absolute;left:157.61px;top:522.16px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:538.02px" class="cls_005"><span class="cls_005">105</span></div>
<div style="position:absolute;left:69.76px;top:552.94px" class="cls_005"><span class="cls_005">106</span></div>
<div style="position:absolute;left:157.61px;top:552.94px" class="cls_013"><span class="cls_013">// percorrer as conexões existentes à procura de</span></div>
<div style="position:absolute;left:109.49px;top:566.93px" class="cls_013"><span class="cls_013">dados para ler</span></div>
<div style="position:absolute;left:69.76px;top:582.78px" class="cls_005"><span class="cls_005">107</span></div>
<div style="position:absolute;left:157.61px;top:582.78px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(i = </span><span class="cls_009">0</span><span class="cls_005">; i &lt;= fdmax; i++) {</span></div>
<div style="position:absolute;left:69.76px;top:597.70px" class="cls_005"><span class="cls_005">108</span></div>
<div style="position:absolute;left:184.47px;top:597.70px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (FD_ISSET(i, &read_fds)) { </span><span class="cls_013">// nós temos</span></div>
<div style="position:absolute;left:109.49px;top:611.69px" class="cls_013"><span class="cls_013">um!!</span></div>
<div style="position:absolute;left:69.76px;top:627.55px" class="cls_005"><span class="cls_005">109</span></div>
<div style="position:absolute;left:211.33px;top:627.55px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (i == listener) {</span></div>
<div style="position:absolute;left:69.76px;top:643.40px" class="cls_005"><span class="cls_005">110</span></div>
<div style="position:absolute;left:238.19px;top:643.40px" class="cls_013"><span class="cls_013">// manuseia novas conexões</span></div>
<div style="position:absolute;left:69.76px;top:659.26px" class="cls_005"><span class="cls_005">111</span></div>
<div style="position:absolute;left:238.17px;top:659.26px" class="cls_005"><span class="cls_005">addrlen = </span><span class="cls_014">sizeof</span><span class="cls_005"> remoteaddr;</span></div>
<div style="position:absolute;left:69.76px;top:675.11px" class="cls_005"><span class="cls_005">112</span></div>
<div style="position:absolute;left:238.17px;top:675.11px" class="cls_005"><span class="cls_005">newfd = accept(listener,</span></div>
<div style="position:absolute;left:69.76px;top:690.96px" class="cls_005"><span class="cls_005">113</span></div>
<div style="position:absolute;left:265.02px;top:690.96px" class="cls_005"><span class="cls_005">(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&remoteaddr,</span></div>
<div style="position:absolute;left:69.76px;top:706.82px" class="cls_005"><span class="cls_005">114</span></div>
<div style="position:absolute;left:265.02px;top:706.82px" class="cls_005"><span class="cls_005">&addrlen);</span></div>
<div style="position:absolute;left:69.76px;top:722.67px" class="cls_005"><span class="cls_005">115</span></div>
<div style="position:absolute;left:69.76px;top:738.53px" class="cls_005"><span class="cls_005">116</span></div>
<div style="position:absolute;left:238.19px;top:738.53px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (newfd == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">70 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:59570px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background071.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">117</span></div>
<div style="position:absolute;left:265.02px;top:54.93px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"accept"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">118</span></div>
<div style="position:absolute;left:238.17px;top:70.79px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:85.71px" class="cls_005"><span class="cls_005">119</span></div>
<div style="position:absolute;left:265.02px;top:85.71px" class="cls_005"><span class="cls_005">FD_SET(newfd, &master); </span><span class="cls_013">//</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_013"><span class="cls_013">adiciona ao set master</span></div>
<div style="position:absolute;left:69.76px;top:114.62px" class="cls_005"><span class="cls_005">120</span></div>
<div style="position:absolute;left:265.05px;top:114.62px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (newfd > fdmax) {</span></div>
<div style="position:absolute;left:426.70px;top:114.62px" class="cls_013"><span class="cls_013">//</span></div>
<div style="position:absolute;left:109.49px;top:128.61px" class="cls_013"><span class="cls_013">acompanhe o máximo</span></div>
<div style="position:absolute;left:69.76px;top:144.46px" class="cls_005"><span class="cls_005">121</span></div>
<div style="position:absolute;left:291.87px;top:144.46px" class="cls_005"><span class="cls_005">fdmax = newfd;</span></div>
<div style="position:absolute;left:69.76px;top:160.32px" class="cls_005"><span class="cls_005">122</span></div>
<div style="position:absolute;left:265.02px;top:160.32px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:175.24px" class="cls_005"><span class="cls_005">123</span></div>
<div style="position:absolute;left:265.02px;top:175.24px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"selectserver: nova</span></div>
<div style="position:absolute;left:109.49px;top:189.23px" class="cls_010"><span class="cls_010">conexão de %s no "</span></div>
<div style="position:absolute;left:69.76px;top:205.08px" class="cls_005"><span class="cls_005">124</span></div>
<div style="position:absolute;left:291.91px;top:205.08px" class="cls_010"><span class="cls_010">"socket %d\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:69.76px;top:220.00px" class="cls_005"><span class="cls_005">125</span></div>
<div style="position:absolute;left:109.49px;top:233.99px" class="cls_005"><span class="cls_005">inet_ntop(remoteaddr.ss_family,</span></div>
<div style="position:absolute;left:69.76px;top:248.91px" class="cls_005"><span class="cls_005">126</span></div>
<div style="position:absolute;left:318.73px;top:248.91px" class="cls_005"><span class="cls_005">get_in_addr((</span><span class="cls_014">struct</span></div>
<div style="position:absolute;left:109.49px;top:262.90px" class="cls_005"><span class="cls_005">sockaddr*)&remoteaddr),</span></div>
<div style="position:absolute;left:69.76px;top:277.82px" class="cls_005"><span class="cls_005">127</span></div>
<div style="position:absolute;left:318.73px;top:277.82px" class="cls_005"><span class="cls_005">remoteIP,</span></div>
<div style="position:absolute;left:109.49px;top:291.81px" class="cls_005"><span class="cls_005">INET6_ADDRSTRLEN),</span></div>
<div style="position:absolute;left:69.76px;top:307.67px" class="cls_005"><span class="cls_005">128</span></div>
<div style="position:absolute;left:291.87px;top:307.67px" class="cls_005"><span class="cls_005">newfd);</span></div>
<div style="position:absolute;left:69.76px;top:323.52px" class="cls_005"><span class="cls_005">129</span></div>
<div style="position:absolute;left:238.17px;top:323.52px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:339.37px" class="cls_005"><span class="cls_005">130</span></div>
<div style="position:absolute;left:211.31px;top:339.37px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:355.23px" class="cls_005"><span class="cls_005">131</span></div>
<div style="position:absolute;left:238.19px;top:355.23px" class="cls_013"><span class="cls_013">// manipular dados do cliente</span></div>
<div style="position:absolute;left:69.76px;top:370.15px" class="cls_005"><span class="cls_005">132</span></div>
<div style="position:absolute;left:238.19px;top:370.15px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((nbytes = recv(i, buf, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:384.14px" class="cls_005"><span class="cls_005">buf, </span><span class="cls_009">0</span><span class="cls_005">)) &lt;= </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:399.06px" class="cls_005"><span class="cls_005">133</span></div>
<div style="position:absolute;left:265.05px;top:399.06px" class="cls_013"><span class="cls_013">// há erro ou conexão fechada</span></div>
<div style="position:absolute;left:109.49px;top:413.05px" class="cls_013"><span class="cls_013">pelo cliente</span></div>
<div style="position:absolute;left:69.76px;top:428.90px" class="cls_005"><span class="cls_005">134</span></div>
<div style="position:absolute;left:265.05px;top:428.90px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (nbytes == </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:444.76px" class="cls_005"><span class="cls_005">135</span></div>
<div style="position:absolute;left:291.91px;top:444.76px" class="cls_013"><span class="cls_013">// conexão fechada</span></div>
<div style="position:absolute;left:69.76px;top:459.68px" class="cls_005"><span class="cls_005">136</span></div>
<div style="position:absolute;left:291.87px;top:459.68px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"selectserver: socket</span></div>
<div style="position:absolute;left:109.49px;top:473.67px" class="cls_010"><span class="cls_010">%d desligado\n"</span><span class="cls_005">, i);</span></div>
<div style="position:absolute;left:69.76px;top:489.52px" class="cls_005"><span class="cls_005">137</span></div>
<div style="position:absolute;left:265.02px;top:489.52px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:505.38px" class="cls_005"><span class="cls_005">138</span></div>
<div style="position:absolute;left:291.87px;top:505.38px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"recv"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:521.23px" class="cls_005"><span class="cls_005">139</span></div>
<div style="position:absolute;left:265.02px;top:521.23px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:537.09px" class="cls_005"><span class="cls_005">140</span></div>
<div style="position:absolute;left:265.02px;top:537.09px" class="cls_005"><span class="cls_005">close(i); </span><span class="cls_013">// tchau!</span></div>
<div style="position:absolute;left:69.76px;top:552.01px" class="cls_005"><span class="cls_005">141</span></div>
<div style="position:absolute;left:265.02px;top:552.01px" class="cls_005"><span class="cls_005">FD_CLR(i, &master); </span><span class="cls_013">// remove do</span></div>
<div style="position:absolute;left:109.49px;top:566.00px" class="cls_013"><span class="cls_013">set master</span></div>
<div style="position:absolute;left:69.76px;top:581.85px" class="cls_005"><span class="cls_005">142</span></div>
<div style="position:absolute;left:238.17px;top:581.85px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:69.76px;top:596.77px" class="cls_005"><span class="cls_005">143</span></div>
<div style="position:absolute;left:265.05px;top:596.77px" class="cls_013"><span class="cls_013">// nós temos alguns dados de um</span></div>
<div style="position:absolute;left:109.49px;top:610.76px" class="cls_013"><span class="cls_013">cliente</span></div>
<div style="position:absolute;left:69.76px;top:626.62px" class="cls_005"><span class="cls_005">144</span></div>
<div style="position:absolute;left:265.05px;top:626.62px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(j = </span><span class="cls_009">0</span><span class="cls_005">; j &lt;= fdmax; j++) {</span></div>
<div style="position:absolute;left:69.76px;top:642.47px" class="cls_005"><span class="cls_005">145</span></div>
<div style="position:absolute;left:291.91px;top:642.47px" class="cls_013"><span class="cls_013">// envia para todos!</span></div>
<div style="position:absolute;left:69.76px;top:658.32px" class="cls_005"><span class="cls_005">146</span></div>
<div style="position:absolute;left:291.91px;top:658.32px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (FD_ISSET(j, &master)) {</span></div>
<div style="position:absolute;left:69.76px;top:673.24px" class="cls_005"><span class="cls_005">147</span></div>
<div style="position:absolute;left:318.76px;top:673.24px" class="cls_013"><span class="cls_013">// exceto listener e nós</span></div>
<div style="position:absolute;left:109.49px;top:687.23px" class="cls_013"><span class="cls_013">mesmos</span></div>
<div style="position:absolute;left:69.76px;top:702.16px" class="cls_005"><span class="cls_005">148</span></div>
<div style="position:absolute;left:318.76px;top:702.16px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (j != listener && j</span></div>
<div style="position:absolute;left:109.49px;top:716.14px" class="cls_005"><span class="cls_005">!= i) {</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">71 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:60421px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background072.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.00px" class="cls_005"><span class="cls_005">149</span></div>
<div style="position:absolute;left:345.62px;top:54.00px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (send(j, buf,</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">nbytes, </span><span class="cls_009">0</span><span class="cls_005">) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:69.76px;top:83.84px" class="cls_005"><span class="cls_005">150</span></div>
<div style="position:absolute;left:372.44px;top:83.84px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"send"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:99.70px" class="cls_005"><span class="cls_005">151</span></div>
<div style="position:absolute;left:345.58px;top:99.70px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:115.55px" class="cls_005"><span class="cls_005">152</span></div>
<div style="position:absolute;left:318.73px;top:115.55px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:131.41px" class="cls_005"><span class="cls_005">153</span></div>
<div style="position:absolute;left:291.87px;top:131.41px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:147.26px" class="cls_005"><span class="cls_005">154</span></div>
<div style="position:absolute;left:265.02px;top:147.26px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:163.11px" class="cls_005"><span class="cls_005">155</span></div>
<div style="position:absolute;left:238.17px;top:163.11px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:178.97px" class="cls_005"><span class="cls_005">156</span></div>
<div style="position:absolute;left:211.31px;top:178.97px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">FIM</span><span class="cls_013"> manipular dados do cliente</span></div>
<div style="position:absolute;left:69.76px;top:194.82px" class="cls_005"><span class="cls_005">157</span></div>
<div style="position:absolute;left:184.46px;top:194.82px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">FIM</span><span class="cls_013"> receber nova conexão de entrada</span></div>
<div style="position:absolute;left:69.76px;top:209.74px" class="cls_005"><span class="cls_005">158</span></div>
<div style="position:absolute;left:157.61px;top:209.74px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">FIM</span><span class="cls_013"> do loop através dos descritores de</span></div>
<div style="position:absolute;left:109.49px;top:223.73px" class="cls_013"><span class="cls_013">arquivos</span></div>
<div style="position:absolute;left:69.76px;top:238.65px" class="cls_005"><span class="cls_005">159</span></div>
<div style="position:absolute;left:130.75px;top:238.65px" class="cls_005"><span class="cls_005">} </span><span class="cls_013">// </span><span class="cls_005">FIM</span><span class="cls_013"> para (;;)--e você pensou que nunca</span></div>
<div style="position:absolute;left:109.49px;top:252.64px" class="cls_013"><span class="cls_013">terminaria!</span></div>
<div style="position:absolute;left:69.76px;top:268.50px" class="cls_005"><span class="cls_005">160</span></div>
<div style="position:absolute;left:69.76px;top:284.35px" class="cls_005"><span class="cls_005">161</span></div>
<div style="position:absolute;left:130.75px;top:284.35px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:300.21px" class="cls_005"><span class="cls_005">162</span></div>
<div style="position:absolute;left:103.89px;top:300.21px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:334.25px" class="cls_005"><span class="cls_005">Observe que eu tenho dois sets (conjuntos) de descritores de arquivos no código: master e</span></div>
<div style="position:absolute;left:60.99px;top:350.10px" class="cls_005"><span class="cls_005">read_fds. O primeiro, master, detém todos os descritores de socket que estão atualmente</span></div>
<div style="position:absolute;left:60.99px;top:365.02px" class="cls_005"><span class="cls_005">conectados, bem como o descritor de socket que está escutando novas conexões.</span></div>
<div style="position:absolute;left:60.99px;top:391.13px" class="cls_005"><span class="cls_005">O motivo pelo qual eu tenho o set master é que select() na verdade altera o conjunto que</span></div>
<div style="position:absolute;left:60.99px;top:406.06px" class="cls_005"><span class="cls_005">você passa a ela para re  etir que sockets estão prontos para leitura. Como tenho que</span></div>
<div style="position:absolute;left:60.99px;top:420.98px" class="cls_005"><span class="cls_005">acompanhar as conexões sucessivas de uma chamada select(), devo armazená-las com</span></div>
<div style="position:absolute;left:60.99px;top:436.83px" class="cls_005"><span class="cls_005">segurança em algum lugar. No último minuto, eu copio a master para read_fds e, em</span></div>
<div style="position:absolute;left:60.99px;top:452.69px" class="cls_005"><span class="cls_005">seguida, chamo select().</span></div>
<div style="position:absolute;left:60.99px;top:478.80px" class="cls_005"><span class="cls_005">Mas isso não signi ca que toda vez que recebo uma nova conexão, tenho que adicioná-la ao</span></div>
<div style="position:absolute;left:60.99px;top:493.72px" class="cls_005"><span class="cls_005">set master? Sim! E cada vez que uma conexão fecha, eu tenho que removê-la do set master?</span></div>
<div style="position:absolute;left:60.99px;top:508.64px" class="cls_005"><span class="cls_005">Sim.</span></div>
<div style="position:absolute;left:60.99px;top:534.75px" class="cls_005"><span class="cls_005">Repare que eu veri co quando o socket listener está pronto para leitura. Quando isso</span></div>
<div style="position:absolute;left:60.99px;top:550.61px" class="cls_005"><span class="cls_005">acontece, signi ca que tenho uma nova conexão pendente, e eu a aceito com accept() e</span></div>
<div style="position:absolute;left:60.99px;top:566.46px" class="cls_005"><span class="cls_005">adiciono-a ao set master. Da mesma forma, quando uma conexão de cliente está pronta para</span></div>
<div style="position:absolute;left:60.99px;top:582.32px" class="cls_005"><span class="cls_005">leitura, e recv() retorna 0, eu sei que o cliente fechou a conexão, e devo removê-la do set</span></div>
<div style="position:absolute;left:60.99px;top:598.17px" class="cls_005"><span class="cls_005">master.</span></div>
<div style="position:absolute;left:60.99px;top:625.22px" class="cls_005"><span class="cls_005">Se o cliente, em recv(), retorna diferente de zero, no entanto, eu sei que alguns dados foram</span></div>
<div style="position:absolute;left:60.99px;top:641.07px" class="cls_005"><span class="cls_005">recebidos. Então, eu os obtenho, e depois percorrendo a lista master envio esses dados para</span></div>
<div style="position:absolute;left:60.99px;top:655.99px" class="cls_005"><span class="cls_005">o resto dos clientes conectados.</span></div>
<div style="position:absolute;left:60.99px;top:682.10px" class="cls_005"><span class="cls_005">E isso, meus amigos, é uma visão geral simpli cadíssima da poderosa função select().</span></div>
<div style="position:absolute;left:60.99px;top:709.15px" class="cls_005"><span class="cls_005">Nota rápida para todos os fãs de Linux por aí: às vezes, em raras circunstâncias, a select()</span></div>
<div style="position:absolute;left:60.99px;top:724.07px" class="cls_005"><span class="cls_005">do Linux pode retornar "pronto-para-ler" e, em seguida, não estar realmente pronto para ler! Isso</span></div>
<div style="position:absolute;left:60.99px;top:738.99px" class="cls_005"><span class="cls_005">signi ca que ele bloqueará a read() depois que select() declarar que não! De qualquer</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">72 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:61272px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background073.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">forma, a solução alternativa é de nir o sinalizador O_NONBLOCK no socket de recebimento</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">para que se gerem erros com EWOULDBLOCK (que você pode ignorar com segurança se</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">ocorrerem). Consulte a </span><span class="cls_023">pá</span><span class="cls_006">g</span><span class="cls_023">ina de referência fcntl</span><span class="cls_006">()</span><span class="cls_005"> para obter mais informações sobre</span></div>
<div style="position:absolute;left:60.99px;top:101.56px" class="cls_005"><span class="cls_005">como con gurar um socket para non-blocking.</span></div>
<div style="position:absolute;left:60.99px;top:127.68px" class="cls_005"><span class="cls_005">Em adição, aqui está um acréscimo tardio como bônus: existe outra função chamada poll()</span></div>
<div style="position:absolute;left:60.99px;top:143.53px" class="cls_005"><span class="cls_005">que se comporta da mesma maneira que select(), mas com um sistema diferente para a</span></div>
<div style="position:absolute;left:60.99px;top:158.45px" class="cls_005"><span class="cls_005">gestão dos sets de descritores de arquivos. </span><span class="cls_023">Con ra!</span></div>
<div style="position:absolute;left:60.99px;top:187.30px" class="cls_007"><span class="cls_007">Manipulando send()s parcialmente</span></div>
<div style="position:absolute;left:60.99px;top:223.62px" class="cls_005"><span class="cls_005">Lembra-se da seção </span><span class="cls_023">sobre send</span><span class="cls_006">()</span><span class="cls_005">, acima, quando eu disse que send() pode não enviar</span></div>
<div style="position:absolute;left:60.99px;top:238.54px" class="cls_005"><span class="cls_005">todos os bytes que você pediu? Ou seja, você deseja enviar 512 bytes, mas ela retorna 412. O</span></div>
<div style="position:absolute;left:60.99px;top:252.53px" class="cls_005"><span class="cls_005">que aconteceu com os 100 bytes restantes?</span></div>
<div style="position:absolute;left:60.99px;top:277.71px" class="cls_005"><span class="cls_005">Bem, eles ainda estão em seu pequeno buffer esperando para serem enviados. Devido a</span></div>
<div style="position:absolute;left:60.99px;top:291.70px" class="cls_005"><span class="cls_005">circunstâncias além do seu controle, o kernel decidiu não enviar todos os dados em um único</span></div>
<div style="position:absolute;left:60.99px;top:305.68px" class="cls_005"><span class="cls_005">pedaço, e agora, meu amigo, cabe a você enviar os dados restantes.</span></div>
<div style="position:absolute;left:60.99px;top:330.86px" class="cls_005"><span class="cls_005">Você poderia escrever uma função como essa, para fazer isso, também:</span></div>
<div style="position:absolute;left:83.19px;top:363.97px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:363.97px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:379.83px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:379.83px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:83.19px;top:395.68px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:411.53px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:411.53px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sendall(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">char</span><span class="cls_005"> *buf, </span><span class="cls_008">int</span><span class="cls_005"> *len)</span></div>
<div style="position:absolute;left:83.19px;top:427.39px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:427.39px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:443.24px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:443.24px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> total = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:278.48px;top:443.24px" class="cls_013"><span class="cls_013">// quantos bytes enviamos</span></div>
<div style="position:absolute;left:83.19px;top:459.10px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:459.10px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> bytesleft = *len; </span><span class="cls_013">// quantos temos para enviar</span></div>
<div style="position:absolute;left:83.19px;top:474.95px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:474.95px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> n;</span></div>
<div style="position:absolute;left:83.19px;top:490.81px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:506.66px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:506.66px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(total &lt; *len) {</span></div>
<div style="position:absolute;left:76.48px;top:522.51px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:157.60px;top:522.51px" class="cls_005"><span class="cls_005">n = send(s, buf+total, bytesleft, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:538.37px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:157.61px;top:538.37px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (n == -</span><span class="cls_009">1</span><span class="cls_005">) { </span><span class="cls_014">break</span><span class="cls_005">; }</span></div>
<div style="position:absolute;left:76.48px;top:554.22px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:157.60px;top:554.22px" class="cls_005"><span class="cls_005">total += n;</span></div>
<div style="position:absolute;left:76.48px;top:570.08px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:157.60px;top:570.08px" class="cls_005"><span class="cls_005">bytesleft -= n;</span></div>
<div style="position:absolute;left:76.48px;top:585.93px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:585.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:601.78px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:616.71px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:616.71px" class="cls_005"><span class="cls_005">*len = total; </span><span class="cls_013">// retorna número realmente enviado</span></div>
<div style="position:absolute;left:109.49px;top:630.70px" class="cls_013"><span class="cls_013">aqui</span></div>
<div style="position:absolute;left:76.48px;top:646.55px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:661.47px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:661.47px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> n==-</span><span class="cls_009">1</span><span class="cls_005">?-</span><span class="cls_009">1</span><span class="cls_005">:</span><span class="cls_009">0</span><span class="cls_005">; </span><span class="cls_013">// retorna -1 em falha, 0 em</span></div>
<div style="position:absolute;left:109.49px;top:675.46px" class="cls_013"><span class="cls_013">successo</span></div>
<div style="position:absolute;left:76.48px;top:691.31px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:691.31px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:725.35px" class="cls_005"><span class="cls_005">Neste exemplo, s é o socket para o qual você deseja enviar os dados, buf é um buffer</span></div>
<div style="position:absolute;left:60.99px;top:741.21px" class="cls_005"><span class="cls_005">contendo os dados, e len é um ponteiro para um int contendo o número de bytes do buffer.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">73 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:62123px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background074.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">A função retorna -1 em caso de erro (e errno é de nido a partir da chamada a send().) Além</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">disso, o número de bytes realmente enviados é retornado em len. Este será o mesmo número</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">de bytes que você pediu para enviar, a menos que tenha ocorrido um erro. sendall() fará o</span></div>
<div style="position:absolute;left:60.99px;top:101.56px" class="cls_005"><span class="cls_005">melhor possível, enviando os dados para fora, mas se houver um erro ele retornará de volta a</span></div>
<div style="position:absolute;left:60.99px;top:115.55px" class="cls_005"><span class="cls_005">você imediatamente.</span></div>
<div style="position:absolute;left:60.99px;top:140.73px" class="cls_005"><span class="cls_005">Para completar, aqui está um exemplo de chamada para a função:</span></div>
<div style="position:absolute;left:83.19px;top:173.84px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:173.84px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[</span><span class="cls_009">10</span><span class="cls_005">] = </span><span class="cls_010">"Beej!"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:189.69px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:189.69px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> len;</span></div>
<div style="position:absolute;left:83.19px;top:205.55px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:221.40px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:221.40px" class="cls_005"><span class="cls_005">len = strlen(buf);</span></div>
<div style="position:absolute;left:83.19px;top:237.26px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:237.26px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (sendall(s, buf, &len) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:83.19px;top:253.11px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:253.11px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"sendall"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:268.03px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:268.03px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Nós só enviamos %d bytes por causa do</span></div>
<div style="position:absolute;left:109.49px;top:282.02px" class="cls_010"><span class="cls_010">erro!\n"</span><span class="cls_005">, len);</span></div>
<div style="position:absolute;left:83.19px;top:297.87px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:297.87px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:330.98px" class="cls_005"><span class="cls_005">O que acontece ao  nal da recepção quando chega apenas parte de um pacote? Se os pacotes</span></div>
<div style="position:absolute;left:60.99px;top:344.97px" class="cls_005"><span class="cls_005">são de comprimento variável, como o receptor sabe quando um pacote termina e outro</span></div>
<div style="position:absolute;left:60.99px;top:358.96px" class="cls_005"><span class="cls_005">começa? Sim, cenários do mundo real são bem mais complexos. Você provavelmente</span></div>
<div style="position:absolute;left:60.99px;top:372.95px" class="cls_005"><span class="cls_005">precisará encapsular (lembra-se da </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão de encapsulamento de dados</span><span class="cls_005"> lá no começo? Leia-a</span></div>
<div style="position:absolute;left:60.99px;top:386.94px" class="cls_005"><span class="cls_005">para mais detalhes!).</span></div>
<div style="position:absolute;left:60.99px;top:413.92px" class="cls_007"><span class="cls_007">Serialização—Como embalar Dados</span></div>
<div style="position:absolute;left:60.99px;top:449.30px" class="cls_005"><span class="cls_005">É fácil enviar dados em texto através da rede, você está descobrindo, mas o que acontece se</span></div>
<div style="position:absolute;left:60.99px;top:464.23px" class="cls_005"><span class="cls_005">você quiser enviar alguns dados "binários" como int ou float? Para isso você tem algumas</span></div>
<div style="position:absolute;left:60.99px;top:479.15px" class="cls_005"><span class="cls_005">opções.</span></div>
<div style="position:absolute;left:76.97px;top:505.26px" class="cls_005"><span class="cls_005">1. Converter o número em texto com uma função como sprintf() e o enviar. O receptor</span></div>
<div style="position:absolute;left:88.97px;top:520.18px" class="cls_005"><span class="cls_005">irá analisar o texto recebido e o converterá em um número usando uma função como</span></div>
<div style="position:absolute;left:88.97px;top:535.10px" class="cls_005"><span class="cls_005">strtol().</span></div>
<div style="position:absolute;left:76.97px;top:561.22px" class="cls_005"><span class="cls_005">2. Basta enviar os dados em sua forma bruta, passando o ponteiro dos mesmos para</span></div>
<div style="position:absolute;left:88.97px;top:576.14px" class="cls_005"><span class="cls_005">send().</span></div>
<div style="position:absolute;left:76.97px;top:602.25px" class="cls_005"><span class="cls_005">3. Codi que o número em uma forma binária portátil. O receptor o decodi cará.</span></div>
<div style="position:absolute;left:60.99px;top:627.43px" class="cls_005"><span class="cls_005">Visualização prévia! Apenas esta noite!</span></div>
<div style="position:absolute;left:60.99px;top:652.61px" class="cls_005"><span class="cls_005">[Cortinas se abrem]</span></div>
<div style="position:absolute;left:60.99px;top:677.79px" class="cls_005"><span class="cls_005">Beej diz: "Eu pre ro o Método três, acima!"</span></div>
<div style="position:absolute;left:60.99px;top:702.97px" class="cls_005"><span class="cls_005">[THE END]</span></div>
<div style="position:absolute;left:60.99px;top:728.15px" class="cls_005"><span class="cls_005">(Antes de começar esta seção a sério, devo dizer-lhe que existem bibliotecas para fazer isso, e</span></div>
<div style="position:absolute;left:60.99px;top:742.14px" class="cls_005"><span class="cls_005">criar o seu próprio código e mantê-lo livre de erros é um grande desa o. Então, procure e faça</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">74 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:62974px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background075.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">sua lição de casa antes de decidir implementar essas coisas você mesmo. Eu incluo as</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">informações aqui para aqueles curiosos sobre como coisas como essa funcionam.)</span></div>
<div style="position:absolute;left:60.99px;top:93.17px" class="cls_005"><span class="cls_005">Na verdade todos os métodos, acima, têm suas vantagens e desvantagens, mas como eu</span></div>
<div style="position:absolute;left:60.99px;top:107.16px" class="cls_005"><span class="cls_005">disse, em geral, eu pre ro o terceiro método. Primeiro, porém, vamos falar sobre algumas das</span></div>
<div style="position:absolute;left:60.99px;top:121.15px" class="cls_005"><span class="cls_005">vantagens e desvantagens para os outros dois.</span></div>
<div style="position:absolute;left:60.99px;top:146.33px" class="cls_005"><span class="cls_005">O primeiro método, codi cando os números como texto antes de enviar, tem a vantagem de</span></div>
<div style="position:absolute;left:60.99px;top:160.32px" class="cls_005"><span class="cls_005">que você pode facilmente imprimir e ler os dados que estão vindo pelo  o. Às vezes, um</span></div>
<div style="position:absolute;left:60.99px;top:174.31px" class="cls_005"><span class="cls_005">protocolo legível é excelente para uso numa situação que não requeira muita largura de banda</span></div>
<div style="position:absolute;left:60.99px;top:188.29px" class="cls_005"><span class="cls_005">como no </span><span class="cls_023">Internet Rela</span><span class="cls_006">y</span><span class="cls_023"> Chat </span><span class="cls_006">(</span><span class="cls_023">IRC</span><span class="cls_006">)</span><span class="cls_024"><sup>33</sup></span><span class="cls_005">. No entanto, tem a desvantagem de ser lento para</span></div>
<div style="position:absolute;left:60.99px;top:204.22px" class="cls_005"><span class="cls_005">converter e os resultados quase sempre ocupam mais espaço do que o número original!</span></div>
<div style="position:absolute;left:60.99px;top:229.40px" class="cls_005"><span class="cls_005">Método dois: enviar os dados brutos. Este é bem fácil (mas perigoso!): basta ter um ponteiro</span></div>
<div style="position:absolute;left:60.99px;top:243.39px" class="cls_005"><span class="cls_005">para os dados a serem enviados, e chamar send com ele.</span></div>
<div style="position:absolute;left:94.85px;top:276.49px" class="cls_008"><span class="cls_008">double</span><span class="cls_005"> d = </span><span class="cls_009">3490.15926535</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:94.85px;top:308.20px" class="cls_005"><span class="cls_005">send(s, &d, </span><span class="cls_014">sizeof</span><span class="cls_005"> d, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:277.56px;top:308.20px" class="cls_013"><span class="cls_013">/* </span><span class="cls_020">PERIGO</span><span class="cls_013">--não-portátil! */</span></div>
<div style="position:absolute;left:60.99px;top:341.31px" class="cls_005"><span class="cls_005">O receptor recebe assim:</span></div>
<div style="position:absolute;left:94.85px;top:374.42px" class="cls_008"><span class="cls_008">double</span><span class="cls_005"> d;</span></div>
<div style="position:absolute;left:94.85px;top:406.13px" class="cls_005"><span class="cls_005">recv(s, &d, </span><span class="cls_014">sizeof</span><span class="cls_005"> d, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:277.56px;top:406.13px" class="cls_013"><span class="cls_013">/* </span><span class="cls_020">PERIGO</span><span class="cls_013">--não-portátil! */</span></div>
<div style="position:absolute;left:60.99px;top:439.23px" class="cls_005"><span class="cls_005">Rápido, simples—O que há para não gostar? Bem, acontece que nem todas as arquiteturas</span></div>
<div style="position:absolute;left:60.99px;top:454.15px" class="cls_005"><span class="cls_005">representam um double (ou int para esse assunto), com a mesma representação de bit ou</span></div>
<div style="position:absolute;left:60.99px;top:469.08px" class="cls_005"><span class="cls_005">mesmo a mesma ordenação de bytes! O código é de nitivamente não portátil. (Ei, talvez você</span></div>
<div style="position:absolute;left:60.99px;top:483.06px" class="cls_005"><span class="cls_005">não precise de portabilidade, e nesse caso isso é bom e rápido.)</span></div>
<div style="position:absolute;left:60.99px;top:509.18px" class="cls_005"><span class="cls_005">Ao empacotar tipos inteiros já vimos como a classe de funções htons() pode ajudar a</span></div>
<div style="position:absolute;left:60.99px;top:524.10px" class="cls_005"><span class="cls_005">manter as coisas portáteis, convertendo os números para Network Byte Order, e como essa é a</span></div>
<div style="position:absolute;left:60.99px;top:539.02px" class="cls_005"><span class="cls_005">coisa certa a se fazer. Infelizmente, não há funções semelhantes para tipos float. Toda a</span></div>
<div style="position:absolute;left:60.99px;top:553.94px" class="cls_005"><span class="cls_005">esperança está perdida?</span></div>
<div style="position:absolute;left:60.99px;top:579.12px" class="cls_005"><span class="cls_005">Não temas! (Você  cou com medo por um segundo? Não? Nem mesmo um pouco?) Há algo</span></div>
<div style="position:absolute;left:60.99px;top:593.11px" class="cls_005"><span class="cls_005">que podemos fazer: podemos embalar (ou "empacotar", ou "serializar", ou um dos outros</span></div>
<div style="position:absolute;left:60.99px;top:607.10px" class="cls_005"><span class="cls_005">milhões de nomes) os dados em um formato binário conhecido que o receptor possa</span></div>
<div style="position:absolute;left:60.99px;top:621.09px" class="cls_005"><span class="cls_005">descompactar no lado remoto.</span></div>
<div style="position:absolute;left:60.99px;top:647.20px" class="cls_005"><span class="cls_005">O que quero dizer com "formato binário conhecido"? Bem, nós já vimos o exemplo de htons(),</span></div>
<div style="position:absolute;left:60.99px;top:662.12px" class="cls_005"><span class="cls_005">certo? Ele altera (ou "codi ca", se você quiser pensar dessa maneira) um número de host em</span></div>
<div style="position:absolute;left:60.99px;top:676.11px" class="cls_005"><span class="cls_005">qualquer formato para Network Byte Order. Para inverter (unencode) o número, o receptor</span></div>
<div style="position:absolute;left:60.99px;top:691.03px" class="cls_005"><span class="cls_005">chama ntohs().</span></div>
<div style="position:absolute;left:60.99px;top:717.15px" class="cls_005"><span class="cls_005">Mas eu não acabei de dizer que não havia qualquer função para outros tipos não inteiros? Sim.</span></div>
<div style="position:absolute;left:60.99px;top:731.14px" class="cls_005"><span class="cls_005">Eu disse. E uma vez que não há nenhuma forma padrão em C para fazer isso, é um pouco</span></div>
<div style="position:absolute;left:60.99px;top:745.12px" class="cls_005"><span class="cls_005">pickle (um trocadilho gratuito para os fãs de Python).</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">75 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:63825px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background076.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">A única coisa a fazer é empacotar os dados em um formato conhecido e enviá-los pelo  o para</span></div>
<div style="position:absolute;left:60.99px;top:68.92px" class="cls_005"><span class="cls_005">a decodi cação. Por exemplo, para embalar floats, aqui está </span><span class="cls_023">al</span><span class="cls_006">g</span><span class="cls_023">o rápido e su</span><span class="cls_006">j</span><span class="cls_023">o com muito</span></div>
<div style="position:absolute;left:60.99px;top:83.84px" class="cls_023"><span class="cls_023">espa</span><span class="cls_006">ç</span><span class="cls_023">o para melhorias</span><span class="cls_024"><sup>34</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:118.89px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:118.89px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdint.h></span></div>
<div style="position:absolute;left:83.19px;top:134.74px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:150.59px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:150.59px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> htonf(</span><span class="cls_008">float</span><span class="cls_005"> f)</span></div>
<div style="position:absolute;left:83.19px;top:166.45px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:166.45px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:182.30px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:130.75px;top:182.30px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> p;</span></div>
<div style="position:absolute;left:83.19px;top:198.16px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:198.16px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> sign;</span></div>
<div style="position:absolute;left:83.19px;top:214.01px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:229.86px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:229.86px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (f &lt; </span><span class="cls_009">0</span><span class="cls_005">) { sign = </span><span class="cls_009">1</span><span class="cls_005">; f = -f; }</span></div>
<div style="position:absolute;left:83.19px;top:245.72px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:245.72px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { sign = </span><span class="cls_009">0</span><span class="cls_005">; }</span></div>
<div style="position:absolute;left:76.48px;top:261.57px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:276.49px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:276.49px" class="cls_005"><span class="cls_005">p = ((((</span><span class="cls_008">uint32_t</span><span class="cls_005">)f)&</span><span class="cls_009">0x7fff</span><span class="cls_005">)&lt;&lt;</span><span class="cls_009">16</span><span class="cls_005">) | (sign&lt;&lt;</span><span class="cls_009">31</span><span class="cls_005">); </span><span class="cls_013">//</span></div>
<div style="position:absolute;left:109.49px;top:290.48px" class="cls_013"><span class="cls_013">parte inteira e sinal</span></div>
<div style="position:absolute;left:76.48px;top:305.41px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:305.41px" class="cls_005"><span class="cls_005">p |= (</span><span class="cls_008">uint32_t</span><span class="cls_005">)(((f - (</span><span class="cls_008">int</span><span class="cls_005">)f) * </span><span class="cls_009">65536.0</span><span class="cls_005">f))&</span><span class="cls_009">0xffff</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:109.49px;top:319.39px" class="cls_013"><span class="cls_013">// fração</span></div>
<div style="position:absolute;left:76.48px;top:335.25px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:76.48px;top:351.10px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:351.10px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> p;</span></div>
<div style="position:absolute;left:76.48px;top:366.96px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:366.96px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:382.81px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:398.66px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:398.66px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> ntohf(</span><span class="cls_008">uint32_t</span><span class="cls_005"> p)</span></div>
<div style="position:absolute;left:76.48px;top:414.52px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:414.52px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:430.37px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:430.37px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> f = ((p>></span><span class="cls_009">16</span><span class="cls_005">)&</span><span class="cls_009">0x7fff</span><span class="cls_005">); </span><span class="cls_013">// parte inteira</span></div>
<div style="position:absolute;left:76.48px;top:446.23px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:446.23px" class="cls_005"><span class="cls_005">f += (p&</span><span class="cls_009">0xffff</span><span class="cls_005">) / </span><span class="cls_009">65536.0</span><span class="cls_005">f; </span><span class="cls_013">// fração</span></div>
<div style="position:absolute;left:76.48px;top:462.08px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:477.00px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:477.00px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (((p>></span><span class="cls_009">31</span><span class="cls_005">)&</span><span class="cls_009">0x1</span><span class="cls_005">) == </span><span class="cls_009">0x1</span><span class="cls_005">) { f = -f; } </span><span class="cls_013">// conjunto de</span></div>
<div style="position:absolute;left:109.49px;top:490.99px" class="cls_013"><span class="cls_013">bits de sinal</span></div>
<div style="position:absolute;left:76.48px;top:506.85px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:76.48px;top:522.70px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:522.70px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> f;</span></div>
<div style="position:absolute;left:76.48px;top:538.55px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:538.55px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:572.59px" class="cls_005"><span class="cls_005">O código acima é uma espécie de implementação ingênua que armazena um float em um</span></div>
<div style="position:absolute;left:60.99px;top:587.52px" class="cls_005"><span class="cls_005">número de 32-bit. O bit alto (31) é usado para armazenar o sinal do número ("1" signi ca</span></div>
<div style="position:absolute;left:60.99px;top:601.50px" class="cls_005"><span class="cls_005">negativo), e os próximos sete bits (30-16) são usados para armazenar a porção inteira do</span></div>
<div style="position:absolute;left:60.99px;top:616.43px" class="cls_005"><span class="cls_005">número float. Finalmente, os bits restantes (15-0) são usados para armazenar a parte</span></div>
<div style="position:absolute;left:60.99px;top:631.35px" class="cls_005"><span class="cls_005">fracionária do número.</span></div>
<div style="position:absolute;left:60.99px;top:656.53px" class="cls_005"><span class="cls_005">O uso é bastante simples:</span></div>
<div style="position:absolute;left:83.19px;top:689.64px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:689.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:705.49px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:721.34px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:721.34px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:83.19px;top:737.20px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:737.20px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">76 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:64676px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background077.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> f = </span><span class="cls_009">3.1415926</span><span class="cls_005">, f2;</span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> netf;</span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_005"><span class="cls_005">netf = htonf(f);</span></div>
<div style="position:absolute;left:251.65px;top:102.50px" class="cls_013"><span class="cls_013">// converte para formato "network"</span></div>
<div style="position:absolute;left:83.19px;top:118.35px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_005"><span class="cls_005">f2 = ntohf(netf); </span><span class="cls_013">// converter de volta para teste</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:150.06px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Original: %f\n"</span><span class="cls_005">, f);</span></div>
<div style="position:absolute;left:372.52px;top:150.06px" class="cls_013"><span class="cls_013">// 3.141593</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:165.91px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">" Network: 0x%08X\n"</span><span class="cls_005">, netf); </span><span class="cls_013">// 0x0003243F</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:181.77px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Unpacked: %f\n"</span><span class="cls_005">, f2);</span></div>
<div style="position:absolute;left:372.52px;top:181.77px" class="cls_013"><span class="cls_013">// 3.141586</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:213.47px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:213.47px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:229.33px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:229.33px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:262.44px" class="cls_005"><span class="cls_005">No lado positivo, é pequeno, simples e rápido. No lado negativo, não é uma utilização e ciente</span></div>
<div style="position:absolute;left:60.99px;top:276.42px" class="cls_005"><span class="cls_005">do espaço e o intervalo é severamente restrito—tente armazenar um número maior do que</span></div>
<div style="position:absolute;left:60.99px;top:290.41px" class="cls_005"><span class="cls_005">32767 e será muito infeliz! Você também pode ver no exemplo acima que as últimas duas</span></div>
<div style="position:absolute;left:60.99px;top:304.40px" class="cls_005"><span class="cls_005">casas decimais não são corretamente preservadas.</span></div>
<div style="position:absolute;left:60.99px;top:329.58px" class="cls_005"><span class="cls_005">O que podemos fazer em vez disso? Bem, O padrão para armazenar números de ponto</span></div>
<div style="position:absolute;left:67.34px;top:343.57px" class="cls_005"><span class="cls_005">utuante é conhecido como </span><span class="cls_023">IEEE-754</span><span class="cls_024"><sup>35</sup></span><span class="cls_005">. Muitos computadores usam este formato</span></div>
<div style="position:absolute;left:60.99px;top:359.50px" class="cls_005"><span class="cls_005">internamente para fazer contas com ponto   utuante, por isso, nesses casos, estritamente</span></div>
<div style="position:absolute;left:60.99px;top:373.48px" class="cls_005"><span class="cls_005">falando, a conversão não precisaria ser feita. Mas se você quiser que o seu código fonte seja</span></div>
<div style="position:absolute;left:60.99px;top:387.47px" class="cls_005"><span class="cls_005">portátil essa é uma suposição que você não pode necessariamente fazer. (Por outro lado, se</span></div>
<div style="position:absolute;left:60.99px;top:401.46px" class="cls_005"><span class="cls_005">você quer que as coisas sejam rápidas, você deve otimizá-lo em plataformas que não precisam</span></div>
<div style="position:absolute;left:60.99px;top:416.38px" class="cls_005"><span class="cls_005">fazê-lo! Isso é o que htons() e sua turma fazem.)</span></div>
<div style="position:absolute;left:60.99px;top:442.50px" class="cls_023"><span class="cls_023">Aqui está um códi</span><span class="cls_006">g</span><span class="cls_023">o que codi ca   oats e doubles no formato IEEE 754</span><span class="cls_024"><sup>36</sup></span><span class="cls_005">. (Principalmente—</span></div>
<div style="position:absolute;left:60.99px;top:458.42px" class="cls_005"><span class="cls_005">isso não codi ca NaN ou in nito, mas poderia ser modi cado para fazer isso.)</span></div>
<div style="position:absolute;left:83.19px;top:491.53px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:491.53px" class="cls_012"><span class="cls_012">#define pack754_32(f) (pack754((f), 32, 8))</span></div>
<div style="position:absolute;left:83.19px;top:507.38px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:507.38px" class="cls_012"><span class="cls_012">#define pack754_64(f) (pack754((f), 64, 11))</span></div>
<div style="position:absolute;left:83.19px;top:523.24px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:523.24px" class="cls_012"><span class="cls_012">#define unpack754_32(i) (unpack754((i), 32, 8))</span></div>
<div style="position:absolute;left:83.19px;top:539.09px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:539.09px" class="cls_012"><span class="cls_012">#define unpack754_64(i) (unpack754((i), 64, 11))</span></div>
<div style="position:absolute;left:83.19px;top:554.94px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:569.87px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:569.87px" class="cls_008"><span class="cls_008">uint64_t</span><span class="cls_005"> pack754(</span><span class="cls_008">long  double</span><span class="cls_005"> f, </span><span class="cls_008">unsigned</span><span class="cls_005"> bits, </span><span class="cls_008">unsigned</span></div>
<div style="position:absolute;left:109.49px;top:583.86px" class="cls_005"><span class="cls_005">expbits)</span></div>
<div style="position:absolute;left:83.19px;top:599.71px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:599.71px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:615.56px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:615.56px" class="cls_008"><span class="cls_008">long  double</span><span class="cls_005"> fnorm;</span></div>
<div style="position:absolute;left:83.19px;top:631.42px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:631.42px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> shift;</span></div>
<div style="position:absolute;left:76.48px;top:647.27px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:647.27px" class="cls_008"><span class="cls_008">long  long</span><span class="cls_005"> sign, exp, significand;</span></div>
<div style="position:absolute;left:76.48px;top:662.19px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:662.19px" class="cls_008"><span class="cls_008">unsigned</span><span class="cls_005"> significandbits = bits - expbits - </span><span class="cls_009">1</span><span class="cls_005">; </span><span class="cls_013">// -1</span></div>
<div style="position:absolute;left:109.49px;top:676.18px" class="cls_013"><span class="cls_013">para sign bit</span></div>
<div style="position:absolute;left:76.48px;top:692.04px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:706.96px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:706.96px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (f == </span><span class="cls_009">0.0</span><span class="cls_005">) </span><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">; </span><span class="cls_013">// tirar este caso especial</span></div>
<div style="position:absolute;left:109.49px;top:720.95px" class="cls_013"><span class="cls_013">do caminho</span></div>
<div style="position:absolute;left:76.48px;top:736.80px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">77 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:65527px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background078.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_013"><span class="cls_013">// verifique o sinal e comece a normalização</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (f &lt; </span><span class="cls_009">0</span><span class="cls_005">) { sign = </span><span class="cls_009">1</span><span class="cls_005">; fnorm = -f; }</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { sign = </span><span class="cls_009">0</span><span class="cls_005">; fnorm = f; }</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:117.42px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:117.42px" class="cls_013"><span class="cls_013">// obtenha a forma normalizada de f e acompanhe o</span></div>
<div style="position:absolute;left:109.49px;top:131.41px" class="cls_013"><span class="cls_013">expoente</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:147.26px" class="cls_005"><span class="cls_005">shift = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:163.11px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(fnorm >= </span><span class="cls_009">2.0</span><span class="cls_005">) { fnorm /= </span><span class="cls_009">2.0</span><span class="cls_005">; shift++; }</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(fnorm &lt; </span><span class="cls_009">1.0</span><span class="cls_005">) { fnorm *= </span><span class="cls_009">2.0</span><span class="cls_005">; shift--; }</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_005"><span class="cls_005">fnorm = fnorm - </span><span class="cls_009">1.0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:225.60px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:225.60px" class="cls_013"><span class="cls_013">// calcular a forma binária (não flutuante) dos</span></div>
<div style="position:absolute;left:109.49px;top:239.59px" class="cls_013"><span class="cls_013">dados significativos</span></div>
<div style="position:absolute;left:76.48px;top:254.51px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:254.51px" class="cls_005"><span class="cls_005">significand = fnorm * ((</span><span class="cls_009">1</span><span class="cls_005">LL&lt;&lt;significandbits) +</span></div>
<div style="position:absolute;left:109.49px;top:268.50px" class="cls_009"><span class="cls_009">0.5</span><span class="cls_005">f);</span></div>
<div style="position:absolute;left:76.48px;top:284.35px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:300.21px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:300.21px" class="cls_013"><span class="cls_013">// obter o expoente tendencioso</span></div>
<div style="position:absolute;left:76.48px;top:315.13px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:315.13px" class="cls_005"><span class="cls_005">exp = shift + ((</span><span class="cls_009">1</span><span class="cls_005">&lt;&lt;(expbits-</span><span class="cls_009">1</span><span class="cls_005">)) - </span><span class="cls_009">1</span><span class="cls_005">); </span><span class="cls_013">// shift +</span></div>
<div style="position:absolute;left:109.49px;top:329.12px" class="cls_013"><span class="cls_013">bias</span></div>
<div style="position:absolute;left:76.48px;top:344.97px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:76.48px;top:360.82px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:360.82px" class="cls_013"><span class="cls_013">// retornar a resposta final</span></div>
<div style="position:absolute;left:76.48px;top:375.75px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:375.75px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> (sign&lt;&lt;(bits-</span><span class="cls_009">1</span><span class="cls_005">)) | (exp&lt;&lt;(bits-expbits-</span><span class="cls_009">1</span><span class="cls_005">)) |</span></div>
<div style="position:absolute;left:109.49px;top:389.74px" class="cls_005"><span class="cls_005">significand;</span></div>
<div style="position:absolute;left:76.48px;top:405.59px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:103.89px;top:405.59px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:421.44px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:76.48px;top:436.37px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:103.89px;top:436.37px" class="cls_008"><span class="cls_008">long  double</span><span class="cls_005"> unpack754(</span><span class="cls_008">uint64_t</span><span class="cls_005"> i, </span><span class="cls_008">unsigned</span><span class="cls_005"> bits,</span></div>
<div style="position:absolute;left:109.49px;top:450.35px" class="cls_008"><span class="cls_008">unsigned</span><span class="cls_005"> expbits)</span></div>
<div style="position:absolute;left:76.48px;top:466.21px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:103.89px;top:466.21px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:482.06px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:482.06px" class="cls_008"><span class="cls_008">long  double</span><span class="cls_005"> result;</span></div>
<div style="position:absolute;left:76.48px;top:497.92px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:497.92px" class="cls_008"><span class="cls_008">long  long</span><span class="cls_005"> shift;</span></div>
<div style="position:absolute;left:76.48px;top:513.77px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:513.77px" class="cls_008"><span class="cls_008">unsigned</span><span class="cls_005"> bias;</span></div>
<div style="position:absolute;left:76.48px;top:528.69px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:528.69px" class="cls_008"><span class="cls_008">unsigned</span><span class="cls_005"> significandbits = bits - expbits - </span><span class="cls_009">1</span><span class="cls_005">; </span><span class="cls_013">// -1</span></div>
<div style="position:absolute;left:109.49px;top:542.68px" class="cls_013"><span class="cls_013">para bit de sinal</span></div>
<div style="position:absolute;left:76.48px;top:558.54px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:76.48px;top:574.39px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:130.75px;top:574.39px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (i == </span><span class="cls_009">0</span><span class="cls_005">) </span><span class="cls_014">return</span><span class="cls_009"> 0.0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:590.24px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:76.48px;top:606.10px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:606.10px" class="cls_013"><span class="cls_013">// puxe o significando</span></div>
<div style="position:absolute;left:76.48px;top:621.95px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:130.75px;top:621.95px" class="cls_005"><span class="cls_005">result = (i&((</span><span class="cls_009">1</span><span class="cls_005">LL&lt;&lt;significandbits)-</span><span class="cls_009">1</span><span class="cls_005">)); </span><span class="cls_013">// mascarar</span></div>
<div style="position:absolute;left:76.48px;top:636.87px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:636.87px" class="cls_005"><span class="cls_005">result /= (</span><span class="cls_009">1</span><span class="cls_005">LL&lt;&lt;significandbits); </span><span class="cls_013">// converter de</span></div>
<div style="position:absolute;left:109.49px;top:650.86px" class="cls_013"><span class="cls_013">volta para float</span></div>
<div style="position:absolute;left:76.48px;top:666.72px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:130.75px;top:666.72px" class="cls_005"><span class="cls_005">result += </span><span class="cls_009">1.0</span><span class="cls_005">f; </span><span class="cls_013">// adicione o de volta</span></div>
<div style="position:absolute;left:76.48px;top:682.57px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:76.48px;top:698.43px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:130.75px;top:698.43px" class="cls_013"><span class="cls_013">// lidar com o expoente</span></div>
<div style="position:absolute;left:76.48px;top:714.28px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:130.75px;top:714.28px" class="cls_005"><span class="cls_005">bias = (</span><span class="cls_009">1</span><span class="cls_005">&lt;&lt;(expbits-</span><span class="cls_009">1</span><span class="cls_005">)) - </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">78 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:66378px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background079.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:54.00px" class="cls_005"><span class="cls_005">shift = ((i>>significandbits)&((</span><span class="cls_009">1</span><span class="cls_005">LL&lt;&lt;expbits)-</span><span class="cls_009">1</span><span class="cls_005">)) -</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">bias;</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:130.75px;top:83.84px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(shift > </span><span class="cls_009">0</span><span class="cls_005">) { result *= </span><span class="cls_009">2.0</span><span class="cls_005">; shift--; }</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:130.75px;top:99.70px" class="cls_014"><span class="cls_014">while</span><span class="cls_005">(shift &lt; </span><span class="cls_009">0</span><span class="cls_005">) { result /= </span><span class="cls_009">2.0</span><span class="cls_005">; shift++; }</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_013"><span class="cls_013">// assine</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:130.75px;top:147.26px" class="cls_005"><span class="cls_005">result *= (i>>(bits-</span><span class="cls_009">1</span><span class="cls_005">))&</span><span class="cls_009">1</span><span class="cls_005">? -</span><span class="cls_009">1.0</span><span class="cls_005">: </span><span class="cls_009">1.0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> result;</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:103.89px;top:194.82px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:227.93px" class="cls_005"><span class="cls_005">Eu coloquei alguns macros úteis lá em cima no topo para embalar e desembalar números 32</span></div>
<div style="position:absolute;left:60.99px;top:242.85px" class="cls_005"><span class="cls_005">bits (provavelmente um float) e 64 bits (provavelmente um double), mas a função</span></div>
<div style="position:absolute;left:60.99px;top:258.71px" class="cls_005"><span class="cls_005">pack754() poderia ser chamada diretamente e informada para codi car bits de dados</span></div>
<div style="position:absolute;left:60.99px;top:274.56px" class="cls_005"><span class="cls_005">(expbits dos quais estão reservados para o expoente do número normalizado.)</span></div>
<div style="position:absolute;left:60.99px;top:300.67px" class="cls_005"><span class="cls_005">Aqui está um exemplo de uso:</span></div>
<div style="position:absolute;left:83.19px;top:333.78px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:83.19px;top:349.63px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:349.63px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:365.49px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:365.49px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdint.h></span><span class="cls_013">  // definir tipos uintN_t</span></div>
<div style="position:absolute;left:83.19px;top:381.34px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:381.34px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;inttypes.h></span><span class="cls_013">  // definir macros PRIx</span></div>
<div style="position:absolute;left:83.19px;top:397.20px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:413.05px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:413.05px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:83.19px;top:428.90px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:428.90px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:444.76px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:444.76px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> f = </span><span class="cls_009">3.1415926</span><span class="cls_005">, f2;</span></div>
<div style="position:absolute;left:83.19px;top:460.61px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:460.61px" class="cls_008"><span class="cls_008">double</span><span class="cls_005"> d = </span><span class="cls_009">3.14159265358979323</span><span class="cls_005">, d2;</span></div>
<div style="position:absolute;left:76.48px;top:476.47px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:476.47px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> fi;</span></div>
<div style="position:absolute;left:76.48px;top:492.32px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:492.32px" class="cls_008"><span class="cls_008">uint64_t</span><span class="cls_005"> di;</span></div>
<div style="position:absolute;left:76.48px;top:508.18px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:524.03px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:524.03px" class="cls_005"><span class="cls_005">fi = pack754_32(f);</span></div>
<div style="position:absolute;left:76.48px;top:539.88px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:539.88px" class="cls_005"><span class="cls_005">f2 = unpack754_32(fi);</span></div>
<div style="position:absolute;left:76.48px;top:555.74px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:571.59px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:571.59px" class="cls_005"><span class="cls_005">di = pack754_64(d);</span></div>
<div style="position:absolute;left:76.48px;top:587.45px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:587.45px" class="cls_005"><span class="cls_005">d2 = unpack754_64(di);</span></div>
<div style="position:absolute;left:76.48px;top:603.30px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:619.15px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:619.15px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"float antes</span></div>
<div style="position:absolute;left:271.76px;top:619.15px" class="cls_010"><span class="cls_010">: %.7f\n"</span><span class="cls_005">, f);</span></div>
<div style="position:absolute;left:76.48px;top:635.01px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:635.01px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"float encoded: 0x%08"</span><span class="cls_005"> PRIx32 </span><span class="cls_010">"\n"</span><span class="cls_005">, fi);</span></div>
<div style="position:absolute;left:76.48px;top:650.86px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:650.86px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"float depois : %.7f\n\n"</span><span class="cls_005">, f2);</span></div>
<div style="position:absolute;left:76.48px;top:666.72px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:682.57px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:682.57px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"double antes</span></div>
<div style="position:absolute;left:278.48px;top:682.57px" class="cls_010"><span class="cls_010">: %.20lf\n"</span><span class="cls_005">, d);</span></div>
<div style="position:absolute;left:76.48px;top:698.43px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:698.43px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"double encoded: 0x%016"</span><span class="cls_005"> PRIx64 </span><span class="cls_010">"\n"</span><span class="cls_005">, di);</span></div>
<div style="position:absolute;left:76.48px;top:714.28px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:714.28px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"double depois : %.20lf\n"</span><span class="cls_005">, d2);</span></div>
<div style="position:absolute;left:76.48px;top:730.13px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">79 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:67229px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background080.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:103.89px" class="cls_005"><span class="cls_005">O código acima produz esta saída:</span></div>
<div style="position:absolute;left:94.85px;top:137.00px" class="cls_005"><span class="cls_005">float antes</span></div>
<div style="position:absolute;left:188.84px;top:137.00px" class="cls_005"><span class="cls_005">: 3.1415925</span></div>
<div style="position:absolute;left:94.85px;top:152.86px" class="cls_005"><span class="cls_005">float encoded : 0x40490FDA</span></div>
<div style="position:absolute;left:94.85px;top:168.71px" class="cls_005"><span class="cls_005">float depois</span></div>
<div style="position:absolute;left:188.84px;top:168.71px" class="cls_005"><span class="cls_005">: 3.1415925</span></div>
<div style="position:absolute;left:94.85px;top:200.42px" class="cls_005"><span class="cls_005">double antes</span></div>
<div style="position:absolute;left:188.83px;top:200.42px" class="cls_005"><span class="cls_005">: 3.14159265358979311600</span></div>
<div style="position:absolute;left:94.85px;top:216.27px" class="cls_005"><span class="cls_005">double encoded: 0x400921FB54442D18</span></div>
<div style="position:absolute;left:94.85px;top:232.13px" class="cls_005"><span class="cls_005">double depois : 3.14159265358979311600</span></div>
<div style="position:absolute;left:60.99px;top:266.17px" class="cls_005"><span class="cls_005">Outra questão que você pode ter é: como embalar structs? Infelizmente para você, o</span></div>
<div style="position:absolute;left:60.99px;top:282.02px" class="cls_005"><span class="cls_005">compilador é livre para colocar padding em todos os lugares em uma struct, e isso signi ca</span></div>
<div style="position:absolute;left:60.99px;top:296.94px" class="cls_005"><span class="cls_005">que você não pode tornar partátil e enviar a coisa toda pelo  o em um pedaço. (Você não está</span></div>
<div style="position:absolute;left:67.18px;top:310.93px" class="cls_005"><span class="cls_005">cando cansado de ouvir "não pode fazer isso", "não pode fazer isso"? Desculpe! Para citar um</span></div>
<div style="position:absolute;left:60.99px;top:324.92px" class="cls_005"><span class="cls_005">amigo: "Sempre que algo dá errado, eu sempre culpo a Microsoft". Esta pode não ser uma</span></div>
<div style="position:absolute;left:60.99px;top:338.91px" class="cls_005"><span class="cls_005">culpa da Microsoft, admito, mas a a rmação do meu amigo é completamente verdadeira.)</span></div>
<div style="position:absolute;left:60.99px;top:365.02px" class="cls_005"><span class="cls_005">Voltando ao assunto: a melhor maneira para enviar uma struct através do  o é embalar cada</span></div>
<div style="position:absolute;left:60.99px;top:380.88px" class="cls_005"><span class="cls_005">campo, independentemente, e, em seguida, desempacotá-los para a struct quando chegarem</span></div>
<div style="position:absolute;left:60.99px;top:395.80px" class="cls_005"><span class="cls_005">ao outro lado.</span></div>
<div style="position:absolute;left:60.99px;top:420.98px" class="cls_005"><span class="cls_005">Isso é muito trabalhoso, é o que você está pensando. Sim. Uma coisa que você pode fazer é</span></div>
<div style="position:absolute;left:60.99px;top:434.97px" class="cls_005"><span class="cls_005">escrever uma função auxiliar para ajudar a embalar os dados para você. Vai ser divertido!</span></div>
<div style="position:absolute;left:60.99px;top:448.96px" class="cls_005"><span class="cls_005">Realmente!</span></div>
<div style="position:absolute;left:60.99px;top:474.14px" class="cls_005"><span class="cls_005">No livro </span><span class="cls_023">The Practice of Pro</span><span class="cls_006">g</span><span class="cls_023">rammin</span><span class="cls_006">g</span><span class="cls_024"><sup>37</sup></span><span class="cls_005"> de Kernighan e Pike, eles implementam printf()-</span></div>
<div style="position:absolute;left:60.99px;top:491.92px" class="cls_005"><span class="cls_005">como funções chamadas pack() e unpack() que fazem exatamente isso. Eu teria um link</span></div>
<div style="position:absolute;left:60.99px;top:506.85px" class="cls_005"><span class="cls_005">para elas mas, aparentemente, essas funções não estão online com o resto dos fontes do livro.</span></div>
<div style="position:absolute;left:60.99px;top:532.03px" class="cls_005"><span class="cls_005">(The Practice of Programming é uma excelente leitura. Zeus salva um gatinho cada vez que eu</span></div>
<div style="position:absolute;left:60.99px;top:546.02px" class="cls_005"><span class="cls_005">a recomendo.)</span></div>
<div style="position:absolute;left:60.99px;top:571.20px" class="cls_005"><span class="cls_005">Neste ponto, largarei um ponteiro para o </span><span class="cls_023">Protocol Buffers implementation in C</span><span class="cls_024"><sup>38</sup></span><span class="cls_005"> que eu nunca</span></div>
<div style="position:absolute;left:60.99px;top:587.12px" class="cls_005"><span class="cls_005">usei, mas parece completamente respeitável. Os programadores Python e Perl podem veri car</span></div>
<div style="position:absolute;left:60.99px;top:602.04px" class="cls_005"><span class="cls_005">as funções pack() e unpack() de sua linguagem para realizarem a mesma coisa. E o Java</span></div>
<div style="position:absolute;left:60.99px;top:616.96px" class="cls_005"><span class="cls_005">possui uma interface serializável que pode ser usada de maneira semelhante.</span></div>
<div style="position:absolute;left:60.99px;top:642.14px" class="cls_005"><span class="cls_005">Mas se você quiser escrever seu próprio utilitário de empacotamento em C, o truque de K&P é</span></div>
<div style="position:absolute;left:60.99px;top:657.06px" class="cls_005"><span class="cls_005">usar listas de argumentos variáveis para criar funções como printf() para construir os</span></div>
<div style="position:absolute;left:60.99px;top:671.99px" class="cls_005"><span class="cls_005">pacotes. </span><span class="cls_023">Aqui está a versão que eu criei</span><span class="cls_024"><sup>39</sup></span><span class="cls_005"> sozinho com base naquilo que espero ser su ciente</span></div>
<div style="position:absolute;left:60.99px;top:687.91px" class="cls_005"><span class="cls_005">para lhe dar uma idéia de como isso pode funcionar.</span></div>
<div style="position:absolute;left:60.99px;top:714.02px" class="cls_005"><span class="cls_005">(Este código faz referência às funções pack754() acima. As funções packi*() operam de</span></div>
<div style="position:absolute;left:60.99px;top:729.88px" class="cls_005"><span class="cls_005">forma similar as da família htons(), exceto por elas embalarem array de char em vez de</span></div>
<div style="position:absolute;left:60.99px;top:744.80px" class="cls_005"><span class="cls_005">outro inteiro.)</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">80 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:68080px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background081.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:61.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:61.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:77.78px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:77.78px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;ctype.h></span></div>
<div style="position:absolute;left:83.19px;top:93.64px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:93.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdarg.h></span></div>
<div style="position:absolute;left:83.19px;top:109.49px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:109.49px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:83.19px;top:125.34px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:141.20px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:141.20px" class="cls_013"><span class="cls_013">/* packi16() -- armazena um int de 16 bits em um buffer</span></div>
<div style="position:absolute;left:83.19px;top:157.05px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:157.05px" class="cls_013"><span class="cls_013">** de char (como htons ())</span></div>
<div style="position:absolute;left:83.19px;top:172.91px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:172.91px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:188.76px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:188.76px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> packi16(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf, </span><span class="cls_008">unsigned  int</span><span class="cls_005"> i)</span></div>
<div style="position:absolute;left:76.48px;top:204.61px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:204.61px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:220.47px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:220.47px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">8</span><span class="cls_005">; *buf++ = i;</span></div>
<div style="position:absolute;left:76.48px;top:236.32px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:236.32px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:252.18px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:76.48px;top:268.03px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:268.03px" class="cls_013"><span class="cls_013">/* packi32() -- armazena um int de 16 bits em um buffer</span></div>
<div style="position:absolute;left:76.48px;top:283.89px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:283.89px" class="cls_013"><span class="cls_013">** de char (como htons ())</span></div>
<div style="position:absolute;left:76.48px;top:299.74px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:299.74px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:315.59px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:315.59px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> packi32(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf, </span><span class="cls_008">unsigned  long  int</span><span class="cls_005"> i)</span></div>
<div style="position:absolute;left:76.48px;top:331.45px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:331.45px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:347.30px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:347.30px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">24</span><span class="cls_005">; *buf++ = i>></span><span class="cls_009">16</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:363.16px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:363.16px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:238.20px;top:363.16px" class="cls_005"><span class="cls_005">*buf++ = i;</span></div>
<div style="position:absolute;left:76.48px;top:379.01px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:379.01px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:394.86px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:410.72px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:410.72px" class="cls_013"><span class="cls_013">/* packi64() -- armazena um int de 64 bits em um buffer</span></div>
<div style="position:absolute;left:76.48px;top:426.57px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:426.57px" class="cls_013"><span class="cls_013">** de char (como htonl())</span></div>
<div style="position:absolute;left:76.48px;top:442.43px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:442.43px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:457.35px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:103.89px;top:457.35px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> packi64(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf, </span><span class="cls_008">unsigned  long  long  int</span></div>
<div style="position:absolute;left:109.49px;top:471.34px" class="cls_005"><span class="cls_005">i)</span></div>
<div style="position:absolute;left:76.48px;top:487.19px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:103.89px;top:487.19px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:503.05px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:503.05px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">56</span><span class="cls_005">; *buf++ = i>></span><span class="cls_009">48</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:518.90px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:518.90px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">40</span><span class="cls_005">; *buf++ = i>></span><span class="cls_009">32</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:534.75px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:534.75px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">24</span><span class="cls_005">; *buf++ = i>></span><span class="cls_009">16</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:550.61px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:550.61px" class="cls_005"><span class="cls_005">*buf++ = i>></span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:238.20px;top:550.61px" class="cls_005"><span class="cls_005">*buf++ = i;</span></div>
<div style="position:absolute;left:76.48px;top:566.46px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:566.46px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:582.32px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:76.48px;top:597.24px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:103.89px;top:597.24px" class="cls_013"><span class="cls_013">/* unpacki16() -- descompacta um int de 16 bits de um</span></div>
<div style="position:absolute;left:109.49px;top:611.23px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:76.48px;top:627.08px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:103.89px;top:627.08px" class="cls_013"><span class="cls_013">** de char (como ntohs())</span></div>
<div style="position:absolute;left:76.48px;top:642.94px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:103.89px;top:642.94px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:658.79px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:103.89px;top:658.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> unpacki16(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:76.48px;top:674.64px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:103.89px;top:674.64px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:689.57px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:689.57px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> i2 = ((</span><span class="cls_008">unsigned  int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:109.49px;top:703.55px" class="cls_005"><span class="cls_005">buf[</span><span class="cls_009">1</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:719.41px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:719.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:76.48px;top:735.26px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">81 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:68931px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background082.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_013"><span class="cls_013">// alterar números unsigned para signed</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (i2 &lt;= </span><span class="cls_009">0x7fff</span><span class="cls_005">u) { i = i2; }</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { i = -</span><span class="cls_009">1</span><span class="cls_005"> - (</span><span class="cls_008">unsigned int</span><span class="cls_005">)(</span><span class="cls_009">0xffff</span><span class="cls_005">u - i2); }</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:103.89px;top:134.20px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:76.48px;top:164.98px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:103.89px;top:164.98px" class="cls_013"><span class="cls_013">/* unpacku16() -- descompacta um 16 bits unsigned de um</span></div>
<div style="position:absolute;left:109.49px;top:178.97px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:103.89px;top:194.82px" class="cls_013"><span class="cls_013">** de char (como ntohs())</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:103.89px;top:226.53px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> unpacku16(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:103.89px;top:242.38px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> ((</span><span class="cls_008">unsigned int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">) | buf[</span><span class="cls_009">1</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:103.89px;top:274.09px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:289.95px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:76.48px;top:304.87px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:103.89px;top:304.87px" class="cls_013"><span class="cls_013">/* unpacki32() -- descompacta um int de 32 bits de um</span></div>
<div style="position:absolute;left:109.49px;top:318.86px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:76.48px;top:334.71px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:103.89px;top:334.71px" class="cls_013"><span class="cls_013">** de char (como ntohl())</span></div>
<div style="position:absolute;left:76.48px;top:350.57px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:103.89px;top:350.57px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:366.42px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:103.89px;top:366.42px" class="cls_008"><span class="cls_008">long  int</span><span class="cls_005"> unpacki32(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:76.48px;top:382.27px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:103.89px;top:382.27px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:397.20px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:130.75px;top:397.20px" class="cls_008"><span class="cls_008">unsigned  long  int</span><span class="cls_005"> i2 = ((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:109.49px;top:411.18px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">24</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:426.11px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:285.16px;top:426.11px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:109.49px;top:440.10px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">1</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">16</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:455.02px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:285.16px;top:455.02px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:109.49px;top:469.01px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">2</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:216.94px;top:469.01px" class="cls_005"><span class="cls_005">|</span></div>
<div style="position:absolute;left:76.48px;top:484.86px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:285.16px;top:484.86px" class="cls_005"><span class="cls_005">buf[</span><span class="cls_009">3</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:500.71px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:130.75px;top:500.71px" class="cls_008"><span class="cls_008">long  int</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:76.48px;top:516.57px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:76.48px;top:532.42px" class="cls_005"><span class="cls_005">68</span></div>
<div style="position:absolute;left:130.75px;top:532.42px" class="cls_013"><span class="cls_013">// alterar números unsigned para signed</span></div>
<div style="position:absolute;left:76.48px;top:548.28px" class="cls_005"><span class="cls_005">69</span></div>
<div style="position:absolute;left:130.75px;top:548.28px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (i2 &lt;= </span><span class="cls_009">0x7fffffff</span><span class="cls_005">u) { i = i2; }</span></div>
<div style="position:absolute;left:76.48px;top:564.13px" class="cls_005"><span class="cls_005">70</span></div>
<div style="position:absolute;left:130.75px;top:564.13px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { i = -</span><span class="cls_009">1</span><span class="cls_005"> - (</span><span class="cls_008">long int</span><span class="cls_005">)(</span><span class="cls_009">0xffffffff</span><span class="cls_005">u - i2); }</span></div>
<div style="position:absolute;left:76.48px;top:579.99px" class="cls_005"><span class="cls_005">71</span></div>
<div style="position:absolute;left:76.48px;top:595.84px" class="cls_005"><span class="cls_005">72</span></div>
<div style="position:absolute;left:130.75px;top:595.84px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:76.48px;top:611.69px" class="cls_005"><span class="cls_005">73</span></div>
<div style="position:absolute;left:103.89px;top:611.69px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:627.55px" class="cls_005"><span class="cls_005">74</span></div>
<div style="position:absolute;left:76.48px;top:642.47px" class="cls_005"><span class="cls_005">75</span></div>
<div style="position:absolute;left:103.89px;top:642.47px" class="cls_013"><span class="cls_013">/* unpacku32() -- descompacta um 32 bits unsigned de um</span></div>
<div style="position:absolute;left:109.49px;top:656.46px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:76.48px;top:672.31px" class="cls_005"><span class="cls_005">76</span></div>
<div style="position:absolute;left:103.89px;top:672.31px" class="cls_013"><span class="cls_013">** de char (como ntohl())</span></div>
<div style="position:absolute;left:76.48px;top:688.17px" class="cls_005"><span class="cls_005">77</span></div>
<div style="position:absolute;left:103.89px;top:688.17px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:704.02px" class="cls_005"><span class="cls_005">78</span></div>
<div style="position:absolute;left:103.89px;top:704.02px" class="cls_008"><span class="cls_008">unsigned  long  int</span><span class="cls_005"> unpacku32(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:76.48px;top:719.87px" class="cls_005"><span class="cls_005">79</span></div>
<div style="position:absolute;left:103.89px;top:719.87px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:735.73px" class="cls_005"><span class="cls_005">80</span></div>
<div style="position:absolute;left:130.75px;top:735.73px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> ((</span><span class="cls_008">unsigned long int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">24</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">82 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:69782px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background083.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">81</span></div>
<div style="position:absolute;left:177.74px;top:54.93px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">1</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">16</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">82</span></div>
<div style="position:absolute;left:177.74px;top:70.79px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">2</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:392.64px;top:70.79px" class="cls_005"><span class="cls_005">|</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">83</span></div>
<div style="position:absolute;left:177.74px;top:86.64px" class="cls_005"><span class="cls_005">buf[</span><span class="cls_009">3</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">84</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">85</span></div>
<div style="position:absolute;left:76.48px;top:133.27px" class="cls_005"><span class="cls_005">86</span></div>
<div style="position:absolute;left:103.89px;top:133.27px" class="cls_013"><span class="cls_013">/* unpacki64() -- descompacta um int de 64 bits de um</span></div>
<div style="position:absolute;left:109.49px;top:147.26px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">87</span></div>
<div style="position:absolute;left:103.89px;top:163.11px" class="cls_013"><span class="cls_013">** de char (como ntohl())</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">88</span></div>
<div style="position:absolute;left:103.89px;top:178.97px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">89</span></div>
<div style="position:absolute;left:103.89px;top:194.82px" class="cls_008"><span class="cls_008">long  long  int</span><span class="cls_005"> unpacki64(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">90</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:225.60px" class="cls_005"><span class="cls_005">91</span></div>
<div style="position:absolute;left:130.75px;top:225.60px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> i2 = ((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:225.60px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:239.59px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">56</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:254.51px" class="cls_005"><span class="cls_005">92</span></div>
<div style="position:absolute;left:318.73px;top:254.51px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:254.51px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:268.50px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">1</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">48</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:283.42px" class="cls_005"><span class="cls_005">93</span></div>
<div style="position:absolute;left:318.73px;top:283.42px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:283.42px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:297.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">2</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">40</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:312.33px" class="cls_005"><span class="cls_005">94</span></div>
<div style="position:absolute;left:318.73px;top:312.33px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:312.33px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:326.32px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">3</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">32</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:341.24px" class="cls_005"><span class="cls_005">95</span></div>
<div style="position:absolute;left:318.73px;top:341.24px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:341.24px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:355.23px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">4</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">24</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:370.15px" class="cls_005"><span class="cls_005">96</span></div>
<div style="position:absolute;left:318.73px;top:370.15px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:370.15px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:384.14px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">5</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">16</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:76.48px;top:399.06px" class="cls_005"><span class="cls_005">97</span></div>
<div style="position:absolute;left:318.73px;top:399.06px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:426.20px;top:399.06px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:109.49px;top:413.05px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">)buf[</span><span class="cls_009">6</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:216.94px;top:413.05px" class="cls_005"><span class="cls_005">|</span></div>
<div style="position:absolute;left:76.48px;top:428.90px" class="cls_005"><span class="cls_005">98</span></div>
<div style="position:absolute;left:318.73px;top:428.90px" class="cls_005"><span class="cls_005">buf[</span><span class="cls_009">7</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:444.76px" class="cls_005"><span class="cls_005">99</span></div>
<div style="position:absolute;left:130.75px;top:444.76px" class="cls_008"><span class="cls_008">long  long  int</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:69.76px;top:460.61px" class="cls_005"><span class="cls_005">100</span></div>
<div style="position:absolute;left:69.76px;top:476.47px" class="cls_005"><span class="cls_005">101</span></div>
<div style="position:absolute;left:130.75px;top:476.47px" class="cls_013"><span class="cls_013">// alterar números unsigned para signed</span></div>
<div style="position:absolute;left:69.76px;top:492.32px" class="cls_005"><span class="cls_005">102</span></div>
<div style="position:absolute;left:130.75px;top:492.32px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (i2 &lt;= </span><span class="cls_009">0x7fffffffffffffff</span><span class="cls_005">u) { i = i2; }</span></div>
<div style="position:absolute;left:69.76px;top:507.24px" class="cls_005"><span class="cls_005">103</span></div>
<div style="position:absolute;left:130.75px;top:507.24px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { i = -</span><span class="cls_009">1</span><span class="cls_005"> -(</span><span class="cls_008">long long int</span><span class="cls_005">)(</span><span class="cls_009">0xffffffffffffffff</span><span class="cls_005">u -</span></div>
<div style="position:absolute;left:109.49px;top:521.23px" class="cls_005"><span class="cls_005">i2); }</span></div>
<div style="position:absolute;left:69.76px;top:537.09px" class="cls_005"><span class="cls_005">104</span></div>
<div style="position:absolute;left:69.76px;top:552.94px" class="cls_005"><span class="cls_005">105</span></div>
<div style="position:absolute;left:130.75px;top:552.94px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:69.76px;top:568.79px" class="cls_005"><span class="cls_005">106</span></div>
<div style="position:absolute;left:103.89px;top:568.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:584.65px" class="cls_005"><span class="cls_005">107</span></div>
<div style="position:absolute;left:69.76px;top:599.57px" class="cls_005"><span class="cls_005">108</span></div>
<div style="position:absolute;left:103.89px;top:599.57px" class="cls_013"><span class="cls_013">/* unpacku64() -- descompacta um 64 bits unsigned de um</span></div>
<div style="position:absolute;left:109.49px;top:613.56px" class="cls_013"><span class="cls_013">buffer</span></div>
<div style="position:absolute;left:69.76px;top:629.41px" class="cls_005"><span class="cls_005">109</span></div>
<div style="position:absolute;left:103.89px;top:629.41px" class="cls_013"><span class="cls_013">** de char (como ntohl())</span></div>
<div style="position:absolute;left:69.76px;top:645.27px" class="cls_005"><span class="cls_005">110</span></div>
<div style="position:absolute;left:103.89px;top:645.27px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:69.76px;top:661.12px" class="cls_005"><span class="cls_005">111</span></div>
<div style="position:absolute;left:103.89px;top:661.12px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> unpacku64(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf)</span></div>
<div style="position:absolute;left:69.76px;top:676.98px" class="cls_005"><span class="cls_005">112</span></div>
<div style="position:absolute;left:103.89px;top:676.98px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:69.76px;top:692.83px" class="cls_005"><span class="cls_005">113</span></div>
<div style="position:absolute;left:130.75px;top:692.83px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> ((</span><span class="cls_008">unsigned long long int</span><span class="cls_005">)buf[</span><span class="cls_009">0</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">56</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:69.76px;top:708.68px" class="cls_005"><span class="cls_005">114</span></div>
<div style="position:absolute;left:177.74px;top:708.68px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">1</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">48</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:69.76px;top:724.54px" class="cls_005"><span class="cls_005">115</span></div>
<div style="position:absolute;left:177.74px;top:724.54px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">2</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">40</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:69.76px;top:740.39px" class="cls_005"><span class="cls_005">116</span></div>
<div style="position:absolute;left:177.74px;top:740.39px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">3</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">32</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">83 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:70633px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background084.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">117</span></div>
<div style="position:absolute;left:177.74px;top:54.93px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">4</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">24</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">118</span></div>
<div style="position:absolute;left:177.74px;top:70.79px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">5</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">16</span><span class="cls_005">) |</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">119</span></div>
<div style="position:absolute;left:177.74px;top:86.64px" class="cls_005"><span class="cls_005">((</span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">)buf[</span><span class="cls_009">6</span><span class="cls_005">]&lt;&lt;</span><span class="cls_009">8</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:426.21px;top:86.64px" class="cls_005"><span class="cls_005">|</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">120</span></div>
<div style="position:absolute;left:177.74px;top:102.50px" class="cls_005"><span class="cls_005">buf[</span><span class="cls_009">7</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">121</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">122</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">123</span></div>
<div style="position:absolute;left:103.89px;top:150.06px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:69.76px;top:164.98px" class="cls_005"><span class="cls_005">124</span></div>
<div style="position:absolute;left:103.89px;top:164.98px" class="cls_013"><span class="cls_013">** pack() -- armazenar dados ditados pelo formato string</span></div>
<div style="position:absolute;left:109.49px;top:178.97px" class="cls_013"><span class="cls_013">no buffer</span></div>
<div style="position:absolute;left:69.76px;top:194.82px" class="cls_005"><span class="cls_005">125</span></div>
<div style="position:absolute;left:103.89px;top:194.82px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:69.76px;top:210.68px" class="cls_005"><span class="cls_005">126</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_013"><span class="cls_013">**   bits |signed   unsigned   float   string</span></div>
<div style="position:absolute;left:69.76px;top:226.53px" class="cls_005"><span class="cls_005">127</span></div>
<div style="position:absolute;left:103.89px;top:226.53px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:137.47px;top:226.53px" class="cls_013"><span class="cls_013">-----+----------------------------------</span></div>
<div style="position:absolute;left:69.76px;top:242.38px" class="cls_005"><span class="cls_005">128</span></div>
<div style="position:absolute;left:103.89px;top:242.38px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:157.60px;top:242.38px" class="cls_013"><span class="cls_013">8 |   c</span></div>
<div style="position:absolute;left:258.31px;top:242.38px" class="cls_013"><span class="cls_013">C</span></div>
<div style="position:absolute;left:69.76px;top:258.24px" class="cls_005"><span class="cls_005">129</span></div>
<div style="position:absolute;left:103.89px;top:258.24px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:258.24px" class="cls_013"><span class="cls_013">16 |   h</span></div>
<div style="position:absolute;left:258.31px;top:258.24px" class="cls_013"><span class="cls_013">H</span></div>
<div style="position:absolute;left:325.45px;top:258.24px" class="cls_013"><span class="cls_013">f</span></div>
<div style="position:absolute;left:69.76px;top:274.09px" class="cls_005"><span class="cls_005">130</span></div>
<div style="position:absolute;left:103.89px;top:274.09px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:274.09px" class="cls_013"><span class="cls_013">32 |   l</span></div>
<div style="position:absolute;left:258.31px;top:274.09px" class="cls_013"><span class="cls_013">L</span></div>
<div style="position:absolute;left:325.45px;top:274.09px" class="cls_013"><span class="cls_013">d</span></div>
<div style="position:absolute;left:69.76px;top:289.95px" class="cls_005"><span class="cls_005">131</span></div>
<div style="position:absolute;left:103.89px;top:289.95px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:289.95px" class="cls_013"><span class="cls_013">64 |   q</span></div>
<div style="position:absolute;left:258.31px;top:289.95px" class="cls_013"><span class="cls_013">Q</span></div>
<div style="position:absolute;left:325.45px;top:289.95px" class="cls_013"><span class="cls_013">g</span></div>
<div style="position:absolute;left:69.76px;top:305.80px" class="cls_005"><span class="cls_005">132</span></div>
<div style="position:absolute;left:103.89px;top:305.80px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:157.60px;top:305.80px" class="cls_013"><span class="cls_013">- |</span></div>
<div style="position:absolute;left:385.87px;top:305.80px" class="cls_013"><span class="cls_013">s</span></div>
<div style="position:absolute;left:69.76px;top:321.66px" class="cls_005"><span class="cls_005">133</span></div>
<div style="position:absolute;left:103.89px;top:321.66px" class="cls_013"><span class="cls_013">** (O comprimento de um 16 bits unsigned é anexado</span></div>
<div style="position:absolute;left:69.76px;top:337.51px" class="cls_005"><span class="cls_005">134</span></div>
<div style="position:absolute;left:103.89px;top:337.51px" class="cls_013"><span class="cls_013">**  automaticamente às strings)</span></div>
<div style="position:absolute;left:69.76px;top:353.36px" class="cls_005"><span class="cls_005">135</span></div>
<div style="position:absolute;left:103.89px;top:353.36px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:69.76px;top:369.22px" class="cls_005"><span class="cls_005">136</span></div>
<div style="position:absolute;left:69.76px;top:385.07px" class="cls_005"><span class="cls_005">137</span></div>
<div style="position:absolute;left:103.89px;top:385.07px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> pack(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf, </span><span class="cls_008">char</span><span class="cls_005"> *format, ...)</span></div>
<div style="position:absolute;left:69.76px;top:400.93px" class="cls_005"><span class="cls_005">138</span></div>
<div style="position:absolute;left:103.89px;top:400.93px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:69.76px;top:416.78px" class="cls_005"><span class="cls_005">139</span></div>
<div style="position:absolute;left:130.75px;top:416.78px" class="cls_008"><span class="cls_008">va_list</span><span class="cls_005"> ap;</span></div>
<div style="position:absolute;left:69.76px;top:432.63px" class="cls_005"><span class="cls_005">140</span></div>
<div style="position:absolute;left:69.76px;top:448.49px" class="cls_005"><span class="cls_005">141</span></div>
<div style="position:absolute;left:130.75px;top:448.49px" class="cls_008"><span class="cls_008">signed  char</span><span class="cls_005"> c;</span></div>
<div style="position:absolute;left:318.76px;top:448.49px" class="cls_013"><span class="cls_013">// 8-bit</span></div>
<div style="position:absolute;left:69.76px;top:464.34px" class="cls_005"><span class="cls_005">142</span></div>
<div style="position:absolute;left:130.75px;top:464.34px" class="cls_008"><span class="cls_008">unsigned  char</span><span class="cls_005"> C;</span></div>
<div style="position:absolute;left:69.76px;top:480.20px" class="cls_005"><span class="cls_005">143</span></div>
<div style="position:absolute;left:69.76px;top:496.05px" class="cls_005"><span class="cls_005">144</span></div>
<div style="position:absolute;left:130.75px;top:496.05px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> h;</span></div>
<div style="position:absolute;left:318.76px;top:496.05px" class="cls_013"><span class="cls_013">// 16-bit</span></div>
<div style="position:absolute;left:69.76px;top:511.91px" class="cls_005"><span class="cls_005">145</span></div>
<div style="position:absolute;left:130.75px;top:511.91px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> H;</span></div>
<div style="position:absolute;left:69.76px;top:527.76px" class="cls_005"><span class="cls_005">146</span></div>
<div style="position:absolute;left:69.76px;top:543.61px" class="cls_005"><span class="cls_005">147</span></div>
<div style="position:absolute;left:130.75px;top:543.61px" class="cls_008"><span class="cls_008">long  int</span><span class="cls_005"> l;</span></div>
<div style="position:absolute;left:318.76px;top:543.61px" class="cls_013"><span class="cls_013">// 32-bit</span></div>
<div style="position:absolute;left:69.76px;top:559.47px" class="cls_005"><span class="cls_005">148</span></div>
<div style="position:absolute;left:130.75px;top:559.47px" class="cls_008"><span class="cls_008">unsigned  long  int</span><span class="cls_005"> L;</span></div>
<div style="position:absolute;left:69.76px;top:575.32px" class="cls_005"><span class="cls_005">149</span></div>
<div style="position:absolute;left:69.76px;top:591.18px" class="cls_005"><span class="cls_005">150</span></div>
<div style="position:absolute;left:130.75px;top:591.18px" class="cls_008"><span class="cls_008">long  long  int</span><span class="cls_005"> q;</span></div>
<div style="position:absolute;left:318.76px;top:591.18px" class="cls_013"><span class="cls_013">// 64-bit</span></div>
<div style="position:absolute;left:69.76px;top:607.03px" class="cls_005"><span class="cls_005">151</span></div>
<div style="position:absolute;left:130.75px;top:607.03px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> Q;</span></div>
<div style="position:absolute;left:69.76px;top:622.88px" class="cls_005"><span class="cls_005">152</span></div>
<div style="position:absolute;left:69.76px;top:638.74px" class="cls_005"><span class="cls_005">153</span></div>
<div style="position:absolute;left:130.75px;top:638.74px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> f;</span></div>
<div style="position:absolute;left:318.79px;top:638.74px" class="cls_013"><span class="cls_013">// floats</span></div>
<div style="position:absolute;left:69.76px;top:654.59px" class="cls_005"><span class="cls_005">154</span></div>
<div style="position:absolute;left:130.75px;top:654.59px" class="cls_008"><span class="cls_008">double</span><span class="cls_005"> d;</span></div>
<div style="position:absolute;left:69.76px;top:670.45px" class="cls_005"><span class="cls_005">155</span></div>
<div style="position:absolute;left:130.75px;top:670.45px" class="cls_008"><span class="cls_008">long  double</span><span class="cls_005"> g;</span></div>
<div style="position:absolute;left:69.76px;top:686.30px" class="cls_005"><span class="cls_005">156</span></div>
<div style="position:absolute;left:130.75px;top:686.30px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> fhold;</span></div>
<div style="position:absolute;left:69.76px;top:702.16px" class="cls_005"><span class="cls_005">157</span></div>
<div style="position:absolute;left:69.76px;top:718.01px" class="cls_005"><span class="cls_005">158</span></div>
<div style="position:absolute;left:130.75px;top:718.01px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *s;</span></div>
<div style="position:absolute;left:318.76px;top:718.01px" class="cls_013"><span class="cls_013">// strings</span></div>
<div style="position:absolute;left:69.76px;top:733.86px" class="cls_005"><span class="cls_005">159</span></div>
<div style="position:absolute;left:130.75px;top:733.86px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> len;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">84 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:71484px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background085.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">160</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">161</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> size = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">162</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">163</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_005"><span class="cls_005">va_start(ap, format);</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">164</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">165</span></div>
<div style="position:absolute;left:130.75px;top:134.20px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(; *format != </span><span class="cls_010">'\0'</span><span class="cls_005">; format++) {</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">166</span></div>
<div style="position:absolute;left:157.61px;top:150.06px" class="cls_014"><span class="cls_014">switch</span><span class="cls_005">(*format) {</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">167</span></div>
<div style="position:absolute;left:157.61px;top:165.91px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'c'</span><span class="cls_005">: </span><span class="cls_013">// 8-bit</span></div>
<div style="position:absolute;left:69.76px;top:181.77px" class="cls_005"><span class="cls_005">168</span></div>
<div style="position:absolute;left:184.46px;top:181.77px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:196.69px" class="cls_005"><span class="cls_005">169</span></div>
<div style="position:absolute;left:184.46px;top:196.69px" class="cls_005"><span class="cls_005">c = (</span><span class="cls_008">signed  char</span><span class="cls_005">)va_arg(ap, </span><span class="cls_008">int</span><span class="cls_005">); </span><span class="cls_013">//</span></div>
<div style="position:absolute;left:109.49px;top:210.68px" class="cls_013"><span class="cls_013">promovido</span></div>
<div style="position:absolute;left:69.76px;top:226.53px" class="cls_005"><span class="cls_005">170</span></div>
<div style="position:absolute;left:184.46px;top:226.53px" class="cls_005"><span class="cls_005">*buf++ = c;</span></div>
<div style="position:absolute;left:69.76px;top:242.38px" class="cls_005"><span class="cls_005">171</span></div>
<div style="position:absolute;left:184.47px;top:242.38px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:258.24px" class="cls_005"><span class="cls_005">172</span></div>
<div style="position:absolute;left:69.76px;top:274.09px" class="cls_005"><span class="cls_005">173</span></div>
<div style="position:absolute;left:157.61px;top:274.09px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'C'</span><span class="cls_005">: </span><span class="cls_013">// 8-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:289.95px" class="cls_005"><span class="cls_005">174</span></div>
<div style="position:absolute;left:184.46px;top:289.95px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:304.87px" class="cls_005"><span class="cls_005">175</span></div>
<div style="position:absolute;left:184.46px;top:304.87px" class="cls_005"><span class="cls_005">C = (</span><span class="cls_008">unsigned  char</span><span class="cls_005">)va_arg(ap, </span><span class="cls_008">unsigned</span></div>
<div style="position:absolute;left:446.34px;top:304.87px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:109.49px;top:318.86px" class="cls_013"><span class="cls_013">// promovido</span></div>
<div style="position:absolute;left:69.76px;top:334.71px" class="cls_005"><span class="cls_005">176</span></div>
<div style="position:absolute;left:184.46px;top:334.71px" class="cls_005"><span class="cls_005">*buf++ = C;</span></div>
<div style="position:absolute;left:69.76px;top:350.57px" class="cls_005"><span class="cls_005">177</span></div>
<div style="position:absolute;left:184.47px;top:350.57px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:366.42px" class="cls_005"><span class="cls_005">178</span></div>
<div style="position:absolute;left:69.76px;top:382.27px" class="cls_005"><span class="cls_005">179</span></div>
<div style="position:absolute;left:157.61px;top:382.27px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'h'</span><span class="cls_005">: </span><span class="cls_013">// 16-bit</span></div>
<div style="position:absolute;left:69.76px;top:398.13px" class="cls_005"><span class="cls_005">180</span></div>
<div style="position:absolute;left:184.46px;top:398.13px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:413.98px" class="cls_005"><span class="cls_005">181</span></div>
<div style="position:absolute;left:184.46px;top:413.98px" class="cls_005"><span class="cls_005">h = va_arg(ap, </span><span class="cls_008">int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:429.84px" class="cls_005"><span class="cls_005">182</span></div>
<div style="position:absolute;left:184.46px;top:429.84px" class="cls_005"><span class="cls_005">packi16(buf, h);</span></div>
<div style="position:absolute;left:69.76px;top:445.69px" class="cls_005"><span class="cls_005">183</span></div>
<div style="position:absolute;left:184.46px;top:445.69px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:461.55px" class="cls_005"><span class="cls_005">184</span></div>
<div style="position:absolute;left:184.47px;top:461.55px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:477.40px" class="cls_005"><span class="cls_005">185</span></div>
<div style="position:absolute;left:69.76px;top:493.25px" class="cls_005"><span class="cls_005">186</span></div>
<div style="position:absolute;left:157.61px;top:493.25px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'H'</span><span class="cls_005">: </span><span class="cls_013">// 16-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:509.11px" class="cls_005"><span class="cls_005">187</span></div>
<div style="position:absolute;left:184.46px;top:509.11px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:524.96px" class="cls_005"><span class="cls_005">188</span></div>
<div style="position:absolute;left:184.46px;top:524.96px" class="cls_005"><span class="cls_005">H = va_arg(ap, </span><span class="cls_008">unsigned  int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:540.82px" class="cls_005"><span class="cls_005">189</span></div>
<div style="position:absolute;left:184.46px;top:540.82px" class="cls_005"><span class="cls_005">packi16(buf, H);</span></div>
<div style="position:absolute;left:69.76px;top:556.67px" class="cls_005"><span class="cls_005">190</span></div>
<div style="position:absolute;left:184.46px;top:556.67px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:572.52px" class="cls_005"><span class="cls_005">191</span></div>
<div style="position:absolute;left:184.47px;top:572.52px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:588.38px" class="cls_005"><span class="cls_005">192</span></div>
<div style="position:absolute;left:69.76px;top:604.23px" class="cls_005"><span class="cls_005">193</span></div>
<div style="position:absolute;left:157.61px;top:604.23px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'l'</span><span class="cls_005">: </span><span class="cls_013">// 32-bit</span></div>
<div style="position:absolute;left:69.76px;top:620.09px" class="cls_005"><span class="cls_005">194</span></div>
<div style="position:absolute;left:184.46px;top:620.09px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:635.94px" class="cls_005"><span class="cls_005">195</span></div>
<div style="position:absolute;left:184.46px;top:635.94px" class="cls_005"><span class="cls_005">l = va_arg(ap, </span><span class="cls_008">long  int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:651.80px" class="cls_005"><span class="cls_005">196</span></div>
<div style="position:absolute;left:184.46px;top:651.80px" class="cls_005"><span class="cls_005">packi32(buf, l);</span></div>
<div style="position:absolute;left:69.76px;top:667.65px" class="cls_005"><span class="cls_005">197</span></div>
<div style="position:absolute;left:184.46px;top:667.65px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:683.50px" class="cls_005"><span class="cls_005">198</span></div>
<div style="position:absolute;left:184.47px;top:683.50px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:699.36px" class="cls_005"><span class="cls_005">199</span></div>
<div style="position:absolute;left:69.76px;top:715.21px" class="cls_005"><span class="cls_005">200</span></div>
<div style="position:absolute;left:157.61px;top:715.21px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'L'</span><span class="cls_005">: </span><span class="cls_013">// 32-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:731.07px" class="cls_005"><span class="cls_005">201</span></div>
<div style="position:absolute;left:184.46px;top:731.07px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">85 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:72335px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background086.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">202</span></div>
<div style="position:absolute;left:184.46px;top:54.93px" class="cls_005"><span class="cls_005">L = va_arg(ap, </span><span class="cls_008">unsigned  long  int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">203</span></div>
<div style="position:absolute;left:184.46px;top:70.79px" class="cls_005"><span class="cls_005">packi32(buf, L);</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">204</span></div>
<div style="position:absolute;left:184.46px;top:86.64px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">205</span></div>
<div style="position:absolute;left:184.47px;top:102.50px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">206</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">207</span></div>
<div style="position:absolute;left:157.61px;top:134.20px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'q'</span><span class="cls_005">: </span><span class="cls_013">// 64-bit</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">208</span></div>
<div style="position:absolute;left:184.46px;top:150.06px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">209</span></div>
<div style="position:absolute;left:184.46px;top:165.91px" class="cls_005"><span class="cls_005">q = va_arg(ap, </span><span class="cls_008">long  long  int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:181.77px" class="cls_005"><span class="cls_005">210</span></div>
<div style="position:absolute;left:184.46px;top:181.77px" class="cls_005"><span class="cls_005">packi64(buf, q);</span></div>
<div style="position:absolute;left:69.76px;top:197.62px" class="cls_005"><span class="cls_005">211</span></div>
<div style="position:absolute;left:184.46px;top:197.62px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:213.47px" class="cls_005"><span class="cls_005">212</span></div>
<div style="position:absolute;left:184.47px;top:213.47px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:229.33px" class="cls_005"><span class="cls_005">213</span></div>
<div style="position:absolute;left:69.76px;top:245.18px" class="cls_005"><span class="cls_005">214</span></div>
<div style="position:absolute;left:157.61px;top:245.18px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'Q'</span><span class="cls_005">: </span><span class="cls_013">// 64-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:261.04px" class="cls_005"><span class="cls_005">215</span></div>
<div style="position:absolute;left:184.46px;top:261.04px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:276.89px" class="cls_005"><span class="cls_005">216</span></div>
<div style="position:absolute;left:184.46px;top:276.89px" class="cls_005"><span class="cls_005">Q = va_arg(ap, </span><span class="cls_008">unsigned  long  long  int</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:292.75px" class="cls_005"><span class="cls_005">217</span></div>
<div style="position:absolute;left:184.46px;top:292.75px" class="cls_005"><span class="cls_005">packi64(buf, Q);</span></div>
<div style="position:absolute;left:69.76px;top:308.60px" class="cls_005"><span class="cls_005">218</span></div>
<div style="position:absolute;left:184.46px;top:308.60px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:324.45px" class="cls_005"><span class="cls_005">219</span></div>
<div style="position:absolute;left:184.47px;top:324.45px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:340.31px" class="cls_005"><span class="cls_005">220</span></div>
<div style="position:absolute;left:69.76px;top:356.16px" class="cls_005"><span class="cls_005">221</span></div>
<div style="position:absolute;left:157.61px;top:356.16px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'f'</span><span class="cls_005">: </span><span class="cls_013">// float-16</span></div>
<div style="position:absolute;left:69.76px;top:372.02px" class="cls_005"><span class="cls_005">222</span></div>
<div style="position:absolute;left:184.46px;top:372.02px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:387.87px" class="cls_005"><span class="cls_005">223</span></div>
<div style="position:absolute;left:184.46px;top:387.87px" class="cls_005"><span class="cls_005">f = (</span><span class="cls_008">float</span><span class="cls_005">)va_arg(ap, </span><span class="cls_008">double</span><span class="cls_005">); </span><span class="cls_013">// promovido</span></div>
<div style="position:absolute;left:69.76px;top:402.79px" class="cls_005"><span class="cls_005">224</span></div>
<div style="position:absolute;left:184.46px;top:402.79px" class="cls_005"><span class="cls_005">fhold = pack754_16(f); </span><span class="cls_013">// converte para IEEE</span></div>
<div style="position:absolute;left:109.49px;top:416.78px" class="cls_013"><span class="cls_013">754</span></div>
<div style="position:absolute;left:69.76px;top:432.63px" class="cls_005"><span class="cls_005">225</span></div>
<div style="position:absolute;left:184.46px;top:432.63px" class="cls_005"><span class="cls_005">packi16(buf, fhold);</span></div>
<div style="position:absolute;left:69.76px;top:448.49px" class="cls_005"><span class="cls_005">226</span></div>
<div style="position:absolute;left:184.46px;top:448.49px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:464.34px" class="cls_005"><span class="cls_005">227</span></div>
<div style="position:absolute;left:184.47px;top:464.34px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:480.20px" class="cls_005"><span class="cls_005">228</span></div>
<div style="position:absolute;left:69.76px;top:496.05px" class="cls_005"><span class="cls_005">229</span></div>
<div style="position:absolute;left:157.61px;top:496.05px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'd'</span><span class="cls_005">: </span><span class="cls_013">// float-32</span></div>
<div style="position:absolute;left:69.76px;top:511.91px" class="cls_005"><span class="cls_005">230</span></div>
<div style="position:absolute;left:184.46px;top:511.91px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:527.76px" class="cls_005"><span class="cls_005">231</span></div>
<div style="position:absolute;left:184.46px;top:527.76px" class="cls_005"><span class="cls_005">d = va_arg(ap, </span><span class="cls_008">double</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:542.68px" class="cls_005"><span class="cls_005">232</span></div>
<div style="position:absolute;left:184.46px;top:542.68px" class="cls_005"><span class="cls_005">fhold = pack754_32(d); </span><span class="cls_013">// converte para IEEE</span></div>
<div style="position:absolute;left:109.49px;top:556.67px" class="cls_013"><span class="cls_013">754</span></div>
<div style="position:absolute;left:69.76px;top:572.52px" class="cls_005"><span class="cls_005">233</span></div>
<div style="position:absolute;left:184.46px;top:572.52px" class="cls_005"><span class="cls_005">packi32(buf, fhold);</span></div>
<div style="position:absolute;left:69.76px;top:588.38px" class="cls_005"><span class="cls_005">234</span></div>
<div style="position:absolute;left:184.46px;top:588.38px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:604.23px" class="cls_005"><span class="cls_005">235</span></div>
<div style="position:absolute;left:184.47px;top:604.23px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:620.09px" class="cls_005"><span class="cls_005">236</span></div>
<div style="position:absolute;left:69.76px;top:635.94px" class="cls_005"><span class="cls_005">237</span></div>
<div style="position:absolute;left:157.61px;top:635.94px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'g'</span><span class="cls_005">: </span><span class="cls_013">// float-64</span></div>
<div style="position:absolute;left:69.76px;top:651.80px" class="cls_005"><span class="cls_005">238</span></div>
<div style="position:absolute;left:184.46px;top:651.80px" class="cls_005"><span class="cls_005">size += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:667.65px" class="cls_005"><span class="cls_005">239</span></div>
<div style="position:absolute;left:184.46px;top:667.65px" class="cls_005"><span class="cls_005">g = va_arg(ap, </span><span class="cls_008">long  double</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:682.57px" class="cls_005"><span class="cls_005">240</span></div>
<div style="position:absolute;left:184.46px;top:682.57px" class="cls_005"><span class="cls_005">fhold = pack754_64(g); </span><span class="cls_013">// converte para IEEE</span></div>
<div style="position:absolute;left:109.49px;top:696.56px" class="cls_013"><span class="cls_013">754</span></div>
<div style="position:absolute;left:69.76px;top:712.41px" class="cls_005"><span class="cls_005">241</span></div>
<div style="position:absolute;left:184.46px;top:712.41px" class="cls_005"><span class="cls_005">packi64(buf, fhold);</span></div>
<div style="position:absolute;left:69.76px;top:728.27px" class="cls_005"><span class="cls_005">242</span></div>
<div style="position:absolute;left:184.46px;top:728.27px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">86 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:73186px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background087.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">243</span></div>
<div style="position:absolute;left:184.47px;top:54.93px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">244</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">245</span></div>
<div style="position:absolute;left:157.61px;top:86.64px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 's'</span><span class="cls_005">: </span><span class="cls_013">// string</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">246</span></div>
<div style="position:absolute;left:184.46px;top:102.50px" class="cls_005"><span class="cls_005">s = va_arg(ap, </span><span class="cls_008">char</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">247</span></div>
<div style="position:absolute;left:184.46px;top:118.35px" class="cls_005"><span class="cls_005">len = strlen(s);</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">248</span></div>
<div style="position:absolute;left:184.46px;top:134.20px" class="cls_005"><span class="cls_005">size += len + </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">249</span></div>
<div style="position:absolute;left:184.46px;top:150.06px" class="cls_005"><span class="cls_005">packi16(buf, len);</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">250</span></div>
<div style="position:absolute;left:184.46px;top:165.91px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:181.77px" class="cls_005"><span class="cls_005">251</span></div>
<div style="position:absolute;left:184.46px;top:181.77px" class="cls_005"><span class="cls_005">memcpy(buf, s, len);</span></div>
<div style="position:absolute;left:69.76px;top:197.62px" class="cls_005"><span class="cls_005">252</span></div>
<div style="position:absolute;left:184.46px;top:197.62px" class="cls_005"><span class="cls_005">buf += len;</span></div>
<div style="position:absolute;left:69.76px;top:213.47px" class="cls_005"><span class="cls_005">253</span></div>
<div style="position:absolute;left:184.47px;top:213.47px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:229.33px" class="cls_005"><span class="cls_005">254</span></div>
<div style="position:absolute;left:157.61px;top:229.33px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:245.18px" class="cls_005"><span class="cls_005">255</span></div>
<div style="position:absolute;left:130.75px;top:245.18px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:261.04px" class="cls_005"><span class="cls_005">256</span></div>
<div style="position:absolute;left:69.76px;top:276.89px" class="cls_005"><span class="cls_005">257</span></div>
<div style="position:absolute;left:130.75px;top:276.89px" class="cls_005"><span class="cls_005">va_end(ap);</span></div>
<div style="position:absolute;left:69.76px;top:292.75px" class="cls_005"><span class="cls_005">258</span></div>
<div style="position:absolute;left:69.76px;top:308.60px" class="cls_005"><span class="cls_005">259</span></div>
<div style="position:absolute;left:130.75px;top:308.60px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> size;</span></div>
<div style="position:absolute;left:69.76px;top:324.45px" class="cls_005"><span class="cls_005">260</span></div>
<div style="position:absolute;left:103.89px;top:324.45px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:340.31px" class="cls_005"><span class="cls_005">261</span></div>
<div style="position:absolute;left:69.76px;top:356.16px" class="cls_005"><span class="cls_005">262</span></div>
<div style="position:absolute;left:103.89px;top:356.16px" class="cls_013"><span class="cls_013">/* unpack() -- descompacta os dados ditados pelo formato</span></div>
<div style="position:absolute;left:69.76px;top:372.02px" class="cls_005"><span class="cls_005">263</span></div>
<div style="position:absolute;left:103.89px;top:372.02px" class="cls_013"><span class="cls_013">** string no buffer</span></div>
<div style="position:absolute;left:69.76px;top:387.87px" class="cls_005"><span class="cls_005">264</span></div>
<div style="position:absolute;left:103.89px;top:387.87px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:69.76px;top:403.72px" class="cls_005"><span class="cls_005">265</span></div>
<div style="position:absolute;left:103.89px;top:403.72px" class="cls_013"><span class="cls_013">**   bits |signed   unsigned   float   string</span></div>
<div style="position:absolute;left:69.76px;top:419.58px" class="cls_005"><span class="cls_005">266</span></div>
<div style="position:absolute;left:103.89px;top:419.58px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:137.47px;top:419.58px" class="cls_013"><span class="cls_013">-----+----------------------------------</span></div>
<div style="position:absolute;left:69.76px;top:435.43px" class="cls_005"><span class="cls_005">267</span></div>
<div style="position:absolute;left:103.89px;top:435.43px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:157.60px;top:435.43px" class="cls_013"><span class="cls_013">8 |   c</span></div>
<div style="position:absolute;left:258.31px;top:435.43px" class="cls_013"><span class="cls_013">C</span></div>
<div style="position:absolute;left:69.76px;top:451.29px" class="cls_005"><span class="cls_005">268</span></div>
<div style="position:absolute;left:103.89px;top:451.29px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:451.29px" class="cls_013"><span class="cls_013">16 |   h</span></div>
<div style="position:absolute;left:258.31px;top:451.29px" class="cls_013"><span class="cls_013">H</span></div>
<div style="position:absolute;left:325.45px;top:451.29px" class="cls_013"><span class="cls_013">f</span></div>
<div style="position:absolute;left:69.76px;top:467.14px" class="cls_005"><span class="cls_005">269</span></div>
<div style="position:absolute;left:103.89px;top:467.14px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:467.14px" class="cls_013"><span class="cls_013">32 |   l</span></div>
<div style="position:absolute;left:258.31px;top:467.14px" class="cls_013"><span class="cls_013">L</span></div>
<div style="position:absolute;left:325.45px;top:467.14px" class="cls_013"><span class="cls_013">d</span></div>
<div style="position:absolute;left:69.76px;top:482.99px" class="cls_005"><span class="cls_005">270</span></div>
<div style="position:absolute;left:103.89px;top:482.99px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:150.89px;top:482.99px" class="cls_013"><span class="cls_013">64 |   q</span></div>
<div style="position:absolute;left:258.31px;top:482.99px" class="cls_013"><span class="cls_013">Q</span></div>
<div style="position:absolute;left:325.45px;top:482.99px" class="cls_013"><span class="cls_013">g</span></div>
<div style="position:absolute;left:69.76px;top:498.85px" class="cls_005"><span class="cls_005">271</span></div>
<div style="position:absolute;left:103.89px;top:498.85px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:157.60px;top:498.85px" class="cls_013"><span class="cls_013">- |</span></div>
<div style="position:absolute;left:385.87px;top:498.85px" class="cls_013"><span class="cls_013">s</span></div>
<div style="position:absolute;left:69.76px;top:513.77px" class="cls_005"><span class="cls_005">272</span></div>
<div style="position:absolute;left:103.89px;top:513.77px" class="cls_013"><span class="cls_013">** (A string é extraída com base no comprimento</span></div>
<div style="position:absolute;left:109.49px;top:527.76px" class="cls_013"><span class="cls_013">armazenado,</span></div>
<div style="position:absolute;left:69.76px;top:543.61px" class="cls_005"><span class="cls_005">273</span></div>
<div style="position:absolute;left:103.89px;top:543.61px" class="cls_013"><span class="cls_013">** mas 's' pode ser anexado com um comprimento máximo)</span></div>
<div style="position:absolute;left:69.76px;top:559.47px" class="cls_005"><span class="cls_005">274</span></div>
<div style="position:absolute;left:103.89px;top:559.47px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:69.76px;top:575.32px" class="cls_005"><span class="cls_005">275</span></div>
<div style="position:absolute;left:103.89px;top:575.32px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:69.76px;top:591.18px" class="cls_005"><span class="cls_005">276</span></div>
<div style="position:absolute;left:103.89px;top:591.18px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> unpack(</span><span class="cls_008">unsigned  char</span><span class="cls_005"> *buf, </span><span class="cls_008">char</span><span class="cls_005"> *format, ...)</span></div>
<div style="position:absolute;left:69.76px;top:607.03px" class="cls_005"><span class="cls_005">277</span></div>
<div style="position:absolute;left:103.89px;top:607.03px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:69.76px;top:622.88px" class="cls_005"><span class="cls_005">278</span></div>
<div style="position:absolute;left:130.75px;top:622.88px" class="cls_008"><span class="cls_008">va_list</span><span class="cls_005"> ap;</span></div>
<div style="position:absolute;left:69.76px;top:638.74px" class="cls_005"><span class="cls_005">279</span></div>
<div style="position:absolute;left:69.76px;top:654.59px" class="cls_005"><span class="cls_005">280</span></div>
<div style="position:absolute;left:130.75px;top:654.59px" class="cls_008"><span class="cls_008">signed  char</span><span class="cls_005"> *c;</span></div>
<div style="position:absolute;left:325.48px;top:654.59px" class="cls_013"><span class="cls_013">// 8-bit</span></div>
<div style="position:absolute;left:69.76px;top:670.45px" class="cls_005"><span class="cls_005">281</span></div>
<div style="position:absolute;left:130.75px;top:670.45px" class="cls_008"><span class="cls_008">unsigned  char</span><span class="cls_005"> *C;</span></div>
<div style="position:absolute;left:69.76px;top:686.30px" class="cls_005"><span class="cls_005">282</span></div>
<div style="position:absolute;left:69.76px;top:702.16px" class="cls_005"><span class="cls_005">283</span></div>
<div style="position:absolute;left:130.75px;top:702.16px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> *h;</span></div>
<div style="position:absolute;left:325.48px;top:702.16px" class="cls_013"><span class="cls_013">// 16-bit</span></div>
<div style="position:absolute;left:69.76px;top:718.01px" class="cls_005"><span class="cls_005">284</span></div>
<div style="position:absolute;left:130.75px;top:718.01px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> *H;</span></div>
<div style="position:absolute;left:69.76px;top:733.86px" class="cls_005"><span class="cls_005">285</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">87 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:74037px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background088.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">286</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_008"><span class="cls_008">long  int</span><span class="cls_005"> *l;</span></div>
<div style="position:absolute;left:325.48px;top:54.93px" class="cls_013"><span class="cls_013">// 32-bit</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">287</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_008"><span class="cls_008">unsigned  long  int</span><span class="cls_005"> *L;</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">288</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">289</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_008"><span class="cls_008">long  long  int</span><span class="cls_005"> *q;</span></div>
<div style="position:absolute;left:325.48px;top:102.50px" class="cls_013"><span class="cls_013">// 64-bit</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">290</span></div>
<div style="position:absolute;left:130.75px;top:118.35px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> *Q;</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">291</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">292</span></div>
<div style="position:absolute;left:130.75px;top:150.06px" class="cls_008"><span class="cls_008">float</span><span class="cls_005"> *f;</span></div>
<div style="position:absolute;left:325.50px;top:150.06px" class="cls_013"><span class="cls_013">// floats</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">293</span></div>
<div style="position:absolute;left:130.75px;top:165.91px" class="cls_008"><span class="cls_008">double</span><span class="cls_005"> *d;</span></div>
<div style="position:absolute;left:69.76px;top:181.77px" class="cls_005"><span class="cls_005">294</span></div>
<div style="position:absolute;left:130.75px;top:181.77px" class="cls_008"><span class="cls_008">long  double</span><span class="cls_005"> *g;</span></div>
<div style="position:absolute;left:69.76px;top:197.62px" class="cls_005"><span class="cls_005">295</span></div>
<div style="position:absolute;left:130.75px;top:197.62px" class="cls_008"><span class="cls_008">unsigned  long  long  int</span><span class="cls_005"> fhold;</span></div>
<div style="position:absolute;left:69.76px;top:213.47px" class="cls_005"><span class="cls_005">296</span></div>
<div style="position:absolute;left:69.76px;top:229.33px" class="cls_005"><span class="cls_005">297</span></div>
<div style="position:absolute;left:130.75px;top:229.33px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *s;</span></div>
<div style="position:absolute;left:69.76px;top:245.18px" class="cls_005"><span class="cls_005">298</span></div>
<div style="position:absolute;left:130.75px;top:245.18px" class="cls_008"><span class="cls_008">unsigned  int</span><span class="cls_005"> len, maxstrlen=</span><span class="cls_009">0</span><span class="cls_005">, count;</span></div>
<div style="position:absolute;left:69.76px;top:261.04px" class="cls_005"><span class="cls_005">299</span></div>
<div style="position:absolute;left:69.76px;top:276.89px" class="cls_005"><span class="cls_005">300</span></div>
<div style="position:absolute;left:130.75px;top:276.89px" class="cls_005"><span class="cls_005">va_start(ap, format);</span></div>
<div style="position:absolute;left:69.76px;top:292.75px" class="cls_005"><span class="cls_005">301</span></div>
<div style="position:absolute;left:69.76px;top:308.60px" class="cls_005"><span class="cls_005">302</span></div>
<div style="position:absolute;left:130.75px;top:308.60px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(; *format != </span><span class="cls_010">'\0'</span><span class="cls_005">; format++) {</span></div>
<div style="position:absolute;left:69.76px;top:324.45px" class="cls_005"><span class="cls_005">303</span></div>
<div style="position:absolute;left:157.61px;top:324.45px" class="cls_014"><span class="cls_014">switch</span><span class="cls_005">(*format) {</span></div>
<div style="position:absolute;left:69.76px;top:340.31px" class="cls_005"><span class="cls_005">304</span></div>
<div style="position:absolute;left:157.61px;top:340.31px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'c'</span><span class="cls_005">: </span><span class="cls_013">// 8-bit</span></div>
<div style="position:absolute;left:69.76px;top:356.16px" class="cls_005"><span class="cls_005">305</span></div>
<div style="position:absolute;left:184.46px;top:356.16px" class="cls_005"><span class="cls_005">c = va_arg(ap, </span><span class="cls_008">signed  char</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:372.02px" class="cls_005"><span class="cls_005">306</span></div>
<div style="position:absolute;left:184.47px;top:372.02px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (*buf &lt;= </span><span class="cls_009">0x7f</span><span class="cls_005">) { *c = *buf;} </span><span class="cls_013">// re-sign</span></div>
<div style="position:absolute;left:69.76px;top:386.94px" class="cls_005"><span class="cls_005">307</span></div>
<div style="position:absolute;left:184.47px;top:386.94px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> { *c = -</span><span class="cls_009">1</span><span class="cls_005"> - (</span><span class="cls_008">unsigned char</span><span class="cls_005">)(</span><span class="cls_009">0xff</span><span class="cls_005">u -</span></div>
<div style="position:absolute;left:109.49px;top:400.93px" class="cls_005"><span class="cls_005">*buf); }</span></div>
<div style="position:absolute;left:69.76px;top:416.78px" class="cls_005"><span class="cls_005">308</span></div>
<div style="position:absolute;left:184.46px;top:416.78px" class="cls_005"><span class="cls_005">buf++;</span></div>
<div style="position:absolute;left:69.76px;top:432.63px" class="cls_005"><span class="cls_005">309</span></div>
<div style="position:absolute;left:184.47px;top:432.63px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:448.49px" class="cls_005"><span class="cls_005">310</span></div>
<div style="position:absolute;left:69.76px;top:464.34px" class="cls_005"><span class="cls_005">311</span></div>
<div style="position:absolute;left:157.61px;top:464.34px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'C'</span><span class="cls_005">: </span><span class="cls_013">// 8-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:480.20px" class="cls_005"><span class="cls_005">312</span></div>
<div style="position:absolute;left:184.46px;top:480.20px" class="cls_005"><span class="cls_005">C = va_arg(ap, </span><span class="cls_008">unsigned  char</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:496.05px" class="cls_005"><span class="cls_005">313</span></div>
<div style="position:absolute;left:184.46px;top:496.05px" class="cls_005"><span class="cls_005">*C = *buf++;</span></div>
<div style="position:absolute;left:69.76px;top:511.91px" class="cls_005"><span class="cls_005">314</span></div>
<div style="position:absolute;left:184.47px;top:511.91px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:527.76px" class="cls_005"><span class="cls_005">315</span></div>
<div style="position:absolute;left:69.76px;top:543.61px" class="cls_005"><span class="cls_005">316</span></div>
<div style="position:absolute;left:157.61px;top:543.61px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'h'</span><span class="cls_005">: </span><span class="cls_013">// 16-bit</span></div>
<div style="position:absolute;left:69.76px;top:559.47px" class="cls_005"><span class="cls_005">317</span></div>
<div style="position:absolute;left:184.46px;top:559.47px" class="cls_005"><span class="cls_005">h = va_arg(ap, </span><span class="cls_008">int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:575.32px" class="cls_005"><span class="cls_005">318</span></div>
<div style="position:absolute;left:184.46px;top:575.32px" class="cls_005"><span class="cls_005">*h = unpacki16(buf);</span></div>
<div style="position:absolute;left:69.76px;top:591.18px" class="cls_005"><span class="cls_005">319</span></div>
<div style="position:absolute;left:184.46px;top:591.18px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:607.03px" class="cls_005"><span class="cls_005">320</span></div>
<div style="position:absolute;left:184.47px;top:607.03px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:622.88px" class="cls_005"><span class="cls_005">321</span></div>
<div style="position:absolute;left:69.76px;top:638.74px" class="cls_005"><span class="cls_005">322</span></div>
<div style="position:absolute;left:157.61px;top:638.74px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'H'</span><span class="cls_005">: </span><span class="cls_013">// 16-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:654.59px" class="cls_005"><span class="cls_005">323</span></div>
<div style="position:absolute;left:184.46px;top:654.59px" class="cls_005"><span class="cls_005">H = va_arg(ap, </span><span class="cls_008">unsigned  int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:670.45px" class="cls_005"><span class="cls_005">324</span></div>
<div style="position:absolute;left:184.46px;top:670.45px" class="cls_005"><span class="cls_005">*H = unpacku16(buf);</span></div>
<div style="position:absolute;left:69.76px;top:686.30px" class="cls_005"><span class="cls_005">325</span></div>
<div style="position:absolute;left:184.46px;top:686.30px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:702.16px" class="cls_005"><span class="cls_005">326</span></div>
<div style="position:absolute;left:184.47px;top:702.16px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:718.01px" class="cls_005"><span class="cls_005">327</span></div>
<div style="position:absolute;left:69.76px;top:733.86px" class="cls_005"><span class="cls_005">328</span></div>
<div style="position:absolute;left:157.61px;top:733.86px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'l'</span><span class="cls_005">: </span><span class="cls_013">// 32-bit</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">88 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:74888px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background089.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">329</span></div>
<div style="position:absolute;left:184.46px;top:54.93px" class="cls_005"><span class="cls_005">l = va_arg(ap, </span><span class="cls_008">long  int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">330</span></div>
<div style="position:absolute;left:184.46px;top:70.79px" class="cls_005"><span class="cls_005">*l = unpacki32(buf);</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">331</span></div>
<div style="position:absolute;left:184.46px;top:86.64px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">332</span></div>
<div style="position:absolute;left:184.47px;top:102.50px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:118.35px" class="cls_005"><span class="cls_005">333</span></div>
<div style="position:absolute;left:69.76px;top:134.20px" class="cls_005"><span class="cls_005">334</span></div>
<div style="position:absolute;left:157.61px;top:134.20px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'L'</span><span class="cls_005">: </span><span class="cls_013">// 32-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:150.06px" class="cls_005"><span class="cls_005">335</span></div>
<div style="position:absolute;left:184.46px;top:150.06px" class="cls_005"><span class="cls_005">L = va_arg(ap, </span><span class="cls_008">unsigned  long  int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:165.91px" class="cls_005"><span class="cls_005">336</span></div>
<div style="position:absolute;left:184.46px;top:165.91px" class="cls_005"><span class="cls_005">*L = unpacku32(buf);</span></div>
<div style="position:absolute;left:69.76px;top:181.77px" class="cls_005"><span class="cls_005">337</span></div>
<div style="position:absolute;left:184.46px;top:181.77px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:197.62px" class="cls_005"><span class="cls_005">338</span></div>
<div style="position:absolute;left:184.47px;top:197.62px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:213.47px" class="cls_005"><span class="cls_005">339</span></div>
<div style="position:absolute;left:69.76px;top:229.33px" class="cls_005"><span class="cls_005">340</span></div>
<div style="position:absolute;left:157.61px;top:229.33px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'q'</span><span class="cls_005">: </span><span class="cls_013">// 64-bit</span></div>
<div style="position:absolute;left:69.76px;top:245.18px" class="cls_005"><span class="cls_005">341</span></div>
<div style="position:absolute;left:184.46px;top:245.18px" class="cls_005"><span class="cls_005">q = va_arg(ap, </span><span class="cls_008">long  long  int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:261.04px" class="cls_005"><span class="cls_005">342</span></div>
<div style="position:absolute;left:184.46px;top:261.04px" class="cls_005"><span class="cls_005">*q = unpacki64(buf);</span></div>
<div style="position:absolute;left:69.76px;top:276.89px" class="cls_005"><span class="cls_005">343</span></div>
<div style="position:absolute;left:184.46px;top:276.89px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:292.75px" class="cls_005"><span class="cls_005">344</span></div>
<div style="position:absolute;left:184.47px;top:292.75px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:308.60px" class="cls_005"><span class="cls_005">345</span></div>
<div style="position:absolute;left:69.76px;top:324.45px" class="cls_005"><span class="cls_005">346</span></div>
<div style="position:absolute;left:157.61px;top:324.45px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'Q'</span><span class="cls_005">: </span><span class="cls_013">// 64-bit unsigned</span></div>
<div style="position:absolute;left:69.76px;top:340.31px" class="cls_005"><span class="cls_005">347</span></div>
<div style="position:absolute;left:184.46px;top:340.31px" class="cls_005"><span class="cls_005">Q = va_arg(ap, </span><span class="cls_008">unsigned  long</span></div>
<div style="position:absolute;left:379.20px;top:340.31px" class="cls_008"><span class="cls_008">long</span></div>
<div style="position:absolute;left:412.77px;top:340.31px" class="cls_008"><span class="cls_008">int</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:356.16px" class="cls_005"><span class="cls_005">348</span></div>
<div style="position:absolute;left:184.46px;top:356.16px" class="cls_005"><span class="cls_005">*Q = unpacku64(buf);</span></div>
<div style="position:absolute;left:69.76px;top:372.02px" class="cls_005"><span class="cls_005">349</span></div>
<div style="position:absolute;left:184.46px;top:372.02px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:387.87px" class="cls_005"><span class="cls_005">350</span></div>
<div style="position:absolute;left:184.47px;top:387.87px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:403.72px" class="cls_005"><span class="cls_005">351</span></div>
<div style="position:absolute;left:69.76px;top:419.58px" class="cls_005"><span class="cls_005">352</span></div>
<div style="position:absolute;left:157.61px;top:419.58px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'f'</span><span class="cls_005">: </span><span class="cls_013">// float</span></div>
<div style="position:absolute;left:69.76px;top:435.43px" class="cls_005"><span class="cls_005">353</span></div>
<div style="position:absolute;left:184.46px;top:435.43px" class="cls_005"><span class="cls_005">f = va_arg(ap, </span><span class="cls_008">float</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:451.29px" class="cls_005"><span class="cls_005">354</span></div>
<div style="position:absolute;left:184.46px;top:451.29px" class="cls_005"><span class="cls_005">fhold = unpacku16(buf);</span></div>
<div style="position:absolute;left:69.76px;top:467.14px" class="cls_005"><span class="cls_005">355</span></div>
<div style="position:absolute;left:184.46px;top:467.14px" class="cls_005"><span class="cls_005">*f = unpack754_16(fhold);</span></div>
<div style="position:absolute;left:69.76px;top:482.99px" class="cls_005"><span class="cls_005">356</span></div>
<div style="position:absolute;left:184.46px;top:482.99px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:498.85px" class="cls_005"><span class="cls_005">357</span></div>
<div style="position:absolute;left:184.47px;top:498.85px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:514.70px" class="cls_005"><span class="cls_005">358</span></div>
<div style="position:absolute;left:69.76px;top:530.56px" class="cls_005"><span class="cls_005">359</span></div>
<div style="position:absolute;left:157.61px;top:530.56px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'd'</span><span class="cls_005">: </span><span class="cls_013">// float-32</span></div>
<div style="position:absolute;left:69.76px;top:546.41px" class="cls_005"><span class="cls_005">360</span></div>
<div style="position:absolute;left:184.46px;top:546.41px" class="cls_005"><span class="cls_005">d = va_arg(ap, </span><span class="cls_008">double</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:562.27px" class="cls_005"><span class="cls_005">361</span></div>
<div style="position:absolute;left:184.46px;top:562.27px" class="cls_005"><span class="cls_005">fhold = unpacku32(buf);</span></div>
<div style="position:absolute;left:69.76px;top:578.12px" class="cls_005"><span class="cls_005">362</span></div>
<div style="position:absolute;left:184.46px;top:578.12px" class="cls_005"><span class="cls_005">*d = unpack754_32(fhold);</span></div>
<div style="position:absolute;left:69.76px;top:593.97px" class="cls_005"><span class="cls_005">363</span></div>
<div style="position:absolute;left:184.46px;top:593.97px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">4</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:609.83px" class="cls_005"><span class="cls_005">364</span></div>
<div style="position:absolute;left:184.47px;top:609.83px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:625.68px" class="cls_005"><span class="cls_005">365</span></div>
<div style="position:absolute;left:69.76px;top:641.54px" class="cls_005"><span class="cls_005">366</span></div>
<div style="position:absolute;left:157.61px;top:641.54px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 'g'</span><span class="cls_005">: </span><span class="cls_013">// float-64</span></div>
<div style="position:absolute;left:69.76px;top:657.39px" class="cls_005"><span class="cls_005">367</span></div>
<div style="position:absolute;left:184.46px;top:657.39px" class="cls_005"><span class="cls_005">g = va_arg(ap, </span><span class="cls_008">long  double</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:673.24px" class="cls_005"><span class="cls_005">368</span></div>
<div style="position:absolute;left:184.46px;top:673.24px" class="cls_005"><span class="cls_005">fhold = unpacku64(buf);</span></div>
<div style="position:absolute;left:69.76px;top:689.10px" class="cls_005"><span class="cls_005">369</span></div>
<div style="position:absolute;left:184.46px;top:689.10px" class="cls_005"><span class="cls_005">*g = unpack754_64(fhold);</span></div>
<div style="position:absolute;left:69.76px;top:704.95px" class="cls_005"><span class="cls_005">370</span></div>
<div style="position:absolute;left:184.46px;top:704.95px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">8</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:720.81px" class="cls_005"><span class="cls_005">371</span></div>
<div style="position:absolute;left:184.47px;top:720.81px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:736.66px" class="cls_005"><span class="cls_005">372</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">89 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:75739px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background090.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.76px;top:54.93px" class="cls_005"><span class="cls_005">373</span></div>
<div style="position:absolute;left:157.61px;top:54.93px" class="cls_014"><span class="cls_014">case</span><span class="cls_010"> 's'</span><span class="cls_005">: </span><span class="cls_013">// string</span></div>
<div style="position:absolute;left:69.76px;top:70.79px" class="cls_005"><span class="cls_005">374</span></div>
<div style="position:absolute;left:184.46px;top:70.79px" class="cls_005"><span class="cls_005">s = va_arg(ap, </span><span class="cls_008">char</span><span class="cls_005">*);</span></div>
<div style="position:absolute;left:69.76px;top:86.64px" class="cls_005"><span class="cls_005">375</span></div>
<div style="position:absolute;left:184.46px;top:86.64px" class="cls_005"><span class="cls_005">len = unpacku16(buf);</span></div>
<div style="position:absolute;left:69.76px;top:102.50px" class="cls_005"><span class="cls_005">376</span></div>
<div style="position:absolute;left:184.46px;top:102.50px" class="cls_005"><span class="cls_005">buf += </span><span class="cls_009">2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:117.42px" class="cls_005"><span class="cls_005">377</span></div>
<div style="position:absolute;left:184.47px;top:117.42px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (maxstrlen > </span><span class="cls_009">0</span><span class="cls_005"> && len >= maxstrlen) count</span></div>
<div style="position:absolute;left:109.49px;top:131.41px" class="cls_005"><span class="cls_005">= maxstrlen - </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:147.26px" class="cls_005"><span class="cls_005">378</span></div>
<div style="position:absolute;left:184.47px;top:147.26px" class="cls_014"><span class="cls_014">else</span><span class="cls_005"> count = len;</span></div>
<div style="position:absolute;left:69.76px;top:163.11px" class="cls_005"><span class="cls_005">379</span></div>
<div style="position:absolute;left:184.46px;top:163.11px" class="cls_005"><span class="cls_005">memcpy(s, buf, count);</span></div>
<div style="position:absolute;left:69.76px;top:178.97px" class="cls_005"><span class="cls_005">380</span></div>
<div style="position:absolute;left:184.46px;top:178.97px" class="cls_005"><span class="cls_005">s[count] = </span><span class="cls_010">'\0'</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:194.82px" class="cls_005"><span class="cls_005">381</span></div>
<div style="position:absolute;left:184.46px;top:194.82px" class="cls_005"><span class="cls_005">buf += len;</span></div>
<div style="position:absolute;left:69.76px;top:210.68px" class="cls_005"><span class="cls_005">382</span></div>
<div style="position:absolute;left:184.47px;top:210.68px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:226.53px" class="cls_005"><span class="cls_005">383</span></div>
<div style="position:absolute;left:69.76px;top:242.38px" class="cls_005"><span class="cls_005">384</span></div>
<div style="position:absolute;left:157.61px;top:242.38px" class="cls_014"><span class="cls_014">default</span><span class="cls_005">:</span></div>
<div style="position:absolute;left:69.76px;top:258.24px" class="cls_005"><span class="cls_005">385</span></div>
<div style="position:absolute;left:184.47px;top:258.24px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (isdigit(*format)) { </span><span class="cls_013">// segue max str len</span></div>
<div style="position:absolute;left:69.76px;top:273.16px" class="cls_005"><span class="cls_005">386</span></div>
<div style="position:absolute;left:211.31px;top:273.16px" class="cls_005"><span class="cls_005">maxstrlen = maxstrlen * </span><span class="cls_009">10</span><span class="cls_005"> +</span></div>
<div style="position:absolute;left:109.49px;top:287.15px" class="cls_005"><span class="cls_005">(*format-</span><span class="cls_010">'0'</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:69.76px;top:303.00px" class="cls_005"><span class="cls_005">387</span></div>
<div style="position:absolute;left:184.46px;top:303.00px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:318.86px" class="cls_005"><span class="cls_005">388</span></div>
<div style="position:absolute;left:157.61px;top:318.86px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:334.71px" class="cls_005"><span class="cls_005">389</span></div>
<div style="position:absolute;left:69.76px;top:350.57px" class="cls_005"><span class="cls_005">390</span></div>
<div style="position:absolute;left:157.61px;top:350.57px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (!isdigit(*format)) maxstrlen = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:69.76px;top:366.42px" class="cls_005"><span class="cls_005">391</span></div>
<div style="position:absolute;left:130.75px;top:366.42px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:69.76px;top:382.27px" class="cls_005"><span class="cls_005">392</span></div>
<div style="position:absolute;left:69.76px;top:398.13px" class="cls_005"><span class="cls_005">393</span></div>
<div style="position:absolute;left:130.75px;top:398.13px" class="cls_005"><span class="cls_005">va_end(ap);</span></div>
<div style="position:absolute;left:69.76px;top:413.98px" class="cls_005"><span class="cls_005">394</span></div>
<div style="position:absolute;left:103.89px;top:413.98px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:447.09px" class="cls_005"><span class="cls_005">E </span><span class="cls_023">aqui está um pro</span><span class="cls_006">g</span><span class="cls_023">rama de demonstra</span><span class="cls_006">ç</span><span class="cls_023">ão</span><span class="cls_024"><sup>40</sup></span><span class="cls_005"> do código acima que embala alguns dados em</span></div>
<div style="position:absolute;left:60.99px;top:463.95px" class="cls_005"><span class="cls_005">buf e, em seguida, os descompacta em variáveis. Note que quando chamamos unpack()</span></div>
<div style="position:absolute;left:60.99px;top:479.80px" class="cls_005"><span class="cls_005">com um argumento em string (especi cador de formato "s"), é aconselhável colocar uma</span></div>
<div style="position:absolute;left:60.99px;top:494.72px" class="cls_005"><span class="cls_005">contagem de comprimento máximo na frente para evitar uma saturação de buffer, por</span></div>
<div style="position:absolute;left:60.99px;top:509.64px" class="cls_005"><span class="cls_005">exemplo, "96s". Seja cauteloso ao descompactar dados recebidos pela rede—um usuário</span></div>
<div style="position:absolute;left:60.99px;top:524.57px" class="cls_005"><span class="cls_005">malicioso pode enviar pacotes mal construídas em um esforço para atacar seu sistema!</span></div>
<div style="position:absolute;left:83.19px;top:557.67px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:557.67px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:573.53px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:589.38px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:589.38px" class="cls_013"><span class="cls_013">// vários bits para tipos de ponto flutuante--</span></div>
<div style="position:absolute;left:83.19px;top:605.24px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:605.24px" class="cls_013"><span class="cls_013">// varia para diferentes arquiteturas</span></div>
<div style="position:absolute;left:83.19px;top:621.09px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:621.09px" class="cls_014"><span class="cls_014">typedef</span><span class="cls_008"> float</span><span class="cls_005"> float32_t;</span></div>
<div style="position:absolute;left:83.19px;top:636.94px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:636.94px" class="cls_014"><span class="cls_014">typedef</span><span class="cls_008"> double</span><span class="cls_005"> float64_t;</span></div>
<div style="position:absolute;left:83.19px;top:652.80px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:668.65px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:668.65px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">void</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:83.19px;top:684.51px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:684.51px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:700.36px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:700.36px" class="cls_008"><span class="cls_008">unsigned  char</span><span class="cls_005"> buf[</span><span class="cls_009">1024</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:716.21px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:716.21px" class="cls_008"><span class="cls_008">int8_t</span><span class="cls_005"> magic;</span></div>
<div style="position:absolute;left:76.48px;top:732.07px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:732.07px" class="cls_008"><span class="cls_008">int16_t</span><span class="cls_005"> monkeycount;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">90 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:76590px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background091.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_008"><span class="cls_008">int32_t</span><span class="cls_005"> altitude;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">float32_t absurdityfactor;</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:85.71px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *s = </span><span class="cls_010">"Great unmitigated Zot! You've found the</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_010"><span class="cls_010">Runestaff!"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:115.55px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> s2[</span><span class="cls_009">96</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_008"><span class="cls_008">int16_t</span><span class="cls_005"> packetsize, ps2;</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:162.18px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:162.18px" class="cls_005"><span class="cls_005">packetsize = pack(buf, </span><span class="cls_010">"chhlsf"</span><span class="cls_005">, (</span><span class="cls_008">int8_t</span><span class="cls_005">)</span><span class="cls_010">'B'</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:176.17px" class="cls_005"><span class="cls_005">(</span><span class="cls_008">int16_t</span><span class="cls_005">)</span><span class="cls_009">0</span><span class="cls_005">, (</span><span class="cls_008">int16_t</span><span class="cls_005">)</span><span class="cls_009">37</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:184.46px;top:192.02px" class="cls_005"><span class="cls_005">(</span><span class="cls_008">int32_t</span><span class="cls_005">)-</span><span class="cls_009">5</span><span class="cls_005">, s, (float32_t)-</span><span class="cls_009">3490.6677</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:206.95px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:206.95px" class="cls_005"><span class="cls_005">packi16(buf+</span><span class="cls_009">1</span><span class="cls_005">, packetsize); </span><span class="cls_013">// guarda tamanho do</span></div>
<div style="position:absolute;left:109.49px;top:220.93px" class="cls_013"><span class="cls_013">pacote no pacote</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:252.64px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"packet é %"</span><span class="cls_005"> PRId32 </span><span class="cls_010">" bytes\n"</span><span class="cls_005">, packetsize);</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:283.42px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:283.42px" class="cls_005"><span class="cls_005">unpack(buf, </span><span class="cls_010">"chhl96sf"</span><span class="cls_005">, &magic, &ps2, &monkeycount,</span></div>
<div style="position:absolute;left:109.49px;top:297.41px" class="cls_005"><span class="cls_005">&altitude, s2,</span></div>
<div style="position:absolute;left:76.48px;top:313.26px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:157.60px;top:313.26px" class="cls_005"><span class="cls_005">&absurdityfactor);</span></div>
<div style="position:absolute;left:76.48px;top:329.12px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:344.97px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:344.97px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"'%c' %"</span><span class="cls_005"> PRId32</span><span class="cls_010">" %"</span><span class="cls_005"> PRId16 </span><span class="cls_010">" %"</span><span class="cls_005"> PRId32</span></div>
<div style="position:absolute;left:76.48px;top:360.82px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:184.47px;top:360.82px" class="cls_010"><span class="cls_010">" \"%s\" %f\n"</span><span class="cls_005">, magic, ps2, monkeycount,</span></div>
<div style="position:absolute;left:76.48px;top:376.68px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:184.46px;top:376.68px" class="cls_005"><span class="cls_005">altitude, s2, absurdityfactor);</span></div>
<div style="position:absolute;left:76.48px;top:392.53px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:76.48px;top:408.39px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:408.39px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:424.24px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:103.89px;top:424.24px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:457.35px" class="cls_005"><span class="cls_005">Se você trabalha com seu próprio código ou usa o de outra pessoa, é uma boa idéia ter um</span></div>
<div style="position:absolute;left:60.99px;top:471.34px" class="cls_005"><span class="cls_005">conjunto geral de rotinas de embalagem de dados para manter os bugs sob controle, ao invés</span></div>
<div style="position:absolute;left:60.99px;top:485.33px" class="cls_005"><span class="cls_005">de embalar cada bit manualmente a cada vez.</span></div>
<div style="position:absolute;left:60.99px;top:510.51px" class="cls_005"><span class="cls_005">Ao embalar os dados, qual é o melhor formato a ser usado? Excelente questão. Felizmente, a</span></div>
<div style="position:absolute;left:60.99px;top:524.50px" class="cls_023"><span class="cls_023">RFC 4506</span><span class="cls_024"><sup>41</sup></span><span class="cls_005">, o Padrão de Representação de Dados Externos, já de ne formatos binários para</span></div>
<div style="position:absolute;left:60.99px;top:540.42px" class="cls_005"><span class="cls_005">diferentes tipos, como tipos   oat, tipos int, arrays, raw data, etc. Eu sugiro que se conforme</span></div>
<div style="position:absolute;left:60.99px;top:554.41px" class="cls_005"><span class="cls_005">com isso, se você estiver trabalhando com os dados sozinho. Mas você não é obrigado a isso.</span></div>
<div style="position:absolute;left:60.99px;top:568.40px" class="cls_005"><span class="cls_005">A Polícia de Pacotes não estará mesmo à sua porta. Pelo menos, eu não acredito que estará.</span></div>
<div style="position:absolute;left:60.99px;top:593.58px" class="cls_005"><span class="cls_005">Em qualquer caso, codi car os dados de uma forma ou de outra antes de enviá-los é a maneira</span></div>
<div style="position:absolute;left:60.99px;top:607.57px" class="cls_005"><span class="cls_005">certa de fazer as coisas!</span></div>
<div style="position:absolute;left:60.99px;top:634.55px" class="cls_007"><span class="cls_007">Bases do encapsulamento de dados</span></div>
<div style="position:absolute;left:60.99px;top:669.93px" class="cls_005"><span class="cls_005">O que realmente signi ca encapsular dados, de qualquer maneira? No caso mais simples,</span></div>
<div style="position:absolute;left:60.99px;top:683.92px" class="cls_005"><span class="cls_005">signi ca que você colocará um cabeçalho lá com algumas informações de identi cação ou o</span></div>
<div style="position:absolute;left:60.99px;top:697.91px" class="cls_005"><span class="cls_005">comprimento do pacote, ou ambos.</span></div>
<div style="position:absolute;left:60.99px;top:723.09px" class="cls_005"><span class="cls_005">Como deve ser seu cabeçalho? Bem, são apenas alguns dados binários que representam o que</span></div>
<div style="position:absolute;left:60.99px;top:737.08px" class="cls_005"><span class="cls_005">você acha necessário para concluir seu projeto.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">91 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:77441px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background092.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Uau. Isso é vago.</span></div>
<div style="position:absolute;left:60.99px;top:79.18px" class="cls_005"><span class="cls_005">Ok. Por exemplo, digamos que você tenha um programa de chat multi-usuário que use</span></div>
<div style="position:absolute;left:60.99px;top:94.10px" class="cls_005"><span class="cls_005">SOCK_STREAM. Quando um usuário digita ("diz") algo, dois pedaços de informação precisam</span></div>
<div style="position:absolute;left:60.99px;top:109.02px" class="cls_005"><span class="cls_005">ser transmitidos ao servidor: o que foi dito e quem disse.</span></div>
<div style="position:absolute;left:60.99px;top:134.20px" class="cls_005"><span class="cls_005">Até aí tudo bem? "Qual é o problema?" você está perguntando.</span></div>
<div style="position:absolute;left:60.99px;top:159.38px" class="cls_005"><span class="cls_005">O problema é que as mensagens podem ter comprimentos variados. Uma pessoa chamada</span></div>
<div style="position:absolute;left:60.99px;top:173.37px" class="cls_005"><span class="cls_005">"tom" pode dizer: "Olá", e outra pessoa chamada "Benjamin" pode dizer: "Ei, pessoal, o que</span></div>
<div style="position:absolute;left:60.99px;top:187.36px" class="cls_005"><span class="cls_005">aconteceu?"</span></div>
<div style="position:absolute;left:60.99px;top:213.47px" class="cls_005"><span class="cls_005">Então você envia com send() todas essas coisas para os clientes quando chegarem a você.</span></div>
<div style="position:absolute;left:60.99px;top:228.40px" class="cls_005"><span class="cls_005">Seu   uxo de dados de saída se parece com isso:</span></div>
<div style="position:absolute;left:67.99px;top:261.50px" class="cls_005"><span class="cls_005">t o m O l á B e n j a m i n E i , p e s s o a l , o q u e a c o n t</span></div>
<div style="position:absolute;left:67.99px;top:277.36px" class="cls_005"><span class="cls_005">e c e u ?</span></div>
<div style="position:absolute;left:60.99px;top:310.46px" class="cls_005"><span class="cls_005">E assim por diante. Como o cliente sabe quando uma mensagem termina e outra começa?</span></div>
<div style="position:absolute;left:60.99px;top:324.45px" class="cls_005"><span class="cls_005">Você poderia, se quisesse, fazer com que todas as mensagens tivessem o mesmo</span></div>
<div style="position:absolute;left:60.99px;top:339.37px" class="cls_005"><span class="cls_005">comprimento e apenas chamar sendall() que implementamos, </span><span class="cls_023">acima</span><span class="cls_005">. Mas isso desperdiça</span></div>
<div style="position:absolute;left:60.99px;top:355.23px" class="cls_005"><span class="cls_005">largura de banda! Nós não queremos executar send() com 1024 bytes apenas para que "Tom"</span></div>
<div style="position:absolute;left:60.99px;top:370.15px" class="cls_005"><span class="cls_005">possa dizer "Olá".</span></div>
<div style="position:absolute;left:60.99px;top:395.33px" class="cls_005"><span class="cls_005">Por isso, encapsulamos os dados em uma pequena estrutura de cabeçalho e corpo. Tanto o</span></div>
<div style="position:absolute;left:60.99px;top:409.32px" class="cls_005"><span class="cls_005">cliente quanto o servidor sabem como compactar e descompactar (por vezes referido como</span></div>
<div style="position:absolute;left:60.99px;top:423.31px" class="cls_005"><span class="cls_005">"marshal" e "unmarshal") esses dados. Não olhe agora, mas estamos começando a de nir um</span></div>
<div style="position:absolute;left:60.99px;top:437.30px" class="cls_005"><span class="cls_005">protocolo que descreve como um cliente e servidor comunicam-se!</span></div>
<div style="position:absolute;left:60.99px;top:462.48px" class="cls_005"><span class="cls_005">Neste caso, vamos supor que o nome de usuário tenha um comprimento  xo de 8 caracteres,</span></div>
<div style="position:absolute;left:60.99px;top:477.40px" class="cls_005"><span class="cls_005">terminados com '\0'. E então vamos supor que os dados tenham comprimento variável, até</span></div>
<div style="position:absolute;left:60.99px;top:492.32px" class="cls_005"><span class="cls_005">um máximo de 128 caracteres. Vamos dar uma olhada em uma estrutura de pacote num</span></div>
<div style="position:absolute;left:60.99px;top:506.31px" class="cls_005"><span class="cls_005">exemplo que poderíamos usar nesta situação:</span></div>
<div style="position:absolute;left:76.97px;top:532.42px" class="cls_005"><span class="cls_005">1. len (1 byte, sem sinal)—O comprimento total do pacote, contendo 8 bytes do user name</span></div>
<div style="position:absolute;left:88.97px;top:547.34px" class="cls_005"><span class="cls_005">e chat data.</span></div>
<div style="position:absolute;left:76.97px;top:573.46px" class="cls_005"><span class="cls_005">2. name (8 bytes)—O nome do usuário, NUL-preenchido se necessário.</span></div>
<div style="position:absolute;left:76.97px;top:600.50px" class="cls_005"><span class="cls_005">3. chatdata (n-bytes)—Os dados em si, não mais do que 128 bytes. O comprimento do</span></div>
<div style="position:absolute;left:88.97px;top:615.42px" class="cls_005"><span class="cls_005">pacote deve ser calculado como o comprimento dos dados mais 8 (o comprimento do</span></div>
<div style="position:absolute;left:88.97px;top:629.41px" class="cls_005"><span class="cls_005">campo do nome, acima).</span></div>
<div style="position:absolute;left:60.99px;top:654.59px" class="cls_005"><span class="cls_005">Por que escolhi os limites de 8 bytes e 128 bytes para os campos? Eu os puxei para fora pelo</span></div>
<div style="position:absolute;left:67.18px;top:668.58px" class="cls_005"><span class="cls_005">o, assumindo que seriam longos o su ciente. Talvez, porém, 8 bytes sejam muito restritivos</span></div>
<div style="position:absolute;left:60.99px;top:682.57px" class="cls_005"><span class="cls_005">para as suas necessidades, e você pode ter um campo de nome com 30 bytes, ou quantos</span></div>
<div style="position:absolute;left:60.99px;top:696.56px" class="cls_005"><span class="cls_005">queira que sejam. A escolha é sua.</span></div>
<div style="position:absolute;left:60.99px;top:721.74px" class="cls_005"><span class="cls_005">Usando a de nição de pacotes acima, o primeiro pacote consistiria nas seguintes informações</span></div>
<div style="position:absolute;left:60.99px;top:735.73px" class="cls_005"><span class="cls_005">(em hexadecimal e ASCII):</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">92 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:78292px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background093.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:114.98px;top:61.93px" class="cls_005"><span class="cls_005">0A</span></div>
<div style="position:absolute;left:161.98px;top:61.93px" class="cls_005"><span class="cls_005">74 6F 6D 00 00 00 00 00</span></div>
<div style="position:absolute;left:356.68px;top:61.93px" class="cls_005"><span class="cls_005">48 69</span></div>
<div style="position:absolute;left:94.85px;top:77.78px" class="cls_005"><span class="cls_005">(length)  T  o  m</span></div>
<div style="position:absolute;left:235.83px;top:77.78px" class="cls_005"><span class="cls_005">(padding)</span></div>
<div style="position:absolute;left:356.68px;top:77.78px" class="cls_005"><span class="cls_005">H  i</span></div>
<div style="position:absolute;left:60.99px;top:110.89px" class="cls_005"><span class="cls_005">And the second is similar:</span></div>
<div style="position:absolute;left:114.98px;top:144.00px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:161.98px;top:144.00px" class="cls_005"><span class="cls_005">42 65 6E 6A 61 6D 69 6E</span></div>
<div style="position:absolute;left:356.68px;top:144.00px" class="cls_005"><span class="cls_005">48 65 79 20 67 75 79 73</span></div>
<div style="position:absolute;left:67.99px;top:159.85px" class="cls_005"><span class="cls_005">20 77 ...</span></div>
<div style="position:absolute;left:94.85px;top:175.70px" class="cls_005"><span class="cls_005">(length)  B  e  n  j  a  m  i  n</span></div>
<div style="position:absolute;left:356.68px;top:175.70px" class="cls_005"><span class="cls_005">H  e  y</span></div>
<div style="position:absolute;left:437.24px;top:175.70px" class="cls_005"><span class="cls_005">g  u  y  s</span></div>
<div style="position:absolute;left:67.99px;top:191.56px" class="cls_005"><span class="cls_005">w  ...</span></div>
<div style="position:absolute;left:60.99px;top:224.67px" class="cls_005"><span class="cls_005">(O comprimento é armazenado em Network Byte Order, é claro. Neste caso, é apenas um byte,</span></div>
<div style="position:absolute;left:60.99px;top:238.65px" class="cls_005"><span class="cls_005">por isso não importa, mas em geral você desejará que todos os seus inteiros binários sejam</span></div>
<div style="position:absolute;left:60.99px;top:252.64px" class="cls_005"><span class="cls_005">armazenados em Network Byte Order em seus pacotes.)</span></div>
<div style="position:absolute;left:60.99px;top:277.82px" class="cls_005"><span class="cls_005">Quando você está enviando esses dados, você deve estar seguro e usar um comando</span></div>
<div style="position:absolute;left:60.99px;top:292.75px" class="cls_005"><span class="cls_005">semelhante a </span><span class="cls_023">sendall</span><span class="cls_006">()</span><span class="cls_005">, acima, para que você saiba que todos os dados são enviados,</span></div>
<div style="position:absolute;left:60.99px;top:308.60px" class="cls_005"><span class="cls_005">mesmo que sejam necessárias várias chamadas a send() para colocar tudo para fora.</span></div>
<div style="position:absolute;left:60.99px;top:334.71px" class="cls_005"><span class="cls_005">Da mesma forma, quando você está recebendo esses dados, precisa fazer um pouco mais de</span></div>
<div style="position:absolute;left:60.99px;top:348.70px" class="cls_005"><span class="cls_005">trabalho. Para estar seguro, você deve assumir que pode receber um pacote parcial (como</span></div>
<div style="position:absolute;left:60.99px;top:363.62px" class="cls_005"><span class="cls_005">talvez recebamos "18 42 65 6E 6A" de Benjamin, acima, mas isso é tudo o que recebemos</span></div>
<div style="position:absolute;left:60.99px;top:379.48px" class="cls_005"><span class="cls_005">nesta chamada recv()). Precisamos chamar recv() repetidamente até que o pacote seja</span></div>
<div style="position:absolute;left:60.99px;top:394.40px" class="cls_005"><span class="cls_005">completamente recebido.</span></div>
<div style="position:absolute;left:60.99px;top:419.58px" class="cls_005"><span class="cls_005">Mas como? Bem, nós sabemos o número de bytes que precisamos receber no total para que o</span></div>
<div style="position:absolute;left:60.99px;top:433.57px" class="cls_005"><span class="cls_005">pacote esteja completo, uma vez que o número é inserido na frente do pacote. Sabemos</span></div>
<div style="position:absolute;left:60.99px;top:447.56px" class="cls_005"><span class="cls_005">também que o tamanho máximo do pacote é 1+8+128, ou 137 bytes (porque é assim que</span></div>
<div style="position:absolute;left:60.99px;top:461.55px" class="cls_005"><span class="cls_005">de nimos o pacote.)</span></div>
<div style="position:absolute;left:60.99px;top:486.73px" class="cls_005"><span class="cls_005">Na verdade, existem algumas coisas que você pode fazer aqui. Como você sabe que cada</span></div>
<div style="position:absolute;left:60.99px;top:501.65px" class="cls_005"><span class="cls_005">pacote começa com um comprimento, você pode chamar recv() apenas para obter o</span></div>
<div style="position:absolute;left:60.99px;top:516.57px" class="cls_005"><span class="cls_005">tamanho do pacote. Então uma vez que você tenha isso, você pode chamá-la novamente</span></div>
<div style="position:absolute;left:60.99px;top:530.56px" class="cls_005"><span class="cls_005">especi cando exatamente o comprimento restante do pacote (possivelmente repetidamente</span></div>
<div style="position:absolute;left:60.99px;top:544.55px" class="cls_005"><span class="cls_005">para obter todos os dados) até que você tenha o pacote completo. A vantagem deste método é</span></div>
<div style="position:absolute;left:60.99px;top:558.54px" class="cls_005"><span class="cls_005">que você só precisa de um buffer grande su ciente para um pacote, enquanto a desvantagem</span></div>
<div style="position:absolute;left:60.99px;top:573.46px" class="cls_005"><span class="cls_005">é que você precisa chamar recv() pelo menos duas vezes para obter todos os dados.</span></div>
<div style="position:absolute;left:60.99px;top:600.50px" class="cls_005"><span class="cls_005">Outra opção é apenas chamar recv() e dizer que o valor que você está disposto a receber é o</span></div>
<div style="position:absolute;left:60.99px;top:615.42px" class="cls_005"><span class="cls_005">número máximo de bytes em um pacote. Então, o que quer que você receba, coloque-o na</span></div>
<div style="position:absolute;left:60.99px;top:629.41px" class="cls_005"><span class="cls_005">parte de trás de um buffer, e,  nalmente, veri que se o pacote está completo. Claro, você pode</span></div>
<div style="position:absolute;left:60.99px;top:643.40px" class="cls_005"><span class="cls_005">pegar um pouco do próximo pacote, então você precisa ter espaço para isso.</span></div>
<div style="position:absolute;left:60.99px;top:668.58px" class="cls_005"><span class="cls_005">O que você pode fazer é declarar uma matriz grande o su ciente para dois pacotes. Este é o</span></div>
<div style="position:absolute;left:60.99px;top:682.57px" class="cls_005"><span class="cls_005">seu array de trabalho onde você irá reconstruir os pacotes conforme eles chegam.</span></div>
<div style="position:absolute;left:60.99px;top:708.68px" class="cls_005"><span class="cls_005">Cada vez que você receber dados com recv(), você os anexará ao buffer de trabalho e</span></div>
<div style="position:absolute;left:60.99px;top:723.61px" class="cls_005"><span class="cls_005">veri cará se o pacote está completo. Ou seja, o número de bytes no buffer é maior ou igual ao</span></div>
<div style="position:absolute;left:60.99px;top:737.59px" class="cls_005"><span class="cls_005">comprimento especi cado no cabeçalho (+1, porque o comprimento no cabeçalho não inclui o</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">93 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:79143px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background094.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">byte para o próprio comprimento). Se o número de bytes no buffer for menor que 1, o pacote</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">não está completo, obviamente. Você tem que fazer um case especial para isso, porém, desde</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">que o primeiro byte é lixo e você não pode contar com ele para o comprimento correto do</span></div>
<div style="position:absolute;left:60.99px;top:95.97px" class="cls_005"><span class="cls_005">pacote.</span></div>
<div style="position:absolute;left:60.99px;top:121.15px" class="cls_005"><span class="cls_005">Quando o pacote estiver completo, você poderá fazer com ele o que quiser. Use-o e remova-o</span></div>
<div style="position:absolute;left:60.99px;top:135.14px" class="cls_005"><span class="cls_005">do seu buffer de trabalho.</span></div>
<div style="position:absolute;left:60.99px;top:160.32px" class="cls_005"><span class="cls_005">Ufa! Você ainda está fazendo malabarismos com isso na sua cabeça? Bem, aqui está mais</span></div>
<div style="position:absolute;left:60.99px;top:174.31px" class="cls_005"><span class="cls_005">complexidade: você pode ter lido e passado do  m de um pacote e lido parte do próximo em</span></div>
<div style="position:absolute;left:60.99px;top:189.23px" class="cls_005"><span class="cls_005">uma única chamada recv(). Ou seja, você tem um buffer de trabalho com um pacote</span></div>
<div style="position:absolute;left:60.99px;top:204.15px" class="cls_005"><span class="cls_005">completo e uma parte incompleta do próximo pacote! Maldito. (Mas foi por isso que você fez o</span></div>
<div style="position:absolute;left:60.99px;top:218.14px" class="cls_005"><span class="cls_005">seu buffer de trabalho su cientemente grande para conter dois pacotes—caso isso</span></div>
<div style="position:absolute;left:60.99px;top:232.13px" class="cls_005"><span class="cls_005">acontecesse!)</span></div>
<div style="position:absolute;left:60.99px;top:257.31px" class="cls_005"><span class="cls_005">Uma vez que você saiba o tamanho do primeiro pacote do cabeçalho, e você está mantendo o</span></div>
<div style="position:absolute;left:60.99px;top:271.30px" class="cls_005"><span class="cls_005">controle do número de bytes no buffer de trabalho, você pode subtrair e calcular quantos dos</span></div>
<div style="position:absolute;left:60.99px;top:285.28px" class="cls_005"><span class="cls_005">bytes no buffer de trabalho pertencem ao segundo pacote (incompleto). Quando você já lidou</span></div>
<div style="position:absolute;left:60.99px;top:299.27px" class="cls_005"><span class="cls_005">com o primeiro, você pode removê-lo do buffer de trabalho e mover o segundo pacote parcial</span></div>
<div style="position:absolute;left:60.99px;top:314.19px" class="cls_005"><span class="cls_005">para frente no buffer para que ele esteja pronto para o próximo recv().</span></div>
<div style="position:absolute;left:60.99px;top:340.31px" class="cls_005"><span class="cls_005">(Alguns de vocês leitores notarão que mover o segundo pacote parcial para o início do buffer</span></div>
<div style="position:absolute;left:60.99px;top:354.30px" class="cls_005"><span class="cls_005">de trabalho leva tempo, e o programa pode ser codi cado para não exigir isso usando um</span></div>
<div style="position:absolute;left:60.99px;top:368.29px" class="cls_005"><span class="cls_005">buffer circular. Infelizmente para o resto de vocês, uma discussão sobre buffers circulares está</span></div>
<div style="position:absolute;left:60.99px;top:382.27px" class="cls_005"><span class="cls_005">além do escopo deste artigo. Se você ainda está curioso, pegue um livro sobre estruturas de</span></div>
<div style="position:absolute;left:60.99px;top:396.26px" class="cls_005"><span class="cls_005">dados e siga a partir daí.)</span></div>
<div style="position:absolute;left:60.99px;top:421.44px" class="cls_005"><span class="cls_005">Eu nunca disse que era fácil. Ok, eu disse que era fácil. E isso é: você só precisa praticar e</span></div>
<div style="position:absolute;left:60.99px;top:435.43px" class="cls_005"><span class="cls_005">muito em breve se tornará natural. Juro por Excalibur!</span></div>
<div style="position:absolute;left:60.99px;top:462.42px" class="cls_007"><span class="cls_007">Pacotes Broadcast—Olá, mundo!</span></div>
<div style="position:absolute;left:60.99px;top:497.80px" class="cls_005"><span class="cls_005">Até agora, este guia falou sobre o envio de dados de um host para um outro host. Mas é</span></div>
<div style="position:absolute;left:60.99px;top:511.79px" class="cls_005"><span class="cls_005">possível, insisto, que você possa, com a devida autoridade, enviar dados para vários hosts ao</span></div>
<div style="position:absolute;left:60.99px;top:525.78px" class="cls_005"><span class="cls_005">mesmo tempo!</span></div>
<div style="position:absolute;left:60.99px;top:550.96px" class="cls_005"><span class="cls_005">Com UDP (somente UDP, não TCP) e IPv4 padrão, isso é feito através de um mecanismo</span></div>
<div style="position:absolute;left:60.99px;top:564.95px" class="cls_005"><span class="cls_005">chamado broadcasting. Com o IPv6, broadcasting não é suportado e você precisa recorrer à</span></div>
<div style="position:absolute;left:60.99px;top:578.94px" class="cls_005"><span class="cls_005">técnica frequentemente superior de multicasting, que, infelizmente, eu não estarei discutindo</span></div>
<div style="position:absolute;left:60.99px;top:592.92px" class="cls_005"><span class="cls_005">neste momento. Mas o su ciente para espiarmos o futuro—estamos presos no presente de 32</span></div>
<div style="position:absolute;left:60.99px;top:606.91px" class="cls_005"><span class="cls_005">bits.</span></div>
<div style="position:absolute;left:60.99px;top:632.09px" class="cls_005"><span class="cls_005">Mas espere! Você não pode simplesmente sair daqui e começar seu broadcasting de forma</span></div>
<div style="position:absolute;left:60.99px;top:647.02px" class="cls_005"><span class="cls_005">precipitada; Você precisa de nir a opção de socket SO_BROADCAST antes de pode enviar um</span></div>
<div style="position:absolute;left:60.99px;top:661.94px" class="cls_005"><span class="cls_005">pacote broadcast para a rede. É como uma daqueles pequenas tampas de plástico que eles</span></div>
<div style="position:absolute;left:60.99px;top:675.93px" class="cls_005"><span class="cls_005">colocaram sobre o interruptor de lançamento do míssil! Isso é o quanto de poder você tem</span></div>
<div style="position:absolute;left:60.99px;top:689.92px" class="cls_005"><span class="cls_005">suas mãos!</span></div>
<div style="position:absolute;left:60.99px;top:715.10px" class="cls_005"><span class="cls_005">Mas, falando sério, existe o perigo de usar pacotes broadcast, ou seja: todo sistema que</span></div>
<div style="position:absolute;left:60.99px;top:729.08px" class="cls_005"><span class="cls_005">recebe um pacote broadcast deve desfazer todas as camadas de encapsulamento de dados</span></div>
<div style="position:absolute;left:60.99px;top:743.07px" class="cls_005"><span class="cls_005">até que descubra-se a que porta os dados são destinados. E então entrega os dados ou os</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">94 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:79994px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background095.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">descarta. Em ambos os casos, é muito trabalhoso para cada máquina que recebe o pacote</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">broadcast, e como trafegam todos na rede local pode haver muitas máquinas fazendo trabalho</span></div>
<div style="position:absolute;left:60.99px;top:81.98px" class="cls_005"><span class="cls_005">desnecessário. Quando o jogo Doom apareceu pela primeira vez, isso era uma reclamação</span></div>
<div style="position:absolute;left:60.99px;top:95.97px" class="cls_005"><span class="cls_005">sobre seu código de rede.</span></div>
<div style="position:absolute;left:60.99px;top:121.15px" class="cls_005"><span class="cls_005">Agora, há mais de uma maneira de esfolar um gato... espere um minuto. Existe realmente mais</span></div>
<div style="position:absolute;left:60.99px;top:135.14px" class="cls_005"><span class="cls_005">do que uma maneira de esfolar um gato? Que tipo de expressão é essa? E, da mesma forma,</span></div>
<div style="position:absolute;left:60.99px;top:149.12px" class="cls_005"><span class="cls_005">há mais de uma maneira de enviar um pacote broadcast. Então, para chegar à carne e às</span></div>
<div style="position:absolute;left:60.99px;top:163.11px" class="cls_005"><span class="cls_005">batatas da coisa toda: como você especi ca o endereço de destino para uma mensagem de</span></div>
<div style="position:absolute;left:60.99px;top:177.10px" class="cls_005"><span class="cls_005">broadcast? Existem duas formas comuns:</span></div>
<div style="position:absolute;left:76.97px;top:202.28px" class="cls_005"><span class="cls_005">1. Envie os dados para o endereço de broadcast de uma sub-rede especí ca. Esse é o</span></div>
<div style="position:absolute;left:88.97px;top:216.27px" class="cls_005"><span class="cls_005">número de rede da sub-rede com todas os bits um de nidos para a parte de host do</span></div>
<div style="position:absolute;left:88.97px;top:231.19px" class="cls_005"><span class="cls_005">endereço. Por exemplo, em casa minha rede é 192.168.1.0, a minha máscara de rede é</span></div>
<div style="position:absolute;left:88.97px;top:247.05px" class="cls_005"><span class="cls_005">255.255.255.0, então o último byte do endereço é meu número de host (porque os três</span></div>
<div style="position:absolute;left:88.97px;top:261.97px" class="cls_005"><span class="cls_005">primeiros bytes, de acordo com a máscara de rede, são o número da rede). Então, meu</span></div>
<div style="position:absolute;left:88.97px;top:276.89px" class="cls_005"><span class="cls_005">endereço de broadcast é 192.168.1.255. No Unix, o comando ifconfig fornecerá</span></div>
<div style="position:absolute;left:88.97px;top:291.81px" class="cls_005"><span class="cls_005">todos esses dados. (Se você está curioso, a lógica bitwise para obter o seu endereço de</span></div>
<div style="position:absolute;left:88.97px;top:306.73px" class="cls_005"><span class="cls_005">broadcast é network_number OR (NOT netmask).) Você pode enviar este tipo de</span></div>
<div style="position:absolute;left:88.97px;top:321.66px" class="cls_005"><span class="cls_005">pacote broadcast para redes remotas, bem como para a sua rede local, mas você corre o</span></div>
<div style="position:absolute;left:88.97px;top:335.64px" class="cls_005"><span class="cls_005">risco de o pacote ser descartado pelo roteador de destino. (Se eles não o descartassem,</span></div>
<div style="position:absolute;left:88.97px;top:349.63px" class="cls_005"><span class="cls_005">algum smurf aleatório poderia começar a inundar a sua LAN com tráfego de broadcast.)</span></div>
<div style="position:absolute;left:76.97px;top:375.75px" class="cls_005"><span class="cls_005">2. Envie os dados para o endereço de broadcast "global". Isso é 255.255.255.255,</span></div>
<div style="position:absolute;left:88.97px;top:391.60px" class="cls_005"><span class="cls_005">também conhecido como INADDR_BROADCAST. Muitas máquinas realizam operações</span></div>
<div style="position:absolute;left:88.97px;top:406.52px" class="cls_005"><span class="cls_005">bitwise AND com o seu número de rede para o converter em um endereço de broadcast,</span></div>
<div style="position:absolute;left:88.97px;top:420.51px" class="cls_005"><span class="cls_005">mas algumas não. Varia. Roteadores não encaminham este tipo de pacote broadcast</span></div>
<div style="position:absolute;left:88.97px;top:434.50px" class="cls_005"><span class="cls_005">para fora da sua rede local, ironicamente.</span></div>
<div style="position:absolute;left:60.99px;top:459.68px" class="cls_005"><span class="cls_005">Então, o que acontece se você tentar enviar dados para o endereço de broadcast sem antes</span></div>
<div style="position:absolute;left:60.99px;top:474.60px" class="cls_005"><span class="cls_005">de nir a opção SO_BROADCAST no socket? Bem, vamos até o bom e velho </span><span class="cls_023">talker e</span></div>
<div style="position:absolute;left:60.99px;top:490.46px" class="cls_023"><span class="cls_023">listener</span><span class="cls_005"> ver o que acontece.</span></div>
<div style="position:absolute;left:94.85px;top:524.50px" class="cls_005"><span class="cls_005">$ talker 192.168.1.2 foo</span></div>
<div style="position:absolute;left:94.85px;top:540.35px" class="cls_005"><span class="cls_005">sent 3 bytes to 192.168.1.2</span></div>
<div style="position:absolute;left:94.85px;top:556.20px" class="cls_005"><span class="cls_005">$ talker 192.168.1.255 foo</span></div>
<div style="position:absolute;left:94.85px;top:572.06px" class="cls_005"><span class="cls_005">sendto: Permission denied</span></div>
<div style="position:absolute;left:94.85px;top:587.91px" class="cls_005"><span class="cls_005">$ talker 255.255.255.255 foo</span></div>
<div style="position:absolute;left:94.85px;top:603.77px" class="cls_005"><span class="cls_005">sendto: Permission denied</span></div>
<div style="position:absolute;left:60.99px;top:637.81px" class="cls_005"><span class="cls_005">Sim, nem tudo funcionou... porque não de nimos a opção SO_BROADCAST para o socket. Faça</span></div>
<div style="position:absolute;left:60.99px;top:653.66px" class="cls_005"><span class="cls_005">isso, e então você poderá executar sendto() em qualquer lugar!</span></div>
<div style="position:absolute;left:60.99px;top:679.77px" class="cls_005"><span class="cls_005">Na verdade, essa é a única diferença entre um aplicativo UDP que pode transmitir e outro que</span></div>
<div style="position:absolute;left:60.99px;top:694.69px" class="cls_005"><span class="cls_005">não pode. Então, vamos pegar o antigo programa talker e adicionar uma seção que de na a</span></div>
<div style="position:absolute;left:60.99px;top:709.62px" class="cls_005"><span class="cls_005">opção SO_BROADCAST para o socket. Vamos chamar este programa </span><span class="cls_023">broadcaster.c</span><span class="cls_024"><sup>42</sup></span><span class="cls_005">:</span></div>
<div style="position:absolute;left:83.19px;top:745.59px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:745.59px" class="cls_013"><span class="cls_013">/*</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">95 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:80845px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background096.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:103.89px;top:54.00px" class="cls_013"><span class="cls_013">** broadcaster.c -- um "cliente" de datagrama como o</span></div>
<div style="position:absolute;left:83.19px;top:54.00px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_013"><span class="cls_013">talker.c, exceto</span></div>
<div style="position:absolute;left:83.19px;top:83.84px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:83.84px" class="cls_013"><span class="cls_013">**</span></div>
<div style="position:absolute;left:238.17px;top:83.84px" class="cls_013"><span class="cls_013">que este faz broadcast</span></div>
<div style="position:absolute;left:83.19px;top:99.70px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:99.70px" class="cls_013"><span class="cls_013">*/</span></div>
<div style="position:absolute;left:83.19px;top:115.55px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:131.41px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:131.41px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:147.26px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:147.26px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdlib.h></span></div>
<div style="position:absolute;left:83.19px;top:163.11px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:163.11px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:178.97px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:178.97px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:194.82px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:226.53px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:242.38px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:258.24px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:274.09px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:76.48px;top:289.95px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:304.87px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:304.87px" class="cls_012"><span class="cls_012">#define SERVERPORT 4950 </span><span class="cls_013">// a porta onde os usuários se</span></div>
<div style="position:absolute;left:109.49px;top:318.86px" class="cls_013"><span class="cls_013">conectarão</span></div>
<div style="position:absolute;left:76.48px;top:334.71px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:350.57px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:350.57px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">int</span><span class="cls_005"> argc, </span><span class="cls_008">char</span><span class="cls_005"> *argv[])</span></div>
<div style="position:absolute;left:76.48px;top:366.42px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:366.42px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:382.27px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:382.27px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:76.48px;top:397.20px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:397.20px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in their_addr; </span><span class="cls_013">// informações de</span></div>
<div style="position:absolute;left:109.49px;top:411.18px" class="cls_013"><span class="cls_013">endereço do conector</span></div>
<div style="position:absolute;left:76.48px;top:427.04px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:427.04px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> hostent *he;</span></div>
<div style="position:absolute;left:76.48px;top:442.89px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:442.89px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> numbytes;</span></div>
<div style="position:absolute;left:76.48px;top:458.75px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:458.75px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> broadcast = </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:473.67px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:473.67px" class="cls_013"><span class="cls_013">//char broadcast = '1'; // se isso não funcionar,</span></div>
<div style="position:absolute;left:109.49px;top:487.66px" class="cls_013"><span class="cls_013">tente isso</span></div>
<div style="position:absolute;left:76.48px;top:503.51px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:519.37px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:519.37px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (argc != </span><span class="cls_009">3</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:534.29px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:157.60px;top:534.29px" class="cls_005"><span class="cls_005">fprintf(stderr,</span><span class="cls_010">"uso: broadcaster hostname</span></div>
<div style="position:absolute;left:109.49px;top:548.28px" class="cls_010"><span class="cls_010">mensagem\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:564.13px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:157.60px;top:564.13px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:579.99px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:579.99px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:595.84px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:610.76px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:610.76px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((he=gethostbyname(argv[</span><span class="cls_009">1</span><span class="cls_005">])) == NULL) {</span></div>
<div style="position:absolute;left:426.68px;top:610.76px" class="cls_013"><span class="cls_013">// obter</span></div>
<div style="position:absolute;left:109.49px;top:624.75px" class="cls_013"><span class="cls_013">info. do host</span></div>
<div style="position:absolute;left:76.48px;top:640.60px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:157.60px;top:640.60px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"gethostbyname"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:656.46px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:157.60px;top:656.46px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:672.31px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:672.31px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:688.17px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:76.48px;top:703.09px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:703.09px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(AF_INET, SOCK_DGRAM, </span><span class="cls_009">0</span><span class="cls_005">)) == -</span><span class="cls_009">1</span><span class="cls_005">)</span></div>
<div style="position:absolute;left:109.49px;top:717.08px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:732.93px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:157.60px;top:732.93px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">96 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:81696px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background097.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:157.60px;top:54.93px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:130.75px;top:101.56px" class="cls_013"><span class="cls_013">// esta chamada é o que permite o envio de pacotes</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_013"><span class="cls_013">de broadcast:</span></div>
<div style="position:absolute;left:76.48px;top:130.47px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:130.75px;top:130.47px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (setsockopt(sockfd, SOL_SOCKET, SO_BROADCAST,</span></div>
<div style="position:absolute;left:109.49px;top:144.46px" class="cls_005"><span class="cls_005">&broadcast,</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:157.61px;top:160.32px" class="cls_014"><span class="cls_014">sizeof</span><span class="cls_005"> broadcast) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">46</span></div>
<div style="position:absolute;left:157.60px;top:176.17px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"setsockopt (SO_BROADCAST)"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">47</span></div>
<div style="position:absolute;left:157.60px;top:192.02px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:207.88px" class="cls_005"><span class="cls_005">48</span></div>
<div style="position:absolute;left:130.75px;top:207.88px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:223.73px" class="cls_005"><span class="cls_005">49</span></div>
<div style="position:absolute;left:76.48px;top:238.65px" class="cls_005"><span class="cls_005">50</span></div>
<div style="position:absolute;left:130.75px;top:238.65px" class="cls_005"><span class="cls_005">their_addr.sin_family = AF_INET;</span></div>
<div style="position:absolute;left:379.21px;top:238.65px" class="cls_013"><span class="cls_013">// host byte</span></div>
<div style="position:absolute;left:109.49px;top:252.64px" class="cls_013"><span class="cls_013">order</span></div>
<div style="position:absolute;left:76.48px;top:267.56px" class="cls_005"><span class="cls_005">51</span></div>
<div style="position:absolute;left:130.75px;top:267.56px" class="cls_005"><span class="cls_005">their_addr.sin_port = htons(SERVERPORT); </span><span class="cls_013">// short,</span></div>
<div style="position:absolute;left:109.49px;top:281.55px" class="cls_013"><span class="cls_013">network byte order</span></div>
<div style="position:absolute;left:76.48px;top:296.48px" class="cls_005"><span class="cls_005">52</span></div>
<div style="position:absolute;left:130.75px;top:296.48px" class="cls_005"><span class="cls_005">their_addr.sin_addr = *((</span><span class="cls_014">struct</span><span class="cls_005"> in_addr</span></div>
<div style="position:absolute;left:109.49px;top:310.46px" class="cls_005"><span class="cls_005">*)he->h_addr);</span></div>
<div style="position:absolute;left:76.48px;top:325.39px" class="cls_005"><span class="cls_005">53</span></div>
<div style="position:absolute;left:130.75px;top:325.39px" class="cls_005"><span class="cls_005">memset(their_addr.sin_zero, </span><span class="cls_010">'\0'</span><span class="cls_005">, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:339.37px" class="cls_005"><span class="cls_005">their_addr.sin_zero);</span></div>
<div style="position:absolute;left:76.48px;top:355.23px" class="cls_005"><span class="cls_005">54</span></div>
<div style="position:absolute;left:76.48px;top:370.15px" class="cls_005"><span class="cls_005">55</span></div>
<div style="position:absolute;left:130.75px;top:370.15px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((numbytes=sendto(sockfd, argv[</span><span class="cls_009">2</span><span class="cls_005">],</span></div>
<div style="position:absolute;left:109.49px;top:384.14px" class="cls_005"><span class="cls_005">strlen(argv[</span><span class="cls_009">2</span><span class="cls_005">]), </span><span class="cls_009">0</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:399.06px" class="cls_005"><span class="cls_005">56</span></div>
<div style="position:absolute;left:191.17px;top:399.06px" class="cls_005"><span class="cls_005">(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&their_addr, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:413.05px" class="cls_005"><span class="cls_005">their_addr)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:428.90px" class="cls_005"><span class="cls_005">57</span></div>
<div style="position:absolute;left:157.60px;top:428.90px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"sendto"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:444.76px" class="cls_005"><span class="cls_005">58</span></div>
<div style="position:absolute;left:157.60px;top:444.76px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:460.61px" class="cls_005"><span class="cls_005">59</span></div>
<div style="position:absolute;left:130.75px;top:460.61px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:476.47px" class="cls_005"><span class="cls_005">60</span></div>
<div style="position:absolute;left:76.48px;top:492.32px" class="cls_005"><span class="cls_005">61</span></div>
<div style="position:absolute;left:130.75px;top:492.32px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"enviados %d bytes para %s\n"</span><span class="cls_005">, numbytes,</span></div>
<div style="position:absolute;left:76.48px;top:508.18px" class="cls_005"><span class="cls_005">62</span></div>
<div style="position:absolute;left:157.60px;top:508.18px" class="cls_005"><span class="cls_005">inet_ntoa(their_addr.sin_addr));</span></div>
<div style="position:absolute;left:76.48px;top:524.03px" class="cls_005"><span class="cls_005">63</span></div>
<div style="position:absolute;left:76.48px;top:539.88px" class="cls_005"><span class="cls_005">64</span></div>
<div style="position:absolute;left:130.75px;top:539.88px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:555.74px" class="cls_005"><span class="cls_005">65</span></div>
<div style="position:absolute;left:76.48px;top:571.59px" class="cls_005"><span class="cls_005">66</span></div>
<div style="position:absolute;left:130.75px;top:571.59px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:587.45px" class="cls_005"><span class="cls_005">67</span></div>
<div style="position:absolute;left:103.89px;top:587.45px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:620.55px" class="cls_005"><span class="cls_005">O que há de diferente entre esta e uma situação de cliente/servidor UDP "normal"? Nada! (Com</span></div>
<div style="position:absolute;left:60.99px;top:634.54px" class="cls_005"><span class="cls_005">a exceção do cliente ter permissão para enviar pacotes broadcast nesse caso.) Dessa forma,</span></div>
<div style="position:absolute;left:60.99px;top:649.46px" class="cls_005"><span class="cls_005">vá em frente e execute o velho programa UDP </span><span class="cls_023">listener</span><span class="cls_005"> em uma janela e o broadcaster em</span></div>
<div style="position:absolute;left:60.99px;top:664.39px" class="cls_005"><span class="cls_005">outra. Você deve agora ser capaz de fazer todos aqueles envios que falharam acima.</span></div>
<div style="position:absolute;left:94.85px;top:697.49px" class="cls_005"><span class="cls_005">$ broadcaster 192.168.1.2 foo</span></div>
<div style="position:absolute;left:94.85px;top:713.35px" class="cls_005"><span class="cls_005">enviados 3 bytes para 192.168.1.2</span></div>
<div style="position:absolute;left:94.85px;top:729.20px" class="cls_005"><span class="cls_005">$ broadcaster 192.168.1.255 foo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">97 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:82547px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background098.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:54.93px" class="cls_005"><span class="cls_005">enviados 3 bytes para 192.168.1.255</span></div>
<div style="position:absolute;left:94.85px;top:70.79px" class="cls_005"><span class="cls_005">$ broadcaster 255.255.255.255 foo</span></div>
<div style="position:absolute;left:94.85px;top:86.64px" class="cls_005"><span class="cls_005">enviados 3 bytes para 255.255.255.255</span></div>
<div style="position:absolute;left:60.99px;top:120.68px" class="cls_005"><span class="cls_005">E você deve ver listener respondendo que recebeu os pacotes. (Se listener não</span></div>
<div style="position:absolute;left:60.99px;top:136.53px" class="cls_005"><span class="cls_005">responder, pode ser porque ele está vinculado a um endereço IPv6. Tente alterar AF_UNSPEC</span></div>
<div style="position:absolute;left:60.99px;top:152.39px" class="cls_005"><span class="cls_005">em listener.c para AF_INET para forçar IPv4).</span></div>
<div style="position:absolute;left:60.99px;top:179.43px" class="cls_005"><span class="cls_005">Bem, isso é excitante. Mas agora ative o listener em outra máquina próxima a você na</span></div>
<div style="position:absolute;left:60.99px;top:194.36px" class="cls_005"><span class="cls_005">mesma rede para que você tenha duas cópias, uma em cada máquina, e execute</span></div>
<div style="position:absolute;left:60.99px;top:209.28px" class="cls_005"><span class="cls_005">broadcaster novamente com o seu endereço de broadcast... Ei! Ambos listener recebem</span></div>
<div style="position:absolute;left:60.99px;top:225.13px" class="cls_005"><span class="cls_005">o pacote embora você só tenha feito uma chamada a sendto()! Legal!</span></div>
<div style="position:absolute;left:60.99px;top:252.18px" class="cls_005"><span class="cls_005">Se listener receber os dados enviados diretamente a ele, mas não os dados enviados ao</span></div>
<div style="position:absolute;left:60.99px;top:267.10px" class="cls_005"><span class="cls_005">endereço de broadcast, pode ser que você tenha um  rewall em sua máquina local que esteja</span></div>
<div style="position:absolute;left:60.99px;top:281.09px" class="cls_005"><span class="cls_005">bloqueando os pacotes. (Sim, Pat e Bapper, obrigado por perceber antes de mim, era por isso</span></div>
<div style="position:absolute;left:60.99px;top:295.08px" class="cls_005"><span class="cls_005">que o meu código de exemplo não estava funcionando. Eu lhe disse que o mencionaria no guia,</span></div>
<div style="position:absolute;left:60.99px;top:309.07px" class="cls_005"><span class="cls_005">e você está aqui. Então obrigado.)</span></div>
<div style="position:absolute;left:60.99px;top:334.25px" class="cls_005"><span class="cls_005">Mais uma vez, tenha cuidado com pacotes broadcast. Uma vez que cada máquina na LAN será</span></div>
<div style="position:absolute;left:60.99px;top:349.17px" class="cls_005"><span class="cls_005">forçada a lidar com o pacote quer ela receba com recvfrom() ou não, ele pode apresentar</span></div>
<div style="position:absolute;left:60.99px;top:364.09px" class="cls_005"><span class="cls_005">uma grande carga para o toda a rede de computação. De nitivamente eles devem ser usados</span></div>
<div style="position:absolute;left:60.99px;top:378.08px" class="cls_005"><span class="cls_005">com moderação e de forma adequada.</span></div>
<div style="position:absolute;left:60.99px;top:406.13px" class="cls_002"><span class="cls_002">Dúvidas Frequentes</span></div>
<div style="position:absolute;left:60.99px;top:449.10px" class="cls_005"><span class="cls_005">Onde posso obter os arquivos de cabeçalho?</span></div>
<div style="position:absolute;left:60.99px;top:474.28px" class="cls_005"><span class="cls_005">Se você não os tiver em seu sistema, provavelmente não precisará deles. Veri que o manual da</span></div>
<div style="position:absolute;left:60.99px;top:488.26px" class="cls_005"><span class="cls_005">sua plataforma especí ca. Se você está construindo para Windows, você só precisa de</span></div>
<div style="position:absolute;left:60.99px;top:503.19px" class="cls_005"><span class="cls_005">#include &lt;winsock.h>.</span></div>
<div style="position:absolute;left:60.99px;top:530.23px" class="cls_005"><span class="cls_005">O que eu faço quando bind() relata "Endereço já em uso"?</span></div>
<div style="position:absolute;left:60.99px;top:557.28px" class="cls_005"><span class="cls_005">Você precisa usar setsockopt() com a opção SO_REUSEADDR no socket de escuta. Con ra</span></div>
<div style="position:absolute;left:60.99px;top:573.13px" class="cls_005"><span class="cls_005">a </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão</span><span class="cls_005"> de bind() e a </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão</span><span class="cls_005"> de select() para exemplos.</span></div>
<div style="position:absolute;left:60.99px;top:599.24px" class="cls_005"><span class="cls_005">Como faço para obter uma lista de sockets abertos no sistema?</span></div>
<div style="position:absolute;left:60.99px;top:625.36px" class="cls_005"><span class="cls_005">Use o netstat. Veri que suas páginas de manual para mais detalhes, mas você deve obter</span></div>
<div style="position:absolute;left:60.99px;top:640.28px" class="cls_005"><span class="cls_005">uma boa saída apenas digitando:</span></div>
<div style="position:absolute;left:94.85px;top:673.38px" class="cls_005"><span class="cls_005">$ netstat</span></div>
<div style="position:absolute;left:60.99px;top:707.42px" class="cls_005"><span class="cls_005">O único truque é determinar qual socket está associado a qual programa. :-)</span></div>
<div style="position:absolute;left:60.99px;top:733.54px" class="cls_005"><span class="cls_005">Como posso visualizar a tabela de roteamento?</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">98 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:83398px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background099.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Execute o comando route (em /sbin na maioria dos Linuxes) ou o comando netstat -r.</span></div>
<div style="position:absolute;left:60.99px;top:81.05px" class="cls_005"><span class="cls_005">Como posso executar os programas cliente e servidor se eu tiver apenas um computador?</span></div>
<div style="position:absolute;left:60.99px;top:95.03px" class="cls_005"><span class="cls_005">Não preciso de uma rede para escrever programas de rede?</span></div>
<div style="position:absolute;left:60.99px;top:120.21px" class="cls_005"><span class="cls_005">Felizmente, praticamente todas as máquinas implementam um "dispositivo" de rede de</span></div>
<div style="position:absolute;left:60.99px;top:135.14px" class="cls_005"><span class="cls_005">loopback que  ca no kernel e  nge ser uma placa de rede. (Esta é a interface listada como "lo"</span></div>
<div style="position:absolute;left:60.99px;top:150.06px" class="cls_005"><span class="cls_005">na tabela de roteamento.)</span></div>
<div style="position:absolute;left:60.99px;top:176.17px" class="cls_005"><span class="cls_005">Finja que você está conectado a uma máquina chamada "cabra". Execute o cliente em uma</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">janela e o servidor em outra. Ou inicie o servidor em segundo plano ("server &") e execute o</span></div>
<div style="position:absolute;left:60.99px;top:206.95px" class="cls_005"><span class="cls_005">cliente na mesma janela. A conclusão do dispositivo de loopback é que você pode executar</span></div>
<div style="position:absolute;left:60.99px;top:221.87px" class="cls_005"><span class="cls_005">cliente cabra ou cliente localhost (Uma vez que "localhost" está provavelmente</span></div>
<div style="position:absolute;left:60.99px;top:237.72px" class="cls_005"><span class="cls_005">de nido no seu arquivo /etc/hosts) e você terá o cliente conversando com o servidor sem</span></div>
<div style="position:absolute;left:60.99px;top:252.64px" class="cls_005"><span class="cls_005">uma rede!</span></div>
<div style="position:absolute;left:60.99px;top:277.82px" class="cls_005"><span class="cls_005">Em suma, nenhuma alteração é necessária, em qualquer código, para o fazer funcionar em</span></div>
<div style="position:absolute;left:60.99px;top:291.81px" class="cls_005"><span class="cls_005">uma única máquina que não esteja em rede! Uhull!</span></div>
<div style="position:absolute;left:60.99px;top:316.99px" class="cls_005"><span class="cls_005">Como posso saber se o lado remoto fechou a conexão?</span></div>
<div style="position:absolute;left:60.99px;top:343.11px" class="cls_005"><span class="cls_005">Você pode saber veri cando se recv() retornou 0.</span></div>
<div style="position:absolute;left:60.99px;top:369.22px" class="cls_005"><span class="cls_005">Como faço para implementar um utilitário "ping"? O que é ICMP? Onde posso encontrar</span></div>
<div style="position:absolute;left:60.99px;top:384.14px" class="cls_005"><span class="cls_005">mais informações sobre raw sockets e SOCK_RAW?</span></div>
<div style="position:absolute;left:60.99px;top:410.25px" class="cls_005"><span class="cls_005">Todas as suas questões sobre raw sockets serão respondidas nos </span><span class="cls_023">W. Richard Stevens' UNIX</span></div>
<div style="position:absolute;left:60.99px;top:425.17px" class="cls_023"><span class="cls_023">Network Pro</span><span class="cls_006">g</span><span class="cls_023">rammin</span><span class="cls_006">g</span><span class="cls_023"> books</span><span class="cls_005">. Além disso, procure no subdiretório ping/ no Stevens' UNIX</span></div>
<div style="position:absolute;left:60.99px;top:440.10px" class="cls_005"><span class="cls_005">Network Programming source code, </span><span class="cls_023">disponível online</span><span class="cls_024"><sup>43</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:468.14px" class="cls_005"><span class="cls_005">Como posso alterar ou encurtar o tempo de espera em uma chamada à connect()?</span></div>
<div style="position:absolute;left:60.99px;top:494.26px" class="cls_005"><span class="cls_005">Em vez de dar-lhe exatamente a mesma resposta que W. Richard Stevens lhe daria, eu apenas</span></div>
<div style="position:absolute;left:60.99px;top:508.25px" class="cls_005"><span class="cls_005">indicarei </span><span class="cls_023">lib/connect</span><span class="cls_006">_</span><span class="cls_023">nonb.c in the UNIX Network Pro</span><span class="cls_006">g</span><span class="cls_023">rammin</span><span class="cls_006">g</span><span class="cls_023"> source code</span><span class="cls_024"><sup>44</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:537.23px" class="cls_005"><span class="cls_005">A essência disso é que você cria um descritor de socket com socket(), </span><span class="cls_023">o con </span><span class="cls_006">g</span><span class="cls_023">ura para non-</span></div>
<div style="position:absolute;left:60.99px;top:553.08px" class="cls_023"><span class="cls_023">blockin</span><span class="cls_006">g</span><span class="cls_005">, chama connect(), e se tudo correr bem connect() retornará -1 imediatamente e</span></div>
<div style="position:absolute;left:60.99px;top:568.93px" class="cls_005"><span class="cls_005">errno será de nido para EINPROGRESS. Em seguida você chama </span><span class="cls_023">select</span><span class="cls_006">()</span><span class="cls_005"> com o timeout</span></div>
<div style="position:absolute;left:60.99px;top:583.86px" class="cls_005"><span class="cls_005">que desejar, passando o descritor do socket nos sets de leitura e gravação. Se não expirar,</span></div>
<div style="position:absolute;left:60.99px;top:598.78px" class="cls_005"><span class="cls_005">signi ca que a chamada a connect() foi concluída. Neste ponto, você terá que usar</span></div>
<div style="position:absolute;left:60.99px;top:614.63px" class="cls_005"><span class="cls_005">getsockopt() com a opção SO_ERROR para obter o valor de retorno a partir da chamada</span></div>
<div style="position:absolute;left:60.99px;top:630.49px" class="cls_005"><span class="cls_005">connect(), que deve ser zero se não houver erro.</span></div>
<div style="position:absolute;left:60.99px;top:656.60px" class="cls_005"><span class="cls_005">Finalmente, você provavelmente vai querer de nir o socket de volta para blocking antes de</span></div>
<div style="position:absolute;left:60.99px;top:670.59px" class="cls_005"><span class="cls_005">iniciar a transferência de dados sobre ele.</span></div>
<div style="position:absolute;left:60.99px;top:695.77px" class="cls_005"><span class="cls_005">Observe que isso tem a vantagem adicional de permitir que seu programa faça outra coisa</span></div>
<div style="position:absolute;left:60.99px;top:709.76px" class="cls_005"><span class="cls_005">enquanto está se conectando, também. Você poderia, por exemplo, de nir o tempo limite para</span></div>
<div style="position:absolute;left:60.99px;top:723.75px" class="cls_005"><span class="cls_005">algo baixo, como 500 ms, e atualizar um indicador na tela a cada timeout, em seguida, chamar</span></div>
<div style="position:absolute;left:60.99px;top:738.67px" class="cls_005"><span class="cls_005">select() novamente. Quando você tiver chamado select() e excedido, digamos, 20 vezes,</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">99 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:84249px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background100.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">você saberá que é hora de desistir da conexão.</span></div>
<div style="position:absolute;left:60.99px;top:79.18px" class="cls_005"><span class="cls_005">Como eu disse, con ra o source de Stevens para um exemplo perfeitamente excelente.</span></div>
<div style="position:absolute;left:60.99px;top:104.36px" class="cls_005"><span class="cls_005">Como posso construir para Windows?</span></div>
<div style="position:absolute;left:60.99px;top:130.47px" class="cls_005"><span class="cls_005">Primeiro, apague o Windows e instale um Linux ou um BSD. };-). Não, na verdade, apenas</span></div>
<div style="position:absolute;left:60.99px;top:145.39px" class="cls_005"><span class="cls_005">consulte a </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão construindo no Windows</span><span class="cls_005"> na introdução.</span></div>
<div style="position:absolute;left:60.99px;top:170.57px" class="cls_005"><span class="cls_005">Como faço para construir para Solaris/SunOS? Eu continuo recebendo erros de linker</span></div>
<div style="position:absolute;left:60.99px;top:184.56px" class="cls_005"><span class="cls_005">quando tento compilar!</span></div>
<div style="position:absolute;left:60.99px;top:209.74px" class="cls_005"><span class="cls_005">Os erros de linker acontecem porque ambientes Sun não compilam automaticamente com</span></div>
<div style="position:absolute;left:60.99px;top:223.73px" class="cls_005"><span class="cls_005">bibliotecas de socket. Consulte a seção </span><span class="cls_023">constru</span><span class="cls_006">ç</span><span class="cls_023">ão para Solaris/SunOS</span><span class="cls_005"> na introdução para um</span></div>
<div style="position:absolute;left:60.99px;top:237.72px" class="cls_005"><span class="cls_005">exemplo de como fazer isso.</span></div>
<div style="position:absolute;left:60.99px;top:263.83px" class="cls_005"><span class="cls_005">Por que select() segue caindo em um sinal?</span></div>
<div style="position:absolute;left:60.99px;top:290.88px" class="cls_005"><span class="cls_005">Os sinais tendem a fazer com que as chamadas do sistema bloqueadas retornem -1 com</span></div>
<div style="position:absolute;left:60.99px;top:306.73px" class="cls_005"><span class="cls_005">errno de nido como EINTR. Quando você con gura um manipulador de sinal com</span></div>
<div style="position:absolute;left:60.99px;top:322.59px" class="cls_005"><span class="cls_005">sigaction(), você pode de nir o sinalizador SA_RESTART, que deve reiniciar a chamada de</span></div>
<div style="position:absolute;left:60.99px;top:337.51px" class="cls_005"><span class="cls_005">sistema depois que ela for interrompida.</span></div>
<div style="position:absolute;left:60.99px;top:362.69px" class="cls_005"><span class="cls_005">Naturalmente, isso nem sempre funciona.</span></div>
<div style="position:absolute;left:60.99px;top:388.80px" class="cls_005"><span class="cls_005">A minha solução favorita para isso envolve uma estrutura goto. Você sabe que isso irrita seus</span></div>
<div style="position:absolute;left:60.99px;top:403.72px" class="cls_005"><span class="cls_005">professores in nitamente, então vá em frente!</span></div>
<div style="position:absolute;left:83.19px;top:436.83px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:436.83px" class="cls_005"><span class="cls_005">select_restart:</span></div>
<div style="position:absolute;left:83.19px;top:451.75px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:451.75px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((err = select(fdmax+</span><span class="cls_009">1</span><span class="cls_005">, &readfds, NULL, NULL, NULL))</span></div>
<div style="position:absolute;left:109.49px;top:465.74px" class="cls_005"><span class="cls_005">==</span></div>
<div style="position:absolute;left:129.63px;top:465.74px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:83.19px;top:481.60px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:130.75px;top:481.60px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (errno == EINTR) {</span></div>
<div style="position:absolute;left:83.19px;top:496.52px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:157.61px;top:496.52px" class="cls_013"><span class="cls_013">// algum sinal acabou de nos interromper, então</span></div>
<div style="position:absolute;left:109.49px;top:510.51px" class="cls_013"><span class="cls_013">reinicie</span></div>
<div style="position:absolute;left:83.19px;top:526.36px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:157.61px;top:526.36px" class="cls_014"><span class="cls_014">goto</span><span class="cls_005"> select_restart;</span></div>
<div style="position:absolute;left:83.19px;top:542.21px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:542.21px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:83.19px;top:558.07px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:558.07px" class="cls_013"><span class="cls_013">// lide com o erro real aqui:</span></div>
<div style="position:absolute;left:83.19px;top:573.92px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:573.92px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"select"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:589.78px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:589.78px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:623.82px" class="cls_005"><span class="cls_005">Claro, você não necessita usar goto, neste caso; Você pode usar outras estruturas para</span></div>
<div style="position:absolute;left:60.99px;top:639.67px" class="cls_005"><span class="cls_005">controle. Mas acho que goto é realmente mais limpa.</span></div>
<div style="position:absolute;left:60.99px;top:666.72px" class="cls_005"><span class="cls_005">Como posso implementar um timeout em uma chamada a recv()?</span></div>
<div style="position:absolute;left:60.99px;top:693.76px" class="cls_005"><span class="cls_005">Use </span><span class="cls_023">select</span><span class="cls_006">()</span><span class="cls_005">! Ela permite que você especi que um parâmetro de tempo limite para os</span></div>
<div style="position:absolute;left:60.99px;top:708.68px" class="cls_005"><span class="cls_005">descritores de socket que você deseja ler. Ou, você poderia envolver toda a funcionalidade em</span></div>
<div style="position:absolute;left:60.99px;top:722.67px" class="cls_005"><span class="cls_005">uma única função, assim:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">100 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:85100px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background101.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:61.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:61.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:83.19px;top:77.78px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:77.78px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/time.h></span></div>
<div style="position:absolute;left:83.19px;top:93.64px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:93.64px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:109.49px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:109.49px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:83.19px;top:125.34px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:141.20px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:141.20px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> recvtimeout(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">char</span><span class="cls_005"> *buf, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> timeout)</span></div>
<div style="position:absolute;left:83.19px;top:157.05px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:157.05px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:172.91px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:172.91px" class="cls_005"><span class="cls_005">fd_set fds;</span></div>
<div style="position:absolute;left:83.19px;top:188.76px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:130.75px;top:188.76px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> n;</span></div>
<div style="position:absolute;left:76.48px;top:204.61px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:204.61px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> timeval tv;</span></div>
<div style="position:absolute;left:76.48px;top:220.47px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:236.32px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:236.32px" class="cls_013"><span class="cls_013">// configurar set do descritor de arquivo</span></div>
<div style="position:absolute;left:76.48px;top:252.18px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:252.18px" class="cls_005"><span class="cls_005">FD_ZERO(&fds);</span></div>
<div style="position:absolute;left:76.48px;top:268.03px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:268.03px" class="cls_005"><span class="cls_005">FD_SET(s, &fds);</span></div>
<div style="position:absolute;left:76.48px;top:283.89px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:299.74px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:299.74px" class="cls_013"><span class="cls_013">// configura a struct timeval para timeout</span></div>
<div style="position:absolute;left:76.48px;top:315.59px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:315.59px" class="cls_005"><span class="cls_005">tv.tv_sec = timeout;</span></div>
<div style="position:absolute;left:76.48px;top:331.45px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:130.75px;top:331.45px" class="cls_005"><span class="cls_005">tv.tv_usec = </span><span class="cls_009">0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:347.30px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:363.16px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:363.16px" class="cls_013"><span class="cls_013">// aguarde até timeout ou receber os dados</span></div>
<div style="position:absolute;left:76.48px;top:379.01px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:379.01px" class="cls_005"><span class="cls_005">n = select(s+</span><span class="cls_009">1</span><span class="cls_005">, &fds, NULL, NULL, &tv);</span></div>
<div style="position:absolute;left:76.48px;top:394.86px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:130.75px;top:394.86px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (n == </span><span class="cls_009">0</span><span class="cls_005">) </span><span class="cls_014">return</span><span class="cls_005"> -</span><span class="cls_009">2</span><span class="cls_005">; </span><span class="cls_013">// timeout!</span></div>
<div style="position:absolute;left:76.48px;top:410.72px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:410.72px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (n == -</span><span class="cls_009">1</span><span class="cls_005">) </span><span class="cls_014">return</span><span class="cls_005"> -</span><span class="cls_009">1</span><span class="cls_005">; </span><span class="cls_013">// error</span></div>
<div style="position:absolute;left:76.48px;top:426.57px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:441.49px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:441.49px" class="cls_013"><span class="cls_013">// os dados devem estar aqui, então faça um recv()</span></div>
<div style="position:absolute;left:109.49px;top:455.48px" class="cls_013"><span class="cls_013">normal</span></div>
<div style="position:absolute;left:76.48px;top:471.34px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:471.34px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> recv(s, buf, len, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:487.19px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:103.89px;top:487.19px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:503.05px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:76.48px;top:518.90px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:76.48px;top:534.75px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:76.48px;top:550.61px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:103.89px;top:550.61px" class="cls_013"><span class="cls_013">// Chamada de amostra para recvtimeout():</span></div>
<div style="position:absolute;left:76.48px;top:565.53px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:565.53px" class="cls_005"><span class="cls_005">n = recvtimeout(s, buf, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf, </span><span class="cls_009">10</span><span class="cls_005">); </span><span class="cls_013">// 10 seg</span></div>
<div style="position:absolute;left:109.49px;top:579.52px" class="cls_013"><span class="cls_013">timeout</span></div>
<div style="position:absolute;left:76.48px;top:595.37px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:76.48px;top:611.23px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:103.89px;top:611.23px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (n == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:627.08px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:627.08px" class="cls_013"><span class="cls_013">// ocorreu um erro</span></div>
<div style="position:absolute;left:76.48px;top:642.94px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:642.94px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"recvtimeout"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:658.79px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:103.89px;top:658.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:674.64px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:103.89px;top:674.64px" class="cls_014"><span class="cls_014">else if</span><span class="cls_005"> (n == -</span><span class="cls_009">2</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:690.50px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:690.50px" class="cls_013"><span class="cls_013">// ocorreu timeout</span></div>
<div style="position:absolute;left:76.48px;top:706.35px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:103.89px;top:706.35px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:76.48px;top:722.21px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:722.21px" class="cls_013"><span class="cls_013">// tenho alguns dados em buf</span></div>
<div style="position:absolute;left:76.48px;top:738.06px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:103.89px;top:738.06px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">101 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:85951px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background102.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">45</span></div>
<div style="position:absolute;left:60.99px;top:120.68px" class="cls_005"><span class="cls_005">Observe que recvtimeout() retorna -2 no caso de um timeout. Por que não retorna 0? Bem,</span></div>
<div style="position:absolute;left:60.99px;top:136.53px" class="cls_005"><span class="cls_005">se você se lembra, um valor de retorno 0 em uma chamada a recv() signi ca que o lado</span></div>
<div style="position:absolute;left:60.99px;top:152.39px" class="cls_005"><span class="cls_005">remoto fechou a conexão. Então esse valor de retorno já é usado, e -1 signi ca "erro", então eu</span></div>
<div style="position:absolute;left:60.99px;top:168.24px" class="cls_005"><span class="cls_005">escolhi -2 como o meu indicador de timeout.</span></div>
<div style="position:absolute;left:60.99px;top:194.36px" class="cls_005"><span class="cls_005">Como posso criptografar ou comprimir os dados antes de enviá-los através do socket?</span></div>
<div style="position:absolute;left:60.99px;top:219.54px" class="cls_005"><span class="cls_005">Uma maneira fácil de criptografar é usar SSL (Secure sockets layer), mas isso está além do</span></div>
<div style="position:absolute;left:60.99px;top:233.53px" class="cls_005"><span class="cls_005">escopo deste guia. (Con ra o </span><span class="cls_023">pro</span><span class="cls_006">j</span><span class="cls_023">eto OpenSSL</span><span class="cls_024"><sup>45</sup></span><span class="cls_005"> para mais informações.)</span></div>
<div style="position:absolute;left:60.99px;top:260.64px" class="cls_005"><span class="cls_005">Mas supondo que você deseja conectar ou implementar seu próprio compressor ou sistema de</span></div>
<div style="position:absolute;left:60.99px;top:274.63px" class="cls_005"><span class="cls_005">criptogra a, é apenas uma questão de pensar em seus dados como uma sequência de etapas</span></div>
<div style="position:absolute;left:60.99px;top:288.62px" class="cls_005"><span class="cls_005">entre as duas extremidades. Cada etapa altera os dados de alguma forma.</span></div>
<div style="position:absolute;left:76.97px;top:313.80px" class="cls_005"><span class="cls_005">1. servidor lê dados do arquivo (ou de qualquer lugar)</span></div>
<div style="position:absolute;left:76.97px;top:327.79px" class="cls_005"><span class="cls_005">2. servidor criptografa/comprime os dados (você adiciona esta parte)</span></div>
<div style="position:absolute;left:76.97px;top:342.71px" class="cls_005"><span class="cls_005">3. servidor envia os dados criptografados com send()</span></div>
<div style="position:absolute;left:60.99px;top:368.82px" class="cls_005"><span class="cls_005">Agora o contrário:</span></div>
<div style="position:absolute;left:76.97px;top:394.93px" class="cls_005"><span class="cls_005">1. cliente recebe os dados criptografados, com recv()</span></div>
<div style="position:absolute;left:76.97px;top:409.86px" class="cls_005"><span class="cls_005">2. cliente decifra/descomprime os dados (você adiciona esta parte)</span></div>
<div style="position:absolute;left:76.97px;top:423.84px" class="cls_005"><span class="cls_005">3. cliente grava os dados em arquivo (ou em qualquer lugar)</span></div>
<div style="position:absolute;left:60.99px;top:449.96px" class="cls_005"><span class="cls_005">Se você for compactar e criptografar, lembre-se de compactar primeiro. :-)</span></div>
<div style="position:absolute;left:60.99px;top:476.07px" class="cls_005"><span class="cls_005">Contando que o cliente desfaça corretamente o que o servidor faz, os dados  carão bem no</span></div>
<div style="position:absolute;left:67.18px;top:490.06px" class="cls_005"><span class="cls_005">nal, independentemente de quantos passos intermediários você adicione.</span></div>
<div style="position:absolute;left:60.99px;top:515.24px" class="cls_005"><span class="cls_005">Então, tudo que você precisa fazer para usar meu código é encontrar o local entre onde os</span></div>
<div style="position:absolute;left:60.99px;top:530.16px" class="cls_005"><span class="cls_005">dados são lidos e onde são enviados (usando send()) através da rede, e colocar lá algum</span></div>
<div style="position:absolute;left:60.99px;top:545.08px" class="cls_005"><span class="cls_005">código que faça a criptogra a.</span></div>
<div style="position:absolute;left:60.99px;top:571.20px" class="cls_005"><span class="cls_005">O que é esse "PF_INET" que continuo vendo? Está relacionado com AF_INET?</span></div>
<div style="position:absolute;left:60.99px;top:598.24px" class="cls_005"><span class="cls_005">Sim, sim é isso. Consulte a </span><span class="cls_023">se</span><span class="cls_006">ç</span><span class="cls_023">ão sobre socket</span><span class="cls_006">()</span><span class="cls_005"> para mais detalhes.</span></div>
<div style="position:absolute;left:60.99px;top:624.35px" class="cls_005"><span class="cls_005">Como eu posso escrever um servidor que aceite comandos shell de um cliente e os</span></div>
<div style="position:absolute;left:60.99px;top:638.34px" class="cls_005"><span class="cls_005">execute?</span></div>
<div style="position:absolute;left:60.99px;top:664.46px" class="cls_005"><span class="cls_005">Para simpli car, vamos dizer que o cliente execute connect(), send() e close() na</span></div>
<div style="position:absolute;left:60.99px;top:679.38px" class="cls_005"><span class="cls_005">conexão (ou seja, não haverá chamadas de sistema subseqüentes sem que o cliente se</span></div>
<div style="position:absolute;left:60.99px;top:693.37px" class="cls_005"><span class="cls_005">conecte novamente.)</span></div>
<div style="position:absolute;left:60.99px;top:718.55px" class="cls_005"><span class="cls_005">O processo que o cliente segue é o seguinte:</span></div>
<div style="position:absolute;left:76.97px;top:744.66px" class="cls_005"><span class="cls_005">1. connect() conecta ao servidor</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">102 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:86802px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background103.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.97px;top:54.93px" class="cls_005"><span class="cls_005">2. send("/sbin/ls > /tmp/client.out")</span></div>
<div style="position:absolute;left:76.97px;top:70.79px" class="cls_005"><span class="cls_005">3. close() termina a conexão</span></div>
<div style="position:absolute;left:60.99px;top:96.90px" class="cls_005"><span class="cls_005">Enquanto isso, o servidor está manipulando os dados e os executando:</span></div>
<div style="position:absolute;left:76.97px;top:123.01px" class="cls_005"><span class="cls_005">1. accept() aceita a conexão do cliente</span></div>
<div style="position:absolute;left:76.97px;top:138.87px" class="cls_005"><span class="cls_005">2. recv(str) recebe a string de comandos</span></div>
<div style="position:absolute;left:76.97px;top:154.72px" class="cls_005"><span class="cls_005">3. close() termina a conexão</span></div>
<div style="position:absolute;left:76.97px;top:170.57px" class="cls_005"><span class="cls_005">4. system(str) para executar o comando</span></div>
<div style="position:absolute;left:60.99px;top:196.69px" class="cls_005"><span class="cls_005">Atenção! Ter o servidor executando o que o cliente diz é como dar acesso a um shell remoto e</span></div>
<div style="position:absolute;left:60.99px;top:210.68px" class="cls_005"><span class="cls_005">as pessoas podem fazer coisas na sua conta quando se conectam ao servidor. Por exemplo,</span></div>
<div style="position:absolute;left:60.99px;top:225.60px" class="cls_005"><span class="cls_005">no exemplo acima, e se o cliente envia "rm -rf ~"? Ele excluiria tudo na sua conta, isso é um</span></div>
<div style="position:absolute;left:60.99px;top:240.52px" class="cls_005"><span class="cls_005">absurdo!</span></div>
<div style="position:absolute;left:60.99px;top:265.70px" class="cls_005"><span class="cls_005">Então seja prudente, e evite que o cliente use qualquer comando com exceção de um par de</span></div>
<div style="position:absolute;left:60.99px;top:280.62px" class="cls_005"><span class="cls_005">utilitários que você sabe que são seguros, como o utilitário foobar:</span></div>
<div style="position:absolute;left:94.85px;top:314.66px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (!strncmp(str, </span><span class="cls_010">"foobar"</span><span class="cls_005">, </span><span class="cls_009">6</span><span class="cls_005">)) {</span></div>
<div style="position:absolute;left:121.70px;top:330.52px" class="cls_005"><span class="cls_005">sprintf(sysstr, </span><span class="cls_010">"%s > /tmp/server.out"</span><span class="cls_005">, str);</span></div>
<div style="position:absolute;left:121.70px;top:346.37px" class="cls_005"><span class="cls_005">system(sysstr);</span></div>
<div style="position:absolute;left:94.85px;top:362.22px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:396.26px" class="cls_005"><span class="cls_005">Mas você ainda está inseguro, infelizmente: o que acontece se o cliente entra com "foobar;</span></div>
<div style="position:absolute;left:60.99px;top:412.12px" class="cls_005"><span class="cls_005">rm -rf ~"? A coisa mais segura a fazer é escrever uma pequena rotina que coloque um</span></div>
<div style="position:absolute;left:60.99px;top:427.97px" class="cls_005"><span class="cls_005">caractere de escape ( "\") na frente de todos os caracteres não alfanuméricos (incluindo</span></div>
<div style="position:absolute;left:60.99px;top:442.89px" class="cls_005"><span class="cls_005">espaços, se for o caso) nos argumentos para o comando.</span></div>
<div style="position:absolute;left:60.99px;top:468.07px" class="cls_005"><span class="cls_005">Como você pode ver, a segurança é um grande problema quando o servidor começa a executar</span></div>
<div style="position:absolute;left:60.99px;top:482.06px" class="cls_005"><span class="cls_005">o que o cliente envia.</span></div>
<div style="position:absolute;left:60.99px;top:508.18px" class="cls_005"><span class="cls_005">Estou enviando uma enorme quantidade de dados, mas quando eu executo recv() ele</span></div>
<div style="position:absolute;left:60.99px;top:523.10px" class="cls_005"><span class="cls_005">recebe apenas 536 bytes ou 1460 bytes de cada vez. Mas se eu executo em minha</span></div>
<div style="position:absolute;left:60.99px;top:537.09px" class="cls_005"><span class="cls_005">máquina local, ele recebe todos os dados ao mesmo tempo. O que está acontecendo?</span></div>
<div style="position:absolute;left:60.99px;top:562.27px" class="cls_005"><span class="cls_005">Você está atingindo o MTU—o tamanho máximo que o meio físico pode manipular. Na</span></div>
<div style="position:absolute;left:60.99px;top:576.25px" class="cls_005"><span class="cls_005">máquina local, você está usando o dispositivo de loopback que pode lidar até com 8K ou mais</span></div>
<div style="position:absolute;left:60.99px;top:590.24px" class="cls_005"><span class="cls_005">sem nenhum problema. Mas em Ethernet, que pode manipular apenas 1500 bytes com um</span></div>
<div style="position:absolute;left:60.99px;top:604.23px" class="cls_005"><span class="cls_005">cabeçalho, você atinge esse limite. Através de um modem, com 576 MTU (novamente, com</span></div>
<div style="position:absolute;left:60.99px;top:618.22px" class="cls_005"><span class="cls_005">cabeçalho), você atinge o limite ainda mais rapidamente.</span></div>
<div style="position:absolute;left:60.99px;top:643.40px" class="cls_005"><span class="cls_005">Você precisa garantir que todos os dados estão sendo enviados, em primeiro lugar. (Veja a</span></div>
<div style="position:absolute;left:60.99px;top:658.32px" class="cls_005"><span class="cls_005">implementação da função </span><span class="cls_023">sendall</span><span class="cls_006">()</span><span class="cls_005"> para detalhes.) Uma vez que você tenha certeza disso,</span></div>
<div style="position:absolute;left:60.99px;top:674.18px" class="cls_005"><span class="cls_005">então você precisa chamar recv() em um loop até que todos os seus dados sejam lidos.</span></div>
<div style="position:absolute;left:60.99px;top:700.29px" class="cls_005"><span class="cls_005">Leia a seção </span><span class="cls_023">Bases do encapsulamento de dados</span><span class="cls_005"> para obter detalhes sobre o recebimento de</span></div>
<div style="position:absolute;left:60.99px;top:715.21px" class="cls_005"><span class="cls_005">pacotes completos de dados usando várias chamadas recv().</span></div>
<div style="position:absolute;left:60.99px;top:742.26px" class="cls_005"><span class="cls_005">Eu estou em um ambiente Windows e eu não possuo a chamada de sistema fork() ou</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">103 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:87653px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background104.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">qualquer tipo de struct sigaction. O que fazer?</span></div>
<div style="position:absolute;left:60.99px;top:81.05px" class="cls_005"><span class="cls_005">Elas podem estar em qualquer lugar, elas estarão em bibliotecas POSIX que podem ter sido</span></div>
<div style="position:absolute;left:60.99px;top:95.03px" class="cls_005"><span class="cls_005">fornecidas com o compilador. Como eu não tenho um ambiente Windows, eu realmente não</span></div>
<div style="position:absolute;left:60.99px;top:109.02px" class="cls_005"><span class="cls_005">posso dizer-lhe a resposta, mas eu me lembro que a Microsoft tem uma camada de</span></div>
<div style="position:absolute;left:60.99px;top:123.94px" class="cls_005"><span class="cls_005">compatibilidade POSIX e é aí onde estaria fork(). (E talvez até mesmo sigaction.)</span></div>
<div style="position:absolute;left:60.99px;top:150.06px" class="cls_005"><span class="cls_005">Procure no help que veio com o VC++ por "fork" ou "POSIX" e veja se ele fornece alguma pista.</span></div>
<div style="position:absolute;left:60.99px;top:176.17px" class="cls_005"><span class="cls_005">Se isso não funcionar, esqueça fork()/sigaction e use em substituiçao o equivalente em</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">Win32: CreateProcess(). Eu não sei como usar CreateProcess()—é preciso milhões de</span></div>
<div style="position:absolute;left:60.99px;top:206.95px" class="cls_005"><span class="cls_005">argumentos, mas isso deve ser coberto na documentação que veio com VC++.</span></div>
<div style="position:absolute;left:60.99px;top:232.13px" class="cls_005"><span class="cls_005">Estou atrás de um  rewall—como faço para que as pessoas de fora do  rewall saibam o</span></div>
<div style="position:absolute;left:60.99px;top:246.12px" class="cls_005"><span class="cls_005">meu endereço IP para que elas possam se conectar à minha máquina?</span></div>
<div style="position:absolute;left:60.99px;top:271.30px" class="cls_005"><span class="cls_005">Infelizmente, o objetivo de um  rewall é impedir que pessoas fora do  rewall se conectem à</span></div>
<div style="position:absolute;left:60.99px;top:285.28px" class="cls_005"><span class="cls_005">máquinas dentro do  rewall, portanto, permitir que isso ocorra é basicamente considerado</span></div>
<div style="position:absolute;left:60.99px;top:299.27px" class="cls_005"><span class="cls_005">uma violação de segurança.</span></div>
<div style="position:absolute;left:60.99px;top:325.39px" class="cls_005"><span class="cls_005">Isto não quer dizer que tudo está perdido. Por um lado, você ainda pode usar connect()</span></div>
<div style="position:absolute;left:60.99px;top:340.31px" class="cls_005"><span class="cls_005">através do  rewall, se ele estiver fazendo algum tipo de mascaramento ou NAT ou algo</span></div>
<div style="position:absolute;left:60.99px;top:354.30px" class="cls_005"><span class="cls_005">parecido. Basta projetar seus programas para que você seja sempre o único a iniciar a</span></div>
<div style="position:absolute;left:60.99px;top:368.29px" class="cls_005"><span class="cls_005">conexão, e tudo ocorrerá bem.</span></div>
<div style="position:absolute;left:60.99px;top:393.47px" class="cls_005"><span class="cls_005">Se isso não for satisfatório, você pode pedir a seus administradores para que abram um</span></div>
<div style="position:absolute;left:60.99px;top:407.45px" class="cls_005"><span class="cls_005">buraco no  rewall para que as pessoas possam se conectar a você. O  rewall pode</span></div>
<div style="position:absolute;left:60.99px;top:421.44px" class="cls_005"><span class="cls_005">encaminhar pacotes para você através do software NAT, ou através de um proxy ou algo</span></div>
<div style="position:absolute;left:60.99px;top:435.43px" class="cls_005"><span class="cls_005">parecido.</span></div>
<div style="position:absolute;left:60.99px;top:460.61px" class="cls_005"><span class="cls_005">Esteja ciente dee que um buraco no  rewall não deve ser visto de forma leviana. Você precisa</span></div>
<div style="position:absolute;left:60.99px;top:474.60px" class="cls_005"><span class="cls_005">garantir que não concederá às pessoas más acesso à rede interna; se você é um novato, é</span></div>
<div style="position:absolute;left:60.99px;top:488.59px" class="cls_005"><span class="cls_005">muito mais difícil fazer software seguro do que você possa imaginar.</span></div>
<div style="position:absolute;left:60.99px;top:514.70px" class="cls_005"><span class="cls_005">Não faça seu sysadmin ter raiva de mim. ;-)</span></div>
<div style="position:absolute;left:60.99px;top:540.82px" class="cls_005"><span class="cls_005">Como faço para escrever um packet sniffer? Como faço para colocar minha interface</span></div>
<div style="position:absolute;left:60.99px;top:554.80px" class="cls_005"><span class="cls_005">Ethernet em modo promíscuo?</span></div>
<div style="position:absolute;left:60.99px;top:579.99px" class="cls_005"><span class="cls_005">Para aqueles que não sabem, quando uma placa de rede está em "modo promíscuo", ela</span></div>
<div style="position:absolute;left:60.99px;top:593.97px" class="cls_005"><span class="cls_005">encaminhará TODOS os pacotes para o sistema operacional, e não apenas aqueles que foram</span></div>
<div style="position:absolute;left:60.99px;top:607.96px" class="cls_005"><span class="cls_005">endereçados a esta máquina especí ca. (Estamos falando de endereços da camada Ethernet</span></div>
<div style="position:absolute;left:60.99px;top:621.95px" class="cls_005"><span class="cls_005">aqui, não endereços IP--mas como ethernet é de camada inferior a camada IP, todos os</span></div>
<div style="position:absolute;left:60.99px;top:635.94px" class="cls_005"><span class="cls_005">endereços IP são efetivamente encaminhados. Consulte a seção </span><span class="cls_023">Baixo nível nonsense e Teoria</span></div>
<div style="position:absolute;left:60.99px;top:649.93px" class="cls_023"><span class="cls_023">de Rede</span><span class="cls_005"> para mais informações.)</span></div>
<div style="position:absolute;left:60.99px;top:675.11px" class="cls_005"><span class="cls_005">Esta é a base para o funcionamento de um packet sniffer. Ela coloca a interface em modo</span></div>
<div style="position:absolute;left:60.99px;top:689.10px" class="cls_005"><span class="cls_005">promíscuo e, em seguida, o sistema operacional obtém cada pacote que passa pelo  o. Você</span></div>
<div style="position:absolute;left:60.99px;top:703.09px" class="cls_005"><span class="cls_005">terá um socket de algum tipo do qual você poderá ler esses dados.</span></div>
<div style="position:absolute;left:60.99px;top:728.27px" class="cls_005"><span class="cls_005">Infelizmente, a resposta para a pergunta varia de acordo com a plataforma, mas se você busca</span></div>
<div style="position:absolute;left:60.99px;top:742.26px" class="cls_005"><span class="cls_005">no Google por, por exemplo, "windows promiscuous ioctl" você provavelmente chegará a algum</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">104 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:88504px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background105.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">lugar. Para Linux, há o que parece ser uma </span><span class="cls_023">thread útil no Stack Over  ow</span><span class="cls_024"><sup>46</sup></span><span class="cls_005">, também.</span></div>
<div style="position:absolute;left:60.99px;top:81.12px" class="cls_005"><span class="cls_005">Como posso de nir um valor de timeout personalizado para um socket TCP ou UDP?</span></div>
<div style="position:absolute;left:60.99px;top:107.23px" class="cls_005"><span class="cls_005">Depende de seu sistema. Você pode pesquisar na net por SO_RCVTIMEO e SO_SNDTIMEO</span></div>
<div style="position:absolute;left:60.99px;top:123.08px" class="cls_005"><span class="cls_005">(para uso com setsockopt()) para ver se o seu sistema suporta essa funcionalidade.</span></div>
<div style="position:absolute;left:60.99px;top:150.13px" class="cls_005"><span class="cls_005">As páginas man Linux sugerem o uso de alarm() ou setitimer() como um substituto.</span></div>
<div style="position:absolute;left:60.99px;top:176.24px" class="cls_005"><span class="cls_005">Como posso saber quais portas estão disponíveis para uso? Existe uma lista de números</span></div>
<div style="position:absolute;left:60.99px;top:190.23px" class="cls_005"><span class="cls_005">"o  ciais" de portas?</span></div>
<div style="position:absolute;left:60.99px;top:215.41px" class="cls_005"><span class="cls_005">Normalmente, isso não é um problema. Se você está escrevendo, digamos, um servidor web,</span></div>
<div style="position:absolute;left:60.99px;top:229.40px" class="cls_005"><span class="cls_005">então é uma boa ideia usar a bem conhecida porta 80 para o seu programa. Se você estiver</span></div>
<div style="position:absolute;left:60.99px;top:243.39px" class="cls_005"><span class="cls_005">escrevendo apenas o seu próprio servidor especializado, escolha uma porta aleatoriamente</span></div>
<div style="position:absolute;left:60.99px;top:257.38px" class="cls_005"><span class="cls_005">(mas maior que 1023) e experimente.</span></div>
<div style="position:absolute;left:60.99px;top:283.49px" class="cls_005"><span class="cls_005">Se a porta já estiver em uso, você receberá um erro "Endereço já em uso" ao tentar bind().</span></div>
<div style="position:absolute;left:60.99px;top:298.41px" class="cls_005"><span class="cls_005">Escolha outra porta. (É uma boa ideia permitir que o usuário do seu software especi que uma</span></div>
<div style="position:absolute;left:60.99px;top:312.40px" class="cls_005"><span class="cls_005">porta alternativa com um arquivo de con guração ou uma opção de linha de comando.)</span></div>
<div style="position:absolute;left:60.99px;top:337.58px" class="cls_005"><span class="cls_005">Há uma </span><span class="cls_023">lista de números de portas o ciais</span><span class="cls_024"><sup>47</sup></span><span class="cls_005"> mantida pelo Internet Assigned Numbers</span></div>
<div style="position:absolute;left:60.99px;top:353.50px" class="cls_005"><span class="cls_005">Authority (IANA). Só porque algo (acima de 1023) está nessa lista, não signi ca que você não</span></div>
<div style="position:absolute;left:60.99px;top:367.49px" class="cls_005"><span class="cls_005">possa usar a porta. Por exemplo, o DOOM da Id Software usa a mesma porta que "mdqs", de</span></div>
<div style="position:absolute;left:60.99px;top:381.48px" class="cls_005"><span class="cls_005">qualquer forma. Tudo o que importa é que ninguém mais na mesma máquina esteja usando</span></div>
<div style="position:absolute;left:60.99px;top:395.47px" class="cls_005"><span class="cls_005">essa porta quando você quiser usá-la.</span></div>
<div style="position:absolute;left:60.99px;top:423.52px" class="cls_002"><span class="cls_002">Páginas de Manual</span></div>
<div style="position:absolute;left:60.99px;top:466.49px" class="cls_005"><span class="cls_005">No mundo Unix, há uma série de manuais. Eles têm pequenas seções que descrevem funções</span></div>
<div style="position:absolute;left:60.99px;top:480.48px" class="cls_005"><span class="cls_005">individuais que você tem à sua disposição.</span></div>
<div style="position:absolute;left:60.99px;top:506.59px" class="cls_005"><span class="cls_005">Claro, manual seria muito texto para digitar. Quero dizer, ninguém no mundo Unix, inclusive eu,</span></div>
<div style="position:absolute;left:60.99px;top:521.51px" class="cls_005"><span class="cls_005">gosta de digitar muito. Na verdade, eu poderia continuar e continuar longamente escrevendo</span></div>
<div style="position:absolute;left:60.99px;top:535.50px" class="cls_005"><span class="cls_005">sobre o quanto eu pre ro ser conciso, mas em vez disso, serei breve e não o aborrecerei com</span></div>
<div style="position:absolute;left:60.99px;top:549.49px" class="cls_005"><span class="cls_005">textos despropositados sobre quão incrivelmente breve eu pre ro ser em quase todas as</span></div>
<div style="position:absolute;left:60.99px;top:563.48px" class="cls_005"><span class="cls_005">circunstâncias em sua totalidade.</span></div>
<div style="position:absolute;left:60.99px;top:588.66px" class="cls_005"><span class="cls_005">[Aplausos]</span></div>
<div style="position:absolute;left:60.99px;top:613.84px" class="cls_005"><span class="cls_005">Obrigado. O que estou querendo dizer é que estas páginas são chamadas de "man pages" no</span></div>
<div style="position:absolute;left:60.99px;top:627.83px" class="cls_005"><span class="cls_005">mundo Unix, e eu incluí minha própria variante pessoal truncada aqui para o seu prazer de</span></div>
<div style="position:absolute;left:60.99px;top:641.82px" class="cls_005"><span class="cls_005">leitura. A coisa é, muitas destas funções são de uso muito mais geral do que estou mostrando,</span></div>
<div style="position:absolute;left:60.99px;top:655.81px" class="cls_005"><span class="cls_005">mas eu só apresentarei os usos relevantes para Internet Sockets Programming.</span></div>
<div style="position:absolute;left:60.99px;top:680.99px" class="cls_005"><span class="cls_005">Mas espere! Isso não é tudo o que há de errado com minhas man pages:</span></div>
<div style="position:absolute;left:88.97px;top:706.17px" class="cls_005"><span class="cls_005">Elas estão incompletas e mostram apenas os conceitos básicos do guia.</span></div>
<div style="position:absolute;left:88.97px;top:720.15px" class="cls_005"><span class="cls_005">Existem muito mais páginas do que estas no mundo real.</span></div>
<div style="position:absolute;left:88.97px;top:734.14px" class="cls_005"><span class="cls_005">Elas são diferentes das que estão em seu sistema.</span></div>
<div style="position:absolute;left:88.97px;top:748.13px" class="cls_005"><span class="cls_005">Os arquivos de cabeçalho podem ser diferente para determinadas funções no seu</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">105 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:89355px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background106.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:88.97px;top:54.00px" class="cls_005"><span class="cls_005">sistema.</span></div>
<div style="position:absolute;left:88.97px;top:67.99px" class="cls_005"><span class="cls_005">Os parâmetros das funções podem ser diferentes para determinadas funções no seu</span></div>
<div style="position:absolute;left:88.97px;top:81.98px" class="cls_005"><span class="cls_005">sistema.</span></div>
<div style="position:absolute;left:60.99px;top:108.09px" class="cls_005"><span class="cls_005">Se você quiser a informação real, veri que suas man pages Unix locais digitando man</span></div>
<div style="position:absolute;left:60.99px;top:123.94px" class="cls_005"><span class="cls_005">qualquer, onde "qualquer" é algo em que você está incrivelmente interessado, como</span></div>
<div style="position:absolute;left:60.99px;top:139.80px" class="cls_005"><span class="cls_005">"accept". (Tenho certeza que o Microsoft Visual Studio tem algo semelhante em sua seção de</span></div>
<div style="position:absolute;left:60.99px;top:154.72px" class="cls_005"><span class="cls_005">ajuda. Mas o "man" é melhor porque é um byte mais conciso do que "help". Unix ganha</span></div>
<div style="position:absolute;left:60.99px;top:168.71px" class="cls_005"><span class="cls_005">novamente!)</span></div>
<div style="position:absolute;left:60.99px;top:193.89px" class="cls_005"><span class="cls_005">Então, se elas são tão falhas, porque mesmo incluí-las no Guia? Bem, há algumas razões, mas</span></div>
<div style="position:absolute;left:60.99px;top:207.88px" class="cls_005"><span class="cls_005">as melhores são que (a)estas versões são voltadas especi camente para a programação de</span></div>
<div style="position:absolute;left:60.99px;top:221.87px" class="cls_005"><span class="cls_005">rede e são mais fáceis de digerir que as reais, e (b)estas versões contêm exemplos!</span></div>
<div style="position:absolute;left:60.99px;top:247.05px" class="cls_005"><span class="cls_005">Oh! E falando dos exemplos, eu não costumo colocar toda a veri cação de erros, porque</span></div>
<div style="position:absolute;left:60.99px;top:261.04px" class="cls_005"><span class="cls_005">realmente aumenta o comprimento do código. Mas você deve absolutamente fazer a</span></div>
<div style="position:absolute;left:60.99px;top:275.03px" class="cls_005"><span class="cls_005">veri cação de erros praticamente sempre que  zer qualquer chamada de sistema, a menos</span></div>
<div style="position:absolute;left:60.99px;top:289.01px" class="cls_005"><span class="cls_005">que você esteja totalmente, 100%, certo de que não irá falhar, e você provavelmente deveria</span></div>
<div style="position:absolute;left:60.99px;top:303.00px" class="cls_005"><span class="cls_005">fazê-lo mesmo assim!</span></div>
<div style="position:absolute;left:60.99px;top:331.86px" class="cls_007"><span class="cls_007">accept()</span></div>
<div style="position:absolute;left:60.99px;top:367.24px" class="cls_005"><span class="cls_005">Aceita uma conexão de entrada em um socket de escuta</span></div>
<div style="position:absolute;left:60.99px;top:396.11px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:432.91px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:448.77px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:480.48px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> accept(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *addr, socklen_t *addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:517.28px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:547.09px" class="cls_005"><span class="cls_005">Uma vez que você tenha passado pela di culdade de conseguir um socket SOCK_STREAM e</span></div>
<div style="position:absolute;left:60.99px;top:562.94px" class="cls_005"><span class="cls_005">de ni-lo para conexões de entrada com listen(), então você chama accept() para obter-</span></div>
<div style="position:absolute;left:60.99px;top:577.86px" class="cls_005"><span class="cls_005">se, na verdade, um novo descritor de socket para utilizar para comunicação posterior com o</span></div>
<div style="position:absolute;left:60.99px;top:591.85px" class="cls_005"><span class="cls_005">cliente recém-conectado.</span></div>
<div style="position:absolute;left:60.99px;top:617.03px" class="cls_005"><span class="cls_005">O velho socket que você está usando para ouvir ainda está lá, e será usado para as chamadas</span></div>
<div style="position:absolute;left:60.99px;top:631.95px" class="cls_005"><span class="cls_005">accept() mais recentes.</span></div>
<div style="position:absolute;left:69.53px;top:665.99px" class="cls_025"><span class="cls_025">Parâmetro</span></div>
<div style="position:absolute;left:306.56px;top:665.99px" class="cls_025"><span class="cls_025">Descrição</span></div>
<div style="position:absolute;left:69.39px;top:682.31px" class="cls_005"><span class="cls_005">s</span></div>
<div style="position:absolute;left:139.36px;top:682.31px" class="cls_005"><span class="cls_005">O descritor de socket de listen().</span></div>
<div style="position:absolute;left:69.39px;top:699.57px" class="cls_005"><span class="cls_005">addr</span></div>
<div style="position:absolute;left:139.36px;top:699.57px" class="cls_005"><span class="cls_005">Isso é preenchido com o endereço de quem se conecta a você.</span></div>
<div style="position:absolute;left:139.36px;top:716.82px" class="cls_005"><span class="cls_005">Isso é preenchido com sizeof() da estrutura retornada no parâmetro addr.</span></div>
<div style="position:absolute;left:69.39px;top:728.63px" class="cls_005"><span class="cls_005">addrlen</span></div>
<div style="position:absolute;left:139.36px;top:731.74px" class="cls_005"><span class="cls_005">Você pode com segurança ignorá-lo se você assumir que você está</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">106 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:90206px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background107.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:69.53px;top:61.93px" class="cls_025"><span class="cls_025">Parâmetro</span></div>
<div style="position:absolute;left:306.56px;top:61.93px" class="cls_025"><span class="cls_025">Descrição</span></div>
<div style="position:absolute;left:139.36px;top:78.25px" class="cls_005"><span class="cls_005">recebendo uma struct sockaddr_in de volta, você sabe o que é, porque</span></div>
<div style="position:absolute;left:139.36px;top:94.10px" class="cls_005"><span class="cls_005">esse é o tipo que você passou para add.</span></div>
<div style="position:absolute;left:60.99px;top:130.47px" class="cls_005"><span class="cls_005">accept() normalmente bloqueará, e você pode usar select() para dar uma olhada no</span></div>
<div style="position:absolute;left:60.99px;top:145.39px" class="cls_005"><span class="cls_005">descritor de socket de escuta antes do tempo para ver se ele está "pronto para ler". Se sim,</span></div>
<div style="position:absolute;left:60.99px;top:160.32px" class="cls_005"><span class="cls_005">então há uma nova conexão esperando para ser aceita com accept(), Sim! Alternativamente,</span></div>
<div style="position:absolute;left:60.99px;top:176.17px" class="cls_005"><span class="cls_005">você pode de nir a   ag O_NONBLOCK no socket de escuta usando fcntl(), e, em seguida, ele</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">nunca será bloqueado, preferindo retornar -1 com errno de nido para EWOULDBLOCK.</span></div>
<div style="position:absolute;left:60.99px;top:219.07px" class="cls_005"><span class="cls_005">O descritor de socket retornado por accept() é funcional, aberto e conectado ao host remoto.</span></div>
<div style="position:absolute;left:60.99px;top:234.92px" class="cls_005"><span class="cls_005">Você precisa o fechar com close() ao terminar.</span></div>
<div style="position:absolute;left:60.99px;top:264.73px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:294.54px" class="cls_005"><span class="cls_005">accept() retorna o descritor de socket recém-conectado, ou -1 em caso de erro, com errno</span></div>
<div style="position:absolute;left:60.99px;top:309.46px" class="cls_005"><span class="cls_005">de nido apropriadamente.</span></div>
<div style="position:absolute;left:60.99px;top:338.34px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:375.14px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:375.14px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage their_addr;</span></div>
<div style="position:absolute;left:83.19px;top:390.99px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:390.99px" class="cls_005"><span class="cls_005">socklen_t addr_size;</span></div>
<div style="position:absolute;left:83.19px;top:406.85px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:406.85px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:422.70px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:422.70px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd, new_fd;</span></div>
<div style="position:absolute;left:83.19px;top:438.56px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:453.48px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:453.48px" class="cls_013"><span class="cls_013">// primeiro, carregar estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:467.47px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:483.32px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:499.18px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:499.18px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:514.10px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:514.10px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:514.10px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:528.09px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:76.48px;top:543.94px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:543.94px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:558.86px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:558.86px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:325.49px;top:558.86px" class="cls_013"><span class="cls_013">// preencha meu IP para</span></div>
<div style="position:absolute;left:109.49px;top:572.85px" class="cls_013"><span class="cls_013">mim</span></div>
<div style="position:absolute;left:76.48px;top:588.70px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:604.56px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:604.56px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, MYPORT, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:620.41px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:636.27px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:636.27px" class="cls_013"><span class="cls_013">// crie um socket, faça bind com, e listen:</span></div>
<div style="position:absolute;left:76.48px;top:652.12px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:667.04px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:667.04px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:681.03px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:696.89px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:696.89px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:76.48px;top:712.74px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:712.74px" class="cls_005"><span class="cls_005">listen(sockfd, BACKLOG);</span></div>
<div style="position:absolute;left:76.48px;top:728.59px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">107 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:91057px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background108.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_013"><span class="cls_013">// agora aceita uma conexão de entrada:</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_005"><span class="cls_005">addr_size = </span><span class="cls_014">sizeof</span><span class="cls_005"> their_addr;</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:101.56px" class="cls_005"><span class="cls_005">new_fd = accept(sockfd, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *)&their_addr,</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_005"><span class="cls_005">&addr_size);</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:76.48px;top:146.33px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:103.89px;top:146.33px" class="cls_013"><span class="cls_013">// pronto para se comunicar no descritor de socket</span></div>
<div style="position:absolute;left:109.49px;top:160.32px" class="cls_013"><span class="cls_013">new_fd!</span></div>
<div style="position:absolute;left:60.99px;top:197.12px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:226.93px" class="cls_023"><span class="cls_023">socket</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">listen</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">struct sockaddr</span><span class="cls_006">_</span><span class="cls_023">in</span></div>
<div style="position:absolute;left:60.99px;top:256.71px" class="cls_007"><span class="cls_007">bind()</span></div>
<div style="position:absolute;left:60.99px;top:292.09px" class="cls_005"><span class="cls_005">Associa um socket com um endereço IP e um número de porta</span></div>
<div style="position:absolute;left:60.99px;top:320.97px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:357.77px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:373.62px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:404.40px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> bind(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *my_addr, socklen_t</span></div>
<div style="position:absolute;left:123.94px;top:418.39px" class="cls_005"><span class="cls_005">addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:455.19px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:484.07px" class="cls_005"><span class="cls_005">Quando uma máquina remota deseja se conectar ao seu programa servidor, ela precisa de</span></div>
<div style="position:absolute;left:60.99px;top:498.99px" class="cls_005"><span class="cls_005">duas informações: o endereço IP e o número da porta. A chamada bind() permite que você</span></div>
<div style="position:absolute;left:60.99px;top:513.91px" class="cls_005"><span class="cls_005">faça exatamente isso.</span></div>
<div style="position:absolute;left:60.99px;top:540.02px" class="cls_005"><span class="cls_005">Primeiro, você chama getaddrinfo() para carregar uma struct sockaddr com o</span></div>
<div style="position:absolute;left:60.99px;top:555.88px" class="cls_005"><span class="cls_005">endereço de destino e informações de porta. Então você chama socket() para obter um</span></div>
<div style="position:absolute;left:60.99px;top:571.73px" class="cls_005"><span class="cls_005">descritor de socket, e então você passa o socket e o endereço IP a bind(), e o endereço IP e a</span></div>
<div style="position:absolute;left:60.99px;top:586.65px" class="cls_005"><span class="cls_005">porta são magicamente (usando magia real) ligados ao socket!</span></div>
<div style="position:absolute;left:60.99px;top:611.83px" class="cls_005"><span class="cls_005">Se você não sabe o seu endereço IP, ou sabe que só possui um endereço IP na máquina, ou</span></div>
<div style="position:absolute;left:60.99px;top:625.82px" class="cls_005"><span class="cls_005">não se importa com qual dos endereços IP da máquina se utiliza, você pode simplesmente</span></div>
<div style="position:absolute;left:60.99px;top:640.74px" class="cls_005"><span class="cls_005">passar a   ag AI_PASSIVE no parâmetro hints para getaddrinfo(). O que isto faz é</span></div>
<div style="position:absolute;left:60.99px;top:656.60px" class="cls_005"><span class="cls_005">preencher parte do endereço IP de struct sockaddr com um valor especial que diz a</span></div>
<div style="position:absolute;left:60.99px;top:672.45px" class="cls_005"><span class="cls_005">bind() que deve preencher automaticamente o endereço IP.</span></div>
<div style="position:absolute;left:60.99px;top:699.50px" class="cls_005"><span class="cls_005">O quê? Que valor especial é carregado no endereço IP da struct sockaddr para fazer com</span></div>
<div style="position:absolute;left:60.99px;top:714.42px" class="cls_005"><span class="cls_005">que ela preencha automaticamente com o endereço do host atual? Eu lhe direi, mas lembre-se</span></div>
<div style="position:absolute;left:60.99px;top:729.34px" class="cls_005"><span class="cls_005">que isto é apenas se você estiver preenchendo a struct sockaddr manualmente; Se não,</span></div>
<div style="position:absolute;left:60.99px;top:745.19px" class="cls_005"><span class="cls_005">use os resultados de getaddrinfo(), conforme acima. Em IPv4, o campo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">108 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:91908px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background109.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">sin_addr.s_addr da estrutura struct sockaddr_in está de nido para INADDR_ANY. Em</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">IPv6, o campo sin6_addr da estrutura struct sockaddr_in6 é atribuído a partir da</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">variável global in6addr_any. Ou, se você está declarando uma nova struct in6_addr,</span></div>
<div style="position:absolute;left:60.99px;top:102.50px" class="cls_005"><span class="cls_005">você pode inicializá-la para IN6ADDR_ANY_INIT.</span></div>
<div style="position:absolute;left:60.99px;top:129.54px" class="cls_005"><span class="cls_005">Por  m, o parâmetro addrlen deve ser de nido como sizeof my_addr.</span></div>
<div style="position:absolute;left:60.99px;top:159.35px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:189.16px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno irá será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:204.08px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:232.95px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:269.76px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:269.76px" class="cls_013"><span class="cls_013">// maneira moderna de fazer as coisas com getaddrinfo()</span></div>
<div style="position:absolute;left:83.19px;top:285.61px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:301.46px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:301.46px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:317.32px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:317.32px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:333.17px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:348.09px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:348.09px" class="cls_013"><span class="cls_013">// primeiro, carregue as estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:362.08px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:377.94px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:393.79px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:393.79px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:408.71px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:408.71px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:408.71px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:422.70px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:76.48px;top:438.56px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:438.56px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:453.48px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:453.48px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:325.49px;top:453.48px" class="cls_013"><span class="cls_013">// preencha meu IP para</span></div>
<div style="position:absolute;left:109.49px;top:467.47px" class="cls_013"><span class="cls_013">mim</span></div>
<div style="position:absolute;left:76.48px;top:483.32px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:499.18px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:499.18px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:515.03px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:530.88px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:530.88px" class="cls_013"><span class="cls_013">// cria um socket:</span></div>
<div style="position:absolute;left:76.48px;top:545.81px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:545.81px" class="cls_013"><span class="cls_013">// (percorra a lista vinculada "res" e verifique por</span></div>
<div style="position:absolute;left:109.49px;top:559.79px" class="cls_013"><span class="cls_013">erros!)</span></div>
<div style="position:absolute;left:76.48px;top:575.65px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:590.57px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:590.57px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:604.56px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:620.41px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:636.27px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:636.27px" class="cls_013"><span class="cls_013">// bind para a porta que passamos para getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:652.12px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:667.98px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:667.98px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:83.19px;top:708.08px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:708.08px" class="cls_013"><span class="cls_013">// exemplo de empacotamento manual de uma estrutura,</span></div>
<div style="position:absolute;left:109.49px;top:722.07px" class="cls_013"><span class="cls_013">IPv4</span></div>
<div style="position:absolute;left:83.19px;top:737.92px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">109 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:92759px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background110.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in myaddr;</span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_005"><span class="cls_005">myaddr.sin_family = AF_INET;</span></div>
<div style="position:absolute;left:83.19px;top:118.35px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_005"><span class="cls_005">myaddr.sin_port = htons(</span><span class="cls_009">3490</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:134.20px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:150.06px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:150.06px" class="cls_013"><span class="cls_013">// você pode especificar um endereço IP:</span></div>
<div style="position:absolute;left:76.48px;top:164.98px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:164.98px" class="cls_005"><span class="cls_005">inet_pton(AF_INET, </span><span class="cls_010">"63.161.169.137"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:178.97px" class="cls_005"><span class="cls_005">&(myaddr.sin_addr));</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:209.74px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:209.74px" class="cls_013"><span class="cls_013">// ou você pode deixar que ele selecione um</span></div>
<div style="position:absolute;left:109.49px;top:223.73px" class="cls_013"><span class="cls_013">automaticamente:</span></div>
<div style="position:absolute;left:76.48px;top:239.59px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:239.59px" class="cls_005"><span class="cls_005">myaddr.sin_addr.s_addr = INADDR_ANY;</span></div>
<div style="position:absolute;left:76.48px;top:255.44px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:271.30px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:271.30px" class="cls_005"><span class="cls_005">s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:287.15px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:287.15px" class="cls_005"><span class="cls_005">bind(s, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr*)&myaddr, </span><span class="cls_014">sizeof</span><span class="cls_005"> myaddr);</span></div>
<div style="position:absolute;left:60.99px;top:323.95px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:353.76px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">socket</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">struct sockaddr</span><span class="cls_006">_</span><span class="cls_023">in</span><span class="cls_005">, </span><span class="cls_023">struct in</span><span class="cls_006">_</span><span class="cls_023">addr</span></div>
<div style="position:absolute;left:60.99px;top:383.55px" class="cls_007"><span class="cls_007">connect()</span></div>
<div style="position:absolute;left:60.99px;top:418.93px" class="cls_005"><span class="cls_005">Conecta um socket a um servidor</span></div>
<div style="position:absolute;left:60.99px;top:447.80px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:484.60px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:500.46px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:532.17px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> connect(</span><span class="cls_008">int</span><span class="cls_005"> sockfd, </span><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> sockaddr *serv_addr,</span></div>
<div style="position:absolute;left:175.40px;top:548.02px" class="cls_005"><span class="cls_005">socklen_t addrlen);</span></div>
<div style="position:absolute;left:60.99px;top:584.82px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:614.63px" class="cls_005"><span class="cls_005">Uma vez que você construiu um descritor de socket com a chamada socket(), pode-se</span></div>
<div style="position:absolute;left:60.99px;top:629.55px" class="cls_005"><span class="cls_005">conectar esse socket a um servidor remoto usando a já bem nomeada chamada de sistema</span></div>
<div style="position:absolute;left:60.99px;top:644.47px" class="cls_005"><span class="cls_005">connect(). Tudo o que você precisa fazer é passar o descritor de socket e o endereço do</span></div>
<div style="position:absolute;left:60.99px;top:659.40px" class="cls_005"><span class="cls_005">servidor que você está interessado em conhecer melhor. (Ah, e o comprimento do endereço,</span></div>
<div style="position:absolute;left:60.99px;top:673.38px" class="cls_005"><span class="cls_005">que é normalmente passado para funções como esta.)</span></div>
<div style="position:absolute;left:60.99px;top:699.50px" class="cls_005"><span class="cls_005">Normalmente, esta informação vem como resultado de uma chamada a getaddrinfo(),</span></div>
<div style="position:absolute;left:60.99px;top:715.35px" class="cls_005"><span class="cls_005">mas você pode preencher sua própria struct sockaddr se você quiser.</span></div>
<div style="position:absolute;left:60.99px;top:742.40px" class="cls_005"><span class="cls_005">Se você ainda não chamou bind() no descritor de socket, ele é automaticamente ligado ao</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">110 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:93610px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background111.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">seu endereço IP e a uma porta local aleatória. Isso geralmente é bom para você, se você não</span></div>
<div style="position:absolute;left:60.99px;top:67.99px" class="cls_005"><span class="cls_005">for um servidor, já que realmente não se importará com a porta local; Você só se importará</span></div>
<div style="position:absolute;left:60.99px;top:82.91px" class="cls_005"><span class="cls_005">com a porta remota, então você pode colocá-la no parâmetro serv_addr. Você pode chamar</span></div>
<div style="position:absolute;left:60.99px;top:98.76px" class="cls_005"><span class="cls_005">bind() se você realmente quiser que seu socket cliente esteja em um endereço IP e porta</span></div>
<div style="position:absolute;left:60.99px;top:113.69px" class="cls_005"><span class="cls_005">especí cos, mas isso é muito raro.</span></div>
<div style="position:absolute;left:60.99px;top:139.80px" class="cls_005"><span class="cls_005">Uma vez que o socket é conectado com connect(), você está livre para usar send() e</span></div>
<div style="position:absolute;left:60.99px;top:155.65px" class="cls_005"><span class="cls_005">recv() e trafegar dados sobre ele como mandar seu coração.</span></div>
<div style="position:absolute;left:60.99px;top:182.70px" class="cls_005"><span class="cls_005">Nota especial: se você se conecta com connect() a um socket SOCK_DGRAM UDP em um</span></div>
<div style="position:absolute;left:60.99px;top:198.55px" class="cls_005"><span class="cls_005">host remoto, você pode usar send() e recv() bem como sendto() e recvfrom(). Se você</span></div>
<div style="position:absolute;left:60.99px;top:213.47px" class="cls_005"><span class="cls_005">quiser.</span></div>
<div style="position:absolute;left:60.99px;top:242.35px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:272.16px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno irá ser de nido em</span></div>
<div style="position:absolute;left:60.99px;top:287.08px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:315.96px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:352.76px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:352.76px" class="cls_013"><span class="cls_013">// conecta à </span><A HREF="http://www.example.com/">www.example.com</A>, porta 80 (http)</div>
<div style="position:absolute;left:83.19px;top:368.61px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:384.47px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:384.47px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:400.32px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:400.32px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:416.17px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:431.10px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:431.10px" class="cls_013"><span class="cls_013">// primeiro, carregar estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:445.08px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:460.94px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:476.79px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:476.79px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:491.71px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:491.71px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:491.71px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:505.70px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:76.48px;top:521.56px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:521.56px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:537.41px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:552.33px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:552.33px" class="cls_013"><span class="cls_013">// poderíamos colocar "80" em vez de "http" na próxima</span></div>
<div style="position:absolute;left:109.49px;top:566.32px" class="cls_013"><span class="cls_013">linha:</span></div>
<div style="position:absolute;left:76.48px;top:582.18px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:582.18px" class="cls_005"><span class="cls_005">getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"http"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:598.03px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:613.89px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:613.89px" class="cls_013"><span class="cls_013">// cria o socket:</span></div>
<div style="position:absolute;left:76.48px;top:629.74px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:644.66px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:644.66px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:658.65px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:674.50px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:689.43px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:689.43px" class="cls_013"><span class="cls_013">// conecte-o ao endereço e à porta que passamos para</span></div>
<div style="position:absolute;left:109.49px;top:703.41px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:719.27px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:76.48px;top:735.12px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:735.12px" class="cls_005"><span class="cls_005">connect(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">111 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:94461px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background112.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:83.81px" class="cls_023"><span class="cls_023">socket</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">bind</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:113.59px" class="cls_007"><span class="cls_007">close()</span></div>
<div style="position:absolute;left:60.99px;top:148.97px" class="cls_005"><span class="cls_005">Fecha um descritor de socket</span></div>
<div style="position:absolute;left:60.99px;top:177.85px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:214.65px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;unistd.h></span></div>
<div style="position:absolute;left:94.85px;top:246.36px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> close(</span><span class="cls_008">int</span><span class="cls_005"> s);</span></div>
<div style="position:absolute;left:60.99px;top:283.16px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:312.04px" class="cls_005"><span class="cls_005">Depois que você terminar de usar o socket para qualquer esquema demente que você tenha</span></div>
<div style="position:absolute;left:60.99px;top:326.96px" class="cls_005"><span class="cls_005">inventado e você não quiser mais usar send() ou recv() ou, na verdade, fazer qualquer coisa</span></div>
<div style="position:absolute;left:60.99px;top:342.81px" class="cls_005"><span class="cls_005">com o socket, você pode o fechar com close(), e ele será liberado, para nunca mais ser</span></div>
<div style="position:absolute;left:60.99px;top:357.74px" class="cls_005"><span class="cls_005">usado novamente.</span></div>
<div style="position:absolute;left:60.99px;top:382.92px" class="cls_005"><span class="cls_005">O lado remoto pode saber que isso aconteceu de duas maneiras. Um: se o lado remoto</span></div>
<div style="position:absolute;left:60.99px;top:397.84px" class="cls_005"><span class="cls_005">chamadar recv(), ele retornará 0. Dois: se o lado remoto chamar send(), receberá um sinal</span></div>
<div style="position:absolute;left:60.99px;top:413.69px" class="cls_005"><span class="cls_005">SIGPIPE e send() retornará -1 e errno será de nido para EPIPE.</span></div>
<div style="position:absolute;left:60.99px;top:440.74px" class="cls_005"><span class="cls_005">Usuários de Windows: a função que você precisa usar chama-se closesocket(), não</span></div>
<div style="position:absolute;left:60.99px;top:456.59px" class="cls_005"><span class="cls_005">close(). Se você tentar usar close() em um descritor de socket, é possível que o Windows</span></div>
<div style="position:absolute;left:67.18px;top:471.51px" class="cls_005"><span class="cls_005">que irritado... E você não gostaria dele irritado.</span></div>
<div style="position:absolute;left:60.99px;top:500.39px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:530.20px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:545.12px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:573.99px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:610.80px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:610.80px" class="cls_005"><span class="cls_005">s = socket(PF_INET, SOCK_DGRAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:626.65px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:642.50px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:658.36px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:674.21px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:674.21px" class="cls_013"><span class="cls_013">// um monte de coisas...*BRRRONNNN!*</span></div>
<div style="position:absolute;left:83.19px;top:690.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:83.19px;top:705.92px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:721.77px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:737.63px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:737.63px" class="cls_005"><span class="cls_005">close(s);</span></div>
<div style="position:absolute;left:177.76px;top:737.63px" class="cls_013"><span class="cls_013">// não muito, realmente.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">112 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:95312px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background113.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:83.81px" class="cls_023"><span class="cls_023">socket</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">shutdown</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:113.59px" class="cls_007"><span class="cls_007">getaddrinfo(), freeaddrinfo(), gai_strerror()</span></div>
<div style="position:absolute;left:60.99px;top:149.91px" class="cls_005"><span class="cls_005">Obtém informações sobre um nome de host e/ou serviço e carrega uma struct sockaddr</span></div>
<div style="position:absolute;left:60.99px;top:164.83px" class="cls_005"><span class="cls_005">com o resultado.</span></div>
<div style="position:absolute;left:60.99px;top:193.70px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:230.51px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:246.36px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:262.21px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:94.85px;top:293.92px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getaddrinfo(</span><span class="cls_008">const  char</span><span class="cls_005"> *nodename, </span><span class="cls_008">const  char</span><span class="cls_005"> *servname,</span></div>
<div style="position:absolute;left:202.28px;top:308.84px" class="cls_008"><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> addrinfo *hints, </span><span class="cls_014">struct</span><span class="cls_005"> addrinfo</span></div>
<div style="position:absolute;left:123.94px;top:322.83px" class="cls_005"><span class="cls_005">**res);</span></div>
<div style="position:absolute;left:94.85px;top:354.54px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> freeaddrinfo(</span><span class="cls_014">struct</span><span class="cls_005"> addrinfo *ai);</span></div>
<div style="position:absolute;left:94.85px;top:386.25px" class="cls_008"><span class="cls_008">const  char</span><span class="cls_005"> *gai_strerror(</span><span class="cls_008">int</span><span class="cls_005"> ecode);</span></div>
<div style="position:absolute;left:94.85px;top:417.96px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo {</span></div>
<div style="position:absolute;left:108.28px;top:433.81px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:161.99px;top:433.81px" class="cls_005"><span class="cls_005">ai_flags;</span></div>
<div style="position:absolute;left:289.59px;top:433.81px" class="cls_013"><span class="cls_013">// AI_PASSIVE, AI_CANONNAME, ...</span></div>
<div style="position:absolute;left:108.28px;top:449.67px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:161.99px;top:449.67px" class="cls_005"><span class="cls_005">ai_family;</span></div>
<div style="position:absolute;left:289.59px;top:449.67px" class="cls_013"><span class="cls_013">// AF_xxx</span></div>
<div style="position:absolute;left:108.28px;top:465.52px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:161.99px;top:465.52px" class="cls_005"><span class="cls_005">ai_socktype;</span></div>
<div style="position:absolute;left:289.57px;top:465.52px" class="cls_013"><span class="cls_013">// SOCK_xxx</span></div>
<div style="position:absolute;left:108.28px;top:480.44px" class="cls_008"><span class="cls_008">int</span></div>
<div style="position:absolute;left:161.99px;top:480.44px" class="cls_005"><span class="cls_005">ai_protocol;</span></div>
<div style="position:absolute;left:289.57px;top:480.44px" class="cls_013"><span class="cls_013">// 0 (auto) ou IPPROTO_TCP,</span></div>
<div style="position:absolute;left:123.94px;top:494.43px" class="cls_013"><span class="cls_013">IPPROTO_UDP</span></div>
<div style="position:absolute;left:108.27px;top:526.14px" class="cls_005"><span class="cls_005">socklen_t  ai_addrlen;</span></div>
<div style="position:absolute;left:289.57px;top:526.14px" class="cls_013"><span class="cls_013">// tamanho de ai_addr</span></div>
<div style="position:absolute;left:108.28px;top:541.99px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:155.28px;top:541.99px" class="cls_005"><span class="cls_005">*ai_canonname;</span></div>
<div style="position:absolute;left:289.57px;top:541.99px" class="cls_013"><span class="cls_013">// nome canônico para nodename</span></div>
<div style="position:absolute;left:108.28px;top:557.85px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr</span></div>
<div style="position:absolute;left:223.81px;top:557.85px" class="cls_005"><span class="cls_005">*ai_addr; </span><span class="cls_013">// endereço binário</span></div>
<div style="position:absolute;left:108.28px;top:572.77px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo</span></div>
<div style="position:absolute;left:223.81px;top:572.77px" class="cls_005"><span class="cls_005">*ai_next; </span><span class="cls_013">// próxima estrutura na lista</span></div>
<div style="position:absolute;left:123.94px;top:586.76px" class="cls_013"><span class="cls_013">vinculada</span></div>
<div style="position:absolute;left:94.85px;top:602.61px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:639.41px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:669.22px" class="cls_005"><span class="cls_005">getaddrinfo() é uma excelente função que retornará informações sobre um nome de host</span></div>
<div style="position:absolute;left:60.99px;top:685.08px" class="cls_005"><span class="cls_005">especí co (como o seu endereço IP) e carregar uma struct sockaddr para você, cuidando</span></div>
<div style="position:absolute;left:60.99px;top:700.00px" class="cls_005"><span class="cls_005">dos detalhes importantes (como se é IPv4 ou IPv6). Ela substitui as antigas funções</span></div>
<div style="position:absolute;left:60.99px;top:714.92px" class="cls_005"><span class="cls_005">gethostbyname() e getservbyname(). A descrição, abaixo, contém uma grande</span></div>
<div style="position:absolute;left:60.99px;top:729.84px" class="cls_005"><span class="cls_005">quantidade de informação que pode ser um pouco assustadora, mas o uso é bastante simples.</span></div>
<div style="position:absolute;left:60.99px;top:743.83px" class="cls_005"><span class="cls_005">Pode valer a pena conferir os exemplos primeiro.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">113 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:96163px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background114.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">O nome do host em que você estiver interessado vai no parâmetro nodename. O endereço</span></div>
<div style="position:absolute;left:60.99px;top:69.85px" class="cls_005"><span class="cls_005">pode ser um nome de host, como "</span><A HREF="http://www.example.com"/">www.example.com"</A>, ou um endereço IPv4 ou IPv6 (passado</div>
<div style="position:absolute;left:60.99px;top:84.78px" class="cls_005"><span class="cls_005">como string). Este parâmetro também pode ser NULL se você estiver usando a   ag</span></div>
<div style="position:absolute;left:60.99px;top:100.63px" class="cls_005"><span class="cls_005">AI_PASSIVE (veja abaixo).</span></div>
<div style="position:absolute;left:60.99px;top:127.68px" class="cls_005"><span class="cls_005">O parâmetro servname é basicamente o número da porta. Ele pode ser um número de porta</span></div>
<div style="position:absolute;left:60.99px;top:142.60px" class="cls_005"><span class="cls_005">(passada como string, como "80"), ou pode ser um nome de serviço, como "http" ou "tftp" ou</span></div>
<div style="position:absolute;left:60.99px;top:156.59px" class="cls_005"><span class="cls_005">"smtp" ou "pop", etc. Nomes de serviços bem conhecidos podem ser encontrados no </span><span class="cls_023">IANA Port</span></div>
<div style="position:absolute;left:60.99px;top:170.57px" class="cls_023"><span class="cls_023">List</span><span class="cls_024"><sup>48</sup></span><span class="cls_005"> ou em seu arquivo /etc/services.</span></div>
<div style="position:absolute;left:60.99px;top:199.56px" class="cls_005"><span class="cls_005">Por  m, para parâmetros de entrada, temos hints. Isto é realmente onde você começa a</span></div>
<div style="position:absolute;left:60.99px;top:215.41px" class="cls_005"><span class="cls_005">de nir o que a função getaddrinfo() fará. Zere toda a estrutura antes da utilização, com</span></div>
<div style="position:absolute;left:60.99px;top:231.26px" class="cls_005"><span class="cls_005">memset(). Vamos dar uma olhada nos campos que você precisa con gurar antes do uso.</span></div>
<div style="position:absolute;left:60.99px;top:258.31px" class="cls_005"><span class="cls_005">O ai_flags pode ser con gurado para uma variedade de coisas, mas aqui estão algumas das</span></div>
<div style="position:absolute;left:60.99px;top:273.23px" class="cls_005"><span class="cls_005">mais importantes. (Se podem especi car múltiplas   ags por bitwise-ORing juntamente com o</span></div>
<div style="position:absolute;left:60.99px;top:288.15px" class="cls_005"><span class="cls_005">operador |.) Veri que a sua página man para a lista completa de   ags.</span></div>
<div style="position:absolute;left:60.99px;top:315.20px" class="cls_005"><span class="cls_005">AI_CANONNAME causa que ai_canonname do resultado se complete com o nome canônico</span></div>
<div style="position:absolute;left:60.99px;top:331.05px" class="cls_005"><span class="cls_005">(real) do host. AI_PASSIVE faz com que o endereço IP do resultado se complete com</span></div>
<div style="position:absolute;left:60.99px;top:346.91px" class="cls_005"><span class="cls_005">INADDR_ANY (IPv4) ou in6addr_any (IPv6); Isso faz com que uma chamada subsequente a</span></div>
<div style="position:absolute;left:60.99px;top:362.76px" class="cls_005"><span class="cls_005">bind() preencha automaticamente o endereço IP da struct sockaddr com o endereço do</span></div>
<div style="position:absolute;left:60.99px;top:377.68px" class="cls_005"><span class="cls_005">host atual. Isso é excelente para con gurar um servidor quando você não deseja codi car o</span></div>
<div style="position:absolute;left:60.99px;top:391.67px" class="cls_005"><span class="cls_005">endereço.</span></div>
<div style="position:absolute;left:60.99px;top:417.78px" class="cls_005"><span class="cls_005">Se você usar a   ag AI_PASSIVE, então você pode passar NULL no nodename (já que bind()</span></div>
<div style="position:absolute;left:60.99px;top:432.70px" class="cls_005"><span class="cls_005">irá preenchê-lo para você mais tarde.)</span></div>
<div style="position:absolute;left:60.99px;top:458.82px" class="cls_005"><span class="cls_005">Continuando com os parâmetros de entrada, você provavelmente vai querer de nir ai_family</span></div>
<div style="position:absolute;left:60.99px;top:474.67px" class="cls_005"><span class="cls_005">para AF_UNSPEC que diz a getaddrinfo() para operar com ambos os endereços, IPv4 e</span></div>
<div style="position:absolute;left:60.99px;top:490.53px" class="cls_005"><span class="cls_005">IPv6. Você também pode restringir a um ou a outro com AF_INET ou AF_INET6.</span></div>
<div style="position:absolute;left:60.99px;top:517.57px" class="cls_005"><span class="cls_005">Em seguida, o campo socktype deve ser de nido como SOCK_STREAM ou SOCK_DGRAM,</span></div>
<div style="position:absolute;left:60.99px;top:532.49px" class="cls_005"><span class="cls_005">dependendo de qual tipo de socket se deseja.</span></div>
<div style="position:absolute;left:60.99px;top:558.61px" class="cls_005"><span class="cls_005">Finalmente, apenas deixe ai_protocol de nido em 0 para escolher automaticamente o seu</span></div>
<div style="position:absolute;left:60.99px;top:573.53px" class="cls_005"><span class="cls_005">tipo de protocolo.</span></div>
<div style="position:absolute;left:60.99px;top:598.71px" class="cls_005"><span class="cls_005">Agora, depois meter todas essas coisas lá dentro, você pode   nalmente fazer a chamada a</span></div>
<div style="position:absolute;left:60.99px;top:613.63px" class="cls_005"><span class="cls_005">getaddrinfo()!</span></div>
<div style="position:absolute;left:60.99px;top:640.67px" class="cls_005"><span class="cls_005">É claro, este é o lugar onde a diversão começa. A res agora apontará para uma lista vinculada</span></div>
<div style="position:absolute;left:60.99px;top:656.53px" class="cls_005"><span class="cls_005">de struct addrinfos, e você pode percorrer esta lista para obter todos os endereços que</span></div>
<div style="position:absolute;left:60.99px;top:671.45px" class="cls_005"><span class="cls_005">correspondam ao que você passou com hints.</span></div>
<div style="position:absolute;left:60.99px;top:696.63px" class="cls_005"><span class="cls_005">Agora, é possível obter alguns endereços que não funcionam por uma razão ou outra, de modo</span></div>
<div style="position:absolute;left:60.99px;top:710.62px" class="cls_005"><span class="cls_005">que o que a Linux man page faz é em loops percorrer a lista fazendo uma chamada a</span></div>
<div style="position:absolute;left:60.99px;top:725.54px" class="cls_005"><span class="cls_005">socket() e connect() (Ou bind() se você estiver con gurando um servidor com a   ag</span></div>
<div style="position:absolute;left:60.99px;top:741.39px" class="cls_005"><span class="cls_005">AI_PASSIVE) até obter êxito.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">114 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:97014px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background115.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Finalmente, quando você terminar com a lista vinculada, você precisa chamar</span></div>
<div style="position:absolute;left:60.99px;top:68.92px" class="cls_005"><span class="cls_005">freeaddrinfo() para liberar memória (ou ela vazará, e algumas pessoas  carão chateadas.)</span></div>
<div style="position:absolute;left:60.99px;top:98.73px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:127.61px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou diferente de zero em caso de erro. Se ela retornar</span></div>
<div style="position:absolute;left:60.99px;top:142.53px" class="cls_005"><span class="cls_005">diferente de zero, você pode usar a função gai_strerror() para obter uma versão de</span></div>
<div style="position:absolute;left:60.99px;top:157.45px" class="cls_005"><span class="cls_005">impressão do código de erro no valor de retorno.</span></div>
<div style="position:absolute;left:60.99px;top:186.32px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:223.13px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:223.13px" class="cls_013"><span class="cls_013">// código para um cliente se conectar a um servidor</span></div>
<div style="position:absolute;left:83.19px;top:238.05px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:238.05px" class="cls_013"><span class="cls_013">// ou seja, um socket stream para </span><A HREF="http://www.example.com/">www.example.com</A> na</div>
<div style="position:absolute;left:109.49px;top:252.04px" class="cls_013"><span class="cls_013">porta 80 (http)</span></div>
<div style="position:absolute;left:83.19px;top:267.89px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:267.89px" class="cls_013"><span class="cls_013">// seja IPv4 ou IPv6</span></div>
<div style="position:absolute;left:83.19px;top:283.75px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:299.60px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:299.60px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:315.45px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:315.45px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:83.19px;top:331.31px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:331.31px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:83.19px;top:347.16px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:363.02px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:363.02px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:377.94px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:377.94px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC; </span><span class="cls_013">// use AF_INET6 para forçar</span></div>
<div style="position:absolute;left:109.49px;top:391.93px" class="cls_013"><span class="cls_013">IPv6</span></div>
<div style="position:absolute;left:76.48px;top:407.78px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:407.78px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:423.64px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:438.56px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:438.56px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"http"</span><span class="cls_005">, &hints,</span></div>
<div style="position:absolute;left:109.49px;top:452.55px" class="cls_005"><span class="cls_005">&servinfo)) != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:467.47px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:467.47px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:481.46px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:497.31px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:497.31px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:513.16px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:513.16px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:529.02px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:543.94px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:543.94px" class="cls_013"><span class="cls_013">// percorre todos os resultados e conecta ao primeiro</span></div>
<div style="position:absolute;left:109.49px;top:557.93px" class="cls_013"><span class="cls_013">que puder</span></div>
<div style="position:absolute;left:76.48px;top:573.78px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:573.78px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:589.64px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:130.75px;top:589.64px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family, p->ai_socktype,</span></div>
<div style="position:absolute;left:76.48px;top:605.49px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:184.46px;top:605.49px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:621.35px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:157.60px;top:621.35px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:637.20px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:157.61px;top:637.20px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:653.05px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:130.75px;top:653.05px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:668.91px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:76.48px;top:683.83px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:683.83px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (connect(sockfd, p->ai_addr, p->ai_addrlen) ==</span></div>
<div style="position:absolute;left:109.49px;top:697.82px" class="cls_005"><span class="cls_005">-</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:713.67px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:157.60px;top:713.67px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"connect"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:729.53px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:157.60px;top:729.53px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">115 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:97865px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background116.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:157.61px;top:54.93px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:101.56px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">; </span><span class="cls_013">// se chegamos aqui, devemos ter conectado</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_013"><span class="cls_013">com sucesso</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:103.89px;top:131.41px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:103.89px;top:163.11px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:178.97px" class="cls_013"><span class="cls_013">// repetiu o final da lista sem conexão</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:194.82px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"falha ao connect\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:210.68px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">2</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:103.89px;top:226.53px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:103.89px;top:258.24px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo); </span><span class="cls_013">// tudo feito com essa estrutura</span></div>
<div style="position:absolute;left:83.19px;top:299.27px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:299.27px" class="cls_013"><span class="cls_013">// código para um servidor aguardar conexões</span></div>
<div style="position:absolute;left:83.19px;top:314.19px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:314.19px" class="cls_013"><span class="cls_013">// ou seja, um socket stream na porta 3490, no IP deste</span></div>
<div style="position:absolute;left:109.49px;top:328.18px" class="cls_013"><span class="cls_013">host</span></div>
<div style="position:absolute;left:83.19px;top:344.04px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:344.04px" class="cls_013"><span class="cls_013">// seja IPv4 ou IPv6.</span></div>
<div style="position:absolute;left:83.19px;top:359.89px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:375.75px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:375.75px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:391.60px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:391.60px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *servinfo, *p;</span></div>
<div style="position:absolute;left:83.19px;top:407.45px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:407.45px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:83.19px;top:423.31px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:439.16px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:439.16px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:454.08px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:454.08px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC; </span><span class="cls_013">// use AF_INET6 para forçar</span></div>
<div style="position:absolute;left:109.49px;top:468.07px" class="cls_013"><span class="cls_013">IPv6</span></div>
<div style="position:absolute;left:76.48px;top:483.93px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:483.93px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:499.78px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:499.78px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE; </span><span class="cls_013">// use meu endereço IP</span></div>
<div style="position:absolute;left:76.48px;top:515.64px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:76.48px;top:530.56px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:530.56px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((rv = getaddrinfo(NULL, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &servinfo))</span></div>
<div style="position:absolute;left:109.49px;top:544.55px" class="cls_005"><span class="cls_005">!= </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:559.47px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:559.47px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"getaddrinfo: %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:573.46px" class="cls_005"><span class="cls_005">gai_strerror(rv));</span></div>
<div style="position:absolute;left:76.48px;top:589.31px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:589.31px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:605.17px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:605.17px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:621.02px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:635.94px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:635.94px" class="cls_013"><span class="cls_013">// loop por todos os resultados e vincular ao primeiro</span></div>
<div style="position:absolute;left:109.49px;top:649.93px" class="cls_013"><span class="cls_013">que pudermos</span></div>
<div style="position:absolute;left:76.48px;top:665.78px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:665.78px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(p = servinfo; p != NULL; p = p->ai_next) {</span></div>
<div style="position:absolute;left:76.48px;top:681.64px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:681.64px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((sockfd = socket(p->ai_family, p->ai_socktype,</span></div>
<div style="position:absolute;left:76.48px;top:697.49px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:184.46px;top:697.49px" class="cls_005"><span class="cls_005">p->ai_protocol)) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:713.35px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:157.60px;top:713.35px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"socket"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:729.20px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:157.61px;top:729.20px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">116 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:98716px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background117.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:86.64px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (bind(sockfd, p->ai_addr, p->ai_addrlen) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:157.60px;top:102.50px" class="cls_005"><span class="cls_005">close(sockfd);</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:157.60px;top:118.35px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"bind"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:134.20px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:157.61px;top:134.20px" class="cls_014"><span class="cls_014">continue</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:150.06px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:150.06px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:76.48px;top:180.83px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:180.83px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">; </span><span class="cls_013">// se chegamos aqui, devemos ter conectado</span></div>
<div style="position:absolute;left:109.49px;top:194.82px" class="cls_013"><span class="cls_013">com sucesso</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:103.89px;top:210.68px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:103.89px;top:242.38px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (p == NULL) {</span></div>
<div style="position:absolute;left:76.48px;top:257.31px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:257.31px" class="cls_013"><span class="cls_013">// repetiu o final da lista sem êxito em realizar</span></div>
<div style="position:absolute;left:109.49px;top:271.30px" class="cls_013"><span class="cls_013">bind</span></div>
<div style="position:absolute;left:76.48px;top:286.22px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:286.22px" class="cls_005"><span class="cls_005">fprintf(stderr, </span><span class="cls_010">"falha ao realizar bind com o</span></div>
<div style="position:absolute;left:109.49px;top:300.21px" class="cls_010"><span class="cls_010">socket\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:316.06px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:316.06px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">2</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:331.91px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:103.89px;top:331.91px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:347.77px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:76.48px;top:363.62px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:103.89px;top:363.62px" class="cls_005"><span class="cls_005">freeaddrinfo(servinfo); </span><span class="cls_013">// tudo feito com essa estrutura</span></div>
<div style="position:absolute;left:60.99px;top:400.43px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:430.23px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">name</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">etnameinfo</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:460.02px" class="cls_007"><span class="cls_007">gethostname()</span></div>
<div style="position:absolute;left:60.99px;top:495.40px" class="cls_005"><span class="cls_005">Retorna o nome do sistema</span></div>
<div style="position:absolute;left:60.99px;top:524.27px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:561.08px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/unistd.h></span></div>
<div style="position:absolute;left:94.85px;top:592.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> gethostname(</span><span class="cls_008">char</span><span class="cls_005"> *name, </span><span class="cls_008">size_t</span><span class="cls_005"> len);</span></div>
<div style="position:absolute;left:60.99px;top:629.59px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:658.46px" class="cls_005"><span class="cls_005">Seu sistema tem um nome. Todos eles têm. Essa é uma coisa um pouco mais de UNIXy do que</span></div>
<div style="position:absolute;left:60.99px;top:672.45px" class="cls_005"><span class="cls_005">o resto das coisas sobre redes das quais temos falado, mas ela ainda tem seus usos.</span></div>
<div style="position:absolute;left:60.99px;top:698.57px" class="cls_005"><span class="cls_005">Por exemplo, você pode obter o seu nome de host, e depois chamar gethostbyname() para</span></div>
<div style="position:absolute;left:60.99px;top:713.49px" class="cls_005"><span class="cls_005">descobrir o seu endereço IP.</span></div>
<div style="position:absolute;left:60.99px;top:739.60px" class="cls_005"><span class="cls_005">O parâmetro name deve apontar para um buffer que conterá o nome de host, e len é o</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">117 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:99567px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background118.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">tamanho desse buffer em bytes. gethostname() não sobrescreve o  nal do buffer (pode</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">retornar um erro, ou pode simplesmente parar de escrever), e terminará a string com NUL, se</span></div>
<div style="position:absolute;left:60.99px;top:85.71px" class="cls_005"><span class="cls_005">houver espaço para isso no buffer.</span></div>
<div style="position:absolute;left:60.99px;top:114.58px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:144.39px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno de</span></div>
<div style="position:absolute;left:415.64px;top:144.39px" class="cls_005"><span class="cls_005">nido em</span></div>
<div style="position:absolute;left:60.99px;top:159.31px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:188.19px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:224.99px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:224.99px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> hostname[</span><span class="cls_009">128</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:240.85px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:256.70px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:256.70px" class="cls_005"><span class="cls_005">gethostname(hostname, </span><span class="cls_014">sizeof</span><span class="cls_005"> hostname);</span></div>
<div style="position:absolute;left:83.19px;top:272.55px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:272.55px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Meu hostname: %s\n"</span><span class="cls_005">, hostname);</span></div>
<div style="position:absolute;left:60.99px;top:309.36px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:339.17px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">name</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:368.95px" class="cls_007"><span class="cls_007">gethostbyname(), gethostbyaddr()</span></div>
<div style="position:absolute;left:60.99px;top:404.33px" class="cls_005"><span class="cls_005">Obtém um endereço IP de um nome de host ou vice-versa.</span></div>
<div style="position:absolute;left:60.99px;top:433.21px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:470.01px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:485.86px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:94.85px;top:516.64px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> hostent *gethostbyname(</span><span class="cls_008">const char</span><span class="cls_005"> *name); </span><span class="cls_013">//</span></div>
<div style="position:absolute;left:123.94px;top:530.63px" class="cls_020"><span class="cls_020">DESCONTINUADA</span><span class="cls_013">!</span></div>
<div style="position:absolute;left:94.85px;top:545.55px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> hostent *gethostbyaddr(</span><span class="cls_008">const char</span><span class="cls_005"> *addr, </span><span class="cls_008">int</span><span class="cls_005"> len, </span><span class="cls_008">int</span></div>
<div style="position:absolute;left:123.94px;top:559.54px" class="cls_005"><span class="cls_005">type);</span></div>
<div style="position:absolute;left:60.99px;top:596.34px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:626.15px" class="cls_005"><span class="cls_005">POR FAVOR NOTE: estas duas funções são substituídas por getaddrinfo() e</span></div>
<div style="position:absolute;left:60.99px;top:642.00px" class="cls_005"><span class="cls_005">getnameinfo()! Em particular, gethostbyname() não funciona bem com o IPv6.</span></div>
<div style="position:absolute;left:60.99px;top:668.12px" class="cls_005"><span class="cls_005">Essas funções são mapeadas entre os nomes de host e os endereços IP. Por exemplo, se você</span></div>
<div style="position:absolute;left:60.99px;top:683.04px" class="cls_005"><span class="cls_005">tem "</span><A HREF="http://www.example.com"/">www.example.com"</A>, você pode usar gethostbyname() para obter seu endereço IP e</div>
<div style="position:absolute;left:60.99px;top:698.89px" class="cls_005"><span class="cls_005">armazená-lo em uma struct in_addr.</span></div>
<div style="position:absolute;left:60.99px;top:725.94px" class="cls_005"><span class="cls_005">Por outro lado, se você tem uma struct in_addr ou uma struct in6_addr, você pode</span></div>
<div style="position:absolute;left:60.99px;top:741.79px" class="cls_005"><span class="cls_005">usar gethostbyaddr() para recuperar o nome de host. gethostbyaddr() é compatível</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">118 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:100418px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background119.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">com IPv6, mas você deve usar o mais novo e brilhante getnameinfo() em seu lugar.</span></div>
<div style="position:absolute;left:60.99px;top:81.05px" class="cls_005"><span class="cls_005">(Se você tem uma string contendo um endereço IP no formato pontos-e-números da qual você</span></div>
<div style="position:absolute;left:60.99px;top:95.97px" class="cls_005"><span class="cls_005">deseja procurar o nome do host, seria melhor usar getaddrinfo() com a   ag</span></div>
<div style="position:absolute;left:60.99px;top:111.82px" class="cls_005"><span class="cls_005">AI_CANONNAME.)</span></div>
<div style="position:absolute;left:60.99px;top:138.87px" class="cls_005"><span class="cls_005">gethostbyname() recebe uma string como "</span><A HREF="http://www.yahoo.com"/">www.yahoo.com"</A>, e retorna uma struct</div>
<div style="position:absolute;left:60.99px;top:154.72px" class="cls_005"><span class="cls_005">hostent, que contém toneladas de informações, incluindo o endereço IP. (Outras informações</span></div>
<div style="position:absolute;left:60.99px;top:169.64px" class="cls_005"><span class="cls_005">são o nome o cial do host, uma lista de aliases, o tipo de endereço, o comprimento dos</span></div>
<div style="position:absolute;left:60.99px;top:183.63px" class="cls_005"><span class="cls_005">endereços e a lista de endereços—é uma estrutura de uso geral que é muito fácil de usar para</span></div>
<div style="position:absolute;left:60.99px;top:197.62px" class="cls_005"><span class="cls_005">os nossos propósitos especí cos, uma vez que você vê como fazer.)</span></div>
<div style="position:absolute;left:60.99px;top:223.73px" class="cls_005"><span class="cls_005">gethostbyaddr() leva uma struct in_addr ou uma struct in6_addr e traz para você</span></div>
<div style="position:absolute;left:60.99px;top:239.59px" class="cls_005"><span class="cls_005">um nome de host correspondente (se houver), por isso é uma espécie de gethostbyname()</span></div>
<div style="position:absolute;left:60.99px;top:255.44px" class="cls_005"><span class="cls_005">reversa. Quanto aos parâmetros, embora addr seja um char*, você realmente deseja passar</span></div>
<div style="position:absolute;left:60.99px;top:271.30px" class="cls_005"><span class="cls_005">um ponteiro para uma struct in_addr. len deve ser sizeof (struct in_addr) e type</span></div>
<div style="position:absolute;left:60.99px;top:287.15px" class="cls_005"><span class="cls_005">deve ser AF_INET.</span></div>
<div style="position:absolute;left:60.99px;top:314.19px" class="cls_005"><span class="cls_005">Então, o que é esta struct hostent que é retornada? Ela possui uma série de campos que</span></div>
<div style="position:absolute;left:60.99px;top:329.12px" class="cls_005"><span class="cls_005">contém informações sobre o host em questão.</span></div>
<div style="position:absolute;left:114.91px;top:362.22px" class="cls_025"><span class="cls_025">Campo</span></div>
<div style="position:absolute;left:343.30px;top:362.22px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:69.39px;top:378.54px" class="cls_005"><span class="cls_005">char *h_name</span></div>
<div style="position:absolute;left:212.84px;top:378.54px" class="cls_005"><span class="cls_005">O nome real canônico do host.</span></div>
<div style="position:absolute;left:212.84px;top:394.86px" class="cls_005"><span class="cls_005">Uma lista de aliases que podem ser acessados com arrays—o</span></div>
<div style="position:absolute;left:69.39px;top:402.79px" class="cls_005"><span class="cls_005">char **h_aliases</span></div>
<div style="position:absolute;left:212.84px;top:409.79px" class="cls_005"><span class="cls_005">último elemento é NULL</span></div>
<div style="position:absolute;left:212.84px;top:426.11px" class="cls_005"><span class="cls_005">O tipo de endereço do resultado, que realmente deve ser</span></div>
<div style="position:absolute;left:69.39px;top:434.03px" class="cls_005"><span class="cls_005">int h_addrtype</span></div>
<div style="position:absolute;left:212.84px;top:441.03px" class="cls_005"><span class="cls_005">AF_INET para nossos propósitos.</span></div>
<div style="position:absolute;left:212.84px;top:457.35px" class="cls_005"><span class="cls_005">O comprimento dos endereços em bytes, que é 4 para</span></div>
<div style="position:absolute;left:69.39px;top:464.34px" class="cls_005"><span class="cls_005">int comprimento</span></div>
<div style="position:absolute;left:212.84px;top:471.34px" class="cls_005"><span class="cls_005">endereços IP (versão 4).</span></div>
<div style="position:absolute;left:212.84px;top:486.73px" class="cls_005"><span class="cls_005">Uma lista de endereços IP para este host. Embora esse seja</span></div>
<div style="position:absolute;left:69.39px;top:501.65px" class="cls_005"><span class="cls_005">char **h_addr_list     um char**, é realmente um array de struct in_addr*s</span></div>
<div style="position:absolute;left:212.84px;top:517.50px" class="cls_005"><span class="cls_005">disfarçado. O último elemento do array é NULL.</span></div>
<div style="position:absolute;left:212.84px;top:534.75px" class="cls_005"><span class="cls_005">Um alias comumente de nido para h_addr_list[0]. Se</span></div>
<div style="position:absolute;left:69.39px;top:548.74px" class="cls_005"><span class="cls_005">h_addr</span></div>
<div style="position:absolute;left:212.84px;top:549.68px" class="cls_005"><span class="cls_005">você apenas quiser qualquer endereço IP antigo para esse</span></div>
<div style="position:absolute;left:212.84px;top:563.66px" class="cls_005"><span class="cls_005">host (sim, eles podem ter mais de um) basta usar este campo.</span></div>
<div style="position:absolute;left:60.99px;top:601.87px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:631.67px" class="cls_005"><span class="cls_005">Retorna um ponteiro para uma struct hostent resultante em caso de sucesso, ou NULL em</span></div>
<div style="position:absolute;left:60.99px;top:646.60px" class="cls_005"><span class="cls_005">caso de erro.</span></div>
<div style="position:absolute;left:60.99px;top:672.71px" class="cls_005"><span class="cls_005">Em vez da perror() normal e todas essas coisas que você normalmente usaria para o</span></div>
<div style="position:absolute;left:60.99px;top:688.56px" class="cls_005"><span class="cls_005">relatório de erros, essas funções têm resultados paralelos na variável h_errno, que podem ser</span></div>
<div style="position:absolute;left:60.99px;top:704.42px" class="cls_005"><span class="cls_005">impressos usando-se as funções herror() ou hstrerror(). Elas funcionam como as</span></div>
<div style="position:absolute;left:60.99px;top:720.27px" class="cls_005"><span class="cls_005">clássicas funções errno, perror(), e strerror() com as quais você está acostumado.</span></div>
<div style="position:absolute;left:60.99px;top:750.08px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">119 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:101269px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background120.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:103.89px;top:60.99px" class="cls_013"><span class="cls_013">// ESTE É UM MÉTODO </span><span class="cls_020">DESCONTINUADO</span><span class="cls_013"> PARA SE OBTER NOMES</span></div>
<div style="position:absolute;left:83.19px;top:60.99px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:109.49px;top:74.98px" class="cls_013"><span class="cls_013">DE HOST</span></div>
<div style="position:absolute;left:83.19px;top:90.84px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:90.84px" class="cls_013"><span class="cls_013">// use getaddrinfo() em vez de!</span></div>
<div style="position:absolute;left:83.19px;top:106.69px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:122.55px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:122.55px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:83.19px;top:138.40px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:138.40px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:83.19px;top:154.25px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:154.25px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:83.19px;top:170.11px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:170.11px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:83.19px;top:185.96px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:185.96px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:83.19px;top:201.82px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:201.82px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:76.48px;top:217.67px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:217.67px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:76.48px;top:233.53px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:249.38px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:249.38px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> main(</span><span class="cls_008">int</span><span class="cls_005"> argc, </span><span class="cls_008">char</span><span class="cls_005"> *argv[])</span></div>
<div style="position:absolute;left:76.48px;top:265.23px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:265.23px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:76.48px;top:281.09px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:281.09px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> i;</span></div>
<div style="position:absolute;left:76.48px;top:296.94px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:296.94px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> hostent *he;</span></div>
<div style="position:absolute;left:76.48px;top:312.80px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:312.80px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr **addr_list;</span></div>
<div style="position:absolute;left:76.48px;top:328.65px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:344.50px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:130.75px;top:344.50px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (argc != </span><span class="cls_009">2</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:360.36px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:157.60px;top:360.36px" class="cls_005"><span class="cls_005">fprintf(stderr,</span><span class="cls_010">"uso: ghbn hostname\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:376.21px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:157.61px;top:376.21px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:392.07px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:392.07px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:407.92px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:422.84px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:422.84px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> ((he = gethostbyname(argv[</span><span class="cls_009">1</span><span class="cls_005">])) == NULL) { </span><span class="cls_013">//</span></div>
<div style="position:absolute;left:109.49px;top:436.83px" class="cls_013"><span class="cls_013">obtém info. do host</span></div>
<div style="position:absolute;left:76.48px;top:452.69px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:157.60px;top:452.69px" class="cls_005"><span class="cls_005">herror(</span><span class="cls_010">"gethostbyname"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:468.54px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:157.61px;top:468.54px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 2</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:484.39px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:130.75px;top:484.39px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:500.25px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:516.10px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:516.10px" class="cls_013"><span class="cls_013">// imprimir informações sobre este host:</span></div>
<div style="position:absolute;left:76.48px;top:531.96px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:531.96px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"O Nome oficial é: %s\n"</span><span class="cls_005">, he->h_name);</span></div>
<div style="position:absolute;left:76.48px;top:547.81px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:547.81px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"</span></div>
<div style="position:absolute;left:211.34px;top:547.81px" class="cls_010"><span class="cls_010">Endereços IP: "</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:563.66px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:563.66px" class="cls_005"><span class="cls_005">addr_list = (</span><span class="cls_014">struct</span><span class="cls_005"> in_addr **)he->h_addr_list;</span></div>
<div style="position:absolute;left:76.48px;top:579.52px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:579.52px" class="cls_014"><span class="cls_014">for</span><span class="cls_005">(i = </span><span class="cls_009">0</span><span class="cls_005">; addr_list[i] != NULL; i++) {</span></div>
<div style="position:absolute;left:76.48px;top:595.37px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:157.60px;top:595.37px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"%s "</span><span class="cls_005">, inet_ntoa(*addr_list[i]));</span></div>
<div style="position:absolute;left:76.48px;top:611.23px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:611.23px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:627.08px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:627.08px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:642.94px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:76.48px;top:658.79px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:658.79px" class="cls_014"><span class="cls_014">return</span><span class="cls_009"> 0</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:674.64px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:103.89px;top:674.64px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:83.19px;top:715.68px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:715.68px" class="cls_013"><span class="cls_013">// ISTO FOI SUPERCEDIDO</span></div>
<div style="position:absolute;left:83.19px;top:731.53px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:731.53px" class="cls_013"><span class="cls_013">// use getnameinfo() em vez de!</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">120 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:102120px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background121.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> hostent *he;</span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr ipv4addr;</span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr ipv6addr;</span></div>
<div style="position:absolute;left:83.19px;top:118.35px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:134.20px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:134.20px" class="cls_005"><span class="cls_005">inet_pton(AF_INET, </span><span class="cls_010">"192.0.2.34"</span><span class="cls_005">, &ipv4addr);</span></div>
<div style="position:absolute;left:83.19px;top:150.06px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:150.06px" class="cls_005"><span class="cls_005">he = gethostbyaddr(&ipv4addr, </span><span class="cls_014">sizeof</span><span class="cls_005"> ipv4addr, AF_INET);</span></div>
<div style="position:absolute;left:76.48px;top:165.91px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:165.91px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Nome de host: %s\n"</span><span class="cls_005">, he->h_name);</span></div>
<div style="position:absolute;left:76.48px;top:181.77px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:197.62px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:197.62px" class="cls_005"><span class="cls_005">inet_pton(AF_INET6, </span><span class="cls_010">"2001:db8:63b3:1::beef"</span><span class="cls_005">, &ipv6addr);</span></div>
<div style="position:absolute;left:76.48px;top:212.54px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:212.54px" class="cls_005"><span class="cls_005">he = gethostbyaddr(&ipv6addr, </span><span class="cls_014">sizeof</span><span class="cls_005"> ipv6addr,</span></div>
<div style="position:absolute;left:109.49px;top:226.53px" class="cls_005"><span class="cls_005">AF_INET6);</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:242.38px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Nome de host: %s\n"</span><span class="cls_005">, he->h_name);</span></div>
<div style="position:absolute;left:60.99px;top:279.19px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:309.00px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">etnameinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostname</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">errno</span><span class="cls_005">, </span><span class="cls_023">perror</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">strerror</span><span class="cls_006">()</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:60.99px;top:324.85px" class="cls_023"><span class="cls_023">struct in</span><span class="cls_006">_</span><span class="cls_023">addr</span></div>
<div style="position:absolute;left:60.99px;top:354.63px" class="cls_007"><span class="cls_007">getnameinfo()</span></div>
<div style="position:absolute;left:60.99px;top:390.95px" class="cls_005"><span class="cls_005">Procura informações do nome do host e do nome do serviço para uma determinada struct</span></div>
<div style="position:absolute;left:60.99px;top:406.80px" class="cls_005"><span class="cls_005">sockaddr.</span></div>
<div style="position:absolute;left:60.99px;top:436.61px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:473.41px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:489.27px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netdb.h></span></div>
<div style="position:absolute;left:94.85px;top:520.97px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getnameinfo(</span><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> sockaddr *sa, socklen_t salen,</span></div>
<div style="position:absolute;left:202.28px;top:536.83px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *host, </span><span class="cls_008">size_t</span><span class="cls_005"> hostlen,</span></div>
<div style="position:absolute;left:202.28px;top:552.68px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *serv, </span><span class="cls_008">size_t</span><span class="cls_005"> servlen, </span><span class="cls_008">int</span><span class="cls_005"> flags);</span></div>
<div style="position:absolute;left:60.99px;top:589.49px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:619.29px" class="cls_005"><span class="cls_005">Esta função é o oposto de getaddrinfo(), isto é, esta função pega uma já carregada</span></div>
<div style="position:absolute;left:60.99px;top:635.15px" class="cls_005"><span class="cls_005">struct sockaddr e faz uma pesquisa de nome e nome de serviço nela. Ela substitui as</span></div>
<div style="position:absolute;left:60.99px;top:651.00px" class="cls_005"><span class="cls_005">antigas funções gethostbyaddr() e getservbyport().</span></div>
<div style="position:absolute;left:60.99px;top:678.05px" class="cls_005"><span class="cls_005">Você deve passar um ponteiro para uma struct sockaddr (que na realidade é</span></div>
<div style="position:absolute;left:60.99px;top:693.90px" class="cls_005"><span class="cls_005">provavelmente uma struct sockaddr_in ou struct sockaddr_in6 que você tenha</span></div>
<div style="position:absolute;left:60.99px;top:709.76px" class="cls_005"><span class="cls_005">convertido) no parâmetro sa, e o comprimento dessa struct em salen.</span></div>
<div style="position:absolute;left:60.99px;top:735.87px" class="cls_005"><span class="cls_005">O nome do host e nome do serviço resultantes serão escritos nas áreas apontadas pelos</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">121 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:102971px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background122.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">parâmetros host e serv. Obviamente, você precisa especi car os comprimentos máximos</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">desses buffers em hostlen e servlen.</span></div>
<div style="position:absolute;left:60.99px;top:97.83px" class="cls_005"><span class="cls_005">Finalmente, existem várias   ags você pode passar, mas aqui estão algumas boas. NI_NOFQDN</span></div>
<div style="position:absolute;left:60.99px;top:113.69px" class="cls_005"><span class="cls_005">fará com que host contenha apenas o nome do host, e não o nome completo do domínio.</span></div>
<div style="position:absolute;left:60.99px;top:129.54px" class="cls_005"><span class="cls_005">NI_NAMEREQD fará com que a função falhe se o nome não puder ser encontrado com uma</span></div>
<div style="position:absolute;left:60.99px;top:144.46px" class="cls_005"><span class="cls_005">pesquisa de DNS (se você não especi car esta   ag e o nome não puder ser encontrado,</span></div>
<div style="position:absolute;left:60.99px;top:159.38px" class="cls_005"><span class="cls_005">getnameinfo() colocará uma versão de string do endereço IP em host no seu lugar.)</span></div>
<div style="position:absolute;left:60.99px;top:185.50px" class="cls_005"><span class="cls_005">Como sempre, veri que as suas man pages locais para informações completas.</span></div>
<div style="position:absolute;left:60.99px;top:214.37px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:243.25px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou diferente de zero em caso de erro. Se o valor de retorno é</span></div>
<div style="position:absolute;left:60.99px;top:258.17px" class="cls_005"><span class="cls_005">diferente de zero, pode ser passado para gai_strerror() para se obter uma string legível</span></div>
<div style="position:absolute;left:60.99px;top:274.02px" class="cls_005"><span class="cls_005">por humanos. Veja getaddrinfo para mais informações.</span></div>
<div style="position:absolute;left:60.99px;top:303.83px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:339.70px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:339.70px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 sa; </span><span class="cls_013">// poderia ser IPv4 se você</span></div>
<div style="position:absolute;left:109.49px;top:353.69px" class="cls_013"><span class="cls_013">quiser</span></div>
<div style="position:absolute;left:83.19px;top:369.54px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:369.54px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> host[</span><span class="cls_009">1024</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:385.40px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:385.40px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> service[</span><span class="cls_009">20</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:401.25px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:416.17px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:416.17px" class="cls_013"><span class="cls_013">// fingir que sa está cheio de boas informações sobre o</span></div>
<div style="position:absolute;left:109.49px;top:430.16px" class="cls_013"><span class="cls_013">host e a porta...</span></div>
<div style="position:absolute;left:83.19px;top:446.02px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:83.19px;top:460.94px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:460.94px" class="cls_005"><span class="cls_005">getnameinfo(&sa, </span><span class="cls_014">sizeof</span><span class="cls_005"> sa, host, </span><span class="cls_014">sizeof</span><span class="cls_005"> host, service,</span></div>
<div style="position:absolute;left:109.49px;top:474.93px" class="cls_014"><span class="cls_014">sizeof</span><span class="cls_005"> service, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:490.78px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:505.70px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:505.70px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"   host: %s\n"</span><span class="cls_005">, host);</span></div>
<div style="position:absolute;left:332.21px;top:505.70px" class="cls_013"><span class="cls_013">// ex.</span></div>
<div style="position:absolute;left:109.49px;top:519.69px" class="cls_013"><span class="cls_013">"</span><A HREF="http://www.example.com"/">www.example.com"</A> </div>
<div style="position:absolute;left:76.48px;top:535.55px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:535.55px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"service: %s\n"</span><span class="cls_005">, service); </span><span class="cls_013">// ex. "http"</span></div>
<div style="position:absolute;left:60.99px;top:572.35px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:602.16px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">addr</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:631.94px" class="cls_007"><span class="cls_007">getpeername()</span></div>
<div style="position:absolute;left:60.99px;top:667.32px" class="cls_005"><span class="cls_005">Retorna informação de endereço sobre o lado remoto da conexão.</span></div>
<div style="position:absolute;left:60.99px;top:696.20px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:733.00px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">122 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:103822px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background123.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:70.79px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getpeername(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_014">struct</span><span class="cls_005"> sockaddr *addr, socklen_t *len);</span></div>
<div style="position:absolute;left:60.99px;top:107.59px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:137.40px" class="cls_005"><span class="cls_005">Uma vez que você tenha aceitado com accept() uma conexão remota, ou conectado com</span></div>
<div style="position:absolute;left:60.99px;top:153.25px" class="cls_005"><span class="cls_005">connect() a um servidor, você agora tem o que é conhecido como um peer (par). Seu par é</span></div>
<div style="position:absolute;left:60.99px;top:168.17px" class="cls_005"><span class="cls_005">simplesmente o computador ao qual você está conectado, identi cado por um endereço IP e</span></div>
<div style="position:absolute;left:60.99px;top:182.16px" class="cls_005"><span class="cls_005">uma porta. Então...</span></div>
<div style="position:absolute;left:60.99px;top:208.27px" class="cls_005"><span class="cls_005">getpeername() simplesmente retorna uma struct sockaddr_in preenchida com</span></div>
<div style="position:absolute;left:60.99px;top:223.20px" class="cls_005"><span class="cls_005">informações sobre a máquina a qual você está conectado.</span></div>
<div style="position:absolute;left:60.99px;top:248.38px" class="cls_005"><span class="cls_005">Por que é chamado um "name"? Bem, há um monte de diferentes tipos de sockets, não apenas</span></div>
<div style="position:absolute;left:60.99px;top:262.37px" class="cls_005"><span class="cls_005">Internet Sockets, como estamos usando neste guia, e então "name" é um bom termo genérico</span></div>
<div style="position:absolute;left:60.99px;top:276.35px" class="cls_005"><span class="cls_005">que cobre todos os casos. No nosso caso, porém, "name" do peer (par) é o seu endereço IP e</span></div>
<div style="position:absolute;left:60.99px;top:290.34px" class="cls_005"><span class="cls_005">porta.</span></div>
<div style="position:absolute;left:60.99px;top:316.46px" class="cls_005"><span class="cls_005">Embora a função retorne o tamanho do endereço resultante em len, é necessário pré-carregar</span></div>
<div style="position:absolute;left:60.99px;top:332.31px" class="cls_005"><span class="cls_005">len com o tamanho de addr.</span></div>
<div style="position:absolute;left:60.99px;top:362.12px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:391.93px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de</span></div>
<div style="position:absolute;left:439.74px;top:391.93px" class="cls_005"><span class="cls_005">nido em</span></div>
<div style="position:absolute;left:60.99px;top:406.85px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:435.72px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:472.53px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:472.53px" class="cls_013"><span class="cls_013">// suponha que s é um socket conectado</span></div>
<div style="position:absolute;left:83.19px;top:488.38px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:504.23px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:504.23px" class="cls_005"><span class="cls_005">socklen_t len;</span></div>
<div style="position:absolute;left:83.19px;top:520.09px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:520.09px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage addr;</span></div>
<div style="position:absolute;left:83.19px;top:535.94px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:535.94px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> ipstr[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:83.19px;top:551.80px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:551.80px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> port;</span></div>
<div style="position:absolute;left:83.19px;top:567.65px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:583.51px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:583.51px" class="cls_005"><span class="cls_005">len = </span><span class="cls_014">sizeof</span><span class="cls_005"> addr;</span></div>
<div style="position:absolute;left:83.19px;top:599.36px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:599.36px" class="cls_005"><span class="cls_005">getpeername(s, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr*)&addr, &len);</span></div>
<div style="position:absolute;left:76.48px;top:615.21px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:631.07px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:631.07px" class="cls_013"><span class="cls_013">// lidar com IPv4 e IPv6:</span></div>
<div style="position:absolute;left:76.48px;top:646.92px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:646.92px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (addr.ss_family == AF_INET) {</span></div>
<div style="position:absolute;left:76.48px;top:661.84px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:661.84px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in *s = (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in</span></div>
<div style="position:absolute;left:109.49px;top:675.83px" class="cls_005"><span class="cls_005">*)&addr;</span></div>
<div style="position:absolute;left:76.48px;top:691.69px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:691.69px" class="cls_005"><span class="cls_005">port = ntohs(s->sin_port);</span></div>
<div style="position:absolute;left:76.48px;top:706.61px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:706.61px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET, &s->sin_addr, ipstr, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:720.60px" class="cls_005"><span class="cls_005">ipstr);</span></div>
<div style="position:absolute;left:76.48px;top:736.45px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:736.45px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> { </span><span class="cls_013">// AF_INET6</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">123 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:104673px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background124.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:130.75px;top:54.00px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 *s = (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">*)&addr;</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:130.75px;top:83.84px" class="cls_005"><span class="cls_005">port = ntohs(s->sin6_port);</span></div>
<div style="position:absolute;left:76.48px;top:98.76px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:130.75px;top:98.76px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET6, &s->sin6_addr, ipstr, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:112.75px" class="cls_005"><span class="cls_005">ipstr);</span></div>
<div style="position:absolute;left:76.48px;top:128.61px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:128.61px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:144.46px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:160.32px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Endereço IP do peer: %s\n"</span><span class="cls_005">, ipstr);</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:176.17px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Porta do peer</span></div>
<div style="position:absolute;left:285.18px;top:176.17px" class="cls_010"><span class="cls_010">: %d\n"</span><span class="cls_005">, port);</span></div>
<div style="position:absolute;left:60.99px;top:212.97px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:242.78px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">ethostname</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">name</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">addr</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:272.57px" class="cls_007"><span class="cls_007">errno</span></div>
<div style="position:absolute;left:60.99px;top:307.95px" class="cls_005"><span class="cls_005">Contém o código de erro da última chamada de sistema.</span></div>
<div style="position:absolute;left:60.99px;top:336.82px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:373.62px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;errno.h></span></div>
<div style="position:absolute;left:94.85px;top:405.33px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> errno;</span></div>
<div style="position:absolute;left:60.99px;top:442.14px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:471.01px" class="cls_005"><span class="cls_005">Essa é a variável que contém informações de erro para muitas chamadas de sistema. Se você</span></div>
<div style="position:absolute;left:60.99px;top:485.93px" class="cls_005"><span class="cls_005">se lembra, coisas como socket() e listen() retornam -1 em caso de erro, e elas de nem</span></div>
<div style="position:absolute;left:60.99px;top:501.79px" class="cls_005"><span class="cls_005">o valor exato de errno para que você saiba especi camente que erro ocorreu.</span></div>
<div style="position:absolute;left:60.99px;top:528.83px" class="cls_005"><span class="cls_005">O arquivo de cabeçalho errno.h lista um monte de nomes simbólicos constantes para erros,</span></div>
<div style="position:absolute;left:60.99px;top:544.69px" class="cls_005"><span class="cls_005">como EADDRINUSE, EPIPE, ECONNREFUSED, etc. Suas man pages locais lhe dirão quais</span></div>
<div style="position:absolute;left:60.99px;top:559.61px" class="cls_005"><span class="cls_005">códigos podem ser retornados como um erro, e você pode usá-los em tempo de execução para</span></div>
<div style="position:absolute;left:60.99px;top:573.60px" class="cls_005"><span class="cls_005">lidar com diferentes erros de diferentes maneiras.</span></div>
<div style="position:absolute;left:60.99px;top:599.71px" class="cls_005"><span class="cls_005">Ou, mais comumente, você pode chamar perror() ou strerror() para obter uma versão</span></div>
<div style="position:absolute;left:60.99px;top:614.63px" class="cls_005"><span class="cls_005">humanamente legível do erro.</span></div>
<div style="position:absolute;left:60.99px;top:639.81px" class="cls_005"><span class="cls_005">Uma coisa a notar, para você estusiasta do multithreading, é que na maioria dos sistemas</span></div>
<div style="position:absolute;left:60.99px;top:654.73px" class="cls_005"><span class="cls_005">errno é de nido de forma thread-safe. (Ou seja, não é realmente uma variável global, mas se</span></div>
<div style="position:absolute;left:60.99px;top:669.65px" class="cls_005"><span class="cls_005">comporta exatamente como uma variável global faria em um ambiente single-threaded).</span></div>
<div style="position:absolute;left:60.99px;top:698.53px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:727.41px" class="cls_005"><span class="cls_005">O valor da variável é o do erro mais recente a ter acontecido, que pode ser o código para o</span></div>
<div style="position:absolute;left:60.99px;top:741.39px" class="cls_005"><span class="cls_005">"sucesso" se a última ação for bem sucedida.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">124 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:105524px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background125.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:90.80px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:90.80px" class="cls_005"><span class="cls_005">s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:106.66px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:106.66px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (s == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:83.19px;top:122.51px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:130.75px;top:122.51px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"socket"</span><span class="cls_005">); </span><span class="cls_013">// ou use strerror()</span></div>
<div style="position:absolute;left:83.19px;top:138.37px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:138.37px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:83.19px;top:154.22px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:170.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:170.07px" class="cls_005"><span class="cls_005">tryagain:</span></div>
<div style="position:absolute;left:83.19px;top:185.93px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:185.93px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (select(n, &readfds, NULL, NULL) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:83.19px;top:201.78px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:130.75px;top:201.78px" class="cls_013"><span class="cls_013">// ocorreu um erro!!</span></div>
<div style="position:absolute;left:83.19px;top:217.64px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:232.56px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:130.75px;top:232.56px" class="cls_013"><span class="cls_013">// se formos interrompidos, basta reiniciar a</span></div>
<div style="position:absolute;left:109.49px;top:246.55px" class="cls_013"><span class="cls_013">chamada select():</span></div>
<div style="position:absolute;left:76.48px;top:262.40px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:130.75px;top:262.40px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (errno == EINTR) </span><span class="cls_014">goto</span><span class="cls_005"> tryagain;</span></div>
<div style="position:absolute;left:373.89px;top:262.40px" class="cls_013"><span class="cls_013">// AAAA! goto!!!</span></div>
<div style="position:absolute;left:76.48px;top:278.25px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:294.11px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:294.11px" class="cls_013"><span class="cls_013">// caso contrário, é um erro mais sério:</span></div>
<div style="position:absolute;left:76.48px;top:309.96px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:130.75px;top:309.96px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"select"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:325.82px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:130.75px;top:325.82px" class="cls_005"><span class="cls_005">exit(</span><span class="cls_009">1</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:341.67px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:341.67px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:378.47px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:408.28px" class="cls_023"><span class="cls_023">perror</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">strerror</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:438.07px" class="cls_007"><span class="cls_007">fcntl()</span></div>
<div style="position:absolute;left:60.99px;top:473.45px" class="cls_005"><span class="cls_005">Controla descritores de socket</span></div>
<div style="position:absolute;left:60.99px;top:502.32px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:539.13px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/unistd.h></span></div>
<div style="position:absolute;left:94.85px;top:554.98px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/fcntl.h></span></div>
<div style="position:absolute;left:94.85px;top:586.69px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fcntl(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">int</span><span class="cls_005"> cmd, </span><span class="cls_008">long</span><span class="cls_005"> arg);</span></div>
<div style="position:absolute;left:60.99px;top:623.49px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:652.37px" class="cls_005"><span class="cls_005">Esta função é normalmente usada para realizar bloqueio de arquivos e outras coisas</span></div>
<div style="position:absolute;left:60.99px;top:666.36px" class="cls_005"><span class="cls_005">relacionadas, mas também possui algumas habilidades relacionadas a sockets que você pode</span></div>
<div style="position:absolute;left:60.99px;top:680.34px" class="cls_005"><span class="cls_005">ver ou usar de tempos em tempos.</span></div>
<div style="position:absolute;left:60.99px;top:706.46px" class="cls_005"><span class="cls_005">O parâmetro s é o descritor de socket no qual você deseja operar, o cmd deve ser de nido</span></div>
<div style="position:absolute;left:60.99px;top:722.31px" class="cls_005"><span class="cls_005">como F_SETFL e arg pode ser um dos seguintes comandos. (Como eu disse, há mais sobre</span></div>
<div style="position:absolute;left:60.99px;top:738.17px" class="cls_005"><span class="cls_005">fcntl() do que eu estou deixando aqui, mas eu estou tentando me manter voltado a</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">125 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:106375px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background126.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">sockets.)</span></div>
<div style="position:absolute;left:94.58px;top:88.04px" class="cls_025"><span class="cls_025">cmd</span></div>
<div style="position:absolute;left:314.88px;top:88.04px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:156.01px;top:104.36px" class="cls_005"><span class="cls_005">Con gura o socket para non-blocking. Veja a seção sobre </span><span class="cls_023">blockin</span><span class="cls_006">g</span><span class="cls_005"> para</span></div>
<div style="position:absolute;left:69.39px;top:111.35px" class="cls_005"><span class="cls_005">O_NONBLOCK</span></div>
<div style="position:absolute;left:156.01px;top:118.35px" class="cls_005"><span class="cls_005">mais detalhes.</span></div>
<div style="position:absolute;left:156.01px;top:133.74px" class="cls_005"><span class="cls_005">De na o socket para executar E/S assíncrona. Quando os dados</span></div>
<div style="position:absolute;left:156.01px;top:148.66px" class="cls_005"><span class="cls_005">estiverem prontos para serem recebidos com recv() no socket, o sinal</span></div>
<div style="position:absolute;left:69.39px;top:156.59px" class="cls_005"><span class="cls_005">O_ASYNC</span></div>
<div style="position:absolute;left:156.01px;top:164.51px" class="cls_005"><span class="cls_005">SIGIO será aumentado. Isso é raro de se ver, e está além do escopo deste</span></div>
<div style="position:absolute;left:156.01px;top:179.43px" class="cls_005"><span class="cls_005">guia. E acho que está disponível apenas em determinados sistemas.</span></div>
<div style="position:absolute;left:60.99px;top:217.64px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:247.44px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:262.37px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:288.48px" class="cls_005"><span class="cls_005">Diferentes usos da chamada de sistema fcntl() na verdade possuem valores de retorno</span></div>
<div style="position:absolute;left:60.99px;top:303.40px" class="cls_005"><span class="cls_005">diferentes, mas eu não os cobrirei aqui porque eles não são relacionados a sockets. Consulte a</span></div>
<div style="position:absolute;left:60.99px;top:318.32px" class="cls_005"><span class="cls_005">sua página man local de fcntl() para mais informações.</span></div>
<div style="position:absolute;left:60.99px;top:348.13px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:384.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:384.93px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:400.79px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:415.71px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:415.71px" class="cls_005"><span class="cls_005">fcntl(s, F_SETFL, O_NONBLOCK);</span></div>
<div style="position:absolute;left:318.78px;top:415.71px" class="cls_013"><span class="cls_013">// configura para non-</span></div>
<div style="position:absolute;left:109.49px;top:429.70px" class="cls_013"><span class="cls_013">blocking</span></div>
<div style="position:absolute;left:83.19px;top:444.62px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:444.62px" class="cls_005"><span class="cls_005">fcntl(s, F_SETFL, O_ASYNC);</span></div>
<div style="position:absolute;left:318.78px;top:444.62px" class="cls_013"><span class="cls_013">// configura E/S</span></div>
<div style="position:absolute;left:109.49px;top:458.61px" class="cls_013"><span class="cls_013">assíncrona</span></div>
<div style="position:absolute;left:60.99px;top:495.41px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:525.22px" class="cls_023"><span class="cls_023">Blockin</span><span class="cls_006">g</span><span class="cls_005">, </span><span class="cls_023">send</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:555.00px" class="cls_007"><span class="cls_007">htons(), htonl(), ntohs(), ntohl()</span></div>
<div style="position:absolute;left:60.99px;top:590.38px" class="cls_005"><span class="cls_005">Converte tipos inteiros multi-byte de host byte order para network byte order.</span></div>
<div style="position:absolute;left:60.99px;top:619.26px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:656.06px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:94.85px;top:687.77px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> htonl(</span><span class="cls_008">uint32_t</span><span class="cls_005"> hostlong);</span></div>
<div style="position:absolute;left:94.85px;top:703.62px" class="cls_008"><span class="cls_008">uint16_t</span><span class="cls_005"> htons(</span><span class="cls_008">uint16_t</span><span class="cls_005"> hostshort);</span></div>
<div style="position:absolute;left:94.85px;top:719.48px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> ntohl(</span><span class="cls_008">uint32_t</span><span class="cls_005"> netlong);</span></div>
<div style="position:absolute;left:94.85px;top:735.33px" class="cls_008"><span class="cls_008">uint16_t</span><span class="cls_005"> ntohs(</span><span class="cls_008">uint16_t</span><span class="cls_005"> netshort);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">126 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:107226px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background127.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:82.88px" class="cls_005"><span class="cls_005">Apenas para fazer você realmente infeliz, computadores diferentes usam diferentes</span></div>
<div style="position:absolute;left:60.99px;top:96.86px" class="cls_005"><span class="cls_005">ordenações de bytes internamente para seus inteiros multi-byte (ou seja, qualquer número</span></div>
<div style="position:absolute;left:60.99px;top:111.79px" class="cls_005"><span class="cls_005">inteiro que seja maior que um char.) O resultado disso é que se você envia um short int de</span></div>
<div style="position:absolute;left:60.99px;top:127.64px" class="cls_005"><span class="cls_005">dois bytes com send() a partir de um ambiente Intel para um Mac (antes de ambos se</span></div>
<div style="position:absolute;left:60.99px;top:142.56px" class="cls_005"><span class="cls_005">tornarem ambientes Intel, também, quero dizer), o que um computador pensa é que o número é</span></div>
<div style="position:absolute;left:60.99px;top:157.48px" class="cls_005"><span class="cls_005">1, o outro pensará que é o número 256, e vice-versa.</span></div>
<div style="position:absolute;left:60.99px;top:183.60px" class="cls_005"><span class="cls_005">A maneira de contornar este problema é que todos deixam de lado suas diferenças e</span></div>
<div style="position:absolute;left:60.99px;top:197.59px" class="cls_005"><span class="cls_005">concordam que a Motorola e a IBM tinham razão, e a Intel fez isso da maneira estranha, e</span></div>
<div style="position:absolute;left:60.99px;top:211.57px" class="cls_005"><span class="cls_005">assim todos nós convertemos nossas ordenações de bytes para "big-endian" antes de enviá-</span></div>
<div style="position:absolute;left:60.99px;top:225.56px" class="cls_005"><span class="cls_005">las. Como a Intel usa máquinas "little-endian", é bem mais politicamente correto chamar nossa</span></div>
<div style="position:absolute;left:60.99px;top:239.55px" class="cls_005"><span class="cls_005">ordenação de bytes preferida de "Network Byte Order". Portanto, essas funções convertem de</span></div>
<div style="position:absolute;left:60.99px;top:253.54px" class="cls_005"><span class="cls_005">sua ordem de bytes nativa para ordem de bytes de rede e de volta.</span></div>
<div style="position:absolute;left:60.99px;top:278.72px" class="cls_005"><span class="cls_005">(Isto signi ca que em Intel essas funções trocam todos os bytes, e em PowerPC elas não</span></div>
<div style="position:absolute;left:60.99px;top:292.71px" class="cls_005"><span class="cls_005">fazem nada porque os bytes já estão em Network Byte Order. Mas você deve sempre usá-las</span></div>
<div style="position:absolute;left:60.99px;top:306.70px" class="cls_005"><span class="cls_005">em seus códigos de qualquer maneira, uma vez que alguém possa querer construí-los em uma</span></div>
<div style="position:absolute;left:60.99px;top:320.69px" class="cls_005"><span class="cls_005">máquina Intel e ainda terá as coisas funcionando adequadamente.)</span></div>
<div style="position:absolute;left:60.99px;top:346.80px" class="cls_005"><span class="cls_005">Note que os tipos envolvidos são de 32 bits (4 bytes, provavelmente int) e de 16 bits (dois</span></div>
<div style="position:absolute;left:60.99px;top:362.65px" class="cls_005"><span class="cls_005">bytes, muito provavelmente short). Máquinas de 64 bits podem ter um htonll() ints de</span></div>
<div style="position:absolute;left:60.99px;top:377.58px" class="cls_005"><span class="cls_005">64bits, mas eu desconheço. Você só terá que escrever o seu próprio.</span></div>
<div style="position:absolute;left:60.99px;top:402.76px" class="cls_005"><span class="cls_005">De qualquer forma, a maneira como essas funções trabalham é que primeiro você decide se</span></div>
<div style="position:absolute;left:60.99px;top:416.75px" class="cls_005"><span class="cls_005">está convertendo de host byte order (da sua máquina) ou de network byte order. Se "host", a</span></div>
<div style="position:absolute;left:60.99px;top:430.73px" class="cls_005"><span class="cls_005">primeira letra da função que você vai chamar é "h". Caso contrário, é "n" para "network". O meio</span></div>
<div style="position:absolute;left:60.99px;top:444.72px" class="cls_005"><span class="cls_005">do nome da função é sempre "to" porque você está convertendo de um "para" o outro, e a</span></div>
<div style="position:absolute;left:60.99px;top:458.71px" class="cls_005"><span class="cls_005">penúltima letra mostra o que você está convertendo to. A última letra é o tamanho dos dados,</span></div>
<div style="position:absolute;left:60.99px;top:472.70px" class="cls_005"><span class="cls_005">"s" para short, ou "l" para long. Assim:</span></div>
<div style="position:absolute;left:214.81px;top:505.81px" class="cls_025"><span class="cls_025">Fun</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:302.77px;top:505.81px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:210.38px;top:522.13px" class="cls_005"><span class="cls_005">htons()   host to network short</span></div>
<div style="position:absolute;left:210.38px;top:539.38px" class="cls_005"><span class="cls_005">htonl()   host to network long</span></div>
<div style="position:absolute;left:210.38px;top:556.64px" class="cls_005"><span class="cls_005">ntohs()   network to host short</span></div>
<div style="position:absolute;left:210.38px;top:573.89px" class="cls_005"><span class="cls_005">ntohl()   network to host long</span></div>
<div style="position:absolute;left:60.99px;top:613.02px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:641.90px" class="cls_005"><span class="cls_005">Cada função retorna o valor convertido.</span></div>
<div style="position:absolute;left:60.99px;top:670.77px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:707.58px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:707.58px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> some_long = </span><span class="cls_009">10</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:723.43px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:723.43px" class="cls_008"><span class="cls_008">uint16_t</span><span class="cls_005"> some_short = </span><span class="cls_009">20</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:739.28px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">127 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:108077px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background128.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:54.93px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_008"><span class="cls_008">uint32_t</span><span class="cls_005"> network_byte_order;</span></div>
<div style="position:absolute;left:83.19px;top:70.79px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:86.64px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:86.64px" class="cls_013"><span class="cls_013">// converter e enviar</span></div>
<div style="position:absolute;left:83.19px;top:102.50px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:102.50px" class="cls_005"><span class="cls_005">network_byte_order = htonl(some_long);</span></div>
<div style="position:absolute;left:83.19px;top:118.35px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_005"><span class="cls_005">send(s, &network_byte_order, </span><span class="cls_014">sizeof</span><span class="cls_005">(</span><span class="cls_008">uint32_t</span><span class="cls_005">), </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:134.20px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:149.12px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:149.12px" class="cls_005"><span class="cls_005">some_short == ntohs(htons(some_short)); </span><span class="cls_013">// essa</span></div>
<div style="position:absolute;left:109.49px;top:163.11px" class="cls_013"><span class="cls_013">expressão é verdadeira</span></div>
<div style="position:absolute;left:60.99px;top:199.89px" class="cls_007"><span class="cls_007">inet_ntoa(), inet_aton(), inet_addr</span></div>
<div style="position:absolute;left:60.99px;top:236.21px" class="cls_005"><span class="cls_005">Converte endereços IP de uma string de pontos-e-números para uma struct in_addr e de</span></div>
<div style="position:absolute;left:60.99px;top:251.13px" class="cls_005"><span class="cls_005">volta.</span></div>
<div style="position:absolute;left:60.99px;top:280.00px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:316.81px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:332.66px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:94.85px;top:348.51px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:94.85px;top:379.29px" class="cls_013"><span class="cls_013">// TODAS ESTAS FORAM </span><span class="cls_020">DESCONTINUADAS</span><span class="cls_013">! Use inet_pton() ou</span></div>
<div style="position:absolute;left:123.94px;top:393.28px" class="cls_013"><span class="cls_013">inet_ntop()!</span></div>
<div style="position:absolute;left:94.85px;top:424.99px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *inet_ntoa(</span><span class="cls_014">struct</span><span class="cls_005"> in_addr in);</span></div>
<div style="position:absolute;left:94.85px;top:440.84px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> inet_aton(</span><span class="cls_008">const  char</span><span class="cls_005"> *cp, </span><span class="cls_014">struct</span><span class="cls_005"> in_addr *inp);</span></div>
<div style="position:absolute;left:94.85px;top:456.70px" class="cls_005"><span class="cls_005">in_addr_t inet_addr(</span><span class="cls_008">const  char</span><span class="cls_005"> *cp);</span></div>
<div style="position:absolute;left:60.99px;top:493.50px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:523.31px" class="cls_005"><span class="cls_005">Estas funções são obsoletas porque não lidam com IPv6! Use inet_ntop() ou</span></div>
<div style="position:absolute;left:60.99px;top:539.16px" class="cls_005"><span class="cls_005">inet_pton() em vez disso! Elas estão incluídas aqui porque ainda podem ser encontradas</span></div>
<div style="position:absolute;left:60.99px;top:554.08px" class="cls_005"><span class="cls_005">na natureza.</span></div>
<div style="position:absolute;left:60.99px;top:580.19px" class="cls_005"><span class="cls_005">Todas essas funções convertem de uma struct in_addr (parte de sua struct</span></div>
<div style="position:absolute;left:60.99px;top:596.05px" class="cls_005"><span class="cls_005">sockaddr_in, o mais provável) para uma string no formato de pontos-e-números (por</span></div>
<div style="position:absolute;left:60.99px;top:610.97px" class="cls_005"><span class="cls_005">exemplo, "192.168.5.10") e vice-versa. Se você tem um endereço IP passado na linha de</span></div>
<div style="position:absolute;left:60.99px;top:625.89px" class="cls_005"><span class="cls_005">comando ou algo assim, esta é a maneira mais fácil de obter uma struct in_addr para</span></div>
<div style="position:absolute;left:60.99px;top:641.75px" class="cls_005"><span class="cls_005">connect(), ou qualquer outra coisa. Se você precisar de mais energia, tente algumas das</span></div>
<div style="position:absolute;left:60.99px;top:657.60px" class="cls_005"><span class="cls_005">funções DNS, como gethostbyname() ou tente um golpe de estado em seu país local.</span></div>
<div style="position:absolute;left:60.99px;top:684.65px" class="cls_005"><span class="cls_005">A função inet_ntoa() converte um endereço de rede de uma struct in_addr para uma</span></div>
<div style="position:absolute;left:60.99px;top:699.57px" class="cls_005"><span class="cls_005">string de formato pontos-e-números. O "n" em "ntoa" signi ca network, e o "a" signi ca ASCII</span></div>
<div style="position:absolute;left:60.99px;top:713.56px" class="cls_005"><span class="cls_005">por razões históricas (então isso é "Network To ASCII"—o su xo "toa" tem um amigo análogo</span></div>
<div style="position:absolute;left:60.99px;top:728.48px" class="cls_005"><span class="cls_005">na biblioteca C chamada atoi() que converte uma cadeia de caracteres ASCII em um número</span></div>
<div style="position:absolute;left:60.99px;top:743.40px" class="cls_005"><span class="cls_005">inteiro.)</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">128 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:108928px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background129.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">A função inet_aton() é o oposto, convertendo de uma string de pontos-e-números em uma</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">in_addr_t (que é o tipo do campo s_addr na tua struct in_addr.)</span></div>
<div style="position:absolute;left:60.99px;top:97.83px" class="cls_005"><span class="cls_005">Finalmente, a função inet_addr() é uma função antiga que faz basicamente a mesma coisa</span></div>
<div style="position:absolute;left:60.99px;top:113.69px" class="cls_005"><span class="cls_005">que inet_aton(). Está teoricamente obsoleta, mas você a verá muito e a polícia não virá</span></div>
<div style="position:absolute;left:60.99px;top:128.61px" class="cls_005"><span class="cls_005">buscá-lo se você a usar.</span></div>
<div style="position:absolute;left:60.99px;top:157.48px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:187.29px" class="cls_005"><span class="cls_005">inet_aton() retorna diferente de zero se o endereço for válido, e retorna zero se o endereço</span></div>
<div style="position:absolute;left:60.99px;top:202.21px" class="cls_005"><span class="cls_005">for inválido.</span></div>
<div style="position:absolute;left:60.99px;top:228.33px" class="cls_005"><span class="cls_005">inet_ntoa() retorna string de pontos-e-números em um buffer estático que é sobrescrito a</span></div>
<div style="position:absolute;left:60.99px;top:243.25px" class="cls_005"><span class="cls_005">cada chamada para a função.</span></div>
<div style="position:absolute;left:60.99px;top:269.36px" class="cls_005"><span class="cls_005">inet_addr() retorna o endereço como um in_addr_t, ou -1 se houver um erro. (Que é o</span></div>
<div style="position:absolute;left:60.99px;top:285.21px" class="cls_005"><span class="cls_005">mesmo resultado como se você tentasse converter a string "255.255.255.255", que é um</span></div>
<div style="position:absolute;left:60.99px;top:301.07px" class="cls_005"><span class="cls_005">endereço IP válido. É por isso que inet_aton() é melhor.)</span></div>
<div style="position:absolute;left:60.99px;top:330.88px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:367.68px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:367.68px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in antelope;</span></div>
<div style="position:absolute;left:83.19px;top:383.53px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:383.53px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *some_addr;</span></div>
<div style="position:absolute;left:83.19px;top:399.39px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:414.31px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:414.31px" class="cls_005"><span class="cls_005">inet_aton(</span><span class="cls_010">"10.0.0.1"</span><span class="cls_005">, &antelope.sin_addr); </span><span class="cls_013">// armazena</span></div>
<div style="position:absolute;left:109.49px;top:428.30px" class="cls_013"><span class="cls_013">IP em antelope</span></div>
<div style="position:absolute;left:83.19px;top:444.15px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:459.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:459.07px" class="cls_005"><span class="cls_005">some_addr = inet_ntoa(antelope.sin_addr); </span><span class="cls_013">// retorna o</span></div>
<div style="position:absolute;left:109.49px;top:473.06px" class="cls_013"><span class="cls_013">IP</span></div>
<div style="position:absolute;left:83.19px;top:488.92px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:488.92px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"%s\n"</span><span class="cls_005">, some_addr); </span><span class="cls_013">// prints "10.0.0.1"</span></div>
<div style="position:absolute;left:83.19px;top:504.77px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:519.69px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:519.69px" class="cls_013"><span class="cls_013">// e esta chamada é a mesma que a chamada inet_aton(),</span></div>
<div style="position:absolute;left:109.49px;top:533.68px" class="cls_013"><span class="cls_013">acima:</span></div>
<div style="position:absolute;left:76.48px;top:549.54px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:549.54px" class="cls_005"><span class="cls_005">antelope.sin_addr.s_addr = inet_addr(</span><span class="cls_010">"10.0.0.1"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:60.99px;top:586.34px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:616.15px" class="cls_023"><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">ntop</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">pton</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">name</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">ethostb</span><span class="cls_006">y</span><span class="cls_023">addr</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:645.93px" class="cls_007"><span class="cls_007">inet_ntop(), inet_pton()</span></div>
<div style="position:absolute;left:60.99px;top:681.31px" class="cls_005"><span class="cls_005">Converte endereços IP para um formato humanamente legível e de volta.</span></div>
<div style="position:absolute;left:60.99px;top:710.19px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:746.99px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;arpa/inet.h></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">129 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:109779px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background130.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:70.79px" class="cls_008"><span class="cls_008">const  char</span><span class="cls_005"> *inet_ntop(</span><span class="cls_008">int</span><span class="cls_005"> af, </span><span class="cls_008">const  void</span><span class="cls_005"> *src,</span></div>
<div style="position:absolute;left:242.57px;top:86.64px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *dst, socklen_t size);</span></div>
<div style="position:absolute;left:94.85px;top:118.35px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> inet_pton(</span><span class="cls_008">int</span><span class="cls_005"> af, </span><span class="cls_008">const  char</span><span class="cls_005"> *src, </span><span class="cls_008">void</span><span class="cls_005"> *dst);</span></div>
<div style="position:absolute;left:60.99px;top:155.15px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:184.03px" class="cls_005"><span class="cls_005">Essas funções permitem lidar com endereços IP legíveis convertendo-os em suas</span></div>
<div style="position:absolute;left:60.99px;top:198.02px" class="cls_005"><span class="cls_005">representações binárias para uso com várias funções e chamadas de sistema. O "n" signi ca</span></div>
<div style="position:absolute;left:60.99px;top:212.01px" class="cls_005"><span class="cls_005">"network" e "p" para "presentation". Ou "text presentation". Mas você pode pensar nisso como</span></div>
<div style="position:absolute;left:60.99px;top:225.99px" class="cls_005"><span class="cls_005">"printable". "ntop" é "network to printable". Vê?</span></div>
<div style="position:absolute;left:60.99px;top:251.17px" class="cls_005"><span class="cls_005">Às vezes você não quer olhar para uma pilha de números binários ao olhar para um endereço</span></div>
<div style="position:absolute;left:60.99px;top:266.10px" class="cls_005"><span class="cls_005">IP. Você quer isso em uma boa forma para impressão, como 192.0.2.180 ou</span></div>
<div style="position:absolute;left:60.99px;top:281.95px" class="cls_005"><span class="cls_005">2001:db8:8714:3a90::12. Nesse caso, inet_ntop() é para você.</span></div>
<div style="position:absolute;left:60.99px;top:309.00px" class="cls_005"><span class="cls_005">inet_ntop() usa a família de endereços no parâmetro af (ou AF_INET ou AF_INET6). O</span></div>
<div style="position:absolute;left:60.99px;top:324.85px" class="cls_005"><span class="cls_005">parâmetro src deve ser um ponteiro para uma struct in_addr ou struct in6_addr</span></div>
<div style="position:absolute;left:60.99px;top:340.70px" class="cls_005"><span class="cls_005">contendo o endereço que você deseja converter para uma string. Finalmente dst e size são o</span></div>
<div style="position:absolute;left:60.99px;top:355.63px" class="cls_005"><span class="cls_005">ponteiro para a string destino e o comprimento máximo dessa string.</span></div>
<div style="position:absolute;left:60.99px;top:381.74px" class="cls_005"><span class="cls_005">Qual deve ser o comprimento máximo da string dst? Qual é o comprimento máximo para</span></div>
<div style="position:absolute;left:60.99px;top:396.66px" class="cls_005"><span class="cls_005">endereços IPv4 e IPv6? Felizmente há um par de macros para ajudá-lo. Os comprimentos</span></div>
<div style="position:absolute;left:60.99px;top:411.58px" class="cls_005"><span class="cls_005">máximos são: INET_ADDRSTRLEN e INET6_ADDRSTRLEN.</span></div>
<div style="position:absolute;left:60.99px;top:437.69px" class="cls_005"><span class="cls_005">Outras vezes, você pode ter uma string contendo um endereço IP em formato legível, e você</span></div>
<div style="position:absolute;left:60.99px;top:452.62px" class="cls_005"><span class="cls_005">quer embalá-la em uma struct sockaddr_in ou struct sockaddr_in6. Nesse caso, a</span></div>
<div style="position:absolute;left:60.99px;top:468.47px" class="cls_005"><span class="cls_005">função oposta inet_pton() é o que você está procurando.</span></div>
<div style="position:absolute;left:60.99px;top:495.52px" class="cls_005"><span class="cls_005">inet_pton() também usa uma família de endereços (ou AF_INET ou AF_INET6) no</span></div>
<div style="position:absolute;left:60.99px;top:511.37px" class="cls_005"><span class="cls_005">parâmetro af. O parâmetro src é um ponteiro para uma string contendo o endereço IP no</span></div>
<div style="position:absolute;left:60.99px;top:527.22px" class="cls_005"><span class="cls_005">formato imprimível. Por  m o parâmetro dst aponta para onde o resultado deve ser</span></div>
<div style="position:absolute;left:60.99px;top:543.08px" class="cls_005"><span class="cls_005">armazenado, que é provavelmente uma struct in_addr ou struct in6_addr.</span></div>
<div style="position:absolute;left:60.99px;top:570.12px" class="cls_005"><span class="cls_005">Estas funções não fazem pesquisas de DNS—você precisará da função getaddrinfo() para</span></div>
<div style="position:absolute;left:60.99px;top:585.04px" class="cls_005"><span class="cls_005">isso.</span></div>
<div style="position:absolute;left:60.99px;top:613.92px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:643.73px" class="cls_005"><span class="cls_005">inet_ntop() retorna o parâmetro dst em sucesso, ou NULL em caso de falha (e errno é</span></div>
<div style="position:absolute;left:60.99px;top:658.65px" class="cls_005"><span class="cls_005">de nido).</span></div>
<div style="position:absolute;left:60.99px;top:684.76px" class="cls_005"><span class="cls_005">inet_pton() retorna 1 em caso de sucesso. Isto retorna -1 se houver erro (errno é</span></div>
<div style="position:absolute;left:60.99px;top:700.62px" class="cls_005"><span class="cls_005">de nido), ou 0 se a entrada não é um endereço IP válido.</span></div>
<div style="position:absolute;left:60.99px;top:730.42px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">130 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:110630px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background131.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.19px;top:61.93px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:61.93px" class="cls_013"><span class="cls_013">// demonstração IPv4 de inet_ntop() e inet_pton()</span></div>
<div style="position:absolute;left:83.19px;top:77.78px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:93.64px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:93.64px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in sa;</span></div>
<div style="position:absolute;left:83.19px;top:109.49px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:109.49px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> str[INET_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:83.19px;top:125.34px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:141.20px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:141.20px" class="cls_013"><span class="cls_013">// armazene esse endereço IP em sa:</span></div>
<div style="position:absolute;left:83.19px;top:157.05px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:157.05px" class="cls_005"><span class="cls_005">inet_pton(AF_INET, </span><span class="cls_010">"192.0.2.33"</span><span class="cls_005">, &(sa.sin_addr));</span></div>
<div style="position:absolute;left:83.19px;top:172.91px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:188.76px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:188.76px" class="cls_013"><span class="cls_013">// agora recupere e imprima</span></div>
<div style="position:absolute;left:76.48px;top:203.68px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:203.68px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET, &(sa.sin_addr), str,</span></div>
<div style="position:absolute;left:109.49px;top:217.67px" class="cls_005"><span class="cls_005">INET_ADDRSTRLEN);</span></div>
<div style="position:absolute;left:76.48px;top:233.53px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:249.38px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:249.38px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"%s\n"</span><span class="cls_005">, str); </span><span class="cls_013">// imprime "192.0.2.33"</span></div>
<div style="position:absolute;left:83.19px;top:290.41px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:290.41px" class="cls_013"><span class="cls_013">// demonstração IPv6 de inet_ntop() e inet_pton()</span></div>
<div style="position:absolute;left:83.19px;top:305.34px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:305.34px" class="cls_013"><span class="cls_013">// (basicamente o mesmo, exceto por ter um monte de 6s</span></div>
<div style="position:absolute;left:109.49px;top:319.32px" class="cls_013"><span class="cls_013">ao redor)</span></div>
<div style="position:absolute;left:83.19px;top:335.18px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:351.03px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:351.03px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 sa;</span></div>
<div style="position:absolute;left:83.19px;top:366.89px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:366.89px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> str[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:83.19px;top:382.74px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:83.19px;top:398.59px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:398.59px" class="cls_013"><span class="cls_013">// armazena esse endereço IP em sa:</span></div>
<div style="position:absolute;left:83.19px;top:413.52px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:413.52px" class="cls_005"><span class="cls_005">inet_pton(AF_INET6, </span><span class="cls_010">"2001:db8:8714:3a90::12"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:427.51px" class="cls_005"><span class="cls_005">&(sa.sin6_addr));</span></div>
<div style="position:absolute;left:83.19px;top:443.36px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:459.21px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:459.21px" class="cls_013"><span class="cls_013">// agora recupere e imprima</span></div>
<div style="position:absolute;left:76.48px;top:474.14px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:474.14px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET6, &(sa.sin6_addr), str,</span></div>
<div style="position:absolute;left:109.49px;top:488.12px" class="cls_005"><span class="cls_005">INET6_ADDRSTRLEN);</span></div>
<div style="position:absolute;left:76.48px;top:503.98px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:519.83px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:519.83px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"%s\n"</span><span class="cls_005">, str); </span><span class="cls_013">// imprima "2001:db8:8714:3a90::12"</span></div>
<div style="position:absolute;left:83.19px;top:560.87px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:560.87px" class="cls_013"><span class="cls_013">// Função auxiliar que você pode usar:</span></div>
<div style="position:absolute;left:83.19px;top:576.72px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:591.64px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:591.64px" class="cls_013"><span class="cls_013">// Converte um endereço de struct sockaddr em uma</span></div>
<div style="position:absolute;left:109.49px;top:605.63px" class="cls_013"><span class="cls_013">string, IPv4 e IPv6:</span></div>
<div style="position:absolute;left:83.19px;top:621.49px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:636.41px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:636.41px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *get_ip_str(</span><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> sockaddr *sa, </span><span class="cls_008">char</span><span class="cls_005"> *s,</span></div>
<div style="position:absolute;left:109.49px;top:650.40px" class="cls_008"><span class="cls_008">size_t</span><span class="cls_005"> maxlen)</span></div>
<div style="position:absolute;left:83.19px;top:666.25px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:666.25px" class="cls_005"><span class="cls_005">{</span></div>
<div style="position:absolute;left:83.19px;top:682.10px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:682.10px" class="cls_014"><span class="cls_014">switch</span><span class="cls_005">(sa->sa_family) {</span></div>
<div style="position:absolute;left:83.19px;top:697.96px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:157.61px;top:697.96px" class="cls_014"><span class="cls_014">case</span><span class="cls_005"> AF_INET:</span></div>
<div style="position:absolute;left:83.19px;top:712.88px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:184.46px;top:712.88px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET, &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in</span></div>
<div style="position:absolute;left:109.49px;top:726.87px" class="cls_005"><span class="cls_005">*)sa)->sin_addr),</span></div>
<div style="position:absolute;left:76.48px;top:742.72px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:238.17px;top:742.72px" class="cls_005"><span class="cls_005">s, maxlen);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">131 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:111481px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background132.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:184.47px;top:54.93px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:157.61px;top:86.64px" class="cls_014"><span class="cls_014">case</span><span class="cls_005"> AF_INET6:</span></div>
<div style="position:absolute;left:76.48px;top:101.56px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:184.46px;top:101.56px" class="cls_005"><span class="cls_005">inet_ntop(AF_INET6, &(((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6</span></div>
<div style="position:absolute;left:109.49px;top:115.55px" class="cls_005"><span class="cls_005">*)sa)->sin6_addr),</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:238.17px;top:131.41px" class="cls_005"><span class="cls_005">s, maxlen);</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:184.47px;top:147.26px" class="cls_014"><span class="cls_014">break</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:163.11px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:178.97px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:157.61px;top:178.97px" class="cls_014"><span class="cls_014">default</span><span class="cls_005">:</span></div>
<div style="position:absolute;left:76.48px;top:194.82px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:184.46px;top:194.82px" class="cls_005"><span class="cls_005">strncpy(s, </span><span class="cls_010">"Unknown AF"</span><span class="cls_005">, maxlen);</span></div>
<div style="position:absolute;left:76.48px;top:210.68px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:184.47px;top:210.68px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> NULL;</span></div>
<div style="position:absolute;left:76.48px;top:226.53px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:130.75px;top:226.53px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:242.38px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:258.24px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:130.75px;top:258.24px" class="cls_014"><span class="cls_014">return</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:76.48px;top:274.09px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:274.09px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:310.90px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:340.70px" class="cls_006"><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:370.49px" class="cls_007"><span class="cls_007">listen()</span></div>
<div style="position:absolute;left:60.99px;top:405.87px" class="cls_005"><span class="cls_005">Diga a um socket para ouvir as conexões recebidas.</span></div>
<div style="position:absolute;left:60.99px;top:434.74px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:471.55px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:503.26px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> listen(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">int</span><span class="cls_005"> backlog);</span></div>
<div style="position:absolute;left:60.99px;top:540.06px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:569.87px" class="cls_005"><span class="cls_005">Você pode obter o seu descritor de socket (feito com a chamada de sistema socket()) e</span></div>
<div style="position:absolute;left:60.99px;top:584.79px" class="cls_005"><span class="cls_005">dizer-lhe para ouvir conexões de entrada. Isto é o que diferencia os servidores dos clientes,</span></div>
<div style="position:absolute;left:60.99px;top:598.78px" class="cls_005"><span class="cls_005">pessoal.</span></div>
<div style="position:absolute;left:60.99px;top:624.89px" class="cls_005"><span class="cls_005">O parâmetro backlog pode signi car algumas coisas diferentes dependendo do sistema em</span></div>
<div style="position:absolute;left:60.99px;top:639.81px" class="cls_005"><span class="cls_005">que você está, mas vagamente é quantas conexões pendentes você pode ter antes que o</span></div>
<div style="position:absolute;left:60.99px;top:653.80px" class="cls_005"><span class="cls_005">kernel comece a rejeitar as novas. Assim que as novas conexões entram, você deve ser rápido</span></div>
<div style="position:absolute;left:60.99px;top:668.72px" class="cls_005"><span class="cls_005">para aceitá-las com accept() para que backlog não seja alcançado. Experimente o de nir</span></div>
<div style="position:absolute;left:60.99px;top:683.64px" class="cls_005"><span class="cls_005">com 10 ou mais, e seus clientes começarão a receber "Connection refused" sob carga pesada,</span></div>
<div style="position:absolute;left:60.99px;top:697.63px" class="cls_005"><span class="cls_005">con gure-o maior.</span></div>
<div style="position:absolute;left:60.99px;top:723.75px" class="cls_005"><span class="cls_005">Antes de chamar listen(), o servidor deve chamar bind() para se conectar a um número</span></div>
<div style="position:absolute;left:60.99px;top:738.67px" class="cls_005"><span class="cls_005">de porta especí co. Esse número de porta (no endereço IP do servidor) será aquele ao qual os</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">132 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:112332px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background133.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">clientes se conectam.</span></div>
<div style="position:absolute;left:60.99px;top:82.88px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:112.68px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:127.61px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:156.48px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:193.28px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:193.28px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:209.14px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:209.14px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:224.99px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:239.91px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:239.91px" class="cls_013"><span class="cls_013">// primeiro, carregue as estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:253.90px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:269.76px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:285.61px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:285.61px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:300.53px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:300.53px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:300.53px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:314.52px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:83.19px;top:330.38px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:330.38px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:83.19px;top:345.30px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:345.30px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:325.49px;top:345.30px" class="cls_013"><span class="cls_013">// preencha meu IP para</span></div>
<div style="position:absolute;left:109.49px;top:359.29px" class="cls_013"><span class="cls_013">mim</span></div>
<div style="position:absolute;left:76.48px;top:375.14px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:76.48px;top:390.99px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:390.99px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:406.85px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:422.70px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:422.70px" class="cls_013"><span class="cls_013">// crie o socket:</span></div>
<div style="position:absolute;left:76.48px;top:438.56px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:453.48px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:453.48px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:467.47px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:483.32px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:76.48px;top:499.18px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:499.18px" class="cls_013"><span class="cls_013">// bind na porta em que passamos a getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:515.03px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:530.88px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:530.88px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:76.48px;top:546.74px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:76.48px;top:561.66px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:561.66px" class="cls_005"><span class="cls_005">listen(sockfd, </span><span class="cls_009">10</span><span class="cls_005">); </span><span class="cls_013">// configura um socket servidor (que</span></div>
<div style="position:absolute;left:109.49px;top:575.65px" class="cls_013"><span class="cls_013">escuta)</span></div>
<div style="position:absolute;left:76.48px;top:591.50px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:607.36px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:607.36px" class="cls_013"><span class="cls_013">// então tem um loop accept() aqui em algum lugar</span></div>
<div style="position:absolute;left:60.99px;top:644.16px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:673.97px" class="cls_023"><span class="cls_023">accept</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">bind</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">socket</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:703.75px" class="cls_007"><span class="cls_007">perror(), strerror()</span></div>
<div style="position:absolute;left:60.99px;top:739.13px" class="cls_005"><span class="cls_005">Imprimir um erro como uma string legível por humanos.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">133 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:113183px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background134.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:90.80px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;stdio.h></span></div>
<div style="position:absolute;left:94.85px;top:106.66px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;string.h></span></div>
<div style="position:absolute;left:242.57px;top:106.66px" class="cls_013"><span class="cls_013">// para strerror()</span></div>
<div style="position:absolute;left:94.85px;top:138.37px" class="cls_008"><span class="cls_008">void</span><span class="cls_005"> perror(</span><span class="cls_008">const  char</span><span class="cls_005"> *s);</span></div>
<div style="position:absolute;left:94.85px;top:154.22px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *strerror(</span><span class="cls_008">int</span><span class="cls_005"> errnum);</span></div>
<div style="position:absolute;left:60.99px;top:191.02px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:220.83px" class="cls_005"><span class="cls_005">Uma vez que tantas funções retornam -1 em caso de erro e de nem o valor da variável errno</span></div>
<div style="position:absolute;left:60.99px;top:235.75px" class="cls_005"><span class="cls_005">como algum número, certamente seria bom se você pudesse facilmente imprimir isso em um</span></div>
<div style="position:absolute;left:60.99px;top:249.74px" class="cls_005"><span class="cls_005">formato que  zesse sentido para você.</span></div>
<div style="position:absolute;left:60.99px;top:275.85px" class="cls_005"><span class="cls_005">Felizmente, perror() faz isso. Se você quiser que mais descrições sejam impressas antes do</span></div>
<div style="position:absolute;left:60.99px;top:291.71px" class="cls_005"><span class="cls_005">erro, você pode apontar o parâmetro s para ela (ou você pode deixar s como NULL e nada</span></div>
<div style="position:absolute;left:60.99px;top:306.63px" class="cls_005"><span class="cls_005">adicional será impresso.)</span></div>
<div style="position:absolute;left:60.99px;top:332.74px" class="cls_005"><span class="cls_005">Em poucas palavras, esta função toma valores de errno, como ECONNRESET, e os imprime</span></div>
<div style="position:absolute;left:60.99px;top:347.66px" class="cls_005"><span class="cls_005">bem, como "Connection reset by peer."</span></div>
<div style="position:absolute;left:60.99px;top:373.78px" class="cls_005"><span class="cls_005">A função strerror() é muito semelhante a perror(), exceto que retorna um ponteiro para</span></div>
<div style="position:absolute;left:60.99px;top:388.70px" class="cls_005"><span class="cls_005">a string da mensagem de erro para um determinado valor (você geralmente passa na variável</span></div>
<div style="position:absolute;left:60.99px;top:403.62px" class="cls_005"><span class="cls_005">errno.)</span></div>
<div style="position:absolute;left:60.99px;top:433.43px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:463.24px" class="cls_005"><span class="cls_005">strerror() retorna um ponteiro para a string da mensagem de erro.</span></div>
<div style="position:absolute;left:60.99px;top:493.04px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:529.85px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:529.85px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:83.19px;top:545.70px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:561.55px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:561.55px" class="cls_005"><span class="cls_005">s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:577.41px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:593.26px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:593.26px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (s == -</span><span class="cls_009">1</span><span class="cls_005">) { </span><span class="cls_013">// ocorreu algum erro</span></div>
<div style="position:absolute;left:83.19px;top:609.12px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:130.75px;top:609.12px" class="cls_013"><span class="cls_013">// imprime "socket error: " + a mensagem de erro:</span></div>
<div style="position:absolute;left:83.19px;top:624.97px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:130.75px;top:624.97px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"socket error"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:640.83px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:640.83px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:83.19px;top:656.68px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:672.53px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:672.53px" class="cls_013"><span class="cls_013">// similarmente:</span></div>
<div style="position:absolute;left:76.48px;top:688.39px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:688.39px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (listen(s, </span><span class="cls_009">10</span><span class="cls_005">) == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:703.31px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:130.75px;top:703.31px" class="cls_013"><span class="cls_013">// isso imprime "an error: " + a mensagem de erro de</span></div>
<div style="position:absolute;left:109.49px;top:717.30px" class="cls_013"><span class="cls_013">errno:</span></div>
<div style="position:absolute;left:76.48px;top:733.15px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:130.75px;top:733.15px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"an error: %s\n"</span><span class="cls_005">, strerror(errno));</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">134 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:114034px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background135.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:54.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:91.74px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:121.54px" class="cls_023"><span class="cls_023">errno</span></div>
<div style="position:absolute;left:60.99px;top:151.33px" class="cls_007"><span class="cls_007">poll()</span></div>
<div style="position:absolute;left:60.99px;top:186.71px" class="cls_005"><span class="cls_005">Teste para eventos em múltiplos sockets simultaneamente.</span></div>
<div style="position:absolute;left:60.99px;top:215.58px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:252.39px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/poll.h></span></div>
<div style="position:absolute;left:94.85px;top:284.10px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> poll(</span><span class="cls_014">struct</span><span class="cls_005"> pollfd *ufds, </span><span class="cls_008">unsigned  int</span><span class="cls_005"> nfds, </span><span class="cls_008">int</span><span class="cls_005"> timeout);</span></div>
<div style="position:absolute;left:60.99px;top:320.90px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:350.71px" class="cls_005"><span class="cls_005">Esta função é muito semelhante a select() porque ambas monitoram eventos em conjuntos</span></div>
<div style="position:absolute;left:60.99px;top:366.56px" class="cls_005"><span class="cls_005">de descritores de arquivos, tais como dados de entrada prontos para recv(), sockets prontos</span></div>
<div style="position:absolute;left:60.99px;top:382.41px" class="cls_005"><span class="cls_005">para enviar dados com send(), dados out-of-band prontos para recv(), erros, etc.</span></div>
<div style="position:absolute;left:60.99px;top:409.46px" class="cls_005"><span class="cls_005">A idéia básica é que você passe um array de nfds struct pollfds em ufds, juntamente</span></div>
<div style="position:absolute;left:60.99px;top:425.31px" class="cls_005"><span class="cls_005">com um tempo limite em milissegundos (1000 milissegundos por segundo.) O timeout pode</span></div>
<div style="position:absolute;left:60.99px;top:440.24px" class="cls_005"><span class="cls_005">ser negativo se você quiser esperar para sempre. Se nenhum evento acontece em qualquer dos</span></div>
<div style="position:absolute;left:60.99px;top:455.16px" class="cls_005"><span class="cls_005">descritores de socket até ao  m de timeout, poll() retornará.</span></div>
<div style="position:absolute;left:60.99px;top:482.20px" class="cls_005"><span class="cls_005">Cada elemento no array de struct pollfd representa um descritor de socket e contém os</span></div>
<div style="position:absolute;left:60.99px;top:497.12px" class="cls_005"><span class="cls_005">seguintes campos:</span></div>
<div style="position:absolute;left:94.85px;top:530.23px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> pollfd {</span></div>
<div style="position:absolute;left:121.71px;top:546.09px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> fd;</span></div>
<div style="position:absolute;left:229.15px;top:546.09px" class="cls_013"><span class="cls_013">// o descritor de socket</span></div>
<div style="position:absolute;left:121.71px;top:561.01px" class="cls_008"><span class="cls_008">short</span><span class="cls_005"> events;</span></div>
<div style="position:absolute;left:229.14px;top:561.01px" class="cls_013"><span class="cls_013">// bitmap de eventos nos quais estamos</span></div>
<div style="position:absolute;left:123.94px;top:575.00px" class="cls_013"><span class="cls_013">interessados</span></div>
<div style="position:absolute;left:121.71px;top:589.92px" class="cls_008"><span class="cls_008">short</span><span class="cls_005"> revents;</span></div>
<div style="position:absolute;left:229.14px;top:589.92px" class="cls_013"><span class="cls_013">// poll() retorna, bitmap de eventos que</span></div>
<div style="position:absolute;left:123.94px;top:603.91px" class="cls_013"><span class="cls_013">ocorreram</span></div>
<div style="position:absolute;left:94.85px;top:619.76px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:653.80px" class="cls_005"><span class="cls_005">Antes de chamar poll(), carregue fd com o descritor de socket (se você de nir fd para um</span></div>
<div style="position:absolute;left:60.99px;top:669.65px" class="cls_005"><span class="cls_005">número negativo, esta struct pollfd será ignorada e seu campo revents será de nido</span></div>
<div style="position:absolute;left:60.99px;top:685.51px" class="cls_005"><span class="cls_005">para zero) e, em seguida, constroi-se o campo events por bitwise-ORing nas seguintes</span></div>
<div style="position:absolute;left:60.99px;top:700.43px" class="cls_005"><span class="cls_005">macros:</span></div>
<div style="position:absolute;left:76.42px;top:733.54px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:302.77px;top:733.54px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">135 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:114885px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background136.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.42px;top:61.93px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:302.77px;top:61.93px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:69.39px;top:78.25px" class="cls_005"><span class="cls_005">POLLIN    Avise-me quando os dados estiverem prontos para recv() neste socket.</span></div>
<div style="position:absolute;left:131.78px;top:95.50px" class="cls_005"><span class="cls_005">Avise-me quando eu puder enviar dados com send() para este socket sem</span></div>
<div style="position:absolute;left:69.39px;top:102.50px" class="cls_005"><span class="cls_005">POLLOUT</span></div>
<div style="position:absolute;left:131.78px;top:110.42px" class="cls_005"><span class="cls_005">blocking.</span></div>
<div style="position:absolute;left:131.78px;top:126.74px" class="cls_005"><span class="cls_005">Avise-me quando os dados out-of-band estiverem prontos para recv() neste</span></div>
<div style="position:absolute;left:69.39px;top:133.74px" class="cls_005"><span class="cls_005">POLLPRI</span></div>
<div style="position:absolute;left:131.78px;top:141.66px" class="cls_005"><span class="cls_005">socket.</span></div>
<div style="position:absolute;left:60.99px;top:177.10px" class="cls_005"><span class="cls_005">Uma vez que a chamada poll() retorna, o campo revents será construído como bitwise-OR</span></div>
<div style="position:absolute;left:60.99px;top:192.02px" class="cls_005"><span class="cls_005">nos campos acima, dizendo a você em quais descritores realmente o evento ocorreu. Além</span></div>
<div style="position:absolute;left:60.99px;top:206.01px" class="cls_005"><span class="cls_005">disso, esses outros campos podem estar presentes:</span></div>
<div style="position:absolute;left:83.80px;top:239.12px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:310.15px;top:239.12px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:69.39px;top:255.44px" class="cls_005"><span class="cls_005">POLLERR</span></div>
<div style="position:absolute;left:146.55px;top:255.44px" class="cls_005"><span class="cls_005">Ocorreu um erro neste socket.</span></div>
<div style="position:absolute;left:69.39px;top:272.69px" class="cls_005"><span class="cls_005">POLLHUP</span></div>
<div style="position:absolute;left:146.55px;top:272.69px" class="cls_005"><span class="cls_005">O lado remoto da conexão foi desligado.</span></div>
<div style="position:absolute;left:146.55px;top:289.95px" class="cls_005"><span class="cls_005">Algo estava errado com o descritor de socket fd—Talvez não esteja</span></div>
<div style="position:absolute;left:69.39px;top:296.94px" class="cls_005"><span class="cls_005">POLLNVAL</span></div>
<div style="position:absolute;left:146.55px;top:304.87px" class="cls_005"><span class="cls_005">inicializado?</span></div>
<div style="position:absolute;left:60.99px;top:343.07px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:372.88px" class="cls_005"><span class="cls_005">Retorna o número de elementos em que ocorreram eventos no array ufds; Isso pode ser zero</span></div>
<div style="position:absolute;left:60.99px;top:388.73px" class="cls_005"><span class="cls_005">se timeout foi alcançado. Além disso retorna -1 em caso de erro (e errno será de</span></div>
<div style="position:absolute;left:476.83px;top:388.73px" class="cls_005"><span class="cls_005">nido em</span></div>
<div style="position:absolute;left:60.99px;top:403.65px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:432.53px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:469.33px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:469.33px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s1, s2;</span></div>
<div style="position:absolute;left:83.19px;top:485.19px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:485.19px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> rv;</span></div>
<div style="position:absolute;left:83.19px;top:501.04px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:501.04px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf1[</span><span class="cls_009">256</span><span class="cls_005">], buf2[</span><span class="cls_009">256</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:516.89px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:516.89px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> pollfd ufds[</span><span class="cls_009">2</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:532.75px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:548.60px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:548.60px" class="cls_005"><span class="cls_005">s1 = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:564.46px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:564.46px" class="cls_005"><span class="cls_005">s2 = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:580.31px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:595.23px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:595.23px" class="cls_013"><span class="cls_013">// finja que estamos conectados a um servidor neste</span></div>
<div style="position:absolute;left:109.49px;top:609.22px" class="cls_013"><span class="cls_013">momento</span></div>
<div style="position:absolute;left:76.48px;top:625.08px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:625.08px" class="cls_013"><span class="cls_013">//connect(s1, ...)...</span></div>
<div style="position:absolute;left:76.48px;top:640.93px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:640.93px" class="cls_013"><span class="cls_013">//connect(s2, ...)...</span></div>
<div style="position:absolute;left:76.48px;top:656.78px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:672.64px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:672.64px" class="cls_013"><span class="cls_013">// configure o array de descritores de arquivo.</span></div>
<div style="position:absolute;left:76.48px;top:688.49px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:688.49px" class="cls_013"><span class="cls_013">//</span></div>
<div style="position:absolute;left:76.48px;top:703.41px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:703.41px" class="cls_013"><span class="cls_013">// neste exemplo, queremos saber quando há normais ou</span></div>
<div style="position:absolute;left:109.49px;top:717.40px" class="cls_013"><span class="cls_013">out-of-band</span></div>
<div style="position:absolute;left:76.48px;top:733.26px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:733.26px" class="cls_013"><span class="cls_013">// dados prontos para recv()...</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">136 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:115736px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background137.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_005"><span class="cls_005">ufds[</span><span class="cls_009">0</span><span class="cls_005">].fd = s1;</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:85.71px" class="cls_005"><span class="cls_005">ufds[</span><span class="cls_009">0</span><span class="cls_005">].events = POLLIN | POLLPRI; </span><span class="cls_013">// checa por normal</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_013"><span class="cls_013">ou out-of-band</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:131.41px" class="cls_005"><span class="cls_005">ufds[</span><span class="cls_009">1</span><span class="cls_005">].fd = s2;</span></div>
<div style="position:absolute;left:76.48px;top:146.33px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:146.33px" class="cls_005"><span class="cls_005">ufds[</span><span class="cls_009">1</span><span class="cls_005">].events = POLLIN; </span><span class="cls_013">// verifique apenas os dados</span></div>
<div style="position:absolute;left:109.49px;top:160.32px" class="cls_013"><span class="cls_013">normais</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:76.48px;top:191.09px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:191.09px" class="cls_013"><span class="cls_013">// espera por eventos nos sockets, timeout de 3,5</span></div>
<div style="position:absolute;left:109.49px;top:205.08px" class="cls_013"><span class="cls_013">segundos</span></div>
<div style="position:absolute;left:76.48px;top:220.93px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:220.93px" class="cls_005"><span class="cls_005">rv = poll(ufds, </span><span class="cls_009">2</span><span class="cls_005">, </span><span class="cls_009">3500</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:103.89px;top:252.64px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (rv == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:130.75px;top:268.50px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"poll"</span><span class="cls_005">); </span><span class="cls_013">// ocorreu erro em poll()</span></div>
<div style="position:absolute;left:76.48px;top:284.35px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:103.89px;top:284.35px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else  if</span><span class="cls_005"> (rv == </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:299.27px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:130.75px;top:299.27px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Timeout ocorreu!  Nenhum dado após 3.5</span></div>
<div style="position:absolute;left:109.49px;top:313.26px" class="cls_010"><span class="cls_010">segundos.\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:329.12px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:103.89px;top:329.12px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:76.48px;top:344.97px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:130.75px;top:344.97px" class="cls_013"><span class="cls_013">// checar por eventos em s1:</span></div>
<div style="position:absolute;left:76.48px;top:360.82px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:360.82px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (ufds[</span><span class="cls_009">0</span><span class="cls_005">].revents & POLLIN) {</span></div>
<div style="position:absolute;left:76.48px;top:375.75px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:157.60px;top:375.75px" class="cls_005"><span class="cls_005">recv(s1, buf1, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf1, </span><span class="cls_009">0</span><span class="cls_005">); </span><span class="cls_013">// recebe dados</span></div>
<div style="position:absolute;left:109.49px;top:389.74px" class="cls_013"><span class="cls_013">normais</span></div>
<div style="position:absolute;left:76.48px;top:405.59px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:130.75px;top:405.59px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:421.44px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:421.44px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (ufds[</span><span class="cls_009">0</span><span class="cls_005">].revents & POLLPRI) {</span></div>
<div style="position:absolute;left:76.48px;top:436.37px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:157.60px;top:436.37px" class="cls_005"><span class="cls_005">recv(s1, buf1, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf1, MSG_OOB); </span><span class="cls_013">// dados</span></div>
<div style="position:absolute;left:109.49px;top:450.35px" class="cls_013"><span class="cls_013">out-of-band</span></div>
<div style="position:absolute;left:76.48px;top:466.21px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:130.75px;top:466.21px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:482.06px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:76.48px;top:497.92px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:130.75px;top:497.92px" class="cls_013"><span class="cls_013">// checar por eventos s2:</span></div>
<div style="position:absolute;left:76.48px;top:513.77px" class="cls_005"><span class="cls_005">41</span></div>
<div style="position:absolute;left:130.75px;top:513.77px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (ufds[</span><span class="cls_009">1</span><span class="cls_005">].revents & POLLIN) {</span></div>
<div style="position:absolute;left:76.48px;top:529.62px" class="cls_005"><span class="cls_005">42</span></div>
<div style="position:absolute;left:157.60px;top:529.62px" class="cls_005"><span class="cls_005">recv(s1, buf2, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf2, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:545.48px" class="cls_005"><span class="cls_005">43</span></div>
<div style="position:absolute;left:130.75px;top:545.48px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:561.33px" class="cls_005"><span class="cls_005">44</span></div>
<div style="position:absolute;left:103.89px;top:561.33px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:598.14px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:627.94px" class="cls_023"><span class="cls_023">select</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:657.73px" class="cls_007"><span class="cls_007">recv(), recvfrom()</span></div>
<div style="position:absolute;left:60.99px;top:693.11px" class="cls_005"><span class="cls_005">Recebe dados em um socket.</span></div>
<div style="position:absolute;left:60.99px;top:721.98px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">137 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:116587px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background138.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:61.93px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:77.78px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:109.49px" class="cls_008"><span class="cls_008">ssize_t</span><span class="cls_005"> recv(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">void</span><span class="cls_005"> *buf, </span><span class="cls_008">size_t</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> flags);</span></div>
<div style="position:absolute;left:94.85px;top:125.34px" class="cls_008"><span class="cls_008">ssize_t</span><span class="cls_005"> recvfrom(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">void</span><span class="cls_005"> *buf, </span><span class="cls_008">size_t</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> flags,</span></div>
<div style="position:absolute;left:209.00px;top:141.20px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr *from, socklen_t *fromlen);</span></div>
<div style="position:absolute;left:60.99px;top:178.00px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:206.88px" class="cls_005"><span class="cls_005">Uma vez que você tenha um socket ativo e conectado, poderá ler dados de entrada vindos do</span></div>
<div style="position:absolute;left:60.99px;top:221.80px" class="cls_005"><span class="cls_005">lado remoto usando a recv() (para sockets TCP SOCK_STREAM) e recvfrom() (para</span></div>
<div style="position:absolute;left:60.99px;top:237.65px" class="cls_005"><span class="cls_005">sockets UDP SOCK_DGRAM).</span></div>
<div style="position:absolute;left:60.99px;top:264.70px" class="cls_005"><span class="cls_005">Ambas as funções usam o descritor de socket s, um ponteiro para o buffer buf, o tamanho</span></div>
<div style="position:absolute;left:60.99px;top:280.55px" class="cls_005"><span class="cls_005">(em bytes) do buffer len, e um conjunto de flags que controlam como as funções</span></div>
<div style="position:absolute;left:60.99px;top:295.47px" class="cls_005"><span class="cls_005">funcionam.</span></div>
<div style="position:absolute;left:60.99px;top:321.59px" class="cls_005"><span class="cls_005">Além disso, a recvfrom() recebe uma struct sockaddr*, from que lhe dirá de onde os</span></div>
<div style="position:absolute;left:60.99px;top:337.44px" class="cls_005"><span class="cls_005">dados vieram, e preencherá fromlen com o tamanho da struct sockaddr. (Você também</span></div>
<div style="position:absolute;left:60.99px;top:353.29px" class="cls_005"><span class="cls_005">deve inicializar fromlen para ser do tamanho de from ou struct sockaddr.)</span></div>
<div style="position:absolute;left:60.99px;top:379.41px" class="cls_005"><span class="cls_005">Então, que   ags maravilhosas você pode passar para essa função? Aqui estão algumas delas,</span></div>
<div style="position:absolute;left:60.99px;top:393.40px" class="cls_005"><span class="cls_005">mas você deve veri car suas páginas man locais para obter mais informação sobre o que é</span></div>
<div style="position:absolute;left:60.99px;top:407.38px" class="cls_005"><span class="cls_005">realmente suportado em seu sistema. Você pode realizar operações bitwise-or com elas, ou</span></div>
<div style="position:absolute;left:60.99px;top:422.31px" class="cls_005"><span class="cls_005">apenas de nir flags para 0 se você quer que ela seja uma recv() regular.</span></div>
<div style="position:absolute;left:93.27px;top:456.35px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:315.94px;top:456.35px" class="cls_025"><span class="cls_025">Description</span></div>
<div style="position:absolute;left:165.49px;top:471.73px" class="cls_005"><span class="cls_005">Recebe dados Out of Band. Esta é a forma como obter dados que foram</span></div>
<div style="position:absolute;left:165.49px;top:486.66px" class="cls_005"><span class="cls_005">enviados para você com a   ag MSG_OOB em send(). Como receptor,</span></div>
<div style="position:absolute;left:69.39px;top:503.44px" class="cls_005"><span class="cls_005">MSG_OOB</span></div>
<div style="position:absolute;left:165.49px;top:502.51px" class="cls_005"><span class="cls_005">você terá o sinal SIGURG levantado informando que há dados urgentes.</span></div>
<div style="position:absolute;left:165.49px;top:518.36px" class="cls_005"><span class="cls_005">No seu manipulador para esse sinal, você poderia chamar recv() com</span></div>
<div style="position:absolute;left:165.49px;top:534.22px" class="cls_005"><span class="cls_005">essa   ag MSG_OOB.</span></div>
<div style="position:absolute;left:165.49px;top:551.47px" class="cls_005"><span class="cls_005">Se você quiser chamar recv() "apenas para  ngir", você pode chamá-la</span></div>
<div style="position:absolute;left:165.49px;top:566.39px" class="cls_005"><span class="cls_005">com esta   ag. Isso lhe dirá o que estará lhe esperando no buffer quando</span></div>
<div style="position:absolute;left:69.39px;top:574.32px" class="cls_005"><span class="cls_005">MSG_PEEK</span></div>
<div style="position:absolute;left:165.49px;top:581.31px" class="cls_005"><span class="cls_005">você chamar recv() "realmente" (ou seja sem a   ag MSG_PEEK. É</span></div>
<div style="position:absolute;left:165.49px;top:597.17px" class="cls_005"><span class="cls_005">como uma pré-visualização para a próxima chamada recv().</span></div>
<div style="position:absolute;left:165.49px;top:614.42px" class="cls_005"><span class="cls_005">Diga a recv() para não retornar até que todos os dados especi cados</span></div>
<div style="position:absolute;left:165.49px;top:630.28px" class="cls_005"><span class="cls_005">no parâmetro len sejam recebidos. Ele irá ignorar seus desejos em</span></div>
<div style="position:absolute;left:69.39px;top:643.33px" class="cls_005"><span class="cls_005">MSG_WAITALL    circunstâncias extremas, no entanto, como se um sinal interrompesse a</span></div>
<div style="position:absolute;left:165.49px;top:659.19px" class="cls_005"><span class="cls_005">chamada ou se algum erro ocorresse ou se o lado remoto fechasse a</span></div>
<div style="position:absolute;left:165.49px;top:673.17px" class="cls_005"><span class="cls_005">conexão, etc. Não  que bravo com isso.</span></div>
<div style="position:absolute;left:60.99px;top:708.61px" class="cls_005"><span class="cls_005">Quando você chama recv(), ele irá bloquear até que haja alguns dados para ler. Se você não</span></div>
<div style="position:absolute;left:60.99px;top:724.47px" class="cls_005"><span class="cls_005">quiser blocking, de na o socket para non-blocking ou veri que com select() ou poll() para</span></div>
<div style="position:absolute;left:60.99px;top:740.32px" class="cls_005"><span class="cls_005">ver se há dados de entrada antes de chamar recv() ou recvfrom().</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">138 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:117438px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background139.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:82.88px" class="cls_005"><span class="cls_005">Retorna o número de bytes realmente recebidos (que pode ser menos do que você solicitou no</span></div>
<div style="position:absolute;left:60.99px;top:97.80px" class="cls_005"><span class="cls_005">parâmetro len), ou -1 em caso de erro (e errno de nido em conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:124.84px" class="cls_005"><span class="cls_005">Se o lado remoto fechar a conexão, recv() retornará 0. Este é o método normal para a</span></div>
<div style="position:absolute;left:60.99px;top:139.76px" class="cls_005"><span class="cls_005">determinar se o lado remoto fechou a conexão. A normalidade é boa, rebelde!</span></div>
<div style="position:absolute;left:60.99px;top:168.64px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:205.44px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:205.44px" class="cls_013"><span class="cls_013">// stream sockets e recv()</span></div>
<div style="position:absolute;left:83.19px;top:221.30px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:237.15px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:237.15px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:253.00px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:253.00px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:268.86px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:268.86px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[</span><span class="cls_009">512</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:284.71px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:284.71px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> byte_count;</span></div>
<div style="position:absolute;left:83.19px;top:300.57px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:315.49px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:315.49px" class="cls_013"><span class="cls_013">// obter informações do host, criar o socket e conectá-</span></div>
<div style="position:absolute;left:109.49px;top:329.48px" class="cls_013"><span class="cls_013">lo</span></div>
<div style="position:absolute;left:83.19px;top:345.33px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:345.33px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:360.25px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:360.25px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:360.25px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:374.24px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:76.48px;top:390.10px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:390.10px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM;</span></div>
<div style="position:absolute;left:76.48px;top:405.95px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:405.95px" class="cls_005"><span class="cls_005">getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:420.87px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:420.87px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:434.86px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:450.72px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:450.72px" class="cls_005"><span class="cls_005">connect(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:76.48px;top:466.57px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:76.48px;top:481.49px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:481.49px" class="cls_013"><span class="cls_013">// Tudo certo! agora conectados, podemos receber alguns</span></div>
<div style="position:absolute;left:109.49px;top:495.48px" class="cls_013"><span class="cls_013">dados!</span></div>
<div style="position:absolute;left:76.48px;top:511.33px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:511.33px" class="cls_005"><span class="cls_005">byte_count = recv(sockfd, buf, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:526.26px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:526.26px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"recv()'d %d bytes de dados em buf\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:540.24px" class="cls_005"><span class="cls_005">byte_count);</span></div>
<div style="position:absolute;left:83.19px;top:581.28px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:581.28px" class="cls_013"><span class="cls_013">// datagram sockets e recvfrom()</span></div>
<div style="position:absolute;left:83.19px;top:597.13px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:612.99px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:612.99px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:628.84px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:628.84px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:644.70px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:644.70px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> byte_count;</span></div>
<div style="position:absolute;left:83.19px;top:660.55px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:660.55px" class="cls_005"><span class="cls_005">socklen_t fromlen;</span></div>
<div style="position:absolute;left:83.19px;top:676.40px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:676.40px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage addr;</span></div>
<div style="position:absolute;left:83.19px;top:692.26px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:692.26px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf[</span><span class="cls_009">512</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:708.11px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:708.11px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> ipstr[INET6_ADDRSTRLEN];</span></div>
<div style="position:absolute;left:76.48px;top:723.97px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">139 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:118289px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background140.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:54.00px" class="cls_013"><span class="cls_013">// obter informações do host, criar socket, bind para a</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_013"><span class="cls_013">porta 4950</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:83.84px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:76.48px;top:98.76px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:98.76px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:305.35px;top:98.76px" class="cls_013"><span class="cls_013">// use IPv4 ou IPv6, o que</span></div>
<div style="position:absolute;left:109.49px;top:112.75px" class="cls_013"><span class="cls_013">for</span></div>
<div style="position:absolute;left:76.48px;top:128.61px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:128.61px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_DGRAM;</span></div>
<div style="position:absolute;left:76.48px;top:144.46px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:144.46px" class="cls_005"><span class="cls_005">hints.ai_flags = AI_PASSIVE;</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:160.32px" class="cls_005"><span class="cls_005">getaddrinfo(NULL, </span><span class="cls_010">"4950"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:175.24px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:175.24px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:189.23px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:76.48px;top:205.08px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:103.89px;top:205.08px" class="cls_005"><span class="cls_005">bind(sockfd, res->ai_addr, res->ai_addrlen);</span></div>
<div style="position:absolute;left:76.48px;top:220.93px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:236.79px" class="cls_013"><span class="cls_013">// não precisa de accept(), apenas recvfrom():</span></div>
<div style="position:absolute;left:76.48px;top:252.64px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:268.50px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:268.50px" class="cls_005"><span class="cls_005">fromlen = </span><span class="cls_014">sizeof</span><span class="cls_005"> addr;</span></div>
<div style="position:absolute;left:76.48px;top:283.42px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:283.42px" class="cls_005"><span class="cls_005">byte_count = recvfrom(sockfd, buf, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf, </span><span class="cls_009">0</span><span class="cls_005">, &addr,</span></div>
<div style="position:absolute;left:109.49px;top:297.41px" class="cls_005"><span class="cls_005">&fromlen);</span></div>
<div style="position:absolute;left:76.48px;top:313.26px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:76.48px;top:328.18px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:328.18px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"recv()'d %d bytes de dados em buf\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:342.17px" class="cls_005"><span class="cls_005">byte_count);</span></div>
<div style="position:absolute;left:76.48px;top:358.03px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:103.89px;top:358.03px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"do endereço IP %s\n"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:373.88px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:130.75px;top:373.88px" class="cls_005"><span class="cls_005">inet_ntop(addr.ss_family,</span></div>
<div style="position:absolute;left:76.48px;top:389.74px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:157.60px;top:389.74px" class="cls_005"><span class="cls_005">addr.ss_family == AF_INET?</span></div>
<div style="position:absolute;left:76.48px;top:405.59px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:184.46px;top:405.59px" class="cls_005"><span class="cls_005">((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in *)&addr)->sin_addr:</span></div>
<div style="position:absolute;left:76.48px;top:421.44px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:184.46px;top:421.44px" class="cls_005"><span class="cls_005">((</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 *)&addr)->sin6_addr,</span></div>
<div style="position:absolute;left:76.48px;top:437.30px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:157.60px;top:437.30px" class="cls_005"><span class="cls_005">ipstr, </span><span class="cls_014">sizeof</span><span class="cls_005"> ipstr);</span></div>
<div style="position:absolute;left:60.99px;top:474.10px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:503.91px" class="cls_023"><span class="cls_023">send</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">sendto</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">select</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">poll</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">Blockin</span><span class="cls_006">g</span></div>
<div style="position:absolute;left:60.99px;top:533.69px" class="cls_007"><span class="cls_007">select()</span></div>
<div style="position:absolute;left:60.99px;top:569.07px" class="cls_005"><span class="cls_005">Veri ca se os descritores de sockets estão prontos para leitura/escrita.</span></div>
<div style="position:absolute;left:60.99px;top:597.95px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:634.75px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/select.h></span></div>
<div style="position:absolute;left:94.85px;top:665.53px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> select(</span><span class="cls_008">int</span><span class="cls_005"> n, fd_set *readfds, fd_set *writefds, fd_set</span></div>
<div style="position:absolute;left:123.94px;top:679.52px" class="cls_005"><span class="cls_005">*exceptfds,</span></div>
<div style="position:absolute;left:168.71px;top:695.37px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> timeval *timeout);</span></div>
<div style="position:absolute;left:94.85px;top:727.08px" class="cls_005"><span class="cls_005">FD_SET(</span><span class="cls_008">int</span><span class="cls_005"> fd, fd_set *set);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">140 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:119140px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background141.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:54.93px" class="cls_005"><span class="cls_005">FD_CLR(</span><span class="cls_008">int</span><span class="cls_005"> fd, fd_set *set);</span></div>
<div style="position:absolute;left:94.85px;top:70.79px" class="cls_005"><span class="cls_005">FD_ISSET(</span><span class="cls_008">int</span><span class="cls_005"> fd, fd_set *set);</span></div>
<div style="position:absolute;left:94.85px;top:86.64px" class="cls_005"><span class="cls_005">FD_ZERO(fd_set *set);</span></div>
<div style="position:absolute;left:60.99px;top:123.44px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:153.25px" class="cls_005"><span class="cls_005">A função select() fornece a você uma maneira de veri car simultaneamente vários sockets</span></div>
<div style="position:absolute;left:60.99px;top:169.11px" class="cls_005"><span class="cls_005">para ver se eles têm dados esperando para serem lidos com recv(), ou se você pode enviar</span></div>
<div style="position:absolute;left:60.99px;top:184.96px" class="cls_005"><span class="cls_005">com send() dados a eles sem blocking, ou se alguma exceção ocorreu.</span></div>
<div style="position:absolute;left:60.99px;top:212.01px" class="cls_005"><span class="cls_005">Você preenche seus sets de descritores de sockets usando as macros, como FD_SET(),</span></div>
<div style="position:absolute;left:60.99px;top:226.93px" class="cls_005"><span class="cls_005">acima. Uma vez que você tenha o set, você passa-o para a função como um dos seguintes</span></div>
<div style="position:absolute;left:60.99px;top:241.85px" class="cls_005"><span class="cls_005">parâmetros: readfds se você quiser saber quando qualquer um dos sockets no set está</span></div>
<div style="position:absolute;left:60.99px;top:257.70px" class="cls_005"><span class="cls_005">pronto para receber dados com recv(), writefds se qualquer um dos sockets estiver pronto</span></div>
<div style="position:absolute;left:60.99px;top:273.56px" class="cls_005"><span class="cls_005">para enviar dados com send(), e/ou exceptfds se você precisa saber quando uma exceção</span></div>
<div style="position:absolute;left:60.99px;top:288.48px" class="cls_005"><span class="cls_005">(erro) ocorre em qualquer um dos sockets. Qualquer um ou todos estes parâmetros podem ser</span></div>
<div style="position:absolute;left:60.99px;top:303.40px" class="cls_005"><span class="cls_005">NULL se você não estiver interessado nesses tipos de eventos. Após o retorno de select(),</span></div>
<div style="position:absolute;left:60.99px;top:318.32px" class="cls_005"><span class="cls_005">os valores nos sets serão alterados para mostrar quais estão prontos para leitura ou escrita, e</span></div>
<div style="position:absolute;left:60.99px;top:332.31px" class="cls_005"><span class="cls_005">quais possuem exceções.</span></div>
<div style="position:absolute;left:60.99px;top:358.42px" class="cls_005"><span class="cls_005">O primeiro parâmetro, n é o descritor de socket com a numeração mais alta (eles são apenas</span></div>
<div style="position:absolute;left:60.99px;top:374.28px" class="cls_005"><span class="cls_005">ints, lembra?) mais um.</span></div>
<div style="position:absolute;left:60.99px;top:401.32px" class="cls_005"><span class="cls_005">Por  m, a struct timeval, timeout, no  nal—isso permite que você informe a select()</span></div>
<div style="position:absolute;left:60.99px;top:416.24px" class="cls_005"><span class="cls_005">por quanto tempo veri car esses sets. Ela retornará após o timeout ou quando um evento</span></div>
<div style="position:absolute;left:60.99px;top:431.17px" class="cls_005"><span class="cls_005">ocorrer, o que ocorrer primeiro. A estrutura struct timeval possui dois campos: tv_sec é</span></div>
<div style="position:absolute;left:60.99px;top:447.02px" class="cls_005"><span class="cls_005">o número de segundos, ao qual é adicionado tv_usec, o número de microssegundos</span></div>
<div style="position:absolute;left:60.99px;top:461.94px" class="cls_005"><span class="cls_005">(1.000.000 microssegundos em um segundo.)</span></div>
<div style="position:absolute;left:60.99px;top:487.12px" class="cls_005"><span class="cls_005">As macros auxiliares fazem o seguinte:</span></div>
<div style="position:absolute;left:189.38px;top:520.23px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:376.32px;top:520.23px" class="cls_025"><span class="cls_025">Description</span></div>
<div style="position:absolute;left:105.12px;top:536.55px" class="cls_005"><span class="cls_005">FD_SET(int fd, fd_set *set);</span></div>
<div style="position:absolute;left:321.97px;top:536.55px" class="cls_005"><span class="cls_005">Adiciona fd para o set.</span></div>
<div style="position:absolute;left:105.12px;top:553.80px" class="cls_005"><span class="cls_005">FD_CLR(int fd, fd_set *set);</span></div>
<div style="position:absolute;left:321.97px;top:553.80px" class="cls_005"><span class="cls_005">Remove fd do set.</span></div>
<div style="position:absolute;left:105.12px;top:571.06px" class="cls_005"><span class="cls_005">FD_ISSET(int fd, fd_set *set);   Retorna true se fd está no set.</span></div>
<div style="position:absolute;left:105.12px;top:588.31px" class="cls_005"><span class="cls_005">FD_ZERO(fd_set *set);</span></div>
<div style="position:absolute;left:321.97px;top:588.31px" class="cls_005"><span class="cls_005">Limpar todas as entradas do set.</span></div>
<div style="position:absolute;left:60.99px;top:624.68px" class="cls_005"><span class="cls_005">Nota para usuários Linux: A select() do Linux pode retornar "pronto-para-ler" e, em seguida,</span></div>
<div style="position:absolute;left:60.99px;top:640.53px" class="cls_005"><span class="cls_005">na verdade não estar pronta para ler, fazendo com que a chamada subsequente a read() gere</span></div>
<div style="position:absolute;left:60.99px;top:656.39px" class="cls_005"><span class="cls_005">blocking. Você pode contornar este problema de nindo a   ag O_NONBLOCK no socket receptor</span></div>
<div style="position:absolute;left:60.99px;top:672.24px" class="cls_005"><span class="cls_005">para que ele gere um erro com EWOULDBLOCK, em seguida, ignore-o se este erro ocorrer. Veja a</span></div>
<div style="position:absolute;left:60.99px;top:688.10px" class="cls_005"><span class="cls_005">man page </span><span class="cls_023">fcntl</span><span class="cls_006">()</span><span class="cls_005"> para mais informações sobre como con gurar um socket para non-</span></div>
<div style="position:absolute;left:60.99px;top:703.02px" class="cls_005"><span class="cls_005">blocking.</span></div>
<div style="position:absolute;left:60.99px;top:731.89px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">141 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:119991px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background142.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Retorna o número de descritores no set em caso de sucesso, 0 se o tempo limite foi atingido,</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">ou -1 em caso de erro (e errno será de nido em conformidade.) Além disso, os sets são</span></div>
<div style="position:absolute;left:60.99px;top:85.71px" class="cls_005"><span class="cls_005">modi cados para mostrar quais sockets estão prontos.</span></div>
<div style="position:absolute;left:60.99px;top:114.58px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:151.39px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:151.39px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s1, s2, n;</span></div>
<div style="position:absolute;left:83.19px;top:167.24px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:167.24px" class="cls_005"><span class="cls_005">fd_set readfds;</span></div>
<div style="position:absolute;left:83.19px;top:183.09px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:183.09px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> timeval tv;</span></div>
<div style="position:absolute;left:83.19px;top:198.95px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:198.95px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> buf1[</span><span class="cls_009">256</span><span class="cls_005">], buf2[</span><span class="cls_009">256</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:83.19px;top:214.80px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:229.72px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:229.72px" class="cls_013"><span class="cls_013">// finja que estamos conectados a um servidor neste</span></div>
<div style="position:absolute;left:109.49px;top:243.71px" class="cls_013"><span class="cls_013">momento</span></div>
<div style="position:absolute;left:83.19px;top:259.57px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:259.57px" class="cls_013"><span class="cls_013">//s1 = socket(...);</span></div>
<div style="position:absolute;left:83.19px;top:275.42px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:275.42px" class="cls_013"><span class="cls_013">//s2 = socket(...);</span></div>
<div style="position:absolute;left:83.19px;top:291.28px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:291.28px" class="cls_013"><span class="cls_013">//connect(s1, ...)...</span></div>
<div style="position:absolute;left:76.48px;top:307.13px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:307.13px" class="cls_013"><span class="cls_013">//connect(s2, ...)...</span></div>
<div style="position:absolute;left:76.48px;top:322.98px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:338.84px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:338.84px" class="cls_013"><span class="cls_013">// limpar o set antes do tempo</span></div>
<div style="position:absolute;left:76.48px;top:354.69px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:354.69px" class="cls_005"><span class="cls_005">FD_ZERO(&readfds);</span></div>
<div style="position:absolute;left:76.48px;top:370.55px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:76.48px;top:386.40px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:386.40px" class="cls_013"><span class="cls_013">// adicione nossos descritores ao set</span></div>
<div style="position:absolute;left:76.48px;top:402.26px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:402.26px" class="cls_005"><span class="cls_005">FD_SET(s1, &readfds);</span></div>
<div style="position:absolute;left:76.48px;top:418.11px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:418.11px" class="cls_005"><span class="cls_005">FD_SET(s2, &readfds);</span></div>
<div style="position:absolute;left:76.48px;top:433.96px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:448.89px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:448.89px" class="cls_013"><span class="cls_013">// desde que temos s2 segundos, é o "maior", então</span></div>
<div style="position:absolute;left:109.49px;top:462.87px" class="cls_013"><span class="cls_013">usamos isso para</span></div>
<div style="position:absolute;left:76.48px;top:478.73px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:478.73px" class="cls_013"><span class="cls_013">// o parâmetro n em select()</span></div>
<div style="position:absolute;left:76.48px;top:494.58px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:103.89px;top:494.58px" class="cls_005"><span class="cls_005">n = s2 + </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:510.44px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:76.48px;top:525.36px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:525.36px" class="cls_013"><span class="cls_013">// espere até que um socket tenha dados para recv()</span></div>
<div style="position:absolute;left:109.49px;top:539.35px" class="cls_013"><span class="cls_013">(timeout 10.5 secs)</span></div>
<div style="position:absolute;left:76.48px;top:555.20px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:555.20px" class="cls_005"><span class="cls_005">tv.tv_sec = </span><span class="cls_009">10</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:571.06px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:571.06px" class="cls_005"><span class="cls_005">tv.tv_usec = </span><span class="cls_009">500000</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:76.48px;top:586.91px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:103.89px;top:586.91px" class="cls_005"><span class="cls_005">rv = select(n, &readfds, NULL, NULL, &tv);</span></div>
<div style="position:absolute;left:76.48px;top:602.76px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:76.48px;top:618.62px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:618.62px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (rv == -</span><span class="cls_009">1</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:634.47px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:130.75px;top:634.47px" class="cls_005"><span class="cls_005">perror(</span><span class="cls_010">"select"</span><span class="cls_005">); </span><span class="cls_013">// ocorreu um erro em select()</span></div>
<div style="position:absolute;left:76.48px;top:650.33px" class="cls_005"><span class="cls_005">30</span></div>
<div style="position:absolute;left:103.89px;top:650.33px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else  if</span><span class="cls_005"> (rv == </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:665.25px" class="cls_005"><span class="cls_005">31</span></div>
<div style="position:absolute;left:130.75px;top:665.25px" class="cls_005"><span class="cls_005">printf(</span><span class="cls_010">"Timeout ocorreu! Sem dados após 10.5</span></div>
<div style="position:absolute;left:109.49px;top:679.24px" class="cls_010"><span class="cls_010">segundos.\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:695.09px" class="cls_005"><span class="cls_005">32</span></div>
<div style="position:absolute;left:103.89px;top:695.09px" class="cls_005"><span class="cls_005">} </span><span class="cls_014">else</span><span class="cls_005"> {</span></div>
<div style="position:absolute;left:76.48px;top:710.95px" class="cls_005"><span class="cls_005">33</span></div>
<div style="position:absolute;left:130.75px;top:710.95px" class="cls_013"><span class="cls_013">// um ou ambos os descritores têm dados</span></div>
<div style="position:absolute;left:76.48px;top:726.80px" class="cls_005"><span class="cls_005">34</span></div>
<div style="position:absolute;left:130.75px;top:726.80px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (FD_ISSET(s1, &readfds)) {</span></div>
<div style="position:absolute;left:76.48px;top:742.65px" class="cls_005"><span class="cls_005">35</span></div>
<div style="position:absolute;left:157.60px;top:742.65px" class="cls_005"><span class="cls_005">recv(s1, buf1, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf1, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">142 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:120842px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background143.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">36</span></div>
<div style="position:absolute;left:130.75px;top:54.93px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">37</span></div>
<div style="position:absolute;left:130.75px;top:70.79px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (FD_ISSET(s2, &readfds)) {</span></div>
<div style="position:absolute;left:76.48px;top:86.64px" class="cls_005"><span class="cls_005">38</span></div>
<div style="position:absolute;left:157.60px;top:86.64px" class="cls_005"><span class="cls_005">recv(s2, buf2, </span><span class="cls_014">sizeof</span><span class="cls_005"> buf2, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:102.50px" class="cls_005"><span class="cls_005">39</span></div>
<div style="position:absolute;left:130.75px;top:102.50px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:76.48px;top:118.35px" class="cls_005"><span class="cls_005">40</span></div>
<div style="position:absolute;left:103.89px;top:118.35px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:155.15px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:184.96px" class="cls_023"><span class="cls_023">poll</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:214.74px" class="cls_007"><span class="cls_007">setsockopt(), getsockopt()</span></div>
<div style="position:absolute;left:60.99px;top:250.13px" class="cls_005"><span class="cls_005">Ajusta várias opções para um socket.</span></div>
<div style="position:absolute;left:60.99px;top:279.00px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:315.80px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:331.66px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:363.37px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> getsockopt(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">int</span><span class="cls_005"> level, </span><span class="cls_008">int</span><span class="cls_005"> optname, </span><span class="cls_008">void</span><span class="cls_005"> *optval,</span></div>
<div style="position:absolute;left:195.55px;top:379.22px" class="cls_005"><span class="cls_005">socklen_t *optlen);</span></div>
<div style="position:absolute;left:94.85px;top:394.14px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> setsockopt(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">int</span><span class="cls_005"> level, </span><span class="cls_008">int</span><span class="cls_005"> optname, </span><span class="cls_008">const  void</span></div>
<div style="position:absolute;left:123.94px;top:408.13px" class="cls_005"><span class="cls_005">*optval,</span></div>
<div style="position:absolute;left:195.55px;top:423.98px" class="cls_005"><span class="cls_005">socklen_t optlen);</span></div>
<div style="position:absolute;left:60.99px;top:460.79px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:489.66px" class="cls_005"><span class="cls_005">Sockets são completamente con guráveis. Na verdade, eles são tão con guráveis que nem</span></div>
<div style="position:absolute;left:60.99px;top:503.65px" class="cls_005"><span class="cls_005">mesmo cobrirei tudo aqui. Provavelmente é dependente do sistema, de qualquer maneira. Mas</span></div>
<div style="position:absolute;left:60.99px;top:517.64px" class="cls_005"><span class="cls_005">vou falar sobre o básico.</span></div>
<div style="position:absolute;left:60.99px;top:542.82px" class="cls_005"><span class="cls_005">Obviamente, essas funções obtêm e de nem determinadas opções em um socket. Em um</span></div>
<div style="position:absolute;left:60.99px;top:556.81px" class="cls_005"><span class="cls_005">ambiente Linux, todas as informações sobre sockets estão na página man de socket na seção</span></div>
<div style="position:absolute;left:60.99px;top:571.73px" class="cls_005"><span class="cls_005">7. (Digite: "man</span></div>
<div style="position:absolute;left:141.41px;top:571.73px" class="cls_005"><span class="cls_005">7 socket" para obter todas estas guloseimas.)</span></div>
<div style="position:absolute;left:60.99px;top:598.78px" class="cls_005"><span class="cls_005">Quanto aos parâmetros, s é o socket em questão, level deve ser de nido como SOL_SOCKET.</span></div>
<div style="position:absolute;left:60.99px;top:614.63px" class="cls_005"><span class="cls_005">Em seguida, de na optname para o nome que você está interessado. Novamente, veja sua</span></div>
<div style="position:absolute;left:60.99px;top:629.55px" class="cls_005"><span class="cls_005">página man para todas as opções, mas aqui estão algumas das mais divertidas:</span></div>
<div style="position:absolute;left:99.64px;top:663.59px" class="cls_025"><span class="cls_025">optname</span></div>
<div style="position:absolute;left:333.84px;top:663.59px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:193.91px;top:679.91px" class="cls_005"><span class="cls_005">Vincula este socket a um nome de dispositivo simbólico como</span></div>
<div style="position:absolute;left:193.91px;top:694.83px" class="cls_005"><span class="cls_005">eth0 em vez de usar bind() para vinculá-lo a um endereço IP.</span></div>
<div style="position:absolute;left:69.39px;top:702.76px" class="cls_005"><span class="cls_005">SO_BINDTODEVICE</span></div>
<div style="position:absolute;left:193.91px;top:710.69px" class="cls_005"><span class="cls_005">Digite o comando ifconfig em Unix para ver o nomes dos</span></div>
<div style="position:absolute;left:193.91px;top:725.61px" class="cls_005"><span class="cls_005">dispositivos.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">143 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:121693px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background144.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:99.64px;top:62.86px" class="cls_025"><span class="cls_025">optname</span></div>
<div style="position:absolute;left:333.84px;top:62.86px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:193.91px;top:80.11px" class="cls_005"><span class="cls_005">Permite que outros sockets façam bind() contra esta porta, a</span></div>
<div style="position:absolute;left:193.91px;top:95.03px" class="cls_005"><span class="cls_005">menos que haja um socket de escuta ativo já ligado à porta. Isso</span></div>
<div style="position:absolute;left:69.39px;top:101.10px" class="cls_005"><span class="cls_005">SO_REUSEADDR</span></div>
<div style="position:absolute;left:193.91px;top:109.02px" class="cls_005"><span class="cls_005">permite que você contorne as mensagens de erro "Endereço já em</span></div>
<div style="position:absolute;left:193.91px;top:123.01px" class="cls_005"><span class="cls_005">uso" ao tentar reiniciar o servidor após uma falha.</span></div>
<div style="position:absolute;left:193.91px;top:139.33px" class="cls_005"><span class="cls_005">Permite que sockets UDP datagram (SOCK_DGRAM) enviem e</span></div>
<div style="position:absolute;left:69.39px;top:153.32px" class="cls_005"><span class="cls_005">SOCK_DGRAM</span></div>
<div style="position:absolute;left:193.91px;top:154.25px" class="cls_005"><span class="cls_005">recebam pacotes para e do endereço de broadcast. Não faz</span></div>
<div style="position:absolute;left:193.91px;top:168.24px" class="cls_005"><span class="cls_005">nada—NADA!!—para sockets TCP stream! Hahaha!</span></div>
<div style="position:absolute;left:60.99px;top:203.68px" class="cls_005"><span class="cls_005">Quanto ao parâmetro optval, geralmente é um ponteiro para um int indicando o valor em</span></div>
<div style="position:absolute;left:60.99px;top:218.60px" class="cls_005"><span class="cls_005">questão. Para booleanos, zero é falso, e diferente de zero é verdade. E isso é um fato absoluto,</span></div>
<div style="position:absolute;left:60.99px;top:232.59px" class="cls_005"><span class="cls_005">a menos que seja diferente em seu sistema. Se não houver um parâmetro a ser passado,</span></div>
<div style="position:absolute;left:60.99px;top:247.51px" class="cls_005"><span class="cls_005">optval pode ser NULL.</span></div>
<div style="position:absolute;left:60.99px;top:274.56px" class="cls_005"><span class="cls_005">O parâmetro  nal, optlen, deve ser de nido para o comprimento de optval, provavelmente</span></div>
<div style="position:absolute;left:60.99px;top:290.41px" class="cls_005"><span class="cls_005">sizeof(int), mas varia dependendo da opção. Observe que, no caso de getsockopt(),</span></div>
<div style="position:absolute;left:60.99px;top:306.27px" class="cls_005"><span class="cls_005">esse é um ponteiro para um socklen_t, e especi ca o objeto de tamanho máximo que será</span></div>
<div style="position:absolute;left:60.99px;top:322.12px" class="cls_005"><span class="cls_005">armazenado em optval (para evitar buffer over  ows). E getsockopt() modi cará o valor de</span></div>
<div style="position:absolute;left:60.99px;top:337.98px" class="cls_005"><span class="cls_005">optlen para re  etir o número de bytes realmente de nidos.</span></div>
<div style="position:absolute;left:60.99px;top:365.02px" class="cls_005"><span class="cls_005">Aviso: em alguns sistemas (nomeadamente Sun e Windows), a option pode ser um char em</span></div>
<div style="position:absolute;left:60.99px;top:380.88px" class="cls_005"><span class="cls_005">vez de um int, e é de nida como, por exemplo, um valor de caractere '1' em vez de um valor</span></div>
<div style="position:absolute;left:60.99px;top:396.73px" class="cls_005"><span class="cls_005">int 1. Mais uma vez, veri que as suas próprias man pages para obter mais informações com</span></div>
<div style="position:absolute;left:60.99px;top:412.58px" class="cls_005"><span class="cls_005">"man setsockopt" e "man 7 socket"!</span></div>
<div style="position:absolute;left:60.99px;top:442.39px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:472.20px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:487.12px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:516.00px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:552.80px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:552.80px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> optval;</span></div>
<div style="position:absolute;left:83.19px;top:568.65px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:568.65px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> optlen;</span></div>
<div style="position:absolute;left:83.19px;top:584.51px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:584.51px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *optval2;</span></div>
<div style="position:absolute;left:83.19px;top:600.36px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:616.22px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:616.22px" class="cls_013"><span class="cls_013">// define SO_REUSEADDR em um socket para true (1):</span></div>
<div style="position:absolute;left:83.19px;top:632.07px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:632.07px" class="cls_005"><span class="cls_005">optval = </span><span class="cls_009">1</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:646.99px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:646.99px" class="cls_005"><span class="cls_005">setsockopt(s1, SOL_SOCKET, SO_REUSEADDR, &optval, </span><span class="cls_014">sizeof</span></div>
<div style="position:absolute;left:109.49px;top:660.98px" class="cls_005"><span class="cls_005">optval);</span></div>
<div style="position:absolute;left:83.19px;top:676.84px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:83.19px;top:691.76px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:103.89px;top:691.76px" class="cls_013"><span class="cls_013">// liga socket a nome de dispositivo (pode não funcionar</span></div>
<div style="position:absolute;left:109.49px;top:705.75px" class="cls_013"><span class="cls_013">em todos S.O):</span></div>
<div style="position:absolute;left:76.48px;top:721.60px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:721.60px" class="cls_005"><span class="cls_005">optval2 = </span><span class="cls_010">"eth1"</span><span class="cls_005">; </span><span class="cls_013">// 4 bytes long, então 4, abaixo:</span></div>
<div style="position:absolute;left:76.48px;top:737.45px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:737.45px" class="cls_005"><span class="cls_005">setsockopt(s2, SOL_SOCKET, SO_BINDTODEVICE, optval2, </span><span class="cls_009">4</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">144 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:122544px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background145.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.93px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:76.48px;top:70.79px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:70.79px" class="cls_013"><span class="cls_013">// veja se a flag SO_BROADCAST está definida:</span></div>
<div style="position:absolute;left:76.48px;top:85.71px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:85.71px" class="cls_005"><span class="cls_005">getsockopt(s3, SOL_SOCKET, SO_BROADCAST, &optval,</span></div>
<div style="position:absolute;left:109.49px;top:99.70px" class="cls_005"><span class="cls_005">&optlen);</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:115.55px" class="cls_014"><span class="cls_014">if</span><span class="cls_005"> (optval != </span><span class="cls_009">0</span><span class="cls_005">) {</span></div>
<div style="position:absolute;left:76.48px;top:131.41px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:130.75px;top:131.41px" class="cls_005"><span class="cls_005">print(</span><span class="cls_010">"SO_BROADCAST ativado em s3!\n"</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:147.26px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:147.26px" class="cls_005"><span class="cls_005">}</span></div>
<div style="position:absolute;left:60.99px;top:184.06px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:213.87px" class="cls_023"><span class="cls_023">fcntl</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:243.66px" class="cls_007"><span class="cls_007">send(), sendto()</span></div>
<div style="position:absolute;left:60.99px;top:279.04px" class="cls_005"><span class="cls_005">Envia dados através de um socket.</span></div>
<div style="position:absolute;left:60.99px;top:307.91px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:344.71px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:360.57px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:392.28px" class="cls_008"><span class="cls_008">ssize_t</span><span class="cls_005"> send(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">const  void</span><span class="cls_005"> *buf, </span><span class="cls_008">size_t</span><span class="cls_005"> len, </span><span class="cls_008">int</span><span class="cls_005"> flags);</span></div>
<div style="position:absolute;left:94.85px;top:408.13px" class="cls_008"><span class="cls_008">ssize_t</span><span class="cls_005"> sendto(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">const  void</span><span class="cls_005"> *buf, </span><span class="cls_008">size_t</span><span class="cls_005"> len,</span></div>
<div style="position:absolute;left:195.57px;top:423.98px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> flags, </span><span class="cls_008">const</span><span class="cls_014">  struct</span><span class="cls_005"> sockaddr *to,</span></div>
<div style="position:absolute;left:195.55px;top:439.84px" class="cls_005"><span class="cls_005">socklen_t tolen);</span></div>
<div style="position:absolute;left:60.99px;top:476.64px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:506.45px" class="cls_005"><span class="cls_005">Estas funções enviam dados para um socket. De um modo geral, send() é usada para</span></div>
<div style="position:absolute;left:60.99px;top:522.30px" class="cls_005"><span class="cls_005">sockets TCP SOCK_STREAM conectados, e sendto() é utilizada para sockets datagram UDP</span></div>
<div style="position:absolute;left:60.99px;top:538.16px" class="cls_005"><span class="cls_005">SOCK_DGRAM desconectados. Com os sockets não conectados, você deve especi car o</span></div>
<div style="position:absolute;left:60.99px;top:553.08px" class="cls_005"><span class="cls_005">destino de um pacote toda vez que você enviar um, e é por isso que os últimos parâmetros de</span></div>
<div style="position:absolute;left:60.99px;top:568.00px" class="cls_005"><span class="cls_005">sendto() de nem para onde o pacote irá.</span></div>
<div style="position:absolute;left:60.99px;top:595.05px" class="cls_005"><span class="cls_005">Com send() e sendto(), o parâmetro s é o socket, buf é um ponteiro para os dados que</span></div>
<div style="position:absolute;left:60.99px;top:610.90px" class="cls_005"><span class="cls_005">você deseja enviar, len é o número de bytes que você deseja enviar e flags permite que você</span></div>
<div style="position:absolute;left:60.99px;top:626.75px" class="cls_005"><span class="cls_005">especi que mais informações sobre como os dados devem ser enviados. De na flags para</span></div>
<div style="position:absolute;left:60.99px;top:641.68px" class="cls_005"><span class="cls_005">zero se você quiser que sejam dados "normais". Aqui estão algumas das   ags comumente</span></div>
<div style="position:absolute;left:60.99px;top:656.60px" class="cls_005"><span class="cls_005">usadas, mas veri que as suas man pages locais de send() para mais detalhes:</span></div>
<div style="position:absolute;left:100.37px;top:690.64px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:326.73px;top:690.64px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:179.70px;top:706.03px" class="cls_005"><span class="cls_005">Enviar dados como "out of band". TCP suporta isso, e é uma maneira</span></div>
<div style="position:absolute;left:179.70px;top:720.01px" class="cls_005"><span class="cls_005">de informar ao sistema receptor que esses dados têm uma maior</span></div>
<div style="position:absolute;left:69.39px;top:723.70px" class="cls_005"><span class="cls_005">MSG_OOB</span></div>
<div style="position:absolute;left:179.70px;top:734.94px" class="cls_005"><span class="cls_005">prioridade que os dados normais. O receptor receberá o sinal SIGURG</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">145 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:123395px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background146.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:100.37px;top:61.93px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:326.73px;top:61.93px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:179.70px;top:77.31px" class="cls_005"><span class="cls_005">e poderá receber esses dados sem antes receber todos os demais</span></div>
<div style="position:absolute;left:179.70px;top:91.30px" class="cls_005"><span class="cls_005">dados normais da  la.</span></div>
<div style="position:absolute;left:179.70px;top:106.69px" class="cls_005"><span class="cls_005">Não envie esses dados através de um roteador, apenas mantenha-os</span></div>
<div style="position:absolute;left:69.39px;top:113.69px" class="cls_005"><span class="cls_005">MSG_DONTROUTE</span></div>
<div style="position:absolute;left:179.70px;top:120.68px" class="cls_005"><span class="cls_005">localmente.</span></div>
<div style="position:absolute;left:179.70px;top:137.00px" class="cls_005"><span class="cls_005">Se send() bloquear porque o tráfego de saída está obstruído, faça-o</span></div>
<div style="position:absolute;left:69.39px;top:151.92px" class="cls_005"><span class="cls_005">MSG_DONTWAIT</span></div>
<div style="position:absolute;left:179.70px;top:152.86px" class="cls_005"><span class="cls_005">retornar EAGAIN. Isto é como um "ativar non-blocking somente para</span></div>
<div style="position:absolute;left:179.70px;top:167.78px" class="cls_005"><span class="cls_005">este send." Veja a seção sobre </span><span class="cls_023">blockin</span><span class="cls_006">g</span><span class="cls_005"> para obter mais detalhes.</span></div>
<div style="position:absolute;left:179.70px;top:184.10px" class="cls_005"><span class="cls_005">Se você enviar com send() a um host remoto que já não esta</span></div>
<div style="position:absolute;left:69.39px;top:199.02px" class="cls_005"><span class="cls_005">MSG_NOSIGNAL</span></div>
<div style="position:absolute;left:179.70px;top:199.95px" class="cls_005"><span class="cls_005">executando recv(), você normalmente obterá o sinal SIGPIPE. A</span></div>
<div style="position:absolute;left:179.70px;top:214.87px" class="cls_005"><span class="cls_005">adição desta   ag impede que o sinal se levante.</span></div>
<div style="position:absolute;left:60.99px;top:253.07px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:282.88px" class="cls_005"><span class="cls_005">Retorna o número de bytes realmente enviados ou -1 em caso de erro (e errno será de nido</span></div>
<div style="position:absolute;left:60.99px;top:297.80px" class="cls_005"><span class="cls_005">em conformidade.). Observe que o número de bytes realmente enviados pode ser menor que o</span></div>
<div style="position:absolute;left:60.99px;top:312.73px" class="cls_005"><span class="cls_005">número que você pediu para enviar! Veja a seção sobre </span><span class="cls_023">manipulando send</span><span class="cls_006">()</span><span class="cls_023">s parcialmente</span></div>
<div style="position:absolute;left:60.99px;top:327.65px" class="cls_005"><span class="cls_005">para uma função auxiliar para contornar este problema.</span></div>
<div style="position:absolute;left:60.99px;top:352.83px" class="cls_005"><span class="cls_005">Além disso, se o socket for fechado por qualquer um dos lados, o processo que chamar</span></div>
<div style="position:absolute;left:60.99px;top:367.75px" class="cls_005"><span class="cls_005">send() obterá o sinal SIGPIPE. (A menos que send() tenha sido chamado com a</span></div>
<div style="position:absolute;left:486.00px;top:367.75px" class="cls_005"><span class="cls_005">ag</span></div>
<div style="position:absolute;left:60.99px;top:383.60px" class="cls_005"><span class="cls_005">MSG_NOSIGNAL.)</span></div>
<div style="position:absolute;left:60.99px;top:413.41px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:450.21px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:450.21px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> spatula_count = </span><span class="cls_009">3490</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:466.07px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:466.07px" class="cls_008"><span class="cls_008">char</span><span class="cls_005"> *secret_message = </span><span class="cls_010">"The Cheese is in The Toaster"</span><span class="cls_005">;</span></div>
<div style="position:absolute;left:83.19px;top:481.92px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:497.78px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:497.78px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> stream_socket, dgram_socket;</span></div>
<div style="position:absolute;left:83.19px;top:513.63px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:513.63px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in dest;</span></div>
<div style="position:absolute;left:83.19px;top:529.48px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:529.48px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> temp;</span></div>
<div style="position:absolute;left:83.19px;top:545.34px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:83.19px;top:561.19px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:561.19px" class="cls_013"><span class="cls_013">// primeiro com sockets TCP stream:</span></div>
<div style="position:absolute;left:83.19px;top:577.05px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:592.90px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:592.90px" class="cls_013"><span class="cls_013">// assumir que sockets estão criados e conectados</span></div>
<div style="position:absolute;left:76.48px;top:608.76px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:608.76px" class="cls_013"><span class="cls_013">//stream_socket = socket(...</span></div>
<div style="position:absolute;left:76.48px;top:624.61px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:624.61px" class="cls_013"><span class="cls_013">//connect(stream_socket, ...</span></div>
<div style="position:absolute;left:76.48px;top:640.46px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:76.48px;top:656.32px" class="cls_005"><span class="cls_005">14</span></div>
<div style="position:absolute;left:103.89px;top:656.32px" class="cls_013"><span class="cls_013">// converter para network byte order</span></div>
<div style="position:absolute;left:76.48px;top:672.17px" class="cls_005"><span class="cls_005">15</span></div>
<div style="position:absolute;left:103.89px;top:672.17px" class="cls_005"><span class="cls_005">temp = htonl(spatula_count);</span></div>
<div style="position:absolute;left:76.48px;top:688.03px" class="cls_005"><span class="cls_005">16</span></div>
<div style="position:absolute;left:103.89px;top:688.03px" class="cls_013"><span class="cls_013">// envia dados com send normalmente:</span></div>
<div style="position:absolute;left:76.48px;top:703.88px" class="cls_005"><span class="cls_005">17</span></div>
<div style="position:absolute;left:103.89px;top:703.88px" class="cls_005"><span class="cls_005">send(stream_socket, &temp, </span><span class="cls_014">sizeof</span><span class="cls_005"> temp, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:719.73px" class="cls_005"><span class="cls_005">18</span></div>
<div style="position:absolute;left:76.48px;top:735.59px" class="cls_005"><span class="cls_005">19</span></div>
<div style="position:absolute;left:103.89px;top:735.59px" class="cls_013"><span class="cls_013">// envia mensagem secreta out of band:</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">146 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:124246px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background147.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:76.48px;top:54.00px" class="cls_005"><span class="cls_005">20</span></div>
<div style="position:absolute;left:103.89px;top:54.00px" class="cls_005"><span class="cls_005">send(stream_socket, secret_message,</span></div>
<div style="position:absolute;left:109.49px;top:67.99px" class="cls_005"><span class="cls_005">strlen(secret_message)+</span><span class="cls_009">1</span><span class="cls_005">, MSG_OOB);</span></div>
<div style="position:absolute;left:76.48px;top:83.84px" class="cls_005"><span class="cls_005">21</span></div>
<div style="position:absolute;left:76.48px;top:99.70px" class="cls_005"><span class="cls_005">22</span></div>
<div style="position:absolute;left:103.89px;top:99.70px" class="cls_013"><span class="cls_013">// agora com sockets UDP datagram:</span></div>
<div style="position:absolute;left:76.48px;top:115.55px" class="cls_005"><span class="cls_005">23</span></div>
<div style="position:absolute;left:103.89px;top:115.55px" class="cls_013"><span class="cls_013">//getaddrinfo(...</span></div>
<div style="position:absolute;left:76.48px;top:130.47px" class="cls_005"><span class="cls_005">24</span></div>
<div style="position:absolute;left:103.89px;top:130.47px" class="cls_013"><span class="cls_013">//dest = ... // assuma que "dest" contém o endereço do</span></div>
<div style="position:absolute;left:109.49px;top:144.46px" class="cls_013"><span class="cls_013">destino</span></div>
<div style="position:absolute;left:76.48px;top:160.32px" class="cls_005"><span class="cls_005">25</span></div>
<div style="position:absolute;left:103.89px;top:160.32px" class="cls_013"><span class="cls_013">//dgram_socket = socket(...</span></div>
<div style="position:absolute;left:76.48px;top:176.17px" class="cls_005"><span class="cls_005">26</span></div>
<div style="position:absolute;left:76.48px;top:192.02px" class="cls_005"><span class="cls_005">27</span></div>
<div style="position:absolute;left:103.89px;top:192.02px" class="cls_013"><span class="cls_013">// envia mensagem secreta normalmente:</span></div>
<div style="position:absolute;left:76.48px;top:206.95px" class="cls_005"><span class="cls_005">28</span></div>
<div style="position:absolute;left:103.89px;top:206.95px" class="cls_005"><span class="cls_005">sendto(dgram_socket, secret_message,</span></div>
<div style="position:absolute;left:109.49px;top:220.93px" class="cls_005"><span class="cls_005">strlen(secret_message)+</span><span class="cls_009">1</span><span class="cls_005">, </span><span class="cls_009">0</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:76.48px;top:236.79px" class="cls_005"><span class="cls_005">29</span></div>
<div style="position:absolute;left:150.90px;top:236.79px" class="cls_005"><span class="cls_005">(</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr*)&dest, </span><span class="cls_014">sizeof</span><span class="cls_005"> dest);</span></div>
<div style="position:absolute;left:60.99px;top:273.59px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:303.40px" class="cls_023"><span class="cls_023">recv</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">recvfrom</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:333.18px" class="cls_007"><span class="cls_007">shutdown()</span></div>
<div style="position:absolute;left:60.99px;top:368.57px" class="cls_005"><span class="cls_005">Para de enviar e ou receber em um socket.</span></div>
<div style="position:absolute;left:60.99px;top:397.44px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:434.24px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:465.95px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> shutdown(</span><span class="cls_008">int</span><span class="cls_005"> s, </span><span class="cls_008">int</span><span class="cls_005"> how);</span></div>
<div style="position:absolute;left:60.99px;top:502.75px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:532.56px" class="cls_005"><span class="cls_005">É isso aí! Nós temos isso! Se não quero mais permitir send()s no socket, mas eu ainda quero</span></div>
<div style="position:absolute;left:60.99px;top:548.42px" class="cls_005"><span class="cls_005">receber dados com recv() por ele! Ou vice-versa! Como posso fazer isso?</span></div>
<div style="position:absolute;left:60.99px;top:575.46px" class="cls_005"><span class="cls_005">Quando você fecha um descritor de socket com close(), ele fecha ambos os lados do socket</span></div>
<div style="position:absolute;left:60.99px;top:590.38px" class="cls_005"><span class="cls_005">para leitura e escrita, e libera o descritor de socket. Se você quiser apenas para fechar um lado</span></div>
<div style="position:absolute;left:60.99px;top:605.31px" class="cls_005"><span class="cls_005">ou outro, você pode usar esta chamada shutdown().</span></div>
<div style="position:absolute;left:60.99px;top:632.35px" class="cls_005"><span class="cls_005">Quanto aos parâmetros, s é, obviamente, o socket no qual você quer executar esta ação, e a</span></div>
<div style="position:absolute;left:60.99px;top:648.20px" class="cls_005"><span class="cls_005">ação escolhida e que possa ser especi cada estará no parâmetro how. How pode ser SHUT_RD</span></div>
<div style="position:absolute;left:60.99px;top:664.06px" class="cls_005"><span class="cls_005">para evitar mais recv()s, SHUT_WR para proibir mais send()s, ou SHUT_RDWR para ambos.</span></div>
<div style="position:absolute;left:60.99px;top:691.10px" class="cls_005"><span class="cls_005">Note que shutdown() não libera o descritor de socket, então você ainda tem que fechar o</span></div>
<div style="position:absolute;left:60.99px;top:706.96px" class="cls_005"><span class="cls_005">socket com close(), mesmo que tenha sido completamente desligado.</span></div>
<div style="position:absolute;left:60.99px;top:733.07px" class="cls_005"><span class="cls_005">Esta é uma chamada de sistema raramente usada.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">147 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:125097px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background148.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:83.81px" class="cls_005"><span class="cls_005">Retorna zero em caso de sucesso, ou -1 em caso de erro (e errno será de nido em</span></div>
<div style="position:absolute;left:60.99px;top:98.73px" class="cls_005"><span class="cls_005">conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:127.61px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:164.41px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:164.41px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:180.26px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:196.12px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:196.12px" class="cls_013"><span class="cls_013">// ...faça alguns send() e outras coisas aqui...</span></div>
<div style="position:absolute;left:83.19px;top:211.97px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:83.19px;top:227.82px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:103.89px;top:227.82px" class="cls_013"><span class="cls_013">// e agora que terminamos, não permita mais send()s:</span></div>
<div style="position:absolute;left:83.19px;top:243.68px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:243.68px" class="cls_005"><span class="cls_005">shutdown(s, SHUT_WR);</span></div>
<div style="position:absolute;left:60.99px;top:280.48px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:310.29px" class="cls_023"><span class="cls_023">close</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:60.99px;top:340.07px" class="cls_007"><span class="cls_007">socket()</span></div>
<div style="position:absolute;left:60.99px;top:375.45px" class="cls_005"><span class="cls_005">Aloca um descritor de socket.</span></div>
<div style="position:absolute;left:60.99px;top:404.33px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:441.13px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/types.h></span></div>
<div style="position:absolute;left:94.85px;top:456.99px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;sys/socket.h></span></div>
<div style="position:absolute;left:94.85px;top:488.70px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> socket(</span><span class="cls_008">int</span><span class="cls_005"> domain, </span><span class="cls_008">int</span><span class="cls_005"> type, </span><span class="cls_008">int</span><span class="cls_005"> protocol);</span></div>
<div style="position:absolute;left:60.99px;top:525.50px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:554.37px" class="cls_005"><span class="cls_005">Retorna um novo descritor de socket com o qual você pode fazer coisas de socket. Esta é</span></div>
<div style="position:absolute;left:60.99px;top:568.36px" class="cls_005"><span class="cls_005">geralmente a primeira chamada no processo enorme de escrever um programa com sockets, e</span></div>
<div style="position:absolute;left:60.99px;top:583.28px" class="cls_005"><span class="cls_005">você pode usar o resultado nas chamadas subsequentes como listen(), bind(),</span></div>
<div style="position:absolute;left:60.99px;top:599.14px" class="cls_005"><span class="cls_005">accept(), ou uma variedade de outras funções.</span></div>
<div style="position:absolute;left:60.99px;top:625.25px" class="cls_005"><span class="cls_005">No uso normal, você obtém os valores para esses parâmetros de uma chamada</span></div>
<div style="position:absolute;left:60.99px;top:640.17px" class="cls_005"><span class="cls_005">getaddrinfo(), como é mostrado no exemplo abaixo. Mas você pode preenchê-los à mão se</span></div>
<div style="position:absolute;left:60.99px;top:655.09px" class="cls_005"><span class="cls_005">você realmente quiser.</span></div>
<div style="position:absolute;left:83.80px;top:688.20px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:310.15px;top:688.20px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:146.55px;top:704.52px" class="cls_005"><span class="cls_005">domain descreve em que tipo de socket você está interessado. Isso pode,</span></div>
<div style="position:absolute;left:69.39px;top:719.44px" class="cls_005"><span class="cls_005">domain</span></div>
<div style="position:absolute;left:146.55px;top:719.44px" class="cls_005"><span class="cls_005">acredite, ser uma grande variedade de coisas, mas uma vez que este é um</span></div>
<div style="position:absolute;left:146.55px;top:734.37px" class="cls_005"><span class="cls_005">guia sobre sockets, ele será PF_INET para IPv4 e PF_INET6 para o IPv6.</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">148 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:125948px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background149.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:83.80px;top:61.93px" class="cls_025"><span class="cls_025">Macro</span></div>
<div style="position:absolute;left:310.15px;top:61.93px" class="cls_025"><span class="cls_025">Descri</span><span class="cls_005">ç</span><span class="cls_025">ão</span></div>
<div style="position:absolute;left:146.55px;top:78.25px" class="cls_005"><span class="cls_005">Além disso, o parâmetro type pode ser uma série de coisas, mas você</span></div>
<div style="position:absolute;left:146.55px;top:94.10px" class="cls_005"><span class="cls_005">provavelmente o con gurará como SOCK_STREAM para sockets TPC</span></div>
<div style="position:absolute;left:146.55px;top:109.96px" class="cls_005"><span class="cls_005">(send(), recv()) ou SOCK_DGRAM para rápidos e não con áveis sockets</span></div>
<div style="position:absolute;left:69.39px;top:116.95px" class="cls_005"><span class="cls_005">type</span></div>
<div style="position:absolute;left:146.55px;top:125.81px" class="cls_005"><span class="cls_005">UDP (sendto(), recvfrom()). (Outro tipo de socket interessante é</span></div>
<div style="position:absolute;left:146.55px;top:141.66px" class="cls_005"><span class="cls_005">SOCK_RAW, que pode ser usado para construir pacotes manualmente. É</span></div>
<div style="position:absolute;left:146.55px;top:156.59px" class="cls_005"><span class="cls_005">bem legal.)</span></div>
<div style="position:absolute;left:146.55px;top:172.91px" class="cls_005"><span class="cls_005">Finalmente, o parâmetro protocol informa qual protocolo usar com um</span></div>
<div style="position:absolute;left:146.55px;top:188.76px" class="cls_005"><span class="cls_005">determinado tipo de socket. Como eu já disse, por exemplo, SOCK_STREAM</span></div>
<div style="position:absolute;left:146.55px;top:204.61px" class="cls_005"><span class="cls_005">usa TCP. Felizmente para você, ao usar SOCK_STREAM ou SOCK_DGRAM,</span></div>
<div style="position:absolute;left:69.39px;top:210.68px" class="cls_005"><span class="cls_005">protocol</span></div>
<div style="position:absolute;left:146.55px;top:219.54px" class="cls_005"><span class="cls_005">você pode apenas de nir o protocolo como 0, e ele usará o protocolo</span></div>
<div style="position:absolute;left:146.55px;top:233.53px" class="cls_005"><span class="cls_005">apropriado automaticamente. Caso contrário, você pode usar</span></div>
<div style="position:absolute;left:146.55px;top:248.45px" class="cls_005"><span class="cls_005">getprotobyname() para procurar o número de protocolo correto.</span></div>
<div style="position:absolute;left:60.99px;top:287.58px" class="cls_005"><span class="cls_005">Valor de retorno</span></div>
<div style="position:absolute;left:60.99px;top:317.39px" class="cls_005"><span class="cls_005">O novo descritor de socket para ser usado em chamadas subsequentes, ou -1 em caso de erro</span></div>
<div style="position:absolute;left:60.99px;top:333.24px" class="cls_005"><span class="cls_005">(e errno será de nido em conformidade.)</span></div>
<div style="position:absolute;left:60.99px;top:363.05px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:399.85px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:399.85px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> addrinfo hints, *res;</span></div>
<div style="position:absolute;left:83.19px;top:415.71px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:103.89px;top:415.71px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> sockfd;</span></div>
<div style="position:absolute;left:83.19px;top:431.56px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:83.19px;top:446.48px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:446.48px" class="cls_013"><span class="cls_013">// Primeiro, carregue as estruturas de endereço com</span></div>
<div style="position:absolute;left:109.49px;top:460.47px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:83.19px;top:476.33px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:492.18px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:492.18px" class="cls_005"><span class="cls_005">memset(&hints, </span><span class="cls_009">0</span><span class="cls_005">, </span><span class="cls_014">sizeof</span><span class="cls_005"> hints);</span></div>
<div style="position:absolute;left:83.19px;top:507.10px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:507.10px" class="cls_005"><span class="cls_005">hints.ai_family = AF_UNSPEC;</span></div>
<div style="position:absolute;left:325.49px;top:507.10px" class="cls_013"><span class="cls_013">// AF_INET, AF_INET6,</span></div>
<div style="position:absolute;left:109.49px;top:521.09px" class="cls_013"><span class="cls_013">ou AF_UNSPEC</span></div>
<div style="position:absolute;left:83.19px;top:536.01px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:536.01px" class="cls_005"><span class="cls_005">hints.ai_socktype = SOCK_STREAM; </span><span class="cls_013">// SOCK_STREAM ou</span></div>
<div style="position:absolute;left:109.49px;top:550.00px" class="cls_013"><span class="cls_013">SOCK_DGRAM</span></div>
<div style="position:absolute;left:83.19px;top:565.86px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:581.71px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:581.71px" class="cls_005"><span class="cls_005">getaddrinfo(</span><span class="cls_010">"<A HREF="http://www.example.com"/">www.example.com"</A> </span><span class="cls_005">, </span><span class="cls_010">"3490"</span><span class="cls_005">, &hints, &res);</span></div>
<div style="position:absolute;left:76.48px;top:597.56px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:76.48px;top:612.49px" class="cls_005"><span class="cls_005">12</span></div>
<div style="position:absolute;left:103.89px;top:612.49px" class="cls_013"><span class="cls_013">// crie um socket usando as informações obtidas com</span></div>
<div style="position:absolute;left:109.49px;top:626.48px" class="cls_013"><span class="cls_013">getaddrinfo():</span></div>
<div style="position:absolute;left:76.48px;top:641.40px" class="cls_005"><span class="cls_005">13</span></div>
<div style="position:absolute;left:103.89px;top:641.40px" class="cls_005"><span class="cls_005">sockfd = socket(res->ai_family, res->ai_socktype,</span></div>
<div style="position:absolute;left:109.49px;top:655.39px" class="cls_005"><span class="cls_005">res->ai_protocol);</span></div>
<div style="position:absolute;left:60.99px;top:692.19px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:722.00px" class="cls_023"><span class="cls_023">accept</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">bind</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_006">g</span><span class="cls_023">etaddrinfo</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">listen</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">149 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:126799px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background150.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_007"><span class="cls_007">struct sockaddr e companhia</span></div>
<div style="position:absolute;left:60.99px;top:90.31px" class="cls_005"><span class="cls_005">Estruturas para a manipulação de endereços de internet.</span></div>
<div style="position:absolute;left:60.99px;top:119.19px" class="cls_005"><span class="cls_005">Sinopse</span></div>
<div style="position:absolute;left:94.85px;top:155.99px" class="cls_012"><span class="cls_012">#include </span><span class="cls_005">&lt;netinet/in.h></span></div>
<div style="position:absolute;left:94.85px;top:187.70px" class="cls_013"><span class="cls_013">// Todos os ponteiros para estruturas de endereços de socket são</span></div>
<div style="position:absolute;left:94.85px;top:203.55px" class="cls_013"><span class="cls_013">// convertidos em ponteiros para este tipo antes do uso:</span></div>
<div style="position:absolute;left:94.85px;top:235.26px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr {</span></div>
<div style="position:absolute;left:121.71px;top:250.18px" class="cls_008"><span class="cls_008">unsigned  short</span></div>
<div style="position:absolute;left:242.57px;top:250.18px" class="cls_005"><span class="cls_005">sa_family;</span></div>
<div style="position:absolute;left:336.59px;top:250.18px" class="cls_013"><span class="cls_013">// família de endereço,</span></div>
<div style="position:absolute;left:123.94px;top:264.17px" class="cls_013"><span class="cls_013">AF_xxx</span></div>
<div style="position:absolute;left:121.71px;top:279.09px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:242.56px;top:279.09px" class="cls_005"><span class="cls_005">sa_data[</span><span class="cls_009">14</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:336.58px;top:279.09px" class="cls_013"><span class="cls_013">// 14 bytes do endereço do</span></div>
<div style="position:absolute;left:123.94px;top:293.08px" class="cls_013"><span class="cls_013">protocolo</span></div>
<div style="position:absolute;left:94.85px;top:308.94px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:356.50px" class="cls_013"><span class="cls_013">// sockets IPv4 AF_INET:</span></div>
<div style="position:absolute;left:94.85px;top:388.21px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in {</span></div>
<div style="position:absolute;left:121.71px;top:404.06px" class="cls_008"><span class="cls_008">short</span></div>
<div style="position:absolute;left:235.85px;top:404.06px" class="cls_005"><span class="cls_005">sin_family;</span></div>
<div style="position:absolute;left:329.87px;top:404.06px" class="cls_013"><span class="cls_013">// ex. AF_INET, AF_INET6</span></div>
<div style="position:absolute;left:121.71px;top:419.92px" class="cls_008"><span class="cls_008">unsigned  short</span></div>
<div style="position:absolute;left:235.86px;top:419.92px" class="cls_005"><span class="cls_005">sin_port;</span></div>
<div style="position:absolute;left:329.86px;top:419.92px" class="cls_013"><span class="cls_013">// ex. htons(3490)</span></div>
<div style="position:absolute;left:121.71px;top:434.84px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr</span></div>
<div style="position:absolute;left:237.24px;top:434.84px" class="cls_005"><span class="cls_005">sin_addr;</span></div>
<div style="position:absolute;left:331.26px;top:434.84px" class="cls_013"><span class="cls_013">// veja struct in_addr,</span></div>
<div style="position:absolute;left:123.94px;top:448.83px" class="cls_013"><span class="cls_013">abaixo</span></div>
<div style="position:absolute;left:121.71px;top:464.68px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:235.85px;top:464.68px" class="cls_005"><span class="cls_005">sin_zero[</span><span class="cls_009">8</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:329.86px;top:464.68px" class="cls_013"><span class="cls_013">// zere isso se você quiser</span></div>
<div style="position:absolute;left:94.85px;top:480.54px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:512.24px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in_addr {</span></div>
<div style="position:absolute;left:121.71px;top:528.10px" class="cls_008"><span class="cls_008">unsigned  long</span><span class="cls_005"> s_addr;</span></div>
<div style="position:absolute;left:329.86px;top:528.10px" class="cls_013"><span class="cls_013">// carregar com inet_pton()</span></div>
<div style="position:absolute;left:94.85px;top:543.95px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:591.51px" class="cls_013"><span class="cls_013">// sockets IPv6 AF_INET6:</span></div>
<div style="position:absolute;left:94.85px;top:623.22px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 {</span></div>
<div style="position:absolute;left:121.70px;top:638.14px" class="cls_005"><span class="cls_005">u_int16_t</span></div>
<div style="position:absolute;left:229.12px;top:638.14px" class="cls_005"><span class="cls_005">sin6_family;</span></div>
<div style="position:absolute;left:329.87px;top:638.14px" class="cls_013"><span class="cls_013">// família de endereço,</span></div>
<div style="position:absolute;left:123.94px;top:652.13px" class="cls_013"><span class="cls_013">AF_INET6</span></div>
<div style="position:absolute;left:121.70px;top:667.05px" class="cls_005"><span class="cls_005">u_int16_t</span></div>
<div style="position:absolute;left:229.12px;top:667.05px" class="cls_005"><span class="cls_005">sin6_port;</span></div>
<div style="position:absolute;left:329.86px;top:667.05px" class="cls_013"><span class="cls_013">// número da porta, Network</span></div>
<div style="position:absolute;left:123.94px;top:681.04px" class="cls_013"><span class="cls_013">Byte Order</span></div>
<div style="position:absolute;left:121.70px;top:696.90px" class="cls_005"><span class="cls_005">u_int32_t</span></div>
<div style="position:absolute;left:229.12px;top:696.90px" class="cls_005"><span class="cls_005">sin6_flowinfo; </span><span class="cls_013">// informação de fluxo IPv6</span></div>
<div style="position:absolute;left:121.71px;top:712.75px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr sin6_addr;</span></div>
<div style="position:absolute;left:331.26px;top:712.75px" class="cls_013"><span class="cls_013">// endereço IPv6</span></div>
<div style="position:absolute;left:121.70px;top:728.61px" class="cls_005"><span class="cls_005">u_int32_t</span></div>
<div style="position:absolute;left:229.12px;top:728.61px" class="cls_005"><span class="cls_005">sin6_scope_id; </span><span class="cls_013">// ID do escopo</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">150 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:127650px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background151.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:94.85px;top:54.93px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:86.64px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> in6_addr {</span></div>
<div style="position:absolute;left:121.71px;top:102.50px" class="cls_008"><span class="cls_008">unsigned  char</span><span class="cls_005">   s6_addr[</span><span class="cls_009">16</span><span class="cls_005">];</span></div>
<div style="position:absolute;left:329.86px;top:102.50px" class="cls_013"><span class="cls_013">// carregar com inet_pton()</span></div>
<div style="position:absolute;left:94.85px;top:118.35px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:94.85px;top:165.91px" class="cls_013"><span class="cls_013">// Estrutura geral para guarda de endereços de sockets, grande</span></div>
<div style="position:absolute;left:94.85px;top:181.77px" class="cls_013"><span class="cls_013">// o suficiente para struct sockaddr_in ou struct sockaddr_in6:</span></div>
<div style="position:absolute;left:94.85px;top:213.47px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_storage {</span></div>
<div style="position:absolute;left:121.70px;top:229.33px" class="cls_005"><span class="cls_005">sa_family_t  ss_family;</span></div>
<div style="position:absolute;left:309.74px;top:229.33px" class="cls_013"><span class="cls_013">// família de endereço</span></div>
<div style="position:absolute;left:121.71px;top:260.10px" class="cls_013"><span class="cls_013">// tudo isso é preenchimento, implementação específica,</span></div>
<div style="position:absolute;left:123.94px;top:274.09px" class="cls_013"><span class="cls_013">ignore:</span></div>
<div style="position:absolute;left:121.71px;top:289.95px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:188.84px;top:289.95px" class="cls_005"><span class="cls_005">__ss_pad1[_SS_PAD1SIZE];</span></div>
<div style="position:absolute;left:121.71px;top:305.80px" class="cls_008"><span class="cls_008">int64_t</span></div>
<div style="position:absolute;left:188.85px;top:305.80px" class="cls_005"><span class="cls_005">__ss_align;</span></div>
<div style="position:absolute;left:121.71px;top:321.66px" class="cls_008"><span class="cls_008">char</span></div>
<div style="position:absolute;left:188.84px;top:321.66px" class="cls_005"><span class="cls_005">__ss_pad2[_SS_PAD2SIZE];</span></div>
<div style="position:absolute;left:94.85px;top:337.51px" class="cls_005"><span class="cls_005">};</span></div>
<div style="position:absolute;left:60.99px;top:374.31px" class="cls_005"><span class="cls_005">Descrição</span></div>
<div style="position:absolute;left:60.99px;top:403.19px" class="cls_005"><span class="cls_005">Estas são as estruturas básicas para todas as syscalls e funções que lidam com endereços da</span></div>
<div style="position:absolute;left:60.99px;top:418.11px" class="cls_005"><span class="cls_005">internet. Muitas vezes você usará getaddrinfo() para preencher estas estruturas, e, em</span></div>
<div style="position:absolute;left:60.99px;top:433.03px" class="cls_005"><span class="cls_005">seguida, você as lerá quando for necessário.</span></div>
<div style="position:absolute;left:60.99px;top:459.14px" class="cls_005"><span class="cls_005">Na memória, a struct sockaddr_in e a struct sockaddr_in6 partilham a mesma</span></div>
<div style="position:absolute;left:60.99px;top:475.00px" class="cls_005"><span class="cls_005">estrutura inicial que struct sockaddr, e você pode livremente converter o ponteiro de um</span></div>
<div style="position:absolute;left:60.99px;top:489.92px" class="cls_005"><span class="cls_005">tipo para outro, sem qualquer dano, exceto o possível  m do universo.</span></div>
<div style="position:absolute;left:60.99px;top:515.10px" class="cls_005"><span class="cls_005">Estou apenas brincando na parte do  m-do-universo... se o universo terminar, quando você</span></div>
<div style="position:absolute;left:60.99px;top:530.02px" class="cls_005"><span class="cls_005">tentar um cast de struct sockaddr_in* para uma struct sockaddr*, eu prometo a</span></div>
<div style="position:absolute;left:60.99px;top:544.94px" class="cls_005"><span class="cls_005">você que é pura coincidência e você não deveria nem se preocupar com isso.</span></div>
<div style="position:absolute;left:60.99px;top:570.12px" class="cls_005"><span class="cls_005">Então, com isso em mente, lembre-se que sempre que uma função disser que é necessária</span></div>
<div style="position:absolute;left:60.99px;top:585.04px" class="cls_005"><span class="cls_005">uma struct sockaddr* você pode realizar um cast com a sua struct sockaddr_in*,</span></div>
<div style="position:absolute;left:60.99px;top:600.90px" class="cls_005"><span class="cls_005">struct sockaddr_in6* ou struct sockaddr_storage* para aquele tipo com facilidade</span></div>
<div style="position:absolute;left:60.99px;top:615.82px" class="cls_005"><span class="cls_005">e segurança.</span></div>
<div style="position:absolute;left:60.99px;top:641.93px" class="cls_005"><span class="cls_005">struct sockaddr_in é a estrutura utilizada com endereços IPv4 (por exemplo,</span></div>
<div style="position:absolute;left:60.99px;top:657.79px" class="cls_005"><span class="cls_005">"192.0.2.10"). Ela mantém uma família de endereços (AF_INET), uma porta em sin_port, e</span></div>
<div style="position:absolute;left:60.99px;top:673.64px" class="cls_005"><span class="cls_005">um endereço IPv4 em sin_addr.</span></div>
<div style="position:absolute;left:60.99px;top:700.69px" class="cls_005"><span class="cls_005">Há também este campo sin_zero em struct sockaddr_in, que algumas pessoas</span></div>
<div style="position:absolute;left:60.99px;top:715.61px" class="cls_005"><span class="cls_005">a rmam que deve ser de nido para zero. Outras pessoas não a rmam nada sobre isso (a</span></div>
<div style="position:absolute;left:60.99px;top:729.60px" class="cls_005"><span class="cls_005">documentação Linux nem sequer menciona isso), e de ni-lo como zero não parece ser</span></div>
<div style="position:absolute;left:60.99px;top:744.52px" class="cls_005"><span class="cls_005">realmente necessário. Então, se você quiser, de na-o para zero usando memset().</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">151 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:128501px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background152.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.93px" class="cls_005"><span class="cls_005">Agora, essa struct in_addr é uma besta estranha em diferentes sistemas. Às vezes é uma</span></div>
<div style="position:absolute;left:60.99px;top:70.79px" class="cls_005"><span class="cls_005">union louca com todos os tipos de #defines e outras bobagens. Mas o que você deve fazer</span></div>
<div style="position:absolute;left:60.99px;top:86.64px" class="cls_005"><span class="cls_005">é usar apenas o campo s_addr nessa estrutura, porque muitos sistemas só implementam</span></div>
<div style="position:absolute;left:60.99px;top:101.56px" class="cls_005"><span class="cls_005">esse.</span></div>
<div style="position:absolute;left:60.99px;top:127.68px" class="cls_005"><span class="cls_005">struct sockaddr_in6 e struct in6_addr são muito semelhantes, exceto que elas são</span></div>
<div style="position:absolute;left:60.99px;top:142.60px" class="cls_005"><span class="cls_005">usadas para IPv6.</span></div>
<div style="position:absolute;left:60.99px;top:168.71px" class="cls_005"><span class="cls_005">struct sockaddr_storage é uma struct que você pode passar para accept() ou</span></div>
<div style="position:absolute;left:60.99px;top:184.56px" class="cls_005"><span class="cls_005">recvfrom() quando estiver tentando escrever um código independente de versão IP e não</span></div>
<div style="position:absolute;left:60.99px;top:200.42px" class="cls_005"><span class="cls_005">souber se o novo endereço será IPv4 ou IPv6. A estrutura struct sockaddr_storage é</span></div>
<div style="position:absolute;left:60.99px;top:216.27px" class="cls_005"><span class="cls_005">grande o su ciente para conter os dois tipos, ao contrário da pequena struct sockaddr</span></div>
<div style="position:absolute;left:60.99px;top:231.19px" class="cls_005"><span class="cls_005">original.</span></div>
<div style="position:absolute;left:60.99px;top:260.07px" class="cls_005"><span class="cls_005">Exemplo</span></div>
<div style="position:absolute;left:83.19px;top:296.87px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:296.87px" class="cls_013"><span class="cls_013">// IPv4:</span></div>
<div style="position:absolute;left:83.19px;top:312.73px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:328.58px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:328.58px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in ip4addr;</span></div>
<div style="position:absolute;left:83.19px;top:344.43px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:344.43px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:83.19px;top:360.29px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:376.14px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:376.14px" class="cls_005"><span class="cls_005">ip4addr.sin_family = AF_INET;</span></div>
<div style="position:absolute;left:83.19px;top:392.00px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:392.00px" class="cls_005"><span class="cls_005">ip4addr.sin_port = htons(</span><span class="cls_009">3490</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:407.85px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:407.85px" class="cls_005"><span class="cls_005">inet_pton(AF_INET, </span><span class="cls_010">"10.0.0.1"</span><span class="cls_005">, &ip4addr.sin_addr);</span></div>
<div style="position:absolute;left:83.19px;top:423.71px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:439.56px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:439.56px" class="cls_005"><span class="cls_005">s = socket(PF_INET, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:455.41px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:455.41px" class="cls_005"><span class="cls_005">bind(s, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr*)&ip4addr, </span><span class="cls_014">sizeof</span><span class="cls_005"> ip4addr);</span></div>
<div style="position:absolute;left:83.19px;top:496.45px" class="cls_005"><span class="cls_005">1</span></div>
<div style="position:absolute;left:103.89px;top:496.45px" class="cls_013"><span class="cls_013">// IPv6:</span></div>
<div style="position:absolute;left:83.19px;top:512.30px" class="cls_005"><span class="cls_005">2</span></div>
<div style="position:absolute;left:83.19px;top:528.16px" class="cls_005"><span class="cls_005">3</span></div>
<div style="position:absolute;left:103.89px;top:528.16px" class="cls_014"><span class="cls_014">struct</span><span class="cls_005"> sockaddr_in6 ip6addr;</span></div>
<div style="position:absolute;left:83.19px;top:544.01px" class="cls_005"><span class="cls_005">4</span></div>
<div style="position:absolute;left:103.89px;top:544.01px" class="cls_008"><span class="cls_008">int</span><span class="cls_005"> s;</span></div>
<div style="position:absolute;left:83.19px;top:559.86px" class="cls_005"><span class="cls_005">5</span></div>
<div style="position:absolute;left:83.19px;top:575.72px" class="cls_005"><span class="cls_005">6</span></div>
<div style="position:absolute;left:103.89px;top:575.72px" class="cls_005"><span class="cls_005">ip6addr.sin6_family = AF_INET6;</span></div>
<div style="position:absolute;left:83.19px;top:591.57px" class="cls_005"><span class="cls_005">7</span></div>
<div style="position:absolute;left:103.89px;top:591.57px" class="cls_005"><span class="cls_005">ip6addr.sin6_port = htons(</span><span class="cls_009">4950</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:83.19px;top:606.49px" class="cls_005"><span class="cls_005">8</span></div>
<div style="position:absolute;left:103.89px;top:606.49px" class="cls_005"><span class="cls_005">inet_pton(AF_INET6, </span><span class="cls_010">"2001:db8:8714:3a90::12"</span><span class="cls_005">,</span></div>
<div style="position:absolute;left:109.49px;top:620.48px" class="cls_005"><span class="cls_005">&ip6addr.sin6_addr);</span></div>
<div style="position:absolute;left:83.19px;top:636.34px" class="cls_005"><span class="cls_005">9</span></div>
<div style="position:absolute;left:76.48px;top:652.19px" class="cls_005"><span class="cls_005">10</span></div>
<div style="position:absolute;left:103.89px;top:652.19px" class="cls_005"><span class="cls_005">s = socket(PF_INET6, SOCK_STREAM, </span><span class="cls_009">0</span><span class="cls_005">);</span></div>
<div style="position:absolute;left:76.48px;top:668.05px" class="cls_005"><span class="cls_005">11</span></div>
<div style="position:absolute;left:103.89px;top:668.05px" class="cls_005"><span class="cls_005">bind(s, (</span><span class="cls_014">struct</span><span class="cls_005"> sockaddr*)&ip6addr, </span><span class="cls_014">sizeof</span><span class="cls_005"> ip6addr);</span></div>
<div style="position:absolute;left:60.99px;top:704.85px" class="cls_005"><span class="cls_005">Veja também</span></div>
<div style="position:absolute;left:60.99px;top:734.66px" class="cls_023"><span class="cls_023">accept</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">bind</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">connect</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">aton</span><span class="cls_006">()</span><span class="cls_005">, </span><span class="cls_023">inet</span><span class="cls_006">_</span><span class="cls_023">ntoa</span><span class="cls_006">()</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">152 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:129352px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background153.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:53.07px" class="cls_002"><span class="cls_002">Mais Referências</span></div>
<div style="position:absolute;left:60.99px;top:96.04px" class="cls_005"><span class="cls_005">Você chegou até aqui, e agora está gritando por mais! Onde mais você pode ir para aprender</span></div>
<div style="position:absolute;left:60.99px;top:110.03px" class="cls_005"><span class="cls_005">mais sobre tudo isso?</span></div>
<div style="position:absolute;left:60.99px;top:137.01px" class="cls_007"><span class="cls_007">Livros</span></div>
<div style="position:absolute;left:60.99px;top:172.39px" class="cls_005"><span class="cls_005">Para um livro de papel de celulose, old-school, segure-isso-em-suas-mãos, experimente alguns</span></div>
<div style="position:absolute;left:60.99px;top:186.38px" class="cls_005"><span class="cls_005">dos seguintes excelentes livros. Eles redirecionam para links a liados com um livreiro popular,</span></div>
<div style="position:absolute;left:60.99px;top:200.37px" class="cls_005"><span class="cls_005">me oferecendo ótimos subornos. Se você está apenas se sentindo generoso, pode pagar uma</span></div>
<div style="position:absolute;left:60.99px;top:215.29px" class="cls_005"><span class="cls_005">doação para </span><span class="cls_023">bee</span><span class="cls_006">j</span><span class="cls_023">@bee</span><span class="cls_006">j</span><span class="cls_023">.us</span><span class="cls_005">. :-)</span></div>
<div style="position:absolute;left:60.99px;top:241.41px" class="cls_005"><span class="cls_005">Unix Network Programming, volumes 1-2 por W. Richard Stevens. Publicado pela Addison-</span></div>
<div style="position:absolute;left:60.99px;top:255.39px" class="cls_005"><span class="cls_005">Wesley Professional e Prentice Hall. ISBNs para os volumes 1-2: </span><span class="cls_023">978-0131411555</span><span class="cls_024"><sup>49</sup></span><span class="cls_005">,</span></div>
<div style="position:absolute;left:60.99px;top:271.32px" class="cls_023"><span class="cls_023">978-0130810816</span><span class="cls_024"><sup>50</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:298.43px" class="cls_005"><span class="cls_005">Internetworking with TCP/IP, volume I por Douglas E. Comer. Publicado pela Pearson. ISBN</span></div>
<div style="position:absolute;left:60.99px;top:312.42px" class="cls_023"><span class="cls_023">978-0136085300</span><span class="cls_024"><sup>51</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:339.54px" class="cls_005"><span class="cls_005">TCP/IP Illustrated, volumes 1-3 por W. Richard Stevens and Gary R. Wright. Publicado pela</span></div>
<div style="position:absolute;left:60.99px;top:353.53px" class="cls_005"><span class="cls_005">Addison Wesley. ISBNs para os volumes 1, 2, e 3 (e um conjunto com 3 volumes):</span></div>
<div style="position:absolute;left:60.99px;top:367.52px" class="cls_023"><span class="cls_023">978-0201633467</span><span class="cls_024"><sup>52</sup></span><span class="cls_005">, </span><span class="cls_023">978-0201633542</span><span class="cls_024"><sup>53</sup></span><span class="cls_005">, </span><span class="cls_023">978-0201634952</span><span class="cls_024"><sup>54</sup></span><span class="cls_005">, (</span><span class="cls_023">978-0201776317</span><span class="cls_024"><sup>55</sup></span><span class="cls_005">).</span></div>
<div style="position:absolute;left:60.99px;top:394.63px" class="cls_005"><span class="cls_005">TCP/IP Network Administration por Craig Hunt. Publicado pela O’Reilly & Associates, Inc.</span></div>
<div style="position:absolute;left:60.99px;top:408.62px" class="cls_005"><span class="cls_005">ISBN </span><span class="cls_023">978-0596002978</span><span class="cls_024"><sup>56</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:435.74px" class="cls_005"><span class="cls_005">Advanced Programming in the UNIX Environment por W. Richard Stevens. Publicado por</span></div>
<div style="position:absolute;left:60.99px;top:449.72px" class="cls_005"><span class="cls_005">Addison Wesley. ISBN </span><span class="cls_023">978-0321637734</span><span class="cls_024"><sup>57</sup></span><span class="cls_005">.</span></div>
<div style="position:absolute;left:60.99px;top:478.65px" class="cls_007"><span class="cls_007">Web Referências</span></div>
<div style="position:absolute;left:60.99px;top:514.03px" class="cls_005"><span class="cls_005">Na web:</span></div>
<div style="position:absolute;left:60.99px;top:539.21px" class="cls_023"><span class="cls_023">BSD Sockets: A Quick And Dirt</span><span class="cls_006">y</span><span class="cls_023"> Primer</span><span class="cls_025"> </span><span class="cls_024"><sup>58</sup></span><span class="cls_005"> (Informações de programação do sistema Unix</span></div>
<div style="position:absolute;left:60.99px;top:555.13px" class="cls_005"><span class="cls_005">também!)</span></div>
<div style="position:absolute;left:60.99px;top:580.31px" class="cls_023"><span class="cls_023">The Unix Socket FAQ</span><span class="cls_024"><sup>59</sup></span></div>
<div style="position:absolute;left:60.99px;top:607.43px" class="cls_023"><span class="cls_023">TCP/IP FAQ</span><span class="cls_024"><sup>60</sup></span></div>
<div style="position:absolute;left:60.99px;top:634.54px" class="cls_023"><span class="cls_023">The Winsock FAQ</span><span class="cls_024"><sup>61</sup></span></div>
<div style="position:absolute;left:60.99px;top:661.66px" class="cls_005"><span class="cls_005">E aqui estão algumas páginas relevantes na Wikipédia:</span></div>
<div style="position:absolute;left:60.99px;top:686.84px" class="cls_023"><span class="cls_023">Berkele</span><span class="cls_006">y</span><span class="cls_023"> Sockets</span><span class="cls_024"><sup>62</sup></span></div>
<div style="position:absolute;left:60.99px;top:713.95px" class="cls_023"><span class="cls_023">Internet Protocol </span><span class="cls_006">(</span><span class="cls_023">IP</span><span class="cls_006">)</span><span class="cls_024"><sup>63</sup></span></div>
<div style="position:absolute;left:60.99px;top:741.07px" class="cls_023"><span class="cls_023">Transmission Control Protocol </span><span class="cls_006">(</span><span class="cls_023">TCP</span><span class="cls_006">)</span><span class="cls_024"><sup>64</sup></span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">153 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:130203px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background154.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_023"><span class="cls_023">User Data</span><span class="cls_006">g</span><span class="cls_023">ram Protocol </span><span class="cls_006">(</span><span class="cls_023">UDP</span><span class="cls_006">)</span><span class="cls_024"><sup>65</sup></span></div>
<div style="position:absolute;left:60.99px;top:81.12px" class="cls_023"><span class="cls_023">Client-Server</span><span class="cls_024"><sup>66</sup></span></div>
<div style="position:absolute;left:60.99px;top:108.23px" class="cls_023"><span class="cls_023">Serialization</span><span class="cls_024"><sup>67</sup></span><span class="cls_005"> (empacotando e desempacotando dados)</span></div>
<div style="position:absolute;left:60.99px;top:137.15px" class="cls_007"><span class="cls_007">RFCs</span></div>
<div style="position:absolute;left:60.99px;top:172.53px" class="cls_023"><span class="cls_023">RFCs</span><span class="cls_024"><sup>68</sup></span><span class="cls_005">—A sujeira real! Estes são documentos que descrevem números atribuídos, APIs de</span></div>
<div style="position:absolute;left:60.99px;top:188.46px" class="cls_005"><span class="cls_005">programação e protocolos usados na Internet. Incluí links para alguns deles aqui para sua</span></div>
<div style="position:absolute;left:60.99px;top:202.45px" class="cls_005"><span class="cls_005">diversão, então pegue um balde de pipoca e coloque seu boné do pensamento:</span></div>
<div style="position:absolute;left:60.99px;top:227.63px" class="cls_026"><span class="cls_026">RFC 1</span><span class="cls_005"> </span><span class="cls_024"><sup>69</sup></span><span class="cls_005">—A primeiro RFC; Isso lhe dá uma idéia de como era a "Internet", assim como ela</span></div>
<div style="position:absolute;left:60.99px;top:243.55px" class="cls_005"><span class="cls_005">estava ganhando vida, e uma visão de como ela estava sendo projetada desde o zero. (Esta</span></div>
<div style="position:absolute;left:60.99px;top:257.54px" class="cls_005"><span class="cls_005">RFC é completamente obsoleta, obviamente!)</span></div>
<div style="position:absolute;left:60.99px;top:282.72px" class="cls_023"><span class="cls_023">RFC 768</span><span class="cls_024"><sup>70</sup></span><span class="cls_005"> —The User Datagram Protocol (UDP)</span></div>
<div style="position:absolute;left:60.99px;top:309.83px" class="cls_023"><span class="cls_023">RFC 791</span><span class="cls_024"><sup>71</sup></span><span class="cls_005"> —The Internet Protocol (IP)</span></div>
<div style="position:absolute;left:60.99px;top:336.95px" class="cls_023"><span class="cls_023">RFC 793</span><span class="cls_024"><sup>72</sup></span><span class="cls_005"> —The Transmission Control Protocol (TCP)</span></div>
<div style="position:absolute;left:60.99px;top:364.07px" class="cls_023"><span class="cls_023">RFC 854</span><span class="cls_024"><sup>73</sup></span><span class="cls_005"> —The Telnet Protocol</span></div>
<div style="position:absolute;left:60.99px;top:391.18px" class="cls_023"><span class="cls_023">RFC 959</span><span class="cls_024"><sup>74</sup></span><span class="cls_005"> —File Transfer Protocol (FTP)</span></div>
<div style="position:absolute;left:60.99px;top:418.30px" class="cls_023"><span class="cls_023">RFC 1350</span><span class="cls_024"><sup>75</sup></span><span class="cls_005"> —The Trivial File Transfer Protocol (TFTP)</span></div>
<div style="position:absolute;left:60.99px;top:445.41px" class="cls_023"><span class="cls_023">RFC 1459</span><span class="cls_024"><sup>76</sup></span><span class="cls_005"> —Internet Relay Chat Protocol (IRC)</span></div>
<div style="position:absolute;left:60.99px;top:472.53px" class="cls_023"><span class="cls_023">RFC 1918</span><span class="cls_024"><sup>77</sup></span><span class="cls_005"> —Address Allocation for Private Internets</span></div>
<div style="position:absolute;left:60.99px;top:499.64px" class="cls_023"><span class="cls_023">RFC 2131</span><span class="cls_024"><sup>78</sup></span><span class="cls_005"> —Dynamic Host Con guration Protocol (DHCP)</span></div>
<div style="position:absolute;left:60.99px;top:526.76px" class="cls_023"><span class="cls_023">RFC 2616</span><span class="cls_024"><sup>79</sup></span><span class="cls_005"> —Hypertext Transfer Protocol (HTTP)</span></div>
<div style="position:absolute;left:60.99px;top:553.87px" class="cls_023"><span class="cls_023">RFC 2821</span><span class="cls_024"><sup>80</sup></span><span class="cls_005"> —Simple Mail Transfer Protocol (SMTP)</span></div>
<div style="position:absolute;left:60.99px;top:580.99px" class="cls_023"><span class="cls_023">RFC 3330</span><span class="cls_024"><sup>81</sup></span><span class="cls_005"> —Special-Use IPv4 Addresses</span></div>
<div style="position:absolute;left:60.99px;top:608.10px" class="cls_023"><span class="cls_023">RFC 3493</span><span class="cls_024"><sup>82</sup></span><span class="cls_005"> —Basic Socket Interface Extensions for IPv6</span></div>
<div style="position:absolute;left:60.99px;top:635.22px" class="cls_023"><span class="cls_023">RFC 3542</span><span class="cls_024"><sup>83</sup></span><span class="cls_005"> —Advanced Sockets Application Program Interface (API) for IPv6</span></div>
<div style="position:absolute;left:60.99px;top:662.33px" class="cls_023"><span class="cls_023">RFC 3849</span><span class="cls_024"><sup>84</sup></span><span class="cls_005"> —IPv6 Address Pre x Reserved for Documentation</span></div>
<div style="position:absolute;left:60.99px;top:689.45px" class="cls_023"><span class="cls_023">RFC 3920</span><span class="cls_024"><sup>85</sup></span><span class="cls_005"> —Extensible Messaging and Presence Protocol (XMPP)</span></div>
<div style="position:absolute;left:60.99px;top:716.56px" class="cls_023"><span class="cls_023">RFC 3977</span><span class="cls_024"><sup>86</sup></span><span class="cls_005"> —Network News Transfer Protocol (NNTP)</span></div>
<div style="position:absolute;left:60.99px;top:743.68px" class="cls_023"><span class="cls_023">RFC 4193</span><span class="cls_024"><sup>87</sup></span><span class="cls_005"> —Unique Local IPv6 Unicast Addresses</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">154 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:131054px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background155.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:60.99px;top:54.00px" class="cls_023"><span class="cls_023">RFC 4506</span><span class="cls_024"><sup>88</sup></span><span class="cls_005"> —External Data Representation Standard (XDR)</span></div>
<div style="position:absolute;left:60.99px;top:81.12px" class="cls_005"><span class="cls_005">O IETF possuia uma boa ferramenta online para </span><span class="cls_023">pesquisa e nave</span><span class="cls_006">g</span><span class="cls_023">a</span><span class="cls_006">ç</span><span class="cls_023">ão entre RFCs</span><span class="cls_024"><sup>89</sup></span></div>
<div style="position:absolute;left:76.97px;top:121.29px" class="cls_005"><span class="cls_005">1. https://www.linux.com/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:146.47px" class="cls_005"><span class="cls_005">2. https://bsd.org/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:171.65px" class="cls_005"><span class="cls_005">3. https://cygwin.com/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:196.83px" class="cls_005"><span class="cls_005">4. https://docs.microsoft.com/en-us/windows/wsl/about</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:222.01px" class="cls_005"><span class="cls_005">5. https://tangentsoft.net/wskfaq/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:247.19px" class="cls_005"><span class="cls_005">6. http://www.catb.org/~esr/faqs/smart-questions.html</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:272.37px" class="cls_005"><span class="cls_005">7. https://beej.us/guide/bgnet/examples/telnot.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:297.55px" class="cls_005"><span class="cls_005">8. https://tools.ietf.org/html/rfc854</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:76.97px;top:322.73px" class="cls_005"><span class="cls_005">9. https://tools.ietf.org/html/rfc793</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:347.91px" class="cls_005"><span class="cls_005">10. https://tools.ietf.org/html/rfc791</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:373.09px" class="cls_005"><span class="cls_005">11. https://tools.ietf.org/html/rfc768</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:398.27px" class="cls_005"><span class="cls_005">12. https://tools.ietf.org/html/rfc791</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:423.45px" class="cls_005"><span class="cls_005">13. https://en.wikipedia.org/wiki/Vint_Cerf</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:448.63px" class="cls_005"><span class="cls_005">14. https://en.wikipedia.org/wiki/ELIZA</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:473.81px" class="cls_005"><span class="cls_005">15. https://www.iana.org/assignments/port-numbers</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:498.99px" class="cls_005"><span class="cls_005">16. </span><A HREF="https://en.wikipedia.org/wiki/doom_(1993_video_game/">https://en.wikipedia.org/wiki/Doom_(1993_video_game</A>)<span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:524.17px" class="cls_005"><span class="cls_005">17. https://en.wikipedia.org/wiki/Wilford_Brimley</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:549.35px" class="cls_005"><span class="cls_005">18. https://tools.ietf.org/html/rfc1918</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:574.53px" class="cls_005"><span class="cls_005">19. https://tools.ietf.org/html/rfc4193</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:599.71px" class="cls_005"><span class="cls_005">20. https://www.iana.org/assignments/port-numbers</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:624.89px" class="cls_005"><span class="cls_005">21. https://beej.us/guide/bgnet/examples/showip.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:650.07px" class="cls_005"><span class="cls_005">22. https://tools.ietf.org/html/rfc1413</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:675.25px" class="cls_005"><span class="cls_005">23. https://beej.us/guide/bgnet/examples/server.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:700.43px" class="cls_005"><span class="cls_005">24. https://beej.us/guide/bgnet/examples/client.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:725.61px" class="cls_005"><span class="cls_005">25. https://beej.us/guide/bgnet/examples/listener.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">155 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:131905px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background156.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:70.68px;top:54.00px" class="cls_005"><span class="cls_005">26. https://beej.us/guide/bgnet/examples/talker.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:79.18px" class="cls_005"><span class="cls_005">27. https://libevent.org/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:104.36px" class="cls_005"><span class="cls_005">28. https://beej.us/guide/bgnet/examples/poll.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:129.54px" class="cls_005"><span class="cls_005">29. https://beej.us/guide/bgnet/examples/pollserver.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:154.72px" class="cls_005"><span class="cls_005">30. https://libevent.org/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:179.90px" class="cls_005"><span class="cls_005">31. https://beej.us/guide/bgnet/examples/select.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:205.08px" class="cls_005"><span class="cls_005">32. https://beej.us/guide/bgnet/examples/selectserver.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:230.26px" class="cls_005"><span class="cls_005">33. https://en.wikipedia.org/wiki/Internet_Relay_Chat</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:255.44px" class="cls_005"><span class="cls_005">34. https://beej.us/guide/bgnet/examples/pack.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:280.62px" class="cls_005"><span class="cls_005">35. https://en.wikipedia.org/wiki/IEEE_754</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:305.80px" class="cls_005"><span class="cls_005">36. https://beej.us/guide/bgnet/examples/ieee754.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:330.98px" class="cls_005"><span class="cls_005">37. https://beej.us/guide/url/tpop</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:356.16px" class="cls_005"><span class="cls_005">38. https://github.com/protobuf-c/protobuf-c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:381.34px" class="cls_005"><span class="cls_005">39. https://beej.us/guide/bgnet/examples/pack2.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:406.52px" class="cls_005"><span class="cls_005">40. https://beej.us/guide/bgnet/examples/pack2.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:431.70px" class="cls_005"><span class="cls_005">41. https://tools.ietf.org/html/rfc4506</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:456.88px" class="cls_005"><span class="cls_005">42. https://beej.us/guide/bgnet/examples/broadcaster.c</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:482.06px" class="cls_005"><span class="cls_005">43. http://www.unpbook.com/src.html</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:507.24px" class="cls_005"><span class="cls_005">44. http://www.unpbook.com/src.html</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:532.42px" class="cls_005"><span class="cls_005">45. https://www.openssl.org/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:557.60px" class="cls_005"><span class="cls_005">46. </span><A HREF="https://stackover/">https://stackover</A>  ow.com/questions/21323023/<span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:582.78px" class="cls_005"><span class="cls_005">47. https://www.iana.org/assignments/port-numbers</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:607.96px" class="cls_005"><span class="cls_005">48. https://www.iana.org/assignments/port-numbers</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:633.14px" class="cls_005"><span class="cls_005">49. https://beej.us/guide/url/unixnet1</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:658.32px" class="cls_005"><span class="cls_005">50. https://beej.us/guide/url/unixnet2</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:683.50px" class="cls_005"><span class="cls_005">51. https://beej.us/guide/url/intertcp1</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:708.68px" class="cls_005"><span class="cls_005">52. https://beej.us/guide/url/tcpi1</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:733.86px" class="cls_005"><span class="cls_005">53. https://beej.us/guide/url/tcpi2</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">156 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:132756px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background157.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:70.68px;top:54.00px" class="cls_005"><span class="cls_005">54. https://beej.us/guide/url/tcpi3</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:79.18px" class="cls_005"><span class="cls_005">55. https://beej.us/guide/url/tcpi123</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:104.36px" class="cls_005"><span class="cls_005">56. https://beej.us/guide/url/tcpna</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:129.54px" class="cls_005"><span class="cls_005">57. https://beej.us/guide/url/advunix</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:154.72px" class="cls_005"><span class="cls_005">58. https://cis.temple.edu/~giorgio/old/cis307s96/readings/docs/sockets.html</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:179.90px" class="cls_005"><span class="cls_005">59. https://developerweb.net/?f=70</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:205.08px" class="cls_005"><span class="cls_005">60. http://www.faqs.org/faqs/internet/tcp-ip/tcp-ip-faq/part1/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:230.26px" class="cls_005"><span class="cls_005">61. https://tangentsoft.net/wskfaq/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:255.44px" class="cls_005"><span class="cls_005">62. https://en.wikipedia.org/wiki/Berkeley_sockets</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:280.62px" class="cls_005"><span class="cls_005">63. https://en.wikipedia.org/wiki/Internet_Protocol</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:305.80px" class="cls_005"><span class="cls_005">64. https://en.wikipedia.org/wiki/Transmission_Control_Protocol</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:330.98px" class="cls_005"><span class="cls_005">65. https://en.wikipedia.org/wiki/User_Datagram_Protocol</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:356.16px" class="cls_005"><span class="cls_005">66. https://en.wikipedia.org/wiki/Client-server</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:381.34px" class="cls_005"><span class="cls_005">67. https://en.wikipedia.org/wiki/Serialization</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:406.52px" class="cls_005"><span class="cls_005">68. https://www.rfc-editor.org/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:431.70px" class="cls_005"><span class="cls_005">69. https://tools.ietf.org/html/rfc1</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:456.88px" class="cls_005"><span class="cls_005">70. https://tools.ietf.org/html/rfc768</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:482.06px" class="cls_005"><span class="cls_005">71. https://tools.ietf.org/html/rfc791</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:507.24px" class="cls_005"><span class="cls_005">72. https://tools.ietf.org/html/rfc793</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:532.42px" class="cls_005"><span class="cls_005">73. https://tools.ietf.org/html/rfc854</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:557.60px" class="cls_005"><span class="cls_005">74. https://tools.ietf.org/html/rfc959</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:582.78px" class="cls_005"><span class="cls_005">75. https://tools.ietf.org/html/rfc1350</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:607.96px" class="cls_005"><span class="cls_005">76. https://tools.ietf.org/html/rfc1459</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:633.14px" class="cls_005"><span class="cls_005">77. https://tools.ietf.org/html/rfc1918</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:658.32px" class="cls_005"><span class="cls_005">78. https://tools.ietf.org/html/rfc2131</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:683.50px" class="cls_005"><span class="cls_005">79. https://tools.ietf.org/html/rfc2616</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:708.68px" class="cls_005"><span class="cls_005">80. https://tools.ietf.org/html/rfc2821</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:733.86px" class="cls_005"><span class="cls_005">81. https://tools.ietf.org/html/rfc3330</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">157 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-297px;top:133607px;width:595px;height:841px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="c5d64f44-0d62-11eb-8b25-0cc47a792c0a_id_c5d64f44-0d62-11eb-8b25-0cc47a792c0a_files/background158.jpg" width=595 height=841></div>
<div style="position:absolute;left:18.00px;top:18.00px" class="cls_003"><span class="cls_003">Guia Beej's Para Programação em Rede</span></div>
<div style="position:absolute;left:327.40px;top:18.00px" class="cls_003"><span class="cls_003">file:///home/kassane/Downloads/Traducao_Guia...</span></div>
<div style="position:absolute;left:70.68px;top:54.00px" class="cls_005"><span class="cls_005">82. https://tools.ietf.org/html/rfc3493</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:79.18px" class="cls_005"><span class="cls_005">83. https://tools.ietf.org/html/rfc3542</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:104.36px" class="cls_005"><span class="cls_005">84. https://tools.ietf.org/html/rfc3849</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:129.54px" class="cls_005"><span class="cls_005">85. https://tools.ietf.org/html/rfc3920</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:154.72px" class="cls_005"><span class="cls_005">86. https://tools.ietf.org/html/rfc3977</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:179.90px" class="cls_005"><span class="cls_005">87. https://tools.ietf.org/html/rfc4193</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:205.08px" class="cls_005"><span class="cls_005">88. https://tools.ietf.org/html/rfc4506</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:70.68px;top:230.26px" class="cls_005"><span class="cls_005">89. https://tools.ietf.org/rfc/</span><span class="cls_027">↩</span></div>
<div style="position:absolute;left:18.00px;top:787.70px" class="cls_003"><span class="cls_003">158 of 158</span></div>
<div style="position:absolute;left:487.35px;top:787.70px" class="cls_003"><span class="cls_003">23/07/2020 13:49</span></div>
</div>

</body>
</html>
